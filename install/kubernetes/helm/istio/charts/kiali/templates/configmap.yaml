apiVersion: v1
kind: ConfigMap
metadata:
  name: kiali
  namespace: {{ .Release.Namespace }}
  labels:
    app: {{ template "kiali.name" . }}
    chart: {{ template "kiali.chart" . }}
    heritage: {{ .Release.Service }}
    release: {{ .Release.Name }}
data:
  config.yaml: |
    istio_namespace: {{ .Release.Namespace }}
    auth:
      strategy: {{ .Values.dashboard.auth.strategy }}
    server:
      port: 20001
{{- if .Values.contextPath }}
      web_root: {{ .Values.contextPath }}
{{- end }}
    external_services:
      tracing:
        url: {{ .Values.dashboard.jaegerURL }}
      grafana:
        url: {{ .Values.dashboard.grafanaURL }}
{{- if .Values.dashboard.grafana.auth }}
{{ toYaml .Values.dashboard.grafana.auth | indent 8 }}
{{- end }}
      prometheus:
        url: {{ .Values.prometheusAddr }}
