2020-08-31T00:35:45.977031Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6ed0db4e-2015-4c12-919f-a4814de3979e\".sock" 

2020-08-31T00:35:45.977108Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:35:46.278454Z	info	sds	resource:default new connection
2020-08-31T00:35:46.278521Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:35:46.278903Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:35:46.279287Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:35:46.279329Z	error	sds	Remote side closed connection
2020-08-31T00:35:46.279577Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6ed0db4e-2015-4c12-919f-a4814de3979e".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:35:51.573816Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c992dedd-e373-43b5-b7d0-75b858f66402\".sock" 

2020-08-31T00:35:51.573847Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:35:51.875230Z	info	sds	resource:default new connection
2020-08-31T00:35:51.875300Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:35:51.875777Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:35:51.876373Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:35:51.876398Z	error	sds	Remote side closed connection
2020-08-31T00:35:51.876553Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c992dedd-e373-43b5-b7d0-75b858f66402".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.621s
2020-08-31T00:35:57.230708Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e68ecee1-048b-4b92-a8af-db4c2a0f3047\".sock" 

2020-08-31T00:35:57.230769Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:35:57.532062Z	info	sds	resource:default new connection
2020-08-31T00:35:57.532129Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:35:57.532618Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:35:57.532976Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:35:57.533010Z	error	sds	Remote side closed connection
2020-08-31T00:35:57.533274Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e68ecee1-048b-4b92-a8af-db4c2a0f3047".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.618s
2020-08-31T00:36:02.848239Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"30b7bc76-a889-4e16-9457-6421ad8b0060\".sock" 

2020-08-31T00:36:02.848359Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:03.151781Z	info	sds	resource:default new connection
2020-08-31T00:36:03.152011Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:03.152832Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:03.153315Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:03.153347Z	error	sds	Remote side closed connection
2020-08-31T00:36:03.153507Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"30b7bc76-a889-4e16-9457-6421ad8b0060".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:36:08.425246Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"de7b41be-2d8e-4854-8855-f1f5cc7ead35\".sock" 

2020-08-31T00:36:08.425331Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:08.726794Z	info	sds	resource:default new connection
2020-08-31T00:36:08.726861Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:08.727317Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:08.727709Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:08.727755Z	error	sds	Remote side closed connection
2020-08-31T00:36:08.728028Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"de7b41be-2d8e-4854-8855-f1f5cc7ead35".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:36:14.081408Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9fc9e098-044e-4725-9cba-e6af4500cc6c\".sock" 

2020-08-31T00:36:14.081499Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:14.382891Z	info	sds	resource:default new connection
2020-08-31T00:36:14.382962Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:14.383413Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:14.383842Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:14.383898Z	error	sds	Remote side closed connection
2020-08-31T00:36:14.383968Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9fc9e098-044e-4725-9cba-e6af4500cc6c".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:36:19.702579Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"295a3290-aa9f-4244-a075-dc73e770584c\".sock" 

2020-08-31T00:36:19.702648Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:20.004165Z	info	sds	resource:default new connection
2020-08-31T00:36:20.004236Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:20.004781Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:20.005219Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:20.005251Z	error	sds	Remote side closed connection
2020-08-31T00:36:20.005477Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"295a3290-aa9f-4244-a075-dc73e770584c".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:36:25.267108Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"828d166c-93c9-4004-820e-124c953d42b8\".sock" 

2020-08-31T00:36:25.267170Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:25.568564Z	info	sds	resource:default new connection
2020-08-31T00:36:25.568634Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:25.569061Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:25.569457Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:25.569481Z	error	sds	Remote side closed connection
2020-08-31T00:36:25.569679Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"828d166c-93c9-4004-820e-124c953d42b8".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:36:30.868618Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2d6fbf82-2fdb-43b5-be53-e04dfa973076\".sock" 

2020-08-31T00:36:30.868730Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:31.170105Z	info	sds	resource:default new connection
2020-08-31T00:36:31.170173Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:31.170598Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:31.171076Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:31.171103Z	error	sds	Remote side closed connection
2020-08-31T00:36:31.171325Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2d6fbf82-2fdb-43b5-be53-e04dfa973076".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:36:36.398456Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b10ea32b-fde2-49a5-9a87-c18813449609\".sock" 

2020-08-31T00:36:36.398527Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:36.700069Z	info	sds	resource:default new connection
2020-08-31T00:36:36.700147Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:36.700849Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:36.701209Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:36.701236Z	error	sds	Remote side closed connection
2020-08-31T00:36:36.701591Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b10ea32b-fde2-49a5-9a87-c18813449609".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.621s
2020-08-31T00:36:42.019810Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2c54ac34-948c-4cd5-a7b9-bb36db006d60\".sock" 

2020-08-31T00:36:42.019881Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:42.321383Z	info	sds	resource:default new connection
2020-08-31T00:36:42.321450Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:42.321910Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:42.322306Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:42.322338Z	error	sds	Remote side closed connection
2020-08-31T00:36:42.322528Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2c54ac34-948c-4cd5-a7b9-bb36db006d60".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.626s
2020-08-31T00:36:47.642613Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"988df9f6-4dd3-4992-b0de-2cb49c7bbc50\".sock" 

2020-08-31T00:36:47.642684Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:47.944081Z	info	sds	resource:default new connection
2020-08-31T00:36:47.944152Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:47.944550Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:47.944858Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:47.944897Z	error	sds	Remote side closed connection
2020-08-31T00:36:47.945188Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"988df9f6-4dd3-4992-b0de-2cb49c7bbc50".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.617s
2020-08-31T00:36:53.193942Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f354a9db-fce5-47a3-9dc2-dd369ea9f7a3\".sock" 

2020-08-31T00:36:53.194023Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:53.495549Z	info	sds	resource:default new connection
2020-08-31T00:36:53.495618Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:53.496076Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:53.496454Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:53.496491Z	error	sds	Remote side closed connection
2020-08-31T00:36:53.496772Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f354a9db-fce5-47a3-9dc2-dd369ea9f7a3".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.620s
2020-08-31T00:36:58.731310Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e4fca183-29fb-4f05-afd2-8bfa16b49463\".sock" 

2020-08-31T00:36:58.731391Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:36:59.032880Z	info	sds	resource:default new connection
2020-08-31T00:36:59.032949Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:36:59.033394Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:36:59.033886Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:36:59.033931Z	error	sds	Remote side closed connection
2020-08-31T00:36:59.034188Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e4fca183-29fb-4f05-afd2-8bfa16b49463".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.620s
2020-08-31T00:37:04.300787Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4089aad8-e7da-4d6c-8a6f-3eadcecfa3f0\".sock" 

2020-08-31T00:37:04.300859Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:04.602353Z	info	sds	resource:default new connection
2020-08-31T00:37:04.602420Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:04.602907Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:04.603320Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:04.603351Z	error	sds	Remote side closed connection
2020-08-31T00:37:04.603506Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4089aad8-e7da-4d6c-8a6f-3eadcecfa3f0".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:37:09.840307Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"982845b6-11c7-458a-b560-9051197687bf\".sock" 

2020-08-31T00:37:09.840371Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:10.141747Z	info	sds	resource:default new connection
2020-08-31T00:37:10.141814Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:10.142332Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:10.142659Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:10.142686Z	error	sds	Remote side closed connection
2020-08-31T00:37:10.142994Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"982845b6-11c7-458a-b560-9051197687bf".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.620s
2020-08-31T00:37:15.404532Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ecf8c5c3-26c8-43b6-ac82-6c73662d4659\".sock" 

2020-08-31T00:37:15.404617Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:15.706149Z	info	sds	resource:default new connection
2020-08-31T00:37:15.706212Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:15.706744Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:15.707210Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:15.707234Z	error	sds	Remote side closed connection
2020-08-31T00:37:15.707432Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ecf8c5c3-26c8-43b6-ac82-6c73662d4659".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.621s
2020-08-31T00:37:20.977551Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"43ad1fc7-103f-4a08-b749-4627891b9a91\".sock" 

2020-08-31T00:37:20.977610Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:21.278986Z	info	sds	resource:default new connection
2020-08-31T00:37:21.279054Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:21.279484Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:21.279846Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:21.279876Z	error	sds	Remote side closed connection
2020-08-31T00:37:21.280106Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"43ad1fc7-103f-4a08-b749-4627891b9a91".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.620s
2020-08-31T00:37:26.524857Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7ffe36f7-3e57-47db-9a25-7d198c31d32e\".sock" 

2020-08-31T00:37:26.524919Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:26.826276Z	info	sds	resource:default new connection
2020-08-31T00:37:26.826344Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:26.826826Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:26.827220Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:26.827251Z	error	sds	Remote side closed connection
2020-08-31T00:37:26.827546Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7ffe36f7-3e57-47db-9a25-7d198c31d32e".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:37:32.062655Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"92b0e4dc-a7ea-4076-b768-c2ab744a67ef\".sock" 

2020-08-31T00:37:32.062717Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:32.364137Z	info	sds	resource:default new connection
2020-08-31T00:37:32.364202Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:32.364631Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:32.364996Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:32.365020Z	error	sds	Remote side closed connection
2020-08-31T00:37:32.365235Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"92b0e4dc-a7ea-4076-b768-c2ab744a67ef".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.621s
2020-08-31T00:37:37.614613Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"85463772-e2bc-4aed-be65-167bde279522\".sock" 

2020-08-31T00:37:37.614684Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:37.916128Z	info	sds	resource:default new connection
2020-08-31T00:37:37.916237Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:37.916769Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:37.917205Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:37.917256Z	error	sds	Remote side closed connection
2020-08-31T00:37:37.917425Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"85463772-e2bc-4aed-be65-167bde279522".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:37:43.207717Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8de66fc9-85a3-4e83-be15-1e322b2a1db3\".sock" 

2020-08-31T00:37:43.207750Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:43.509260Z	info	sds	resource:default new connection
2020-08-31T00:37:43.509368Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:43.509861Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:43.510386Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:43.510419Z	error	sds	Remote side closed connection
2020-08-31T00:37:43.510631Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8de66fc9-85a3-4e83-be15-1e322b2a1db3".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.627s
2020-08-31T00:37:48.758186Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"54d4619d-4610-4b96-b794-ff26026aa206\".sock" 

2020-08-31T00:37:48.758242Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:49.059706Z	info	sds	resource:default new connection
2020-08-31T00:37:49.059789Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:49.060179Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:49.060594Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:49.060638Z	error	sds	Remote side closed connection
2020-08-31T00:37:49.060860Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"54d4619d-4610-4b96-b794-ff26026aa206".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.617s
2020-08-31T00:37:54.235147Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"383b0ed2-5384-4ad7-aa3c-fd209c806477\".sock" 

2020-08-31T00:37:54.235216Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:37:54.536783Z	info	sds	resource:default new connection
2020-08-31T00:37:54.536889Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:37:54.537327Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:37:54.537690Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:37:54.537718Z	error	sds	Remote side closed connection
2020-08-31T00:37:54.537958Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"383b0ed2-5384-4ad7-aa3c-fd209c806477".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:37:59.767849Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"92d922ac-b8df-419a-89f3-7f968f4310e9\".sock" 

2020-08-31T00:37:59.767919Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:00.069999Z	info	sds	resource:default new connection
2020-08-31T00:38:00.070098Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:00.070996Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:00.071675Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:00.071699Z	error	sds	Remote side closed connection
2020-08-31T00:38:00.071903Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"92d922ac-b8df-419a-89f3-7f968f4310e9".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.619s
2020-08-31T00:38:05.386963Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"23695055-e26a-4f0b-8b93-12250dc6c31b\".sock" 

2020-08-31T00:38:05.387032Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:05.689045Z	info	sds	resource:default new connection
2020-08-31T00:38:05.689125Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:05.689576Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:05.690016Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:05.690042Z	error	sds	Remote side closed connection
2020-08-31T00:38:05.690233Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"23695055-e26a-4f0b-8b93-12250dc6c31b".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.627s
2020-08-31T00:38:11.643980Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bb37a5d6-cb72-4e99-b21c-7cb48a19b98b\".sock" 

2020-08-31T00:38:11.644088Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:11.945605Z	info	sds	resource:default new connection
2020-08-31T00:38:11.945679Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:11.946203Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:11.946579Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:11.946637Z	error	sds	Remote side closed connection
2020-08-31T00:38:11.946938Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bb37a5d6-cb72-4e99-b21c-7cb48a19b98b".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.652s
2020-08-31T00:38:17.879398Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"656cbbc9-0d99-436c-be3f-59337a81ebcb\".sock" 

2020-08-31T00:38:17.879481Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:18.181134Z	info	sds	resource:default new connection
2020-08-31T00:38:18.181211Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:18.181844Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:18.182285Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:18.182338Z	error	sds	Remote side closed connection
2020-08-31T00:38:18.182680Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"656cbbc9-0d99-436c-be3f-59337a81ebcb".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.655s
2020-08-31T00:38:24.278175Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0c936a0d-6f17-4320-b806-51e3716aa046\".sock" 

2020-08-31T00:38:24.278221Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:24.579844Z	info	sds	resource:default new connection
2020-08-31T00:38:24.579966Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:24.580352Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:24.580756Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:24.580775Z	error	sds	Remote side closed connection
2020-08-31T00:38:24.581023Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0c936a0d-6f17-4320-b806-51e3716aa046".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.647s
2020-08-31T00:38:30.163556Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"78e2ffb9-b5be-44c2-94ab-3a43044c6161\".sock" 

2020-08-31T00:38:30.163624Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:30.465252Z	info	sds	resource:default new connection
2020-08-31T00:38:30.465333Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:30.466014Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:30.466380Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:30.466415Z	error	sds	Remote side closed connection
2020-08-31T00:38:30.466705Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"78e2ffb9-b5be-44c2-94ab-3a43044c6161".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:38:35.894488Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8de69fe6-2230-4d61-bb92-f31b38271d50\".sock" 

2020-08-31T00:38:35.894526Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:36.196184Z	info	sds	resource:default new connection
2020-08-31T00:38:36.196366Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:36.196904Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:36.197334Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:36.197364Z	error	sds	Remote side closed connection
2020-08-31T00:38:36.197566Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8de69fe6-2230-4d61-bb92-f31b38271d50".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.636s
2020-08-31T00:38:41.567766Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"506020c2-f697-47c5-aea6-c8c351f84767\".sock" 

2020-08-31T00:38:41.567830Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:41.869361Z	info	sds	resource:default new connection
2020-08-31T00:38:41.869478Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:41.869971Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:41.870286Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:41.870319Z	error	sds	Remote side closed connection
2020-08-31T00:38:41.870637Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"506020c2-f697-47c5-aea6-c8c351f84767".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.619s
2020-08-31T00:38:47.115532Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8f6aa741-09c8-495f-9790-8e4e330960c1\".sock" 

2020-08-31T00:38:47.115571Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:47.417190Z	info	sds	resource:default new connection
2020-08-31T00:38:47.417276Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:47.417795Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:47.418227Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:47.418258Z	error	sds	Remote side closed connection
2020-08-31T00:38:47.418479Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8f6aa741-09c8-495f-9790-8e4e330960c1".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.620s
2020-08-31T00:38:52.642492Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"cf8139cd-db79-4530-91d0-84ead70ba1a2\".sock" 

2020-08-31T00:38:52.642558Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:52.943980Z	info	sds	resource:default new connection
2020-08-31T00:38:52.944054Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:52.944567Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:52.944882Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:52.944929Z	error	sds	Remote side closed connection
2020-08-31T00:38:52.945213Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"cf8139cd-db79-4530-91d0-84ead70ba1a2".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.619s
2020-08-31T00:38:58.169509Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e9a2ffee-9e03-4288-b9c7-e5ce19618f3a\".sock" 

2020-08-31T00:38:58.169586Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:38:58.471105Z	info	sds	resource:default new connection
2020-08-31T00:38:58.471174Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:38:58.471722Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:38:58.472077Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:38:58.472113Z	error	sds	Remote side closed connection
2020-08-31T00:38:58.472393Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e9a2ffee-9e03-4288-b9c7-e5ce19618f3a".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:39:03.744616Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f3233d62-0f22-4df2-bffd-46cedaaa2e8b\".sock" 

2020-08-31T00:39:03.744724Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:04.046154Z	info	sds	resource:default new connection
2020-08-31T00:39:04.046241Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:04.046926Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:04.047324Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:04.047352Z	error	sds	Remote side closed connection
2020-08-31T00:39:04.047572Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f3233d62-0f22-4df2-bffd-46cedaaa2e8b".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.620s
2020-08-31T00:39:09.262825Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d4d95a1c-b20d-4243-8236-87607cd4bfdd\".sock" 

2020-08-31T00:39:09.262861Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:09.564228Z	info	sds	resource:default new connection
2020-08-31T00:39:09.564333Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:09.564877Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:09.565223Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:09.565256Z	error	sds	Remote side closed connection
2020-08-31T00:39:09.565544Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d4d95a1c-b20d-4243-8236-87607cd4bfdd".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.629s
2020-08-31T00:39:14.843933Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"81288011-67ba-461e-8ee5-6f6da7327e05\".sock" 

2020-08-31T00:39:14.844001Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:15.145354Z	info	sds	resource:default new connection
2020-08-31T00:39:15.145429Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:15.145909Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:15.146205Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:15.146226Z	error	sds	Remote side closed connection
2020-08-31T00:39:15.146542Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"81288011-67ba-461e-8ee5-6f6da7327e05".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.621s
2020-08-31T00:39:20.404117Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0414ac45-379f-4ecf-b0f6-4e4cebbec716\".sock" 

2020-08-31T00:39:20.404182Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:20.705628Z	info	sds	resource:default new connection
2020-08-31T00:39:20.705690Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:20.706254Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:20.706789Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:20.706821Z	error	sds	Remote side closed connection
2020-08-31T00:39:20.707007Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0414ac45-379f-4ecf-b0f6-4e4cebbec716".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.620s
2020-08-31T00:39:25.952704Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"abd53d9c-9be3-475d-8047-441fcabac308\".sock" 

2020-08-31T00:39:25.952786Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:26.254259Z	info	sds	resource:default new connection
2020-08-31T00:39:26.254348Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:26.254890Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:26.255398Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:26.255424Z	error	sds	Remote side closed connection
2020-08-31T00:39:26.255719Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"abd53d9c-9be3-475d-8047-441fcabac308".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:39:31.585604Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5c1c5a94-e2a3-494e-9dbf-064952a62082\".sock" 

2020-08-31T00:39:31.585647Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:31.887122Z	info	sds	resource:default new connection
2020-08-31T00:39:31.887191Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:31.887568Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:31.887932Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:31.887972Z	error	sds	Remote side closed connection
2020-08-31T00:39:31.888188Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5c1c5a94-e2a3-494e-9dbf-064952a62082".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.619s
2020-08-31T00:39:37.157765Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"fbc78f66-d9ee-4991-85ce-a2ef4ec33b10\".sock" 

2020-08-31T00:39:37.157828Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:37.459149Z	info	sds	resource:default new connection
2020-08-31T00:39:37.459236Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:37.459755Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:37.460172Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:37.460210Z	error	sds	Remote side closed connection
2020-08-31T00:39:37.460543Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"fbc78f66-d9ee-4991-85ce-a2ef4ec33b10".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.619s
2020-08-31T00:39:42.899904Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3cb75aa5-bea8-45c9-89e0-4686864bf7aa\".sock" 

2020-08-31T00:39:42.899944Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:43.201436Z	info	sds	resource:default new connection
2020-08-31T00:39:43.201510Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:43.201964Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:43.202461Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:43.202506Z	error	sds	Remote side closed connection
2020-08-31T00:39:43.202680Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3cb75aa5-bea8-45c9-89e0-4686864bf7aa".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.636s
2020-08-31T00:39:48.543579Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"cddefe3a-8991-4eaa-8461-9ac1db120c1b\".sock" 

2020-08-31T00:39:48.543643Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:48.845238Z	info	sds	resource:default new connection
2020-08-31T00:39:48.845337Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:48.845693Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:48.846088Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:48.846125Z	error	sds	Remote side closed connection
2020-08-31T00:39:48.846233Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"cddefe3a-8991-4eaa-8461-9ac1db120c1b".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.634s
2020-08-31T00:39:54.152800Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7ce416fa-86e8-468c-952b-6369af917c59\".sock" 

2020-08-31T00:39:54.152867Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:39:54.454093Z	info	sds	resource:default new connection
2020-08-31T00:39:54.454158Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:39:54.454597Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:39:54.455005Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:39:54.455028Z	error	sds	Remote side closed connection
2020-08-31T00:39:54.455243Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7ce416fa-86e8-468c-952b-6369af917c59".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.629s
2020-08-31T00:39:59.736575Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d3917825-6828-4e17-b04a-18b7b7dcd951\".sock" 

2020-08-31T00:39:59.736645Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:00.038046Z	info	sds	resource:default new connection
2020-08-31T00:40:00.038142Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:00.038696Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:00.039095Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:00.039131Z	error	sds	Remote side closed connection
2020-08-31T00:40:00.039487Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d3917825-6828-4e17-b04a-18b7b7dcd951".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.627s
2020-08-31T00:40:05.329134Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c0a90172-7195-4adb-88fd-ad250ccc9f3e\".sock" 

2020-08-31T00:40:05.329216Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:05.630777Z	info	sds	resource:default new connection
2020-08-31T00:40:05.630849Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:05.631326Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:05.631755Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:05.631790Z	error	sds	Remote side closed connection
2020-08-31T00:40:05.632129Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c0a90172-7195-4adb-88fd-ad250ccc9f3e".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:40:10.938762Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"668519f9-a1d3-4c71-9b5d-47d9b86fbcf8\".sock" 

2020-08-31T00:40:10.938832Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:11.240355Z	info	sds	resource:default new connection
2020-08-31T00:40:11.240424Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:11.240981Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:11.241482Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:11.241513Z	error	sds	Remote side closed connection
2020-08-31T00:40:11.241615Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"668519f9-a1d3-4c71-9b5d-47d9b86fbcf8".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.642s
2020-08-31T00:40:16.573862Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c2747bb6-6c9f-441b-92a8-c27d1236cb6d\".sock" 

2020-08-31T00:40:16.573940Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:16.875630Z	info	sds	resource:default new connection
2020-08-31T00:40:16.875714Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:16.876229Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:16.876833Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:16.876884Z	error	sds	Remote side closed connection
2020-08-31T00:40:16.877161Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c2747bb6-6c9f-441b-92a8-c27d1236cb6d".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.631s
2020-08-31T00:40:22.297748Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ca1cb5ef-58e9-41d9-96e4-0b76da5b0755\".sock" 

2020-08-31T00:40:22.297822Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:22.599454Z	info	sds	resource:default new connection
2020-08-31T00:40:22.599512Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:22.599968Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:22.600429Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:22.600457Z	error	sds	Remote side closed connection
2020-08-31T00:40:22.600758Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ca1cb5ef-58e9-41d9-96e4-0b76da5b0755".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.643s
2020-08-31T00:40:28.400865Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a9b359a7-7567-41a6-9c72-ac0c8ebf1cba\".sock" 

2020-08-31T00:40:28.400932Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:28.702524Z	info	sds	resource:default new connection
2020-08-31T00:40:28.702595Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:28.703187Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:28.703671Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:28.703707Z	error	sds	Remote side closed connection
2020-08-31T00:40:28.703864Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a9b359a7-7567-41a6-9c72-ac0c8ebf1cba".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.638s
2020-08-31T00:40:34.219822Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a77d65eb-cc05-42ef-8705-ffa6148b4c7c\".sock" 

2020-08-31T00:40:34.219856Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:34.521603Z	info	sds	resource:default new connection
2020-08-31T00:40:34.521664Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:34.522162Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:34.522599Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:34.522617Z	error	sds	Remote side closed connection
2020-08-31T00:40:34.522963Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a77d65eb-cc05-42ef-8705-ffa6148b4c7c".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.638s
2020-08-31T00:40:40.037210Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bc776c10-282e-4634-8bd4-a712d35d0a4a\".sock" 

2020-08-31T00:40:40.037285Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:40.338854Z	info	sds	resource:default new connection
2020-08-31T00:40:40.338926Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:40.339475Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:40.339941Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:40.339969Z	error	sds	Remote side closed connection
2020-08-31T00:40:40.340298Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bc776c10-282e-4634-8bd4-a712d35d0a4a".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.641s
2020-08-31T00:40:45.705371Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"cb4ee013-c25d-468c-9aeb-993d7c0a293a\".sock" 

2020-08-31T00:40:45.705414Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:46.006733Z	info	sds	resource:default new connection
2020-08-31T00:40:46.006801Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:46.007208Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:46.007623Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:46.007663Z	error	sds	Remote side closed connection
2020-08-31T00:40:46.007891Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"cb4ee013-c25d-468c-9aeb-993d7c0a293a".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.628s
2020-08-31T00:40:51.235545Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7bbeec1c-e6a8-44b1-b9bc-f28d862ed572\".sock" 

2020-08-31T00:40:51.235615Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:51.537188Z	info	sds	resource:default new connection
2020-08-31T00:40:51.537255Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:51.537766Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:51.538095Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:51.538118Z	error	sds	Remote side closed connection
2020-08-31T00:40:51.538342Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7bbeec1c-e6a8-44b1-b9bc-f28d862ed572".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:40:56.765284Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"322c4ba6-107a-47f8-bd97-2b4ff2a63c30\".sock" 

2020-08-31T00:40:56.765328Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:40:57.066706Z	info	sds	resource:default new connection
2020-08-31T00:40:57.066834Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:40:57.067438Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:40:57.067732Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:40:57.067783Z	error	sds	Remote side closed connection
2020-08-31T00:40:57.068040Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"322c4ba6-107a-47f8-bd97-2b4ff2a63c30".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:41:02.392047Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ab8f3cba-50f3-4b00-9841-ba8edea00e43\".sock" 

2020-08-31T00:41:02.392085Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:02.693657Z	info	sds	resource:default new connection
2020-08-31T00:41:02.693734Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:02.694103Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:02.694388Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:02.694416Z	error	sds	Remote side closed connection
2020-08-31T00:41:02.694701Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ab8f3cba-50f3-4b00-9841-ba8edea00e43".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.626s
2020-08-31T00:41:07.955245Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bc783f45-e8c3-4cc2-b8b7-da83c014ddd5\".sock" 

2020-08-31T00:41:07.955333Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:08.256786Z	info	sds	resource:default new connection
2020-08-31T00:41:08.256898Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:08.257417Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:08.257949Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:08.257982Z	error	sds	Remote side closed connection
2020-08-31T00:41:08.258103Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bc783f45-e8c3-4cc2-b8b7-da83c014ddd5".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.624s
2020-08-31T00:41:13.564215Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ed63d7ea-d2ab-4e0e-bbbd-188902935ed1\".sock" 

2020-08-31T00:41:13.564293Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:13.866004Z	info	sds	resource:default new connection
2020-08-31T00:41:13.866073Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:13.866456Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:13.866852Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:13.866887Z	error	sds	Remote side closed connection
2020-08-31T00:41:13.867119Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ed63d7ea-d2ab-4e0e-bbbd-188902935ed1".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.626s
2020-08-31T00:41:19.133878Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b327879e-ee2b-46fa-84dc-bf67915be406\".sock" 

2020-08-31T00:41:19.133945Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:19.435363Z	info	sds	resource:default new connection
2020-08-31T00:41:19.435431Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:19.435939Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:19.436386Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:19.436422Z	error	sds	Remote side closed connection
2020-08-31T00:41:19.436616Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b327879e-ee2b-46fa-84dc-bf67915be406".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.628s
2020-08-31T00:41:24.722155Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f84d06c0-3767-4aad-8b1b-0fe15bc54a55\".sock" 

2020-08-31T00:41:24.722221Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:25.023719Z	info	sds	resource:default new connection
2020-08-31T00:41:25.023811Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:25.024275Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:25.024846Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:25.024881Z	error	sds	Remote side closed connection
2020-08-31T00:41:25.025214Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f84d06c0-3767-4aad-8b1b-0fe15bc54a55".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:41:30.296338Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b2b9ab2f-15d4-4bb4-99f0-16445f416ea5\".sock" 

2020-08-31T00:41:30.296405Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:30.597640Z	info	sds	resource:default new connection
2020-08-31T00:41:30.597714Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:30.598249Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:30.598576Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:30.598624Z	error	sds	Remote side closed connection
2020-08-31T00:41:30.598827Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b2b9ab2f-15d4-4bb4-99f0-16445f416ea5".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:41:35.884682Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f533d6cf-a8fb-410a-8da9-56bf91d469c6\".sock" 

2020-08-31T00:41:35.884761Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:36.186208Z	info	sds	resource:default new connection
2020-08-31T00:41:36.186320Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:36.186778Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:36.187209Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:36.187238Z	error	sds	Remote side closed connection
2020-08-31T00:41:36.187380Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f533d6cf-a8fb-410a-8da9-56bf91d469c6".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:41:41.408920Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bb623d63-8760-4085-9d33-9e55e7a3bc89\".sock" 

2020-08-31T00:41:41.408950Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:41.710576Z	info	sds	resource:default new connection
2020-08-31T00:41:41.710642Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:41.711090Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:41.711460Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:41.711509Z	error	sds	Remote side closed connection
2020-08-31T00:41:41.711804Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bb623d63-8760-4085-9d33-9e55e7a3bc89".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.629s
2020-08-31T00:41:47.006241Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"133dbed6-adc1-4507-ac45-3eab6b8b630b\".sock" 

2020-08-31T00:41:47.006314Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:47.307642Z	info	sds	resource:default new connection
2020-08-31T00:41:47.307720Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:47.308207Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:47.308594Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:47.308632Z	error	sds	Remote side closed connection
2020-08-31T00:41:47.308877Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"133dbed6-adc1-4507-ac45-3eab6b8b630b".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.629s
2020-08-31T00:41:52.560346Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1a9ecbf7-788c-42f9-a9d1-d0e9ece75baa\".sock" 

2020-08-31T00:41:52.560412Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:52.864761Z	info	sds	resource:default new connection
2020-08-31T00:41:52.864895Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:52.865882Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:52.866271Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:52.866299Z	error	sds	Remote side closed connection
2020-08-31T00:41:52.866620Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1a9ecbf7-788c-42f9-a9d1-d0e9ece75baa".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:41:58.118462Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"56522d20-a523-4144-ae88-ddddddd27012\".sock" 

2020-08-31T00:41:58.118537Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:41:58.419869Z	info	sds	resource:default new connection
2020-08-31T00:41:58.419929Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:41:58.420325Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:41:58.420691Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:41:58.420723Z	error	sds	Remote side closed connection
2020-08-31T00:41:58.421008Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"56522d20-a523-4144-ae88-ddddddd27012".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.628s
2020-08-31T00:42:03.710415Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"494bf79b-94b0-47d3-8c8d-e08ac322c4ad\".sock" 

2020-08-31T00:42:03.710477Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:04.011931Z	info	sds	resource:default new connection
2020-08-31T00:42:04.012001Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:04.012370Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:04.012709Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:04.012734Z	error	sds	Remote side closed connection
2020-08-31T00:42:04.012964Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"494bf79b-94b0-47d3-8c8d-e08ac322c4ad".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.620s
2020-08-31T00:42:09.251287Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1b48577b-5d51-4ec3-9cce-d6e1172a52f8\".sock" 

2020-08-31T00:42:09.251360Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:09.552751Z	info	sds	resource:default new connection
2020-08-31T00:42:09.552844Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:09.553256Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:09.553646Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:09.553700Z	error	sds	Remote side closed connection
2020-08-31T00:42:09.553888Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1b48577b-5d51-4ec3-9cce-d6e1172a52f8".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.631s
2020-08-31T00:42:14.813421Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"49579235-57e0-4e8c-b494-c44f8ce07e9e\".sock" 

2020-08-31T00:42:14.813476Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:15.114847Z	info	sds	resource:default new connection
2020-08-31T00:42:15.114911Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:15.115441Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:15.115913Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:15.115936Z	error	sds	Remote side closed connection
2020-08-31T00:42:15.116198Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"49579235-57e0-4e8c-b494-c44f8ce07e9e".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:42:20.390950Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a9374a36-444d-40b0-a33f-f529d4942c91\".sock" 

2020-08-31T00:42:20.391029Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:20.692783Z	info	sds	resource:default new connection
2020-08-31T00:42:20.692843Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:20.693256Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:20.693586Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:20.693611Z	error	sds	Remote side closed connection
2020-08-31T00:42:20.693885Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a9374a36-444d-40b0-a33f-f529d4942c91".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:42:25.973186Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8a6a87a1-4897-46f6-aa93-51844a9bbc00\".sock" 

2020-08-31T00:42:25.973248Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:26.274797Z	info	sds	resource:default new connection
2020-08-31T00:42:26.274865Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:26.275400Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:26.275719Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:26.275759Z	error	sds	Remote side closed connection
2020-08-31T00:42:26.275952Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8a6a87a1-4897-46f6-aa93-51844a9bbc00".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.626s
2020-08-31T00:42:31.585164Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6ee05242-27c7-486d-931c-98a650bf2f68\".sock" 

2020-08-31T00:42:31.585236Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:31.886787Z	info	sds	resource:default new connection
2020-08-31T00:42:31.886841Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:31.887300Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:31.887701Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:31.887737Z	error	sds	Remote side closed connection
2020-08-31T00:42:31.887965Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6ee05242-27c7-486d-931c-98a650bf2f68".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:42:37.145070Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"406cb03a-cb21-4efd-9d3c-e5dcabe3aa6f\".sock" 

2020-08-31T00:42:37.145133Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:37.446447Z	info	sds	resource:default new connection
2020-08-31T00:42:37.446531Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:37.446882Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:37.447200Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:37.447230Z	error	sds	Remote side closed connection
2020-08-31T00:42:37.447494Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"406cb03a-cb21-4efd-9d3c-e5dcabe3aa6f".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:42:42.720586Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bb1f1c1b-999a-4e58-b7c8-6e0c7edd6655\".sock" 

2020-08-31T00:42:42.720675Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:43.022374Z	info	sds	resource:default new connection
2020-08-31T00:42:43.022441Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:43.022923Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:43.023298Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:43.023339Z	error	sds	Remote side closed connection
2020-08-31T00:42:43.023599Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bb1f1c1b-999a-4e58-b7c8-6e0c7edd6655".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.627s
2020-08-31T00:42:48.215218Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"dd3c9e86-b902-43b4-ae25-3a65d1964e0e\".sock" 

2020-08-31T00:42:48.215298Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:48.516949Z	info	sds	resource:default new connection
2020-08-31T00:42:48.517028Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:48.517454Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:48.517834Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:48.517862Z	error	sds	Remote side closed connection
2020-08-31T00:42:48.518110Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"dd3c9e86-b902-43b4-ae25-3a65d1964e0e".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.624s
2020-08-31T00:42:53.728172Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2846ffff-5b95-4f89-8941-949211c5f47a\".sock" 

2020-08-31T00:42:53.728236Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:54.029918Z	info	sds	resource:default new connection
2020-08-31T00:42:54.030038Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:54.030616Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:54.031045Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:54.031080Z	error	sds	Remote side closed connection
2020-08-31T00:42:54.031351Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2846ffff-5b95-4f89-8941-949211c5f47a".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.626s
2020-08-31T00:42:59.207752Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c81112dd-274d-4c13-9769-91a5d057fd6b\".sock" 

2020-08-31T00:42:59.207818Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:42:59.509342Z	info	sds	resource:default new connection
2020-08-31T00:42:59.509450Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:42:59.510072Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:42:59.510542Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:42:59.510570Z	error	sds	Remote side closed connection
2020-08-31T00:42:59.510738Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c81112dd-274d-4c13-9769-91a5d057fd6b".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.624s
2020-08-31T00:43:04.755218Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b0793805-df82-4e35-b4ed-0bd0252e2ccc\".sock" 

2020-08-31T00:43:04.755289Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:05.056924Z	info	sds	resource:default new connection
2020-08-31T00:43:05.057097Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:05.057730Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:05.058242Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:05.058265Z	error	sds	Remote side closed connection
2020-08-31T00:43:05.058560Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b0793805-df82-4e35-b4ed-0bd0252e2ccc".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:43:10.297065Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bf7260ab-7c44-4bbb-8f83-1980ad9f5c17\".sock" 

2020-08-31T00:43:10.297135Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:10.598529Z	info	sds	resource:default new connection
2020-08-31T00:43:10.598607Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:10.599125Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:10.599527Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:10.599547Z	error	sds	Remote side closed connection
2020-08-31T00:43:10.599824Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bf7260ab-7c44-4bbb-8f83-1980ad9f5c17".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.631s
2020-08-31T00:43:15.869894Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3fb056f8-8e78-4771-a7f6-367bd6f9641d\".sock" 

2020-08-31T00:43:15.869962Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:16.171494Z	info	sds	resource:default new connection
2020-08-31T00:43:16.171573Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:16.172067Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:16.172468Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:16.172494Z	error	sds	Remote side closed connection
2020-08-31T00:43:16.172826Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3fb056f8-8e78-4771-a7f6-367bd6f9641d".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.624s
2020-08-31T00:43:21.455104Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a349ba13-9a66-4464-bcb7-c0d92c944100\".sock" 

2020-08-31T00:43:21.455210Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:21.756822Z	info	sds	resource:default new connection
2020-08-31T00:43:21.756909Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:21.757335Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:21.757620Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:21.757636Z	error	sds	Remote side closed connection
2020-08-31T00:43:21.757889Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a349ba13-9a66-4464-bcb7-c0d92c944100".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:43:27.178106Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b1b7c64a-33af-404a-bc92-919047bd8c2e\".sock" 

2020-08-31T00:43:27.178168Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:27.479884Z	info	sds	resource:default new connection
2020-08-31T00:43:27.479969Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:27.480423Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:27.480913Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:27.480945Z	error	sds	Remote side closed connection
2020-08-31T00:43:27.481165Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b1b7c64a-33af-404a-bc92-919047bd8c2e".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.632s
2020-08-31T00:43:32.760092Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"82161fa3-c857-4224-af69-e797f590d68c\".sock" 

2020-08-31T00:43:32.760164Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:33.061670Z	info	sds	resource:default new connection
2020-08-31T00:43:33.061739Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:33.062183Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:33.062554Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:33.062580Z	error	sds	Remote side closed connection
2020-08-31T00:43:33.062802Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"82161fa3-c857-4224-af69-e797f590d68c".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:43:38.348969Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a18f4f33-0f09-4ff0-a034-4f20b5b21ce2\".sock" 

2020-08-31T00:43:38.349038Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:38.650821Z	info	sds	resource:default new connection
2020-08-31T00:43:38.650893Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:38.651290Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:38.651651Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:38.651679Z	error	sds	Remote side closed connection
2020-08-31T00:43:38.652149Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a18f4f33-0f09-4ff0-a034-4f20b5b21ce2".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.628s
2020-08-31T00:43:44.303946Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c1406faa-ba9e-4449-915c-9259d1a3d38a\".sock" 

2020-08-31T00:43:44.304015Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:44.605436Z	info	sds	resource:default new connection
2020-08-31T00:43:44.605520Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:44.605927Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:44.606277Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:44.606301Z	error	sds	Remote side closed connection
2020-08-31T00:43:44.606641Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c1406faa-ba9e-4449-915c-9259d1a3d38a".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.639s
2020-08-31T00:43:49.876062Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7bb2dce3-04ee-4353-a562-66227f45f1dc\".sock" 

2020-08-31T00:43:49.876135Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:50.177662Z	info	sds	resource:default new connection
2020-08-31T00:43:50.177724Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:50.178195Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:50.178654Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:50.178694Z	error	sds	Remote side closed connection
2020-08-31T00:43:50.178825Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7bb2dce3-04ee-4353-a562-66227f45f1dc".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:43:55.407666Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6fc67821-7c2d-4d1d-b047-d72f766e7778\".sock" 

2020-08-31T00:43:55.407734Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:43:55.709419Z	info	sds	resource:default new connection
2020-08-31T00:43:55.709481Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:43:55.709982Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:43:55.710345Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:43:55.710382Z	error	sds	Remote side closed connection
2020-08-31T00:43:55.710664Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6fc67821-7c2d-4d1d-b047-d72f766e7778".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.629s
2020-08-31T00:44:00.951086Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9d41000c-dfb1-4d7d-aaed-4d1e7e8e386e\".sock" 

2020-08-31T00:44:00.951151Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:01.252722Z	info	sds	resource:default new connection
2020-08-31T00:44:01.252791Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:01.253195Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:01.253581Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:01.253618Z	error	sds	Remote side closed connection
2020-08-31T00:44:01.253898Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9d41000c-dfb1-4d7d-aaed-4d1e7e8e386e".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.630s
2020-08-31T00:44:06.501706Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b48c23f1-43de-4644-8c9f-0997f37f85eb\".sock" 

2020-08-31T00:44:06.501768Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:06.803243Z	info	sds	resource:default new connection
2020-08-31T00:44:06.803310Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:06.803838Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:06.804338Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:06.804394Z	error	sds	Remote side closed connection
2020-08-31T00:44:06.804536Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b48c23f1-43de-4644-8c9f-0997f37f85eb".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:44:12.107143Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8dac5f55-8387-441c-8365-d3d0860b0f3d\".sock" 

2020-08-31T00:44:12.107182Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:12.408803Z	info	sds	resource:default new connection
2020-08-31T00:44:12.408885Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:12.409365Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:12.409841Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:12.409870Z	error	sds	Remote side closed connection
2020-08-31T00:44:12.410070Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8dac5f55-8387-441c-8365-d3d0860b0f3d".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.629s
2020-08-31T00:44:17.706159Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4976e36f-82e8-4e9e-aa75-d210306c3077\".sock" 

2020-08-31T00:44:17.706224Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:18.007661Z	info	sds	resource:default new connection
2020-08-31T00:44:18.007731Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:18.008212Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:18.008752Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:18.008795Z	error	sds	Remote side closed connection
2020-08-31T00:44:18.008852Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4976e36f-82e8-4e9e-aa75-d210306c3077".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.623s
2020-08-31T00:44:23.280517Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8cf4637f-a26f-46d1-942e-ff1fc88dcdd9\".sock" 

2020-08-31T00:44:23.280559Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:23.582157Z	info	sds	resource:default new connection
2020-08-31T00:44:23.582238Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:23.582773Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:23.583094Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:23.583130Z	error	sds	Remote side closed connection
2020-08-31T00:44:23.583399Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8cf4637f-a26f-46d1-942e-ff1fc88dcdd9".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.625s
2020-08-31T00:44:29.908943Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4fb18d97-533f-4020-ac6f-075e2c59f064\".sock" 

2020-08-31T00:44:29.908998Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:30.210388Z	info	sds	resource:default new connection
2020-08-31T00:44:30.210467Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:30.210983Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:30.211432Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:30.211487Z	error	sds	Remote side closed connection
2020-08-31T00:44:30.211737Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4fb18d97-533f-4020-ac6f-075e2c59f064".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.624s
2020-08-31T00:44:35.440677Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"21ac664b-f5c8-4e8a-8d7f-f42d529dac62\".sock" 

2020-08-31T00:44:35.440757Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:35.742201Z	info	sds	resource:default new connection
2020-08-31T00:44:35.742276Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:35.742761Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:35.743104Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:35.743136Z	error	sds	Remote side closed connection
2020-08-31T00:44:35.743332Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"21ac664b-f5c8-4e8a-8d7f-f42d529dac62".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.622s
2020-08-31T00:44:41.014889Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"df5e9988-40b1-403b-8d1f-b3807e1d5385\".sock" 

2020-08-31T00:44:41.014963Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:41.316497Z	info	sds	resource:default new connection
2020-08-31T00:44:41.316570Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:41.317001Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:41.317363Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:41.317414Z	error	sds	Remote side closed connection
2020-08-31T00:44:41.317639Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"df5e9988-40b1-403b-8d1f-b3807e1d5385".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.627s
2020-08-31T00:44:46.634689Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"cc791933-6753-4768-b995-ae7ce197475c\".sock" 

2020-08-31T00:44:46.634752Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:46.936052Z	info	sds	resource:default new connection
2020-08-31T00:44:46.936127Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:46.936585Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:46.937088Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:46.937132Z	error	sds	Remote side closed connection
2020-08-31T00:44:46.937343Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"cc791933-6753-4768-b995-ae7ce197475c".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.627s
2020-08-31T00:44:52.161017Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"04352865-d1db-4b02-93b9-1bb9bbfb82b2\".sock" 

2020-08-31T00:44:52.161079Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:52.462593Z	info	sds	resource:default new connection
2020-08-31T00:44:52.462683Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:52.463178Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:52.463548Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:52.463586Z	error	sds	Remote side closed connection
2020-08-31T00:44:52.463819Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"04352865-d1db-4b02-93b9-1bb9bbfb82b2".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.626s
2020-08-31T00:44:57.702710Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ace00f6c-6727-446e-b7bc-eb1f6f337417\".sock" 

2020-08-31T00:44:57.702777Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:44:58.005213Z	info	sds	resource:default new connection
2020-08-31T00:44:58.005858Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:44:58.006694Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:44:58.007208Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:44:58.007233Z	error	sds	Remote side closed connection
2020-08-31T00:44:58.007483Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ace00f6c-6727-446e-b7bc-eb1f6f337417".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.624s
2020-08-31T00:45:03.275777Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"98d213d9-614f-4035-a46f-59b128849924\".sock" 

2020-08-31T00:45:03.275844Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:45:03.577220Z	info	sds	resource:default new connection
2020-08-31T00:45:03.577308Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-1 default} . token:  
2020-08-31T00:45:03.577767Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:45:03.578288Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:45:03.578334Z	error	sds	Remote side closed connection
2020-08-31T00:45:03.578505Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"98d213d9-614f-4035-a46f-59b128849924".sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	0.624s
2020-08-31T00:58:35.006441Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest638253ff-cbe0-4821-8b5e-2d68ee2f835d.sock" 

2020-08-31T00:58:35.006537Z	info	sds	Start SDS grpc server
2020-08-31T00:58:35.007766Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:58:35.007827Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:58:35.008306Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:36.007718Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:36.007782Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T00:58:37.008431Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T00:58:37.008518Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T00:58:37.008541Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T00:58:37.008597Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:37.008981Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest638253ff-cbe0-4821-8b5e-2d68ee2f835d.sock: use of closed network connection
2020-08-31T00:58:37.009158Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:37.009182Z	error	sds	Remote side closed connection
2020-08-31T00:58:37.009329Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2fec35fe-b55f-498d-a82d-1d6172634e8e\".sock" 

2020-08-31T00:58:37.009388Z	info	sds	Start SDS grpc server
2020-08-31T00:58:37.310415Z	info	sds	resource:default new connection
2020-08-31T00:58:37.310478Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T00:58:37.310541Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:37.310800Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:37.310825Z	error	sds	Remote side closed connection
2020-08-31T00:58:37.311461Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:58:37.311513Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T00:58:37.311670Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:58:37.311935Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:37.311956Z	error	sds	Remote side closed connection
2020-08-31T00:58:37.312197Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2fec35fe-b55f-498d-a82d-1d6172634e8e".sock: use of closed network connection
2020-08-31T00:58:37.312392Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"58df1b70-d83d-4801-a533-5898d8798f6f\".sock" 

2020-08-31T00:58:37.312463Z	info	sds	Start SDS grpc server
2020-08-31T00:58:37.312822Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T00:58:37.312852Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T00:58:37.312885Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T00:58:37.313059Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:37.313086Z	error	sds	Remote side closed connection
2020-08-31T00:58:37.313218Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"58df1b70-d83d-4801-a533-5898d8798f6f".sock: use of closed network connection
2020-08-31T00:58:37.313403Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"adc390d0-b1f1-478c-a5c1-b331eff49c54\".sock" 

2020-08-31T00:58:37.313441Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:58:37.614822Z	info	sds	resource:default new connection
2020-08-31T00:58:37.614889Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T00:58:37.614947Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:37.615350Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:37.615384Z	error	sds	Remote side closed connection
2020-08-31T00:58:37.615608Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"adc390d0-b1f1-478c-a5c1-b331eff49c54".sock: use of closed network connection
2020-08-31T00:58:37.615804Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7f740a31-bd67-4c5b-a570-1f98162a4b86\".sock" 

2020-08-31T00:58:37.615873Z	info	sds	Start SDS grpc server
2020-08-31T00:58:37.615982Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"37b75521-aa8e-42df-8021-da2664244089\".sock" 

2020-08-31T00:58:37.616017Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:58:37.917087Z	info	sds	resource:default new connection
2020-08-31T00:58:37.917149Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T00:58:37.917206Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:37.917524Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:37.917553Z	error	sds	Remote side closed connection
2020-08-31T00:58:37.917996Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:58:37.918030Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T00:58:37.918075Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:58:37.918332Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:37.918355Z	error	sds	Remote side closed connection
2020-08-31T00:58:38.009208Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:38.219351Z	info	sds	resource:default new connection
2020-08-31T00:58:38.219403Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T00:58:38.219454Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:38.219687Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:38.219729Z	error	sds	Remote side closed connection
2020-08-31T00:58:38.219915Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7f740a31-bd67-4c5b-a570-1f98162a4b86".sock: use of closed network connection
2020-08-31T00:58:38.219971Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"37b75521-aa8e-42df-8021-da2664244089".sock: use of closed network connection
2020-08-31T00:58:38.220133Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"04487098-20c5-4d05-b4e2-8b7f94ed6573\".sock" 

2020-08-31T00:58:38.220152Z	info	sds	Start SDS grpc server
2020-08-31T00:58:38.312437Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:38.313433Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T00:58:38.522595Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"04487098-20c5-4d05-b4e2-8b7f94ed6573".sock: use of closed network connection
2020-08-31T00:58:38.522905Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5b6ce00c-af26-477b-a7b4-418e3e69964e\".sock" 

2020-08-31T00:58:38.522936Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:58:38.615833Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T00:58:38.824624Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5b6ce00c-af26-477b-a7b4-418e3e69964e".sock: use of closed network connection
2020-08-31T00:58:38.824870Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestc5465b96-7419-47b5-bbc8-d9a3c9373e81.sock" 

2020-08-31T00:58:38.824926Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bee2f231-09f0-4e09-9bdf-3654132f89bc\".sock" 

2020-08-31T00:58:38.824939Z	info	sds	Start SDS grpc server
2020-08-31T00:58:38.824964Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T00:58:39.220101Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:39.220144Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T00:58:39.429099Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestc5465b96-7419-47b5-bbc8-d9a3c9373e81.sock: use of closed network connection
2020-08-31T00:58:39.429151Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bee2f231-09f0-4e09-9bdf-3654132f89bc".sock: use of closed network connection
2020-08-31T00:58:39.429346Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0fdaf0da-c987-429d-868b-3d6e25fecbaf.sock" 

2020-08-31T00:58:39.429389Z	info	sds	Start SDS grpc server
2020-08-31T00:58:39.522834Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:39.730453Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T00:58:39.730544Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:39.731262Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0fdaf0da-c987-429d-868b-3d6e25fecbaf.sock: use of closed network connection
2020-08-31T00:58:39.731563Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6dc3a60d-ef7e-4d5f-90a7-936d2f2e9a8e.sock" 

2020-08-31T00:58:39.731704Z	info	sds	Start SDS grpc server
2020-08-31T00:58:39.733898Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:58:39.733975Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:58:39.734035Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:39.734156Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T00:58:39.734204Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T00:58:39.734250Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:58:39.824737Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:40.009444Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:40.312643Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:40.313607Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:40.429360Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:40.429374Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:40.616056Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:40.731521Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:40.734285Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:40.746541Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:58:41.220418Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:41.220455Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:41.523081Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:41.735127Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:41.735558Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6dc3a60d-ef7e-4d5f-90a7-936d2f2e9a8e.sock: use of closed network connection
2020-08-31T00:58:41.735612Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:41.735638Z	error	sds	Remote side closed connection
2020-08-31T00:58:41.735685Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:41.735710Z	error	sds	Remote side closed connection
2020-08-31T00:58:41.735924Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest19c3d754-50cc-4a23-b6fb-2106e1cb7bda.sock" 

2020-08-31T00:58:41.735987Z	info	sds	Start SDS grpc server
2020-08-31T00:58:41.736765Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T00:58:41.736806Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T00:58:41.736850Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:41.737263Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 00:58:41.736850103 +0000 UTC m=+6.804875396 and is waiting for next SDS request
2020-08-31T00:58:41.737279Z	info	sds	Dynamic push for secret default
2020-08-31T00:58:41.737305Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest19c3d754-50cc-4a23-b6fb-2106e1cb7bda.sock: use of closed network connection
2020-08-31T00:58:41.737410Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:41.737419Z	error	sds	Remote side closed connection
2020-08-31T00:58:41.737407Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:41.737462Z	error	sds	Remote side closed connection
2020-08-31T00:58:41.737542Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdae7ccdc-ad52-4594-95bf-2b9aec182299.sock" 

2020-08-31T00:58:41.737689Z	info	sds	Start SDS grpc server
2020-08-31T00:58:41.738349Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T00:58:41.738407Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T00:58:41.738459Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:41.739158Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T00:58:41.824998Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:42.239265Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:42.239329Z	info	sds	Dynamic push for secret default
2020-08-31T00:58:42.239941Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdae7ccdc-ad52-4594-95bf-2b9aec182299.sock: use of closed network connection
2020-08-31T00:58:42.240057Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:42.240088Z	error	sds	Remote side closed connection
2020-08-31T00:58:42.240089Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:42.240110Z	error	sds	Remote side closed connection
2020-08-31T00:58:42.240212Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta5e73916-43b7-4f8e-a334-3ca6978fe0dd.sock" 

2020-08-31T00:58:42.240242Z	info	sds	Start SDS grpc server
2020-08-31T00:58:42.240501Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta5e73916-43b7-4f8e-a334-3ca6978fe0dd.sock: use of closed network connection
2020-08-31T00:58:42.240591Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd05ceb0b-bf87-4262-a75c-9fec9fea5f68.sock" 

2020-08-31T00:58:42.240609Z	info	sds	Start SDS grpc server
2020-08-31T00:58:42.429540Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:42.429566Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:42.541596Z	info	sds	resource:default new connection
2020-08-31T00:58:42.541654Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T00:58:42.541709Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:42.542066Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:42.542133Z	error	sds	Remote side closed connection
2020-08-31T00:58:42.735760Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:42.737454Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:42.746746Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:42.843228Z	info	sds	resource:default new connection
2020-08-31T00:58:42.843306Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T00:58:42.843375Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:42.843739Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:42.843766Z	error	sds	Remote side closed connection
2020-08-31T00:58:42.844045Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd05ceb0b-bf87-4262-a75c-9fec9fea5f68.sock: use of closed network connection
2020-08-31T00:58:42.844172Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta62f6e3d-41db-4610-8c20-3301a91a62fe.sock" 

2020-08-31T00:58:42.844218Z	info	sds	Start SDS grpc server
2020-08-31T00:58:43.145212Z	info	sds	resource:default new connection
2020-08-31T00:58:43.145277Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T00:58:43.145333Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:43.145726Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:43.145757Z	error	sds	Remote side closed connection
2020-08-31T00:58:43.145960Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta62f6e3d-41db-4610-8c20-3301a91a62fe.sock: use of closed network connection
2020-08-31T00:58:43.240192Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:43.240575Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:43.844233Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:44.009776Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:44.146177Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T00:58:44.312950Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:44.313741Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:44.616333Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:44.735998Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:44.737628Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T00:58:45.177140Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste1fc5f4d-7da0-4521-a218-feec5eefc12e.sock" 

2020-08-31T00:58:45.177188Z	info	sds	Start SDS grpc server
2020-08-31T00:58:45.220718Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:45.220740Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:45.240436Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:45.240767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:45.523183Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:45.825257Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:45.844500Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:46.146411Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:46.180378Z	info	sds	resource:default new connection
2020-08-31T00:58:46.180462Z	info	sds	Skipping waiting for gateway secret
2020-08-31T00:58:46.187144Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T00:58:46.275871Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T00:58:46.275916Z	info	cache	GenerateSecret default
2020-08-31T00:58:46.275979Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:46.276381Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste1fc5f4d-7da0-4521-a218-feec5eefc12e.sock: use of closed network connection
PASS
2020-08-31T00:58:46.276519Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:46.276547Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.591s
2020-08-31T00:58:51.529985Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest40e4b41f-c3fc-407c-8539-5dc6fdd7c716.sock" 

2020-08-31T00:58:51.530106Z	info	sds	Start SDS grpc server
2020-08-31T00:58:51.531472Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:58:51.531554Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:58:51.531990Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:52.531381Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:52.531439Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T00:58:53.531981Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T00:58:53.532054Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T00:58:53.532078Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T00:58:53.532171Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:53.532397Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest40e4b41f-c3fc-407c-8539-5dc6fdd7c716.sock: use of closed network connection
2020-08-31T00:58:53.532559Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:53.532589Z	error	sds	Remote side closed connection
2020-08-31T00:58:53.532738Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"33b240e8-a115-4679-962c-f109cc49d5c9\".sock" 

2020-08-31T00:58:53.532792Z	info	sds	Start SDS grpc server
2020-08-31T00:58:53.833897Z	info	sds	resource:default new connection
2020-08-31T00:58:53.833971Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T00:58:53.834027Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:53.834347Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:53.834367Z	error	sds	Remote side closed connection
2020-08-31T00:58:53.834973Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:58:53.835020Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T00:58:53.835186Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:58:53.835481Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:53.835515Z	error	sds	Remote side closed connection
2020-08-31T00:58:53.835710Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"33b240e8-a115-4679-962c-f109cc49d5c9".sock: use of closed network connection
2020-08-31T00:58:53.835896Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0d1cc8fe-480a-4536-82a0-6823c971171c\".sock" 

2020-08-31T00:58:53.835995Z	info	sds	Start SDS grpc server
2020-08-31T00:58:53.836542Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T00:58:53.836589Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T00:58:53.836623Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T00:58:53.836949Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:53.836978Z	error	sds	Remote side closed connection
2020-08-31T00:58:53.837138Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0d1cc8fe-480a-4536-82a0-6823c971171c".sock: use of closed network connection
2020-08-31T00:58:53.837325Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2496a280-8108-41a4-b355-06028d7cdc12\".sock" 

2020-08-31T00:58:53.837357Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:58:54.138264Z	info	sds	resource:default new connection
2020-08-31T00:58:54.138340Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T00:58:54.138403Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:54.138716Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:54.138756Z	error	sds	Remote side closed connection
2020-08-31T00:58:54.139021Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2496a280-8108-41a4-b355-06028d7cdc12".sock: use of closed network connection
2020-08-31T00:58:54.139271Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"96e0de44-f7e6-4564-b237-8da3c8e823ff\".sock" 

2020-08-31T00:58:54.139350Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"02141e97-ccc3-4a89-8ac6-64a8b38bd5ee\".sock" 

2020-08-31T00:58:54.139368Z	info	sds	Start SDS grpc server
2020-08-31T00:58:54.139398Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:58:54.440222Z	info	sds	resource:default new connection
2020-08-31T00:58:54.440277Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T00:58:54.440331Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:54.440607Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:54.440645Z	error	sds	Remote side closed connection
2020-08-31T00:58:54.441665Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:58:54.441713Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T00:58:54.441760Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:58:54.442023Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:54.442048Z	error	sds	Remote side closed connection
2020-08-31T00:58:54.532617Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:54.742918Z	info	sds	resource:default new connection
2020-08-31T00:58:54.742971Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T00:58:54.743022Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:54.743228Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:54.743271Z	error	sds	Remote side closed connection
2020-08-31T00:58:54.743482Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"96e0de44-f7e6-4564-b237-8da3c8e823ff".sock: use of closed network connection
2020-08-31T00:58:54.743524Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"02141e97-ccc3-4a89-8ac6-64a8b38bd5ee".sock: use of closed network connection
2020-08-31T00:58:54.743721Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"70828c4d-fee6-4866-8b77-c4ffba0c6d90\".sock" 

2020-08-31T00:58:54.743741Z	info	sds	Start SDS grpc server
2020-08-31T00:58:54.835921Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:54.837343Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T00:58:55.046290Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"70828c4d-fee6-4866-8b77-c4ffba0c6d90".sock: use of closed network connection
2020-08-31T00:58:55.046590Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b9b2a3ef-6b41-4b66-a020-1b4f60520772\".sock" 

2020-08-31T00:58:55.046609Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:58:55.139232Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T00:58:55.348386Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b9b2a3ef-6b41-4b66-a020-1b4f60520772".sock: use of closed network connection
2020-08-31T00:58:55.348570Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest4f2ef1a3-7cf7-4f8b-a482-66c430f72a2f.sock" 

2020-08-31T00:58:55.348576Z	info	sds	Start SDS grpc server
2020-08-31T00:58:55.348631Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"cc9a077d-d9a7-4fd9-8e0c-7b1e9ba4ebad\".sock" 

2020-08-31T00:58:55.348636Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T00:58:55.743689Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:55.743726Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T00:58:55.952382Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest4f2ef1a3-7cf7-4f8b-a482-66c430f72a2f.sock: use of closed network connection
2020-08-31T00:58:55.952429Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"cc9a077d-d9a7-4fd9-8e0c-7b1e9ba4ebad".sock: use of closed network connection
2020-08-31T00:58:55.952694Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta28bb461-e8d3-4745-9b35-7dcc58cbc7b0.sock" 

2020-08-31T00:58:55.952721Z	info	sds	Start SDS grpc server
2020-08-31T00:58:56.046568Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:56.255097Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T00:58:56.255542Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:56.255813Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta28bb461-e8d3-4745-9b35-7dcc58cbc7b0.sock: use of closed network connection
2020-08-31T00:58:56.256022Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6df7fca4-ba0d-4b14-87b4-7eebdb8b7f3c.sock" 

2020-08-31T00:58:56.256128Z	info	sds	Start SDS grpc server
2020-08-31T00:58:56.256849Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:58:56.256913Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:58:56.257012Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:56.257090Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T00:58:56.257120Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T00:58:56.257144Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:58:56.348595Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:56.532919Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:56.836191Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:56.837508Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:56.952603Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:56.952598Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:57.139497Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:57.255992Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:57.257106Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:57.257161Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:58:57.743927Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:57.743985Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:58.046878Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:58.257991Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:58.258516Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:58.302201Z	error	sds	Remote side closed connection
2020-08-31T00:58:58.302238Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6df7fca4-ba0d-4b14-87b4-7eebdb8b7f3c.sock: use of closed network connection
2020-08-31T00:58:58.302446Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:58.302474Z	error	sds	Remote side closed connection
2020-08-31T00:58:58.302597Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdef9e2a4-725b-45e8-a5ac-15a4a5544cd1.sock" 

2020-08-31T00:58:58.302689Z	info	sds	Start SDS grpc server
2020-08-31T00:58:58.303534Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T00:58:58.303598Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T00:58:58.303652Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:58.304162Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 00:58:58.303651422 +0000 UTC m=+6.850228791 and is waiting for next SDS request
2020-08-31T00:58:58.304186Z	info	sds	Dynamic push for secret default
2020-08-31T00:58:58.304201Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdef9e2a4-725b-45e8-a5ac-15a4a5544cd1.sock: use of closed network connection
2020-08-31T00:58:58.304286Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:58.304303Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:58.304299Z	error	sds	Remote side closed connection
2020-08-31T00:58:58.304323Z	error	sds	Remote side closed connection
2020-08-31T00:58:58.304455Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdc69a9f1-7179-42b2-9fb0-aae01f0e27c9.sock" 

2020-08-31T00:58:58.304488Z	info	sds	Start SDS grpc server
2020-08-31T00:58:58.305176Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T00:58:58.305234Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T00:58:58.305271Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:58.305879Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T00:58:58.348884Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:58.805894Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:58.805948Z	info	sds	Dynamic push for secret default
2020-08-31T00:58:58.806571Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdc69a9f1-7179-42b2-9fb0-aae01f0e27c9.sock: use of closed network connection
2020-08-31T00:58:58.806653Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:58.806674Z	error	sds	Remote side closed connection
2020-08-31T00:58:58.806694Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:58.806719Z	error	sds	Remote side closed connection
2020-08-31T00:58:58.806853Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf8493f53-0caf-4d6b-92a0-4940bf197954.sock" 

2020-08-31T00:58:58.806893Z	info	sds	Start SDS grpc server
2020-08-31T00:58:58.807130Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf8493f53-0caf-4d6b-92a0-4940bf197954.sock: use of closed network connection
2020-08-31T00:58:58.807218Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4dd0fcfb-632b-4964-a104-fbb15f7c6df7.sock" 

2020-08-31T00:58:58.807239Z	info	sds	Start SDS grpc server
2020-08-31T00:58:58.952958Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:58:58.953001Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:59.107984Z	info	sds	resource:default new connection
2020-08-31T00:58:59.108044Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T00:58:59.108095Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:59.108424Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:59.108458Z	error	sds	Remote side closed connection
2020-08-31T00:58:59.256283Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:59.302457Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:59.304380Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:59.409461Z	info	sds	resource:default new connection
2020-08-31T00:58:59.409524Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T00:58:59.409583Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:59.409884Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:59.409911Z	error	sds	Remote side closed connection
2020-08-31T00:58:59.410147Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4dd0fcfb-632b-4964-a104-fbb15f7c6df7.sock: use of closed network connection
2020-08-31T00:58:59.410311Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta02302af-c48d-4c62-964f-03fcc32453a3.sock" 

2020-08-31T00:58:59.410345Z	info	sds	Start SDS grpc server
2020-08-31T00:58:59.711357Z	info	sds	resource:default new connection
2020-08-31T00:58:59.711421Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T00:58:59.711523Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:58:59.711937Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:58:59.712001Z	error	sds	Remote side closed connection
2020-08-31T00:58:59.712067Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta02302af-c48d-4c62-964f-03fcc32453a3.sock: use of closed network connection
2020-08-31T00:58:59.806790Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:58:59.807214Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:00.410490Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:00.533289Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:00.712370Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T00:59:00.836584Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:00.837713Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:01.139796Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:01.313155Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:01.313219Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T00:59:01.742965Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest80433898-7819-4869-9f37-7d4bc6323cad.sock" 

2020-08-31T00:59:01.743052Z	info	sds	Start SDS grpc server
2020-08-31T00:59:01.744691Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:01.744738Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:01.806936Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:01.807409Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:02.047175Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:02.349166Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:02.410744Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:02.712727Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:02.744075Z	info	sds	resource:default new connection
2020-08-31T00:59:02.744132Z	info	sds	Skipping waiting for gateway secret
2020-08-31T00:59:02.754196Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T00:59:02.842861Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T00:59:02.842909Z	info	cache	GenerateSecret default
2020-08-31T00:59:02.842972Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:02.843453Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest80433898-7819-4869-9f37-7d4bc6323cad.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.637s
2020-08-31T00:59:08.224501Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestea599a21-55d3-449e-89dc-37f09ece7ffb.sock" 

2020-08-31T00:59:08.224595Z	info	sds	Start SDS grpc server
2020-08-31T00:59:08.225953Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:59:08.226028Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:59:08.226869Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:09.225953Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:09.226028Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T00:59:10.226634Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T00:59:10.226705Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T00:59:10.226729Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T00:59:10.226781Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:10.227047Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestea599a21-55d3-449e-89dc-37f09ece7ffb.sock: use of closed network connection
2020-08-31T00:59:10.227161Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:10.227189Z	error	sds	Remote side closed connection
2020-08-31T00:59:10.227380Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"db913978-2a81-4769-aa10-7ad8b42952da\".sock" 

2020-08-31T00:59:10.227412Z	info	sds	Start SDS grpc server
2020-08-31T00:59:10.528415Z	info	sds	resource:default new connection
2020-08-31T00:59:10.528477Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T00:59:10.528536Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:10.528864Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:10.528915Z	error	sds	Remote side closed connection
2020-08-31T00:59:10.529516Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:59:10.529550Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T00:59:10.529721Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:59:10.530095Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:10.530130Z	error	sds	Remote side closed connection
2020-08-31T00:59:10.530367Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"db913978-2a81-4769-aa10-7ad8b42952da".sock: use of closed network connection
2020-08-31T00:59:10.530601Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2227ab84-8a5d-44cc-be85-da156e2d5c24\".sock" 

2020-08-31T00:59:10.530690Z	info	sds	Start SDS grpc server
2020-08-31T00:59:10.531167Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T00:59:10.531215Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T00:59:10.531264Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T00:59:10.531461Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:10.531489Z	error	sds	Remote side closed connection
2020-08-31T00:59:10.531722Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2227ab84-8a5d-44cc-be85-da156e2d5c24".sock: use of closed network connection
2020-08-31T00:59:10.531900Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"efef6080-ce91-4592-b804-1a9aee145b6d\".sock" 

2020-08-31T00:59:10.531938Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:10.832937Z	info	sds	resource:default new connection
2020-08-31T00:59:10.833006Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T00:59:10.833063Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:10.833281Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:10.833310Z	error	sds	Remote side closed connection
2020-08-31T00:59:10.833516Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"efef6080-ce91-4592-b804-1a9aee145b6d".sock: use of closed network connection
2020-08-31T00:59:10.833749Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"876ba485-4943-4e86-bf32-3b71ba971d22\".sock" 

2020-08-31T00:59:10.833796Z	info	sds	Start SDS grpc server
2020-08-31T00:59:10.833840Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9ea851e3-1ad4-4190-b30d-18348a735311\".sock" 

2020-08-31T00:59:10.833845Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:11.134860Z	info	sds	resource:default new connection
2020-08-31T00:59:11.134937Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T00:59:11.135012Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:11.135354Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:11.135385Z	error	sds	Remote side closed connection
2020-08-31T00:59:11.136461Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:59:11.136517Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T00:59:11.136559Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:59:11.136865Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:11.136886Z	error	sds	Remote side closed connection
2020-08-31T00:59:11.227301Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:11.438013Z	info	sds	resource:default new connection
2020-08-31T00:59:11.438065Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T00:59:11.438120Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:11.438511Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:11.438545Z	error	sds	Remote side closed connection
2020-08-31T00:59:11.438635Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"876ba485-4943-4e86-bf32-3b71ba971d22".sock: use of closed network connection
2020-08-31T00:59:11.438677Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9ea851e3-1ad4-4190-b30d-18348a735311".sock: use of closed network connection
2020-08-31T00:59:11.438834Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"190e1f11-83a9-4f79-8f9e-7564f7d74b78\".sock" 

2020-08-31T00:59:11.438854Z	info	sds	Start SDS grpc server
2020-08-31T00:59:11.530556Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:11.531857Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T00:59:11.741621Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"190e1f11-83a9-4f79-8f9e-7564f7d74b78".sock: use of closed network connection
2020-08-31T00:59:11.741899Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"451e1771-259a-4188-a84f-cd84024e2342\".sock" 

2020-08-31T00:59:11.741935Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:11.833710Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T00:59:12.043514Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"451e1771-259a-4188-a84f-cd84024e2342".sock: use of closed network connection
2020-08-31T00:59:12.043789Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestf068d06d-36c2-4064-9192-436e1fb38df2.sock" 

2020-08-31T00:59:12.043855Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"351018e2-3463-41fb-b77b-57f4238b1288\".sock" 

2020-08-31T00:59:12.043890Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:12.043892Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T00:59:12.438859Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:12.438884Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T00:59:12.649224Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestf068d06d-36c2-4064-9192-436e1fb38df2.sock: use of closed network connection
2020-08-31T00:59:12.649348Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"351018e2-3463-41fb-b77b-57f4238b1288".sock: use of closed network connection
2020-08-31T00:59:12.649685Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest97d2c409-ae52-4b1b-a5c0-82fb2721fb45.sock" 

2020-08-31T00:59:12.649744Z	info	sds	Start SDS grpc server
2020-08-31T00:59:12.741845Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:12.950884Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T00:59:12.950990Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:12.951218Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest97d2c409-ae52-4b1b-a5c0-82fb2721fb45.sock: use of closed network connection
2020-08-31T00:59:12.951445Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd911ca9d-70f5-4b59-8454-8b7eaf7590f7.sock" 

2020-08-31T00:59:12.951514Z	info	sds	Start SDS grpc server
2020-08-31T00:59:12.952352Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:59:12.952400Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:59:12.952443Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:12.952706Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T00:59:12.952755Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T00:59:12.952796Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:59:13.043713Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:13.227611Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:13.530799Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:13.532019Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:13.649479Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:13.649560Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:13.833969Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:13.951384Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:13.952753Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:13.952806Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:59:14.439125Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:14.439155Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:14.742080Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:14.953544Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:14.953903Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd911ca9d-70f5-4b59-8454-8b7eaf7590f7.sock: use of closed network connection
2020-08-31T00:59:14.953936Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:14.953957Z	error	sds	Remote side closed connection
2020-08-31T00:59:14.954064Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:14.954088Z	error	sds	Remote side closed connection
2020-08-31T00:59:14.954173Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf90bf133-3938-41fb-879d-f218b39656bf.sock" 

2020-08-31T00:59:14.954328Z	info	sds	Start SDS grpc server
2020-08-31T00:59:14.955042Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T00:59:14.955128Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T00:59:14.955182Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:14.955655Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 00:59:14.95518174 +0000 UTC m=+6.807593012 and is waiting for next SDS request
2020-08-31T00:59:14.955667Z	info	sds	Dynamic push for secret default
2020-08-31T00:59:14.955701Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf90bf133-3938-41fb-879d-f218b39656bf.sock: use of closed network connection
2020-08-31T00:59:14.955783Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:14.955792Z	error	sds	Remote side closed connection
2020-08-31T00:59:14.955825Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:14.955844Z	error	sds	Remote side closed connection
2020-08-31T00:59:14.955912Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest88ba9889-c347-4502-9a77-a212877c35e8.sock" 

2020-08-31T00:59:14.955942Z	info	sds	Start SDS grpc server
2020-08-31T00:59:14.956587Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T00:59:14.956632Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T00:59:14.956702Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:14.957231Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T00:59:15.043975Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:15.457459Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:15.457526Z	info	sds	Dynamic push for secret default
2020-08-31T00:59:15.458159Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest88ba9889-c347-4502-9a77-a212877c35e8.sock: use of closed network connection
2020-08-31T00:59:15.458240Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:15.458280Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:15.458307Z	error	sds	Remote side closed connection
2020-08-31T00:59:15.458264Z	error	sds	Remote side closed connection
2020-08-31T00:59:15.458427Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest51a78b2f-fd79-4831-83da-9a924c487e87.sock" 

2020-08-31T00:59:15.458530Z	info	sds	Start SDS grpc server
2020-08-31T00:59:15.458649Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest51a78b2f-fd79-4831-83da-9a924c487e87.sock: use of closed network connection
2020-08-31T00:59:15.458752Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2358c785-0474-400b-a0eb-1a636def47c9.sock" 

2020-08-31T00:59:15.458774Z	info	sds	Start SDS grpc server
2020-08-31T00:59:15.649704Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:15.649704Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:15.759703Z	info	sds	resource:default new connection
2020-08-31T00:59:15.759762Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T00:59:15.759816Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:15.760087Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:15.760118Z	error	sds	Remote side closed connection
2020-08-31T00:59:15.951652Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:15.954113Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:15.955767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:16.061228Z	info	sds	resource:default new connection
2020-08-31T00:59:16.061341Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T00:59:16.061415Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:16.061748Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:16.061781Z	error	sds	Remote side closed connection
2020-08-31T00:59:16.062124Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2358c785-0474-400b-a0eb-1a636def47c9.sock: use of closed network connection
2020-08-31T00:59:16.062285Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest36e4eeaf-d684-43f2-bcfe-83a002d2d1ad.sock" 

2020-08-31T00:59:16.062329Z	info	sds	Start SDS grpc server
2020-08-31T00:59:16.363305Z	info	sds	resource:default new connection
2020-08-31T00:59:16.363368Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T00:59:16.363424Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:16.363775Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:16.363795Z	error	sds	Remote side closed connection
2020-08-31T00:59:16.363995Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest36e4eeaf-d684-43f2-bcfe-83a002d2d1ad.sock: use of closed network connection
2020-08-31T00:59:16.458329Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:16.458711Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:17.062330Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:17.227856Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:17.364128Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T00:59:17.531053Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:17.532211Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:17.834230Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:17.954444Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:17.955965Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T00:59:18.395735Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest818447a0-9774-403a-a660-c9e16fe60cf8.sock" 

2020-08-31T00:59:18.395818Z	info	sds	Start SDS grpc server
2020-08-31T00:59:18.439373Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:18.439395Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:18.458571Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:18.458844Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:18.742358Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:19.044279Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:19.062586Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:19.364381Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:19.396640Z	info	sds	resource:default new connection
2020-08-31T00:59:19.396736Z	info	sds	Skipping waiting for gateway secret
2020-08-31T00:59:19.404355Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T00:59:19.504292Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T00:59:19.504340Z	info	cache	GenerateSecret default
2020-08-31T00:59:19.504407Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:19.504839Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest818447a0-9774-403a-a660-c9e16fe60cf8.sock: use of closed network connection
PASS
2020-08-31T00:59:19.504961Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:19.504996Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.601s
2020-08-31T00:59:24.771351Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestde38016c-d3a9-4429-a453-e660acaeb314.sock" 

2020-08-31T00:59:24.771522Z	info	sds	Start SDS grpc server
2020-08-31T00:59:24.772639Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:59:24.772742Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:59:24.773097Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:25.772694Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:25.772813Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T00:59:26.773586Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T00:59:26.773652Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T00:59:26.773679Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T00:59:26.773820Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:26.774060Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestde38016c-d3a9-4429-a453-e660acaeb314.sock: use of closed network connection
2020-08-31T00:59:26.774183Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:26.774210Z	error	sds	Remote side closed connection
2020-08-31T00:59:26.774355Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7669a147-8ae4-4c28-8dc1-5c39fc7b4ff2\".sock" 

2020-08-31T00:59:26.774372Z	info	sds	Start SDS grpc server
2020-08-31T00:59:27.075461Z	info	sds	resource:default new connection
2020-08-31T00:59:27.075525Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T00:59:27.075587Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:27.075909Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:27.075938Z	error	sds	Remote side closed connection
2020-08-31T00:59:27.076568Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:59:27.076611Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T00:59:27.076880Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:59:27.077138Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:27.077160Z	error	sds	Remote side closed connection
2020-08-31T00:59:27.077321Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7669a147-8ae4-4c28-8dc1-5c39fc7b4ff2".sock: use of closed network connection
2020-08-31T00:59:27.077536Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9ecf6089-ae65-499f-abeb-30f494e84698\".sock" 

2020-08-31T00:59:27.077627Z	info	sds	Start SDS grpc server
2020-08-31T00:59:27.078067Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T00:59:27.078110Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T00:59:27.078157Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T00:59:27.078451Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:27.078482Z	error	sds	Remote side closed connection
2020-08-31T00:59:27.078612Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9ecf6089-ae65-499f-abeb-30f494e84698".sock: use of closed network connection
2020-08-31T00:59:27.078751Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ad374795-7283-42a6-be98-0b0e77d50ad4\".sock" 

2020-08-31T00:59:27.078775Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:27.379617Z	info	sds	resource:default new connection
2020-08-31T00:59:27.379686Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T00:59:27.379740Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:27.380161Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:27.380191Z	error	sds	Remote side closed connection
2020-08-31T00:59:27.380443Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ad374795-7283-42a6-be98-0b0e77d50ad4".sock: use of closed network connection
2020-08-31T00:59:27.380731Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b6e75694-8b74-4d69-8bc7-e2212e86ea6d\".sock" 

2020-08-31T00:59:27.380797Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3589138b-b059-45bd-abdb-23c9a1c6357f\".sock" 

2020-08-31T00:59:27.380787Z	info	sds	Start SDS grpc server
2020-08-31T00:59:27.380834Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:27.681857Z	info	sds	resource:default new connection
2020-08-31T00:59:27.681914Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T00:59:27.681970Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:27.682274Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:27.682293Z	error	sds	Remote side closed connection
2020-08-31T00:59:27.683355Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:59:27.683401Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T00:59:27.683457Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:59:27.683736Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:27.683759Z	error	sds	Remote side closed connection
2020-08-31T00:59:27.774352Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:27.984724Z	info	sds	resource:default new connection
2020-08-31T00:59:27.984788Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T00:59:27.984852Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:27.985202Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:27.985229Z	error	sds	Remote side closed connection
2020-08-31T00:59:27.985466Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b6e75694-8b74-4d69-8bc7-e2212e86ea6d".sock: use of closed network connection
2020-08-31T00:59:27.985516Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3589138b-b059-45bd-abdb-23c9a1c6357f".sock: use of closed network connection
2020-08-31T00:59:27.985693Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5745bc10-7902-4a3a-bf4e-60e7ba0a8f2a\".sock" 

2020-08-31T00:59:27.985717Z	info	sds	Start SDS grpc server
2020-08-31T00:59:28.077545Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:28.078796Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T00:59:28.288071Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5745bc10-7902-4a3a-bf4e-60e7ba0a8f2a".sock: use of closed network connection
2020-08-31T00:59:28.288261Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1253a4bc-08af-4341-8579-a3c5f408ce78\".sock" 

2020-08-31T00:59:28.288284Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:28.380741Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T00:59:28.590057Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1253a4bc-08af-4341-8579-a3c5f408ce78".sock: use of closed network connection
2020-08-31T00:59:28.590324Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestd4a281d3-4fc3-4d51-b3e7-eb9d9872154e.sock" 

2020-08-31T00:59:28.590397Z	info	sds	Start SDS grpc server
2020-08-31T00:59:28.590426Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:28.590418Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d3f72d66-314d-4d15-83ab-96f099fe91c7\".sock" 

Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T00:59:28.985678Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:28.985737Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T00:59:29.194558Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestd4a281d3-4fc3-4d51-b3e7-eb9d9872154e.sock: use of closed network connection
2020-08-31T00:59:29.194614Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d3f72d66-314d-4d15-83ab-96f099fe91c7".sock: use of closed network connection
2020-08-31T00:59:29.194835Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestc2c49def-49d6-442f-95e2-4dab0307fc51.sock" 

2020-08-31T00:59:29.194876Z	info	sds	Start SDS grpc server
2020-08-31T00:59:29.288279Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:29.495827Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T00:59:29.495918Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:29.496157Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestc2c49def-49d6-442f-95e2-4dab0307fc51.sock: use of closed network connection
2020-08-31T00:59:29.496403Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta5a7e3b6-af93-4ac5-8aca-1d97b6097a01.sock" 

2020-08-31T00:59:29.496473Z	info	sds	Start SDS grpc server
2020-08-31T00:59:29.497657Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:59:29.497710Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:59:29.497757Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:29.497864Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T00:59:29.497908Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T00:59:29.497935Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:59:29.590300Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:29.774600Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:30.077858Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:30.078984Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:30.194783Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:30.194829Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:30.381023Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:30.496365Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:30.498003Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:30.498040Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:59:30.985949Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:30.986011Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:31.288573Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:31.498985Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:31.499309Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta5a7e3b6-af93-4ac5-8aca-1d97b6097a01.sock: use of closed network connection
2020-08-31T00:59:31.499377Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:31.499412Z	error	sds	Remote side closed connection
2020-08-31T00:59:31.499470Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:31.499494Z	error	sds	Remote side closed connection
2020-08-31T00:59:31.499561Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest21fd6ef6-0b08-47d5-aa01-ed4d24f5605c.sock" 

2020-08-31T00:59:31.499626Z	info	sds	Start SDS grpc server
2020-08-31T00:59:31.500407Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T00:59:31.500470Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T00:59:31.500518Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:31.501052Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 00:59:31.500517662 +0000 UTC m=+6.808143146 and is waiting for next SDS request
2020-08-31T00:59:31.501075Z	info	sds	Dynamic push for secret default
2020-08-31T00:59:31.501098Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest21fd6ef6-0b08-47d5-aa01-ed4d24f5605c.sock: use of closed network connection
2020-08-31T00:59:31.501166Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:31.501186Z	error	sds	Remote side closed connection
2020-08-31T00:59:31.501221Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:31.501228Z	error	sds	Remote side closed connection
2020-08-31T00:59:31.501350Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7b0f307d-3312-4f2a-9177-be9d670e8ccd.sock" 

2020-08-31T00:59:31.501407Z	info	sds	Start SDS grpc server
2020-08-31T00:59:31.502627Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T00:59:31.502685Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T00:59:31.502736Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:31.503329Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T00:59:31.590561Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:32.003386Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:32.003445Z	info	sds	Dynamic push for secret default
2020-08-31T00:59:32.004056Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7b0f307d-3312-4f2a-9177-be9d670e8ccd.sock: use of closed network connection
2020-08-31T00:59:32.004139Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:32.004148Z	error	sds	Remote side closed connection
2020-08-31T00:59:32.004277Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:32.004311Z	error	sds	Remote side closed connection
2020-08-31T00:59:32.004445Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste0853008-93ce-48ab-9ef7-8a6a4fa90d44.sock" 

2020-08-31T00:59:32.004470Z	info	sds	Start SDS grpc server
2020-08-31T00:59:32.004797Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste0853008-93ce-48ab-9ef7-8a6a4fa90d44.sock: use of closed network connection
2020-08-31T00:59:32.004919Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestebb2a6a8-113f-4a7d-9825-c2741d614a01.sock" 

2020-08-31T00:59:32.004944Z	info	sds	Start SDS grpc server
2020-08-31T00:59:32.195052Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:32.195103Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:32.305791Z	info	sds	resource:default new connection
2020-08-31T00:59:32.305867Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T00:59:32.305942Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:32.307142Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:32.307187Z	error	sds	Remote side closed connection
2020-08-31T00:59:32.496611Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:32.499488Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:32.501347Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:32.608405Z	info	sds	resource:default new connection
2020-08-31T00:59:32.608482Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T00:59:32.608539Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:32.608862Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:32.608925Z	error	sds	Remote side closed connection
2020-08-31T00:59:32.609127Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestebb2a6a8-113f-4a7d-9825-c2741d614a01.sock: use of closed network connection
2020-08-31T00:59:32.609254Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8fe10c98-8911-4c23-8933-1f8267cdb5f5.sock" 

2020-08-31T00:59:32.609287Z	info	sds	Start SDS grpc server
2020-08-31T00:59:32.910202Z	info	sds	resource:default new connection
2020-08-31T00:59:32.910262Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T00:59:32.910315Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:32.910581Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:32.910625Z	error	sds	Remote side closed connection
2020-08-31T00:59:32.910998Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8fe10c98-8911-4c23-8933-1f8267cdb5f5.sock: use of closed network connection
2020-08-31T00:59:33.004302Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:33.004883Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:33.609349Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:33.774837Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:33.911186Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T00:59:34.078093Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:34.079172Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:34.381251Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:34.499717Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:34.501547Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T00:59:34.939889Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest95db4a09-02a0-4582-bfd9-72b33e5d8ffb.sock" 

2020-08-31T00:59:34.939935Z	info	sds	Start SDS grpc server
2020-08-31T00:59:34.986232Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:34.986210Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:35.004611Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:35.005057Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:35.288832Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:35.590656Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:35.609582Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:35.911413Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:35.941021Z	info	sds	resource:default new connection
2020-08-31T00:59:35.941076Z	info	sds	Skipping waiting for gateway secret
2020-08-31T00:59:35.951718Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T00:59:36.111479Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T00:59:36.111525Z	info	cache	GenerateSecret default
2020-08-31T00:59:36.111588Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:36.112072Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest95db4a09-02a0-4582-bfd9-72b33e5d8ffb.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.667s
2020-08-31T00:59:41.315368Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb123ac8e-4b2c-4c73-825c-c5c15a0a52ed.sock" 

2020-08-31T00:59:41.315460Z	info	sds	Start SDS grpc server
2020-08-31T00:59:41.316718Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:59:41.316806Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:59:41.317214Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:42.316623Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:42.316721Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T00:59:43.317385Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T00:59:43.317478Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T00:59:43.317504Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T00:59:43.317559Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:43.317878Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb123ac8e-4b2c-4c73-825c-c5c15a0a52ed.sock: use of closed network connection
2020-08-31T00:59:43.318059Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:43.318095Z	error	sds	Remote side closed connection
2020-08-31T00:59:43.318165Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"08b56492-c434-495c-9636-e40f07d00912\".sock" 

2020-08-31T00:59:43.318187Z	info	sds	Start SDS grpc server
2020-08-31T00:59:43.619177Z	info	sds	resource:default new connection
2020-08-31T00:59:43.619243Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T00:59:43.619320Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:43.619594Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:43.619621Z	error	sds	Remote side closed connection
2020-08-31T00:59:43.620324Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:59:43.620386Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T00:59:43.620535Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:59:43.620890Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:43.620910Z	error	sds	Remote side closed connection
2020-08-31T00:59:43.621015Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"08b56492-c434-495c-9636-e40f07d00912".sock: use of closed network connection
2020-08-31T00:59:43.621190Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"99bdc4d9-9aa8-4371-820f-976e1f8d733d\".sock" 

2020-08-31T00:59:43.621265Z	info	sds	Start SDS grpc server
2020-08-31T00:59:43.621702Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T00:59:43.621747Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T00:59:43.621799Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T00:59:43.621964Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:43.621993Z	error	sds	Remote side closed connection
2020-08-31T00:59:43.622181Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"99bdc4d9-9aa8-4371-820f-976e1f8d733d".sock: use of closed network connection
2020-08-31T00:59:43.622366Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"80067f31-4399-4c9b-b197-e8d4733b1648\".sock" 

2020-08-31T00:59:43.622407Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:43.923363Z	info	sds	resource:default new connection
2020-08-31T00:59:43.923438Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T00:59:43.923510Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:43.923842Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:43.923863Z	error	sds	Remote side closed connection
2020-08-31T00:59:43.924160Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"80067f31-4399-4c9b-b197-e8d4733b1648".sock: use of closed network connection
2020-08-31T00:59:43.924429Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ed01b844-8aca-4d97-af2e-7f474df4fa36\".sock" 

2020-08-31T00:59:43.924506Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e4221389-34a8-4c5d-afba-e21ad85df1ff\".sock" 

2020-08-31T00:59:43.924509Z	info	sds	Start SDS grpc server
2020-08-31T00:59:43.924547Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:44.225566Z	info	sds	resource:default new connection
2020-08-31T00:59:44.225635Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T00:59:44.225706Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:44.226074Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:44.226096Z	error	sds	Remote side closed connection
2020-08-31T00:59:44.226599Z	info	sds	resource:ROOTCA new connection
2020-08-31T00:59:44.226645Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T00:59:44.226694Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T00:59:44.226871Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:44.226899Z	error	sds	Remote side closed connection
2020-08-31T00:59:44.318073Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:44.528068Z	info	sds	resource:default new connection
2020-08-31T00:59:44.528150Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T00:59:44.528218Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:44.528564Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:44.528589Z	error	sds	Remote side closed connection
2020-08-31T00:59:44.528886Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ed01b844-8aca-4d97-af2e-7f474df4fa36".sock: use of closed network connection
2020-08-31T00:59:44.528934Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e4221389-34a8-4c5d-afba-e21ad85df1ff".sock: use of closed network connection
2020-08-31T00:59:44.529207Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d8d2076b-9475-4296-bf23-ef0a664b46a1\".sock" 

2020-08-31T00:59:44.529235Z	info	sds	Start SDS grpc server
2020-08-31T00:59:44.621211Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:44.622390Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T00:59:44.832030Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d8d2076b-9475-4296-bf23-ef0a664b46a1".sock: use of closed network connection
2020-08-31T00:59:44.832469Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ec6f60de-96ef-4b85-8f11-179624d690ea\".sock" 

2020-08-31T00:59:44.832513Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T00:59:44.924383Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T00:59:45.134156Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ec6f60de-96ef-4b85-8f11-179624d690ea".sock: use of closed network connection
2020-08-31T00:59:45.134401Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1e11094c-b57e-44a9-abec-59de6b8f6184.sock" 

2020-08-31T00:59:45.134459Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2fc7baab-077a-4b4b-b5bc-effb254f57f3\".sock" 

2020-08-31T00:59:45.134491Z	info	sds	Start SDS grpc server
2020-08-31T00:59:45.134505Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T00:59:45.529070Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:45.529106Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T00:59:45.738376Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1e11094c-b57e-44a9-abec-59de6b8f6184.sock: use of closed network connection
2020-08-31T00:59:45.738489Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2fc7baab-077a-4b4b-b5bc-effb254f57f3".sock: use of closed network connection
2020-08-31T00:59:45.738693Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste9068c0d-815f-4d52-8ce9-9b4b5163f05b.sock" 

2020-08-31T00:59:45.738720Z	info	sds	Start SDS grpc server
2020-08-31T00:59:45.832239Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:46.039743Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T00:59:46.039852Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:46.040097Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste9068c0d-815f-4d52-8ce9-9b4b5163f05b.sock: use of closed network connection
2020-08-31T00:59:46.040383Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0d2b004d-68e7-41cb-a4f5-127856f69916.sock" 

2020-08-31T00:59:46.040433Z	info	sds	Start SDS grpc server
2020-08-31T00:59:46.041256Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:59:46.041325Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:59:46.041387Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:46.041441Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T00:59:46.041482Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T00:59:46.041526Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:59:46.134386Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:46.318334Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:46.621373Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:46.622459Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:46.738599Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:46.738654Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:46.924684Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:47.040351Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:47.041619Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:47.041655Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T00:59:47.529330Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:47.529379Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:47.832501Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:48.042590Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:48.042983Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0d2b004d-68e7-41cb-a4f5-127856f69916.sock: use of closed network connection
2020-08-31T00:59:48.043034Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:48.043065Z	error	sds	Remote side closed connection
2020-08-31T00:59:48.043109Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:48.043131Z	error	sds	Remote side closed connection
2020-08-31T00:59:48.043226Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7bd9415b-c434-4a31-913d-b9f521c54651.sock" 

2020-08-31T00:59:48.043341Z	info	sds	Start SDS grpc server
2020-08-31T00:59:48.044481Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T00:59:48.044519Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T00:59:48.044567Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:48.045041Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 00:59:48.044566431 +0000 UTC m=+6.805467689 and is waiting for next SDS request
2020-08-31T00:59:48.045070Z	info	sds	Dynamic push for secret default
2020-08-31T00:59:48.045078Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7bd9415b-c434-4a31-913d-b9f521c54651.sock: use of closed network connection
2020-08-31T00:59:48.045138Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:48.045163Z	error	sds	Remote side closed connection
2020-08-31T00:59:48.045184Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:48.045209Z	error	sds	Remote side closed connection
2020-08-31T00:59:48.045372Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest849eaa39-25b8-4dc3-ae21-af6dcd4c57de.sock" 

2020-08-31T00:59:48.045453Z	info	sds	Start SDS grpc server
2020-08-31T00:59:48.046070Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T00:59:48.046112Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T00:59:48.046150Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:48.046770Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T00:59:48.134617Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:48.546750Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:48.546831Z	info	sds	Dynamic push for secret default
2020-08-31T00:59:48.547479Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest849eaa39-25b8-4dc3-ae21-af6dcd4c57de.sock: use of closed network connection
2020-08-31T00:59:48.547584Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:48.547606Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:48.547631Z	error	sds	Remote side closed connection
2020-08-31T00:59:48.547615Z	error	sds	Remote side closed connection
2020-08-31T00:59:48.547703Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4d922deb-71ae-42b2-8f05-89e3fe838963.sock" 

2020-08-31T00:59:48.547802Z	info	sds	Start SDS grpc server
2020-08-31T00:59:48.547908Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4d922deb-71ae-42b2-8f05-89e3fe838963.sock: use of closed network connection
2020-08-31T00:59:48.547982Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta0598890-a029-4b82-aee3-337ab4807f21.sock" 

2020-08-31T00:59:48.548001Z	info	sds	Start SDS grpc server
2020-08-31T00:59:48.738875Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:48.738922Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:48.848961Z	info	sds	resource:default new connection
2020-08-31T00:59:48.849020Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T00:59:48.849074Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:48.849382Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:48.849411Z	error	sds	Remote side closed connection
2020-08-31T00:59:49.040619Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:49.043149Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:49.045336Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:49.150424Z	info	sds	resource:default new connection
2020-08-31T00:59:49.150491Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T00:59:49.150549Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:49.150757Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:49.150802Z	error	sds	Remote side closed connection
2020-08-31T00:59:49.151103Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta0598890-a029-4b82-aee3-337ab4807f21.sock: use of closed network connection
2020-08-31T00:59:49.151243Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6fb6809e-d3e1-4acd-acf8-6aceb06e8c2f.sock" 

2020-08-31T00:59:49.151297Z	info	sds	Start SDS grpc server
2020-08-31T00:59:49.452348Z	info	sds	resource:default new connection
2020-08-31T00:59:49.452422Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T00:59:49.452475Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:49.452859Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:49.452889Z	error	sds	Remote side closed connection
2020-08-31T00:59:49.453134Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6fb6809e-d3e1-4acd-acf8-6aceb06e8c2f.sock: use of closed network connection
2020-08-31T00:59:49.547703Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:49.547994Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:50.151295Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:50.318548Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:50.453351Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T00:59:50.621636Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:50.622655Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:50.924990Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:51.043257Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:51.045401Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T00:59:51.482617Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaa3aeecc-a304-4e53-b82a-73d3a20836fb.sock" 

2020-08-31T00:59:51.482675Z	info	sds	Start SDS grpc server
2020-08-31T00:59:51.529603Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:51.529652Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:51.547972Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:51.548155Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:51.832798Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:52.134889Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T00:59:52.151574Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:52.453581Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T00:59:52.483569Z	info	sds	resource:default new connection
2020-08-31T00:59:52.483759Z	info	sds	Skipping waiting for gateway secret
2020-08-31T00:59:52.490329Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T00:59:52.560928Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T00:59:52.560972Z	info	cache	GenerateSecret default
2020-08-31T00:59:52.561032Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:52.561398Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaa3aeecc-a304-4e53-b82a-73d3a20836fb.sock: use of closed network connection
PASS
2020-08-31T00:59:52.561504Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:52.561540Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.567s
2020-08-31T00:59:57.897383Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste2c58d9e-a632-4ac2-8d27-343bbb5c2069.sock" 

2020-08-31T00:59:57.897552Z	info	sds	Start SDS grpc server
2020-08-31T00:59:57.900762Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T00:59:57.900839Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T00:59:57.901284Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T00:59:58.899626Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:58.899681Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T00:59:59.900423Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T00:59:59.900508Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T00:59:59.900532Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T00:59:59.900605Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:59.900852Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste2c58d9e-a632-4ac2-8d27-343bbb5c2069.sock: use of closed network connection
2020-08-31T00:59:59.900974Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T00:59:59.900999Z	error	sds	Remote side closed connection
2020-08-31T00:59:59.901117Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"50910bb7-48f0-4f0f-be06-c98c86410f16\".sock" 

2020-08-31T00:59:59.901162Z	info	sds	Start SDS grpc server
2020-08-31T01:00:00.202204Z	info	sds	resource:default new connection
2020-08-31T01:00:00.202286Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:00:00.202351Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:00.202798Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:00.202829Z	error	sds	Remote side closed connection
2020-08-31T01:00:00.203307Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:00:00.203357Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:00:00.203515Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:00:00.203765Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:00.203795Z	error	sds	Remote side closed connection
2020-08-31T01:00:00.203984Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"50910bb7-48f0-4f0f-be06-c98c86410f16".sock: use of closed network connection
2020-08-31T01:00:00.204171Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"955d1ce3-97d7-4c2e-ae0c-2c747fa6b649\".sock" 

2020-08-31T01:00:00.204266Z	info	sds	Start SDS grpc server
2020-08-31T01:00:00.204741Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:00:00.204781Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:00:00.204849Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:00:00.205143Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:00.205162Z	error	sds	Remote side closed connection
2020-08-31T01:00:00.205325Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"955d1ce3-97d7-4c2e-ae0c-2c747fa6b649".sock: use of closed network connection
2020-08-31T01:00:00.205469Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3bf25579-d2c7-4347-8df1-719f3814139e\".sock" 

2020-08-31T01:00:00.205498Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:00.506602Z	info	sds	resource:default new connection
2020-08-31T01:00:00.506687Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:00:00.506763Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:00.507123Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:00.507136Z	error	sds	Remote side closed connection
2020-08-31T01:00:00.507406Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3bf25579-d2c7-4347-8df1-719f3814139e".sock: use of closed network connection
2020-08-31T01:00:00.507613Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e9cd70de-dbcd-4a91-960d-3470fdf330a4\".sock" 

2020-08-31T01:00:00.507670Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"901b076a-96dc-4a09-a0fc-fbea6ec9b293\".sock" 

2020-08-31T01:00:00.507699Z	info	sds	Start SDS grpc server
2020-08-31T01:00:00.507703Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:00.808611Z	info	sds	resource:default new connection
2020-08-31T01:00:00.808724Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:00:00.808797Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:00.809113Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:00.809152Z	error	sds	Remote side closed connection
2020-08-31T01:00:00.809611Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:00:00.809645Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:00:00.809681Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:00:00.809847Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:00.809868Z	error	sds	Remote side closed connection
2020-08-31T01:00:00.901067Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:01.111009Z	info	sds	resource:default new connection
2020-08-31T01:00:01.111077Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:00:01.111140Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:01.111469Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:01.111490Z	error	sds	Remote side closed connection
2020-08-31T01:00:01.111734Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e9cd70de-dbcd-4a91-960d-3470fdf330a4".sock: use of closed network connection
2020-08-31T01:00:01.111805Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"901b076a-96dc-4a09-a0fc-fbea6ec9b293".sock: use of closed network connection
2020-08-31T01:00:01.111966Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0e94d2c2-6c85-4f4f-bc24-6677dbbffca9\".sock" 

2020-08-31T01:00:01.111981Z	info	sds	Start SDS grpc server
2020-08-31T01:00:01.204247Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:01.205504Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:00:01.414436Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0e94d2c2-6c85-4f4f-bc24-6677dbbffca9".sock: use of closed network connection
2020-08-31T01:00:01.414640Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7646ad08-12f1-4192-add9-f30818175d5c\".sock" 

2020-08-31T01:00:01.414656Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:01.507632Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:00:01.716137Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7646ad08-12f1-4192-add9-f30818175d5c".sock: use of closed network connection
2020-08-31T01:00:01.716512Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestef8fe27b-470b-4c26-9d26-dc58b7ad3344.sock" 

2020-08-31T01:00:01.716599Z	info	sds	Start SDS grpc server
2020-08-31T01:00:01.716641Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"003acfcf-bbd2-44a5-bc86-18fbd995e358\".sock" 

2020-08-31T01:00:01.716650Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:00:02.111965Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:02.112012Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:00:02.321003Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestef8fe27b-470b-4c26-9d26-dc58b7ad3344.sock: use of closed network connection
2020-08-31T01:00:02.321085Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"003acfcf-bbd2-44a5-bc86-18fbd995e358".sock: use of closed network connection
2020-08-31T01:00:02.321261Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestbb7550b6-744d-4a9d-8378-c602cb5ff098.sock" 

2020-08-31T01:00:02.321341Z	info	sds	Start SDS grpc server
2020-08-31T01:00:02.414626Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:02.622408Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:00:02.622500Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:02.622685Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestbb7550b6-744d-4a9d-8378-c602cb5ff098.sock: use of closed network connection
2020-08-31T01:00:02.622944Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5d7b57a4-0a0a-4c91-8737-0782f9b88035.sock" 

2020-08-31T01:00:02.623026Z	info	sds	Start SDS grpc server
2020-08-31T01:00:02.623974Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:00:02.624019Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:00:02.624071Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:02.624349Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:00:02.624404Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:00:02.624442Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:00:02.716360Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:02.901384Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:03.204535Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:03.205705Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:03.321244Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:03.321309Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:03.507909Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:03.622931Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:03.624489Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:03.624524Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:00:04.112229Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:04.112276Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:04.414885Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:04.625520Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:04.625887Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5d7b57a4-0a0a-4c91-8737-0782f9b88035.sock: use of closed network connection
2020-08-31T01:00:04.625978Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:04.625997Z	error	sds	Remote side closed connection
2020-08-31T01:00:04.626045Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:04.626100Z	error	sds	Remote side closed connection
2020-08-31T01:00:04.626109Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestded2b451-243f-496d-9c56-3f358c034a69.sock" 

2020-08-31T01:00:04.626198Z	info	sds	Start SDS grpc server
2020-08-31T01:00:04.626874Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:00:04.626916Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:00:04.626961Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:04.627368Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:00:04.626960719 +0000 UTC m=+6.803767141 and is waiting for next SDS request
2020-08-31T01:00:04.627397Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestded2b451-243f-496d-9c56-3f358c034a69.sock: use of closed network connection
2020-08-31T01:00:04.627399Z	info	sds	Dynamic push for secret default
2020-08-31T01:00:04.627482Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:04.627515Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:04.627507Z	error	sds	Remote side closed connection
2020-08-31T01:00:04.627538Z	error	sds	Remote side closed connection
2020-08-31T01:00:04.627585Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc7f0328e-f9fa-4d2b-86b4-51e5e5f289c1.sock" 

2020-08-31T01:00:04.627590Z	info	sds	Start SDS grpc server
2020-08-31T01:00:04.628223Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:00:04.628274Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:00:04.628312Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:04.628791Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:00:04.716624Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:05.128978Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:05.129032Z	info	sds	Dynamic push for secret default
2020-08-31T01:00:05.129623Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc7f0328e-f9fa-4d2b-86b4-51e5e5f289c1.sock: use of closed network connection
2020-08-31T01:00:05.129736Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:05.129779Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:05.129804Z	error	sds	Remote side closed connection
2020-08-31T01:00:05.129761Z	error	sds	Remote side closed connection
2020-08-31T01:00:05.129902Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd7ba4611-ab2e-4333-a3a6-1e2637d6ba47.sock" 

2020-08-31T01:00:05.129963Z	info	sds	Start SDS grpc server
2020-08-31T01:00:05.130116Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd7ba4611-ab2e-4333-a3a6-1e2637d6ba47.sock: use of closed network connection
2020-08-31T01:00:05.130196Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfa3b5c5d-a752-4e91-85fc-3d80f87e8789.sock" 

2020-08-31T01:00:05.130208Z	info	sds	Start SDS grpc server
2020-08-31T01:00:05.321538Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:05.321629Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:05.431204Z	info	sds	resource:default new connection
2020-08-31T01:00:05.431284Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:00:05.431344Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:05.431783Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:05.431812Z	error	sds	Remote side closed connection
2020-08-31T01:00:05.623113Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:05.626071Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:05.627553Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:05.733068Z	info	sds	resource:default new connection
2020-08-31T01:00:05.733133Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:00:05.733205Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:05.733606Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:05.733640Z	error	sds	Remote side closed connection
2020-08-31T01:00:05.733980Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfa3b5c5d-a752-4e91-85fc-3d80f87e8789.sock: use of closed network connection
2020-08-31T01:00:05.734138Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcffdf489-ac1e-403f-a193-ef42da94300b.sock" 

2020-08-31T01:00:05.734177Z	info	sds	Start SDS grpc server
2020-08-31T01:00:06.034924Z	info	sds	resource:default new connection
2020-08-31T01:00:06.034980Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:00:06.035041Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:06.035355Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:06.035373Z	error	sds	Remote side closed connection
2020-08-31T01:00:06.035565Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcffdf489-ac1e-403f-a193-ef42da94300b.sock: use of closed network connection
2020-08-31T01:00:06.129864Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:06.130199Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:06.734183Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:06.901544Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:07.035757Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:00:07.204774Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:07.205884Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:07.508148Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:07.626288Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:07.627766Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:00:08.068302Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste533348a-6b75-4a18-a865-a38f3f357b1c.sock" 

2020-08-31T01:00:08.068365Z	info	sds	Start SDS grpc server
2020-08-31T01:00:08.112499Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:08.112572Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:08.130095Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:08.130352Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:08.415166Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:08.716905Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:08.734337Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:09.036038Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:09.069350Z	info	sds	resource:default new connection
2020-08-31T01:00:09.069419Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:00:09.071919Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:00:09.293545Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:00:09.293596Z	info	cache	GenerateSecret default
2020-08-31T01:00:09.293670Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:09.294054Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste533348a-6b75-4a18-a865-a38f3f357b1c.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.718s
2020-08-31T01:00:14.536048Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2898d06d-8eea-4de3-8c0b-43cbf71ffff5.sock" 

2020-08-31T01:00:14.536183Z	info	sds	Start SDS grpc server
2020-08-31T01:00:14.537592Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:00:14.537659Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:00:14.538111Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:15.537431Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:15.537485Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:00:16.538544Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:00:16.538646Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:00:16.538670Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:00:16.538740Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:16.539030Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2898d06d-8eea-4de3-8c0b-43cbf71ffff5.sock: use of closed network connection
2020-08-31T01:00:16.539142Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:16.539158Z	error	sds	Remote side closed connection
2020-08-31T01:00:16.539289Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"98a4fe30-6548-4305-af9a-beab718af0c7\".sock" 

2020-08-31T01:00:16.539308Z	info	sds	Start SDS grpc server
2020-08-31T01:00:16.840403Z	info	sds	resource:default new connection
2020-08-31T01:00:16.840488Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:00:16.840549Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:16.840907Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:16.840922Z	error	sds	Remote side closed connection
2020-08-31T01:00:16.841677Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:00:16.841708Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:00:16.841868Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:00:16.842091Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:16.842104Z	error	sds	Remote side closed connection
2020-08-31T01:00:16.842460Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"98a4fe30-6548-4305-af9a-beab718af0c7".sock: use of closed network connection
2020-08-31T01:00:16.842709Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6f3cea35-577e-489f-8ba1-d463a0f83cfb\".sock" 

2020-08-31T01:00:16.842776Z	info	sds	Start SDS grpc server
2020-08-31T01:00:16.843305Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:00:16.843346Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:00:16.843381Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:00:16.843566Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:16.843578Z	error	sds	Remote side closed connection
2020-08-31T01:00:16.843873Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6f3cea35-577e-489f-8ba1-d463a0f83cfb".sock: use of closed network connection
2020-08-31T01:00:16.844010Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"af85d769-2505-47a7-90a0-6fbef6708384\".sock" 

2020-08-31T01:00:16.844032Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:17.145053Z	info	sds	resource:default new connection
2020-08-31T01:00:17.145119Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:00:17.145185Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:17.145501Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:17.145525Z	error	sds	Remote side closed connection
2020-08-31T01:00:17.145748Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"af85d769-2505-47a7-90a0-6fbef6708384".sock: use of closed network connection
2020-08-31T01:00:17.146040Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b3befde8-5ed5-4f13-a81d-3b7888868726\".sock" 

2020-08-31T01:00:17.146113Z	info	sds	Start SDS grpc server
2020-08-31T01:00:17.146148Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8cb4f59c-1f37-4022-b9d9-5208d6f66423\".sock" 

2020-08-31T01:00:17.146195Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:17.447192Z	info	sds	resource:default new connection
2020-08-31T01:00:17.447259Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:00:17.447341Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:17.447621Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:17.447634Z	error	sds	Remote side closed connection
2020-08-31T01:00:17.448447Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:00:17.448505Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:00:17.448574Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:00:17.448921Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:17.448945Z	error	sds	Remote side closed connection
2020-08-31T01:00:17.539334Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:17.749888Z	info	sds	resource:default new connection
2020-08-31T01:00:17.749960Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:00:17.750027Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:17.750379Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:17.750403Z	error	sds	Remote side closed connection
2020-08-31T01:00:17.750604Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b3befde8-5ed5-4f13-a81d-3b7888868726".sock: use of closed network connection
2020-08-31T01:00:17.750653Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8cb4f59c-1f37-4022-b9d9-5208d6f66423".sock: use of closed network connection
2020-08-31T01:00:17.750903Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b6135252-0e0d-4ad5-a793-f311e78e4b50\".sock" 

2020-08-31T01:00:17.750938Z	info	sds	Start SDS grpc server
2020-08-31T01:00:17.842541Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:17.843963Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:00:18.054217Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b6135252-0e0d-4ad5-a793-f311e78e4b50".sock: use of closed network connection
2020-08-31T01:00:18.054482Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"efe933e8-db7b-46cd-b099-79d5cfd39afc\".sock" 

2020-08-31T01:00:18.054518Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:18.145932Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:00:18.356184Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"efe933e8-db7b-46cd-b099-79d5cfd39afc".sock: use of closed network connection
2020-08-31T01:00:18.356458Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestc8aedf3b-637a-47ca-ac11-a04b636c17ee.sock" 

2020-08-31T01:00:18.356530Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9e02a256-601d-4579-9add-91989f55d76e\".sock" 

2020-08-31T01:00:18.356526Z	info	sds	Start SDS grpc server
2020-08-31T01:00:18.356558Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:00:18.750821Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:18.750821Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:00:18.960890Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestc8aedf3b-637a-47ca-ac11-a04b636c17ee.sock: use of closed network connection
2020-08-31T01:00:18.960952Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9e02a256-601d-4579-9add-91989f55d76e".sock: use of closed network connection
2020-08-31T01:00:18.961140Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0ae66d0b-96da-4341-8aa9-3fb4adbfd56d.sock" 

2020-08-31T01:00:18.961171Z	info	sds	Start SDS grpc server
2020-08-31T01:00:19.054521Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:19.262304Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:00:19.262435Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:19.262738Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0ae66d0b-96da-4341-8aa9-3fb4adbfd56d.sock: use of closed network connection
2020-08-31T01:00:19.262977Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb19908d3-73cd-449a-8be6-2102e9b70109.sock" 

2020-08-31T01:00:19.263055Z	info	sds	Start SDS grpc server
2020-08-31T01:00:19.264954Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:00:19.265058Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:00:19.265137Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:19.265754Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:00:19.265817Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:00:19.265870Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:00:19.356416Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:19.539582Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:19.847769Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:19.847824Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:19.961156Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:19.961157Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:20.146176Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:20.262937Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:20.265794Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:20.265845Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:00:20.751126Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:20.751149Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:21.054772Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:21.266727Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:21.267090Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb19908d3-73cd-449a-8be6-2102e9b70109.sock: use of closed network connection
2020-08-31T01:00:21.267102Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:21.267128Z	error	sds	Remote side closed connection
2020-08-31T01:00:21.267182Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:21.267201Z	error	sds	Remote side closed connection
2020-08-31T01:00:21.267474Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbd14e71c-16bd-4fda-b66b-00239355453a.sock" 

2020-08-31T01:00:21.267585Z	info	sds	Start SDS grpc server
2020-08-31T01:00:21.268429Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:00:21.268489Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:00:21.268536Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:21.268997Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:00:21.268536028 +0000 UTC m=+6.813965505 and is waiting for next SDS request
2020-08-31T01:00:21.269018Z	info	sds	Dynamic push for secret default
2020-08-31T01:00:21.269046Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbd14e71c-16bd-4fda-b66b-00239355453a.sock: use of closed network connection
2020-08-31T01:00:21.269118Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:21.269126Z	error	sds	Remote side closed connection
2020-08-31T01:00:21.269204Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:21.269229Z	error	sds	Remote side closed connection
2020-08-31T01:00:21.269341Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta461e8f3-1358-4235-9533-4706c50d4d27.sock" 

2020-08-31T01:00:21.269356Z	info	sds	Start SDS grpc server
2020-08-31T01:00:21.269985Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:00:21.270034Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:00:21.270077Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:21.270656Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:00:21.356703Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:21.770835Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:21.770884Z	info	sds	Dynamic push for secret default
2020-08-31T01:00:21.771472Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta461e8f3-1358-4235-9533-4706c50d4d27.sock: use of closed network connection
2020-08-31T01:00:21.771583Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:21.771612Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:21.771612Z	error	sds	Remote side closed connection
2020-08-31T01:00:21.771654Z	error	sds	Remote side closed connection
2020-08-31T01:00:21.771725Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf4fbdad3-32db-4028-baca-bf8da482997a.sock" 

2020-08-31T01:00:21.771757Z	info	sds	Start SDS grpc server
2020-08-31T01:00:21.771987Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf4fbdad3-32db-4028-baca-bf8da482997a.sock: use of closed network connection
2020-08-31T01:00:21.772066Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc20c731a-4dd3-42b8-9ec2-f447d0f7242c.sock" 

2020-08-31T01:00:21.772086Z	info	sds	Start SDS grpc server
2020-08-31T01:00:21.961352Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:21.961398Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:22.072979Z	info	sds	resource:default new connection
2020-08-31T01:00:22.073038Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:00:22.073098Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:22.073440Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:22.073456Z	error	sds	Remote side closed connection
2020-08-31T01:00:22.263179Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:22.267260Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:22.269141Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:22.374620Z	info	sds	resource:default new connection
2020-08-31T01:00:22.374698Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:00:22.374775Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:22.375077Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:22.375101Z	error	sds	Remote side closed connection
2020-08-31T01:00:22.375482Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc20c731a-4dd3-42b8-9ec2-f447d0f7242c.sock: use of closed network connection
2020-08-31T01:00:22.375637Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd37e334e-71fd-41fe-9148-e3bd50e09cc7.sock" 

2020-08-31T01:00:22.375684Z	info	sds	Start SDS grpc server
2020-08-31T01:00:22.676521Z	info	sds	resource:default new connection
2020-08-31T01:00:22.676585Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:00:22.676642Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:22.676928Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:22.676966Z	error	sds	Remote side closed connection
2020-08-31T01:00:22.677245Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd37e334e-71fd-41fe-9148-e3bd50e09cc7.sock: use of closed network connection
2020-08-31T01:00:22.771706Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:22.772118Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:23.375706Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:23.539832Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:23.677382Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:00:23.847982Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:23.848019Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:24.146459Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:24.267519Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:24.269369Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:00:24.707057Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbf8dec0d-285d-4f85-b335-5fbff728a066.sock" 

2020-08-31T01:00:24.707104Z	info	sds	Start SDS grpc server
2020-08-31T01:00:24.751356Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:24.751392Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:24.771965Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:24.772310Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:25.055066Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:25.356955Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:25.376044Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:25.677626Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:25.707995Z	info	sds	resource:default new connection
2020-08-31T01:00:25.708060Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:00:25.714155Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:00:25.777331Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:00:25.777375Z	info	cache	GenerateSecret default
2020-08-31T01:00:25.777435Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:25.778511Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbf8dec0d-285d-4f85-b335-5fbff728a066.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.572s
2020-08-31T01:00:30.988680Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest44fac536-8dc2-4d68-b1a2-18a699c1e33c.sock" 

2020-08-31T01:00:30.988792Z	info	sds	Start SDS grpc server
2020-08-31T01:00:30.990205Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:00:30.990267Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:00:30.990629Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:31.990126Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:31.990192Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:00:32.991017Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:00:32.991100Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:00:32.991124Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:00:32.991198Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:32.991390Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest44fac536-8dc2-4d68-b1a2-18a699c1e33c.sock: use of closed network connection
2020-08-31T01:00:32.991570Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:32.991603Z	error	sds	Remote side closed connection
2020-08-31T01:00:32.991664Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f85d808a-4411-48d1-a5f9-08598a71b7b4\".sock" 

2020-08-31T01:00:32.991684Z	info	sds	Start SDS grpc server
2020-08-31T01:00:33.292727Z	info	sds	resource:default new connection
2020-08-31T01:00:33.292794Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:00:33.292853Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:33.293159Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:33.293191Z	error	sds	Remote side closed connection
2020-08-31T01:00:33.293770Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:00:33.293817Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:00:33.293978Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:00:33.294217Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:33.294236Z	error	sds	Remote side closed connection
2020-08-31T01:00:33.294426Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f85d808a-4411-48d1-a5f9-08598a71b7b4".sock: use of closed network connection
2020-08-31T01:00:33.294612Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3ca06915-28b6-481b-a6a4-139e8cd8237c\".sock" 

2020-08-31T01:00:33.294634Z	info	sds	Start SDS grpc server
2020-08-31T01:00:33.295106Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:00:33.295139Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:00:33.295174Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:00:33.295464Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:33.295476Z	error	sds	Remote side closed connection
2020-08-31T01:00:33.295669Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3ca06915-28b6-481b-a6a4-139e8cd8237c".sock: use of closed network connection
2020-08-31T01:00:33.295881Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"95da90fd-a6f2-481c-bfc6-75efefb0a0f6\".sock" 

2020-08-31T01:00:33.295919Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:33.596835Z	info	sds	resource:default new connection
2020-08-31T01:00:33.596897Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:00:33.596956Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:33.597342Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:33.597374Z	error	sds	Remote side closed connection
2020-08-31T01:00:33.597635Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"95da90fd-a6f2-481c-bfc6-75efefb0a0f6".sock: use of closed network connection
2020-08-31T01:00:33.597865Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"08f4b428-1cf1-4387-8210-542e1df7ceca\".sock" 

2020-08-31T01:00:33.597933Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4200e8bb-71c1-427f-b75f-11b0abb69d87\".sock" 

2020-08-31T01:00:33.597942Z	info	sds	Start SDS grpc server
2020-08-31T01:00:33.597963Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:33.899406Z	info	sds	resource:default new connection
2020-08-31T01:00:33.899473Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:00:33.899543Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:33.899824Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:33.899859Z	error	sds	Remote side closed connection
2020-08-31T01:00:33.900485Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:00:33.900520Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:00:33.900560Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:00:33.900840Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:33.900856Z	error	sds	Remote side closed connection
2020-08-31T01:00:33.991623Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:34.201805Z	info	sds	resource:default new connection
2020-08-31T01:00:34.201866Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:00:34.201921Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:34.202150Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:34.202178Z	error	sds	Remote side closed connection
2020-08-31T01:00:34.202392Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"08f4b428-1cf1-4387-8210-542e1df7ceca".sock: use of closed network connection
2020-08-31T01:00:34.202479Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4200e8bb-71c1-427f-b75f-11b0abb69d87".sock: use of closed network connection
2020-08-31T01:00:34.202664Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"471054cf-b27e-4a16-980c-df05b29865fe\".sock" 

2020-08-31T01:00:34.202686Z	info	sds	Start SDS grpc server
2020-08-31T01:00:34.294675Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:34.295862Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:00:34.505612Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"471054cf-b27e-4a16-980c-df05b29865fe".sock: use of closed network connection
2020-08-31T01:00:34.505789Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a8e22ea2-903b-4367-9bae-476b799bd509\".sock" 

2020-08-31T01:00:34.505814Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:34.597862Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:00:34.807549Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a8e22ea2-903b-4367-9bae-476b799bd509".sock: use of closed network connection
2020-08-31T01:00:34.807778Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste2b8304b-6598-4669-96be-2a313e02d0db.sock" 

2020-08-31T01:00:34.807844Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6193fe18-f623-4ead-97a3-6d04b6b0a634\".sock" 

2020-08-31T01:00:34.807861Z	info	sds	Start SDS grpc server
2020-08-31T01:00:34.807883Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:00:35.202593Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:35.202623Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:00:35.411803Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste2b8304b-6598-4669-96be-2a313e02d0db.sock: use of closed network connection
2020-08-31T01:00:35.411859Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6193fe18-f623-4ead-97a3-6d04b6b0a634".sock: use of closed network connection
2020-08-31T01:00:35.412037Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest49d6014e-d112-4c09-a1fa-1db79e8ae782.sock" 

2020-08-31T01:00:35.412060Z	info	sds	Start SDS grpc server
2020-08-31T01:00:35.505701Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:35.713761Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:00:35.713862Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:35.714136Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest49d6014e-d112-4c09-a1fa-1db79e8ae782.sock: use of closed network connection
2020-08-31T01:00:35.714392Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest19dbcb94-4aaf-4499-a76d-8eac9d018afc.sock" 

2020-08-31T01:00:35.714476Z	info	sds	Start SDS grpc server
2020-08-31T01:00:35.715183Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:00:35.715748Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:00:35.715860Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:35.716237Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:00:35.716314Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:00:35.716372Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:00:35.807787Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:35.991893Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:36.294941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:36.296056Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:36.411900Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:36.411966Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:36.598145Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:36.714395Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:36.716260Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:36.716286Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:00:37.202851Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:37.202870Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:37.505959Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:37.717064Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:37.717490Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest19dbcb94-4aaf-4499-a76d-8eac9d018afc.sock: use of closed network connection
2020-08-31T01:00:37.717509Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:37.717535Z	error	sds	Remote side closed connection
2020-08-31T01:00:37.717611Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:37.717632Z	error	sds	Remote side closed connection
2020-08-31T01:00:37.717757Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest92b68099-e990-4940-96df-7bf344f09ac0.sock" 

2020-08-31T01:00:37.717798Z	info	sds	Start SDS grpc server
2020-08-31T01:00:37.718496Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:00:37.718533Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:00:37.718580Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:37.718994Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:00:37.718579196 +0000 UTC m=+6.803380896 and is waiting for next SDS request
2020-08-31T01:00:37.719029Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest92b68099-e990-4940-96df-7bf344f09ac0.sock: use of closed network connection
2020-08-31T01:00:37.719032Z	info	sds	Dynamic push for secret default
2020-08-31T01:00:37.719092Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:37.719119Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:37.719114Z	error	sds	Remote side closed connection
2020-08-31T01:00:37.719141Z	error	sds	Remote side closed connection
2020-08-31T01:00:37.719209Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta23e762b-78f4-4945-9c50-337ef233fea1.sock" 

2020-08-31T01:00:37.719240Z	info	sds	Start SDS grpc server
2020-08-31T01:00:37.719987Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:00:37.720020Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:00:37.720066Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:37.720558Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:00:37.808047Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:38.220866Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:38.220923Z	info	sds	Dynamic push for secret default
2020-08-31T01:00:38.221563Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta23e762b-78f4-4945-9c50-337ef233fea1.sock: use of closed network connection
2020-08-31T01:00:38.221677Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:38.221693Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:38.221714Z	error	sds	Remote side closed connection
2020-08-31T01:00:38.221698Z	error	sds	Remote side closed connection
2020-08-31T01:00:38.221820Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest574252e8-9c0c-4249-b557-218b8ce5a33d.sock" 

2020-08-31T01:00:38.221922Z	info	sds	Start SDS grpc server
2020-08-31T01:00:38.222045Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest574252e8-9c0c-4249-b557-218b8ce5a33d.sock: use of closed network connection
2020-08-31T01:00:38.222121Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest75ccb0bf-f9a9-4b5c-9be7-dc612e6e4890.sock" 

2020-08-31T01:00:38.222138Z	info	sds	Start SDS grpc server
2020-08-31T01:00:38.412040Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:38.412087Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:38.522962Z	info	sds	resource:default new connection
2020-08-31T01:00:38.523103Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:00:38.523156Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:38.523472Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:38.523497Z	error	sds	Remote side closed connection
2020-08-31T01:00:38.714681Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:38.717662Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:38.719204Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:38.824564Z	info	sds	resource:default new connection
2020-08-31T01:00:38.824639Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:00:38.824734Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:38.825082Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:38.825121Z	error	sds	Remote side closed connection
2020-08-31T01:00:38.825373Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest75ccb0bf-f9a9-4b5c-9be7-dc612e6e4890.sock: use of closed network connection
2020-08-31T01:00:38.825539Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest89f1a730-3789-4d81-8ecf-fd76ee1facab.sock" 

2020-08-31T01:00:38.825566Z	info	sds	Start SDS grpc server
2020-08-31T01:00:39.126519Z	info	sds	resource:default new connection
2020-08-31T01:00:39.126573Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:00:39.126647Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:39.126882Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:39.126902Z	error	sds	Remote side closed connection
2020-08-31T01:00:39.127212Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest89f1a730-3789-4d81-8ecf-fd76ee1facab.sock: use of closed network connection
2020-08-31T01:00:39.221777Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:39.222200Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:39.825605Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:39.992117Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:40.127425Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:00:40.295232Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:40.296251Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:40.598434Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:40.717880Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:40.719456Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:00:41.156807Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf60c9763-f7a3-40f1-b0f5-247a9d0dea63.sock" 

2020-08-31T01:00:41.156866Z	info	sds	Start SDS grpc server
2020-08-31T01:00:41.203127Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:41.203174Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:41.222076Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:41.222367Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:41.506186Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:41.808276Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:41.825857Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:42.127557Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:42.158164Z	info	sds	resource:default new connection
2020-08-31T01:00:42.158225Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:00:42.164817Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:00:42.208182Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:00:42.208229Z	info	cache	GenerateSecret default
2020-08-31T01:00:42.208288Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:42.208881Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf60c9763-f7a3-40f1-b0f5-247a9d0dea63.sock: use of closed network connection
PASS
2020-08-31T01:00:42.208934Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:42.208953Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.541s
2020-08-31T01:00:47.526765Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc59213c4-318c-487c-bccd-3ba5df6d3725.sock" 

2020-08-31T01:00:47.526886Z	info	sds	Start SDS grpc server
2020-08-31T01:00:47.528139Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:00:47.528195Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:00:47.528712Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:48.528062Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:48.528164Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:00:49.528944Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:00:49.529065Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:00:49.529090Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:00:49.529144Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:49.529370Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc59213c4-318c-487c-bccd-3ba5df6d3725.sock: use of closed network connection
2020-08-31T01:00:49.529465Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:49.529495Z	error	sds	Remote side closed connection
2020-08-31T01:00:49.529648Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e832273a-c5ee-4ccb-9cf3-044f182b13af\".sock" 

2020-08-31T01:00:49.529683Z	info	sds	Start SDS grpc server
2020-08-31T01:00:49.830680Z	info	sds	resource:default new connection
2020-08-31T01:00:49.830743Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:00:49.830797Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:49.831155Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:49.831184Z	error	sds	Remote side closed connection
2020-08-31T01:00:49.831860Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:00:49.831906Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:00:49.832068Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:00:49.832299Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:49.832320Z	error	sds	Remote side closed connection
2020-08-31T01:00:49.832497Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e832273a-c5ee-4ccb-9cf3-044f182b13af".sock: use of closed network connection
2020-08-31T01:00:49.832701Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"10f4fd13-f8e8-40b3-803c-b1bcab8ffbc6\".sock" 

2020-08-31T01:00:49.832780Z	info	sds	Start SDS grpc server
2020-08-31T01:00:49.833231Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:00:49.833291Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:00:49.833362Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:00:49.833625Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:49.833649Z	error	sds	Remote side closed connection
2020-08-31T01:00:49.833853Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"10f4fd13-f8e8-40b3-803c-b1bcab8ffbc6".sock: use of closed network connection
2020-08-31T01:00:49.834042Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8c100980-8901-4a98-8f98-b961bc5ab119\".sock" 

2020-08-31T01:00:49.834059Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:50.135044Z	info	sds	resource:default new connection
2020-08-31T01:00:50.135104Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:00:50.135186Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:50.135401Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:50.135417Z	error	sds	Remote side closed connection
2020-08-31T01:00:50.135747Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8c100980-8901-4a98-8f98-b961bc5ab119".sock: use of closed network connection
2020-08-31T01:00:50.135946Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"90e815a3-a014-4196-854d-c4a0939513af\".sock" 

2020-08-31T01:00:50.136045Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5fcea6e6-4389-441d-b87e-519356a72c37\".sock" 

2020-08-31T01:00:50.136059Z	info	sds	Start SDS grpc server
2020-08-31T01:00:50.136078Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:50.437116Z	info	sds	resource:default new connection
2020-08-31T01:00:50.437192Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:00:50.437254Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:50.437660Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:50.437688Z	error	sds	Remote side closed connection
2020-08-31T01:00:50.438109Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:00:50.438142Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:00:50.438178Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:00:50.438334Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:50.438353Z	error	sds	Remote side closed connection
2020-08-31T01:00:50.529543Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:50.739364Z	info	sds	resource:default new connection
2020-08-31T01:00:50.739437Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:00:50.739502Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:50.739750Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:50.739772Z	error	sds	Remote side closed connection
2020-08-31T01:00:50.740019Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"90e815a3-a014-4196-854d-c4a0939513af".sock: use of closed network connection
2020-08-31T01:00:50.740061Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5fcea6e6-4389-441d-b87e-519356a72c37".sock: use of closed network connection
2020-08-31T01:00:50.740259Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a5356e5c-a058-441d-83c1-3977730a6d89\".sock" 

2020-08-31T01:00:50.740280Z	info	sds	Start SDS grpc server
2020-08-31T01:00:50.832722Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:50.834007Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:00:51.043128Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a5356e5c-a058-441d-83c1-3977730a6d89".sock: use of closed network connection
2020-08-31T01:00:51.043388Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"aebaf4ba-52f8-47af-afb5-0bf47be6f726\".sock" 

2020-08-31T01:00:51.043408Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:00:51.135974Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:00:51.345110Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"aebaf4ba-52f8-47af-afb5-0bf47be6f726".sock: use of closed network connection
2020-08-31T01:00:51.345378Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest8d3cc851-8592-4be4-8c54-a61f03452b55.sock" 

2020-08-31T01:00:51.345394Z	info	sds	Start SDS grpc server
2020-08-31T01:00:51.345455Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e29f6bb1-278c-4e5b-bfc5-894e5bd54a60\".sock" 

2020-08-31T01:00:51.345492Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:00:51.740252Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:51.740240Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:00:51.949372Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest8d3cc851-8592-4be4-8c54-a61f03452b55.sock: use of closed network connection
2020-08-31T01:00:51.949436Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e29f6bb1-278c-4e5b-bfc5-894e5bd54a60".sock: use of closed network connection
2020-08-31T01:00:51.949591Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest130f1535-a168-4272-8bf0-0b9f41dccf94.sock" 

2020-08-31T01:00:51.949612Z	info	sds	Start SDS grpc server
2020-08-31T01:00:52.043291Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:52.250576Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:00:52.250673Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:52.250935Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest130f1535-a168-4272-8bf0-0b9f41dccf94.sock: use of closed network connection
2020-08-31T01:00:52.251199Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta23e0d04-da66-44d2-93dd-253a62297ecc.sock" 

2020-08-31T01:00:52.251219Z	info	sds	Start SDS grpc server
2020-08-31T01:00:52.252513Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:00:52.253192Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:00:52.253313Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:52.253926Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:00:52.253989Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:00:52.254052Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:00:52.345321Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:52.529800Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:52.832968Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:52.834155Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:52.949590Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:52.949640Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:53.136163Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:53.251152Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:53.253978Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:53.254016Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:00:53.740407Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:53.740445Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:54.043545Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:54.254770Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:54.255130Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta23e0d04-da66-44d2-93dd-253a62297ecc.sock: use of closed network connection
2020-08-31T01:00:54.255219Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:54.255240Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:54.255251Z	error	sds	Remote side closed connection
2020-08-31T01:00:54.255263Z	error	sds	Remote side closed connection
2020-08-31T01:00:54.255413Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc59162da-2687-4487-b968-447d6ab5d3c4.sock" 

2020-08-31T01:00:54.255507Z	info	sds	Start SDS grpc server
2020-08-31T01:00:54.256200Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:00:54.256267Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:00:54.256330Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:54.256872Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:00:54.256329609 +0000 UTC m=+6.804621172 and is waiting for next SDS request
2020-08-31T01:00:54.256917Z	info	sds	Dynamic push for secret default
2020-08-31T01:00:54.256906Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc59162da-2687-4487-b968-447d6ab5d3c4.sock: use of closed network connection
2020-08-31T01:00:54.256959Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:54.256970Z	error	sds	Remote side closed connection
2020-08-31T01:00:54.257012Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:54.257035Z	error	sds	Remote side closed connection
2020-08-31T01:00:54.257073Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste27d3d02-f74f-49d1-a742-c396fd4fd03c.sock" 

2020-08-31T01:00:54.257091Z	info	sds	Start SDS grpc server
2020-08-31T01:00:54.257846Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:00:54.257881Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:00:54.257916Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:54.258403Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:00:54.345577Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:54.758554Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:54.758609Z	info	sds	Dynamic push for secret default
2020-08-31T01:00:54.759195Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste27d3d02-f74f-49d1-a742-c396fd4fd03c.sock: use of closed network connection
2020-08-31T01:00:54.759296Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:54.759302Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:54.759342Z	error	sds	Remote side closed connection
2020-08-31T01:00:54.759327Z	error	sds	Remote side closed connection
2020-08-31T01:00:54.759434Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest42168759-e5ad-40e9-a1fa-6fc02c12e054.sock" 

2020-08-31T01:00:54.759452Z	info	sds	Start SDS grpc server
2020-08-31T01:00:54.759650Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest42168759-e5ad-40e9-a1fa-6fc02c12e054.sock: use of closed network connection
2020-08-31T01:00:54.759723Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest59cd848f-0de0-4bfc-bae8-9be7823ab008.sock" 

2020-08-31T01:00:54.759743Z	info	sds	Start SDS grpc server
2020-08-31T01:00:54.949839Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:54.949855Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:55.060638Z	info	sds	resource:default new connection
2020-08-31T01:00:55.060739Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:00:55.060795Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:55.061238Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:55.061272Z	error	sds	Remote side closed connection
2020-08-31T01:00:55.251411Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:55.255323Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:55.257086Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:55.362208Z	info	sds	resource:default new connection
2020-08-31T01:00:55.362297Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:00:55.362367Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:55.362644Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:55.362672Z	error	sds	Remote side closed connection
2020-08-31T01:00:55.362926Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest59cd848f-0de0-4bfc-bae8-9be7823ab008.sock: use of closed network connection
2020-08-31T01:00:55.363046Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf7cdc794-e6ec-4be5-98b3-fdb527477f04.sock" 

2020-08-31T01:00:55.363062Z	info	sds	Start SDS grpc server
2020-08-31T01:00:55.664079Z	info	sds	resource:default new connection
2020-08-31T01:00:55.664146Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:00:55.664201Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:55.664716Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:55.664750Z	error	sds	Remote side closed connection
2020-08-31T01:00:55.664978Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf7cdc794-e6ec-4be5-98b3-fdb527477f04.sock: use of closed network connection
2020-08-31T01:00:55.759378Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:55.759721Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:56.363146Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:56.530062Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:56.665166Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:00:56.833190Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:56.834322Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:57.136425Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:57.255555Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:57.257272Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:00:57.694736Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste6526e6a-2ecb-438e-9867-3b0c0a6b7062.sock" 

2020-08-31T01:00:57.694787Z	info	sds	Start SDS grpc server
2020-08-31T01:00:57.740727Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:57.740767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:57.759591Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:57.759850Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:58.043806Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:58.345886Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:00:58.363439Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:58.665424Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:00:58.695453Z	info	sds	resource:default new connection
2020-08-31T01:00:58.695512Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:00:58.700422Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:00:58.761467Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:00:58.761507Z	info	cache	GenerateSecret default
2020-08-31T01:00:58.761573Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:00:58.761995Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste6526e6a-2ecb-438e-9867-3b0c0a6b7062.sock: use of closed network connection
PASS
2020-08-31T01:00:58.762066Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:00:58.762087Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.556s
2020-08-31T01:01:03.970580Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest44decb96-41d2-4ab3-9ff8-5a2401f381e5.sock" 

2020-08-31T01:01:03.970699Z	info	sds	Start SDS grpc server
2020-08-31T01:01:03.972011Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:01:03.972078Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:01:03.972540Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:04.972003Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:04.972064Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:01:05.972834Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:01:05.972923Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:01:05.972954Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:01:05.973014Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:05.973237Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest44decb96-41d2-4ab3-9ff8-5a2401f381e5.sock: use of closed network connection
2020-08-31T01:01:05.973381Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:05.973412Z	error	sds	Remote side closed connection
2020-08-31T01:01:05.973516Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"328d083b-d9d3-426c-8ae9-e8d67099738a\".sock" 

2020-08-31T01:01:05.973557Z	info	sds	Start SDS grpc server
2020-08-31T01:01:06.274580Z	info	sds	resource:default new connection
2020-08-31T01:01:06.274655Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:01:06.274723Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:06.275019Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:06.275045Z	error	sds	Remote side closed connection
2020-08-31T01:01:06.275675Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:01:06.275737Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:01:06.275986Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:01:06.276285Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:06.276306Z	error	sds	Remote side closed connection
2020-08-31T01:01:06.276496Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"328d083b-d9d3-426c-8ae9-e8d67099738a".sock: use of closed network connection
2020-08-31T01:01:06.276721Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5f77590e-30af-4a8e-9133-bc6c96264b02\".sock" 

2020-08-31T01:01:06.276814Z	info	sds	Start SDS grpc server
2020-08-31T01:01:06.277223Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:01:06.277259Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:01:06.277297Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:01:06.277450Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:06.277483Z	error	sds	Remote side closed connection
2020-08-31T01:01:06.277764Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5f77590e-30af-4a8e-9133-bc6c96264b02".sock: use of closed network connection
2020-08-31T01:01:06.277917Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7a84fd63-a7f7-4de5-998a-0a83516a7e8b\".sock" 

2020-08-31T01:01:06.277960Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:06.578996Z	info	sds	resource:default new connection
2020-08-31T01:01:06.579060Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:01:06.579126Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:06.579451Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:06.579469Z	error	sds	Remote side closed connection
2020-08-31T01:01:06.579708Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7a84fd63-a7f7-4de5-998a-0a83516a7e8b".sock: use of closed network connection
2020-08-31T01:01:06.579933Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"86a8cd0f-3ae2-4d1b-8a4c-15b07a448423\".sock" 

2020-08-31T01:01:06.579992Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"40eb3df8-e01a-4acd-a9e3-10e030bc939e\".sock" 

2020-08-31T01:01:06.580003Z	info	sds	Start SDS grpc server
2020-08-31T01:01:06.580026Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:06.880959Z	info	sds	resource:default new connection
2020-08-31T01:01:06.881016Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:01:06.881068Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:06.881411Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:06.881441Z	error	sds	Remote side closed connection
2020-08-31T01:01:06.881990Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:01:06.882032Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:01:06.882093Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:01:06.882305Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:06.882326Z	error	sds	Remote side closed connection
2020-08-31T01:01:06.973561Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:07.183269Z	info	sds	resource:default new connection
2020-08-31T01:01:07.183355Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:01:07.183412Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:07.183607Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:07.183632Z	error	sds	Remote side closed connection
2020-08-31T01:01:07.183906Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"86a8cd0f-3ae2-4d1b-8a4c-15b07a448423".sock: use of closed network connection
2020-08-31T01:01:07.183949Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"40eb3df8-e01a-4acd-a9e3-10e030bc939e".sock: use of closed network connection
2020-08-31T01:01:07.184110Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"67797a8c-f298-4fca-a5d1-47089eaecdd7\".sock" 

2020-08-31T01:01:07.184138Z	info	sds	Start SDS grpc server
2020-08-31T01:01:07.276725Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:07.277940Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:01:07.487129Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"67797a8c-f298-4fca-a5d1-47089eaecdd7".sock: use of closed network connection
2020-08-31T01:01:07.487365Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"75ff33e0-111f-4ed7-bba8-08cc9b722fb8\".sock" 

2020-08-31T01:01:07.487406Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:07.579917Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:01:07.788804Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"75ff33e0-111f-4ed7-bba8-08cc9b722fb8".sock: use of closed network connection
2020-08-31T01:01:07.788997Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta9966f3d-2d05-4092-b5a2-8d3029d598f1.sock" 

2020-08-31T01:01:07.789053Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ee39120a-0cd2-4c40-ac3c-ac890a0e1032\".sock" 

2020-08-31T01:01:07.789083Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:07.789066Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:01:08.184113Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:08.184146Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:01:08.393009Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta9966f3d-2d05-4092-b5a2-8d3029d598f1.sock: use of closed network connection
2020-08-31T01:01:08.393060Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ee39120a-0cd2-4c40-ac3c-ac890a0e1032".sock: use of closed network connection
2020-08-31T01:01:08.393304Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1b338a1a-a74c-4fe2-8b2e-4df70db5bb22.sock" 

2020-08-31T01:01:08.393336Z	info	sds	Start SDS grpc server
2020-08-31T01:01:08.487358Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:08.694284Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:01:08.694370Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:08.694621Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1b338a1a-a74c-4fe2-8b2e-4df70db5bb22.sock: use of closed network connection
2020-08-31T01:01:08.694836Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd0d1dc90-dd4c-446e-86e6-8e76ef9703c2.sock" 

2020-08-31T01:01:08.694852Z	info	sds	Start SDS grpc server
2020-08-31T01:01:08.695600Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:01:08.695655Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:01:08.695702Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:08.695798Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:01:08.695853Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:01:08.695909Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:01:08.789035Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:08.973798Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:09.276974Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:09.278147Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:09.393215Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:09.393277Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:09.580125Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:09.694853Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:09.695828Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:09.695864Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:01:10.184384Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:10.184444Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:10.487594Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:10.696802Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:10.697157Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd0d1dc90-dd4c-446e-86e6-8e76ef9703c2.sock: use of closed network connection
2020-08-31T01:01:10.697246Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:10.697254Z	error	sds	Remote side closed connection
2020-08-31T01:01:10.697289Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:10.697341Z	error	sds	Remote side closed connection
2020-08-31T01:01:10.697475Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestee4b3d7f-26e0-4f16-bfa0-793f084bf4fa.sock" 

2020-08-31T01:01:10.697592Z	info	sds	Start SDS grpc server
2020-08-31T01:01:10.698760Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:01:10.698804Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:01:10.698858Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:10.699271Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:01:10.698857579 +0000 UTC m=+6.802458970 and is waiting for next SDS request
2020-08-31T01:01:10.699290Z	info	sds	Dynamic push for secret default
2020-08-31T01:01:10.699331Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestee4b3d7f-26e0-4f16-bfa0-793f084bf4fa.sock: use of closed network connection
2020-08-31T01:01:10.699369Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:10.699388Z	error	sds	Remote side closed connection
2020-08-31T01:01:10.699425Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:10.699431Z	error	sds	Remote side closed connection
2020-08-31T01:01:10.699563Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest30c7d212-a755-42b0-8244-5c8db0a0b18a.sock" 

2020-08-31T01:01:10.699645Z	info	sds	Start SDS grpc server
2020-08-31T01:01:10.700292Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:01:10.700341Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:01:10.700385Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:10.701033Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:01:10.789284Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:11.201257Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:11.201312Z	info	sds	Dynamic push for secret default
2020-08-31T01:01:11.201878Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest30c7d212-a755-42b0-8244-5c8db0a0b18a.sock: use of closed network connection
2020-08-31T01:01:11.201955Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:11.201972Z	error	sds	Remote side closed connection
2020-08-31T01:01:11.202013Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:11.202021Z	error	sds	Remote side closed connection
2020-08-31T01:01:11.202165Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5d7075b5-513d-44fe-9ef3-3788aa20746e.sock" 

2020-08-31T01:01:11.202187Z	info	sds	Start SDS grpc server
2020-08-31T01:01:11.202445Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5d7075b5-513d-44fe-9ef3-3788aa20746e.sock: use of closed network connection
2020-08-31T01:01:11.202537Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8ed811a6-fd47-41ff-9bad-e7a3f554440a.sock" 

2020-08-31T01:01:11.202568Z	info	sds	Start SDS grpc server
2020-08-31T01:01:11.393375Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:11.393420Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:11.505272Z	info	sds	resource:default new connection
2020-08-31T01:01:11.505334Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:01:11.505427Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:11.505775Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:11.505821Z	error	sds	Remote side closed connection
2020-08-31T01:01:11.695014Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:11.697401Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:11.699573Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:11.806655Z	info	sds	resource:default new connection
2020-08-31T01:01:11.806719Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:01:11.806772Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:11.806929Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:11.806938Z	error	sds	Remote side closed connection
2020-08-31T01:01:11.807325Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8ed811a6-fd47-41ff-9bad-e7a3f554440a.sock: use of closed network connection
2020-08-31T01:01:11.807462Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest659b1ccc-779b-4b8c-a342-32ac0577b5f3.sock" 

2020-08-31T01:01:11.807494Z	info	sds	Start SDS grpc server
2020-08-31T01:01:12.108473Z	info	sds	resource:default new connection
2020-08-31T01:01:12.108533Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:01:12.108584Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:12.108855Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:12.108881Z	error	sds	Remote side closed connection
2020-08-31T01:01:12.109155Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest659b1ccc-779b-4b8c-a342-32ac0577b5f3.sock: use of closed network connection
2020-08-31T01:01:12.202032Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:12.202515Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:12.807524Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:12.974051Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:13.109280Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:01:13.277205Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:13.278379Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:13.580374Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:13.697602Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:13.699777Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:01:14.137638Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2fb1d812-2fc4-485c-b958-3149d332ffd5.sock" 

2020-08-31T01:01:14.137688Z	info	sds	Start SDS grpc server
2020-08-31T01:01:14.184627Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:14.184680Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:14.202289Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:14.202693Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:14.487822Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:14.789615Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:14.807759Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:15.109394Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:15.138703Z	info	sds	resource:default new connection
2020-08-31T01:01:15.138764Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:01:15.141270Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:01:15.393729Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:15.393807Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:15.430679Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:01:15.430728Z	info	cache	GenerateSecret default
2020-08-31T01:01:15.430807Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:15.431225Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2fb1d812-2fc4-485c-b958-3149d332ffd5.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.781s
2020-08-31T01:01:20.929996Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest79eb5581-c9ac-4791-a10f-7207793770d8.sock" 

2020-08-31T01:01:20.930162Z	info	sds	Start SDS grpc server
2020-08-31T01:01:20.931727Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:01:20.931796Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:01:20.932223Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:21.931537Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:21.931594Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:01:22.932416Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:01:22.932526Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:01:22.932563Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:01:22.932621Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:22.932948Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest79eb5581-c9ac-4791-a10f-7207793770d8.sock: use of closed network connection
2020-08-31T01:01:22.933115Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:22.933151Z	error	sds	Remote side closed connection
2020-08-31T01:01:22.933288Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d5b1c464-b1ef-43b3-a2df-905fafbfc5fa\".sock" 

2020-08-31T01:01:22.933320Z	info	sds	Start SDS grpc server
2020-08-31T01:01:23.234653Z	info	sds	resource:default new connection
2020-08-31T01:01:23.234742Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:01:23.234803Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:23.235192Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:23.235206Z	error	sds	Remote side closed connection
2020-08-31T01:01:23.236195Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:01:23.236339Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:01:23.236597Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:01:23.236990Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:23.237019Z	error	sds	Remote side closed connection
2020-08-31T01:01:23.237183Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d5b1c464-b1ef-43b3-a2df-905fafbfc5fa".sock: use of closed network connection
2020-08-31T01:01:23.237417Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a3885e3f-718d-4f41-97cb-cc3b3ab0afab\".sock" 

2020-08-31T01:01:23.237561Z	info	sds	Start SDS grpc server
2020-08-31T01:01:23.238357Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:01:23.238395Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:01:23.238442Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:01:23.238663Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:23.238681Z	error	sds	Remote side closed connection
2020-08-31T01:01:23.239027Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a3885e3f-718d-4f41-97cb-cc3b3ab0afab".sock: use of closed network connection
2020-08-31T01:01:23.239302Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bb9048c3-7088-4fba-bc42-f4faae619abb\".sock" 

2020-08-31T01:01:23.239333Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:23.540587Z	info	sds	resource:default new connection
2020-08-31T01:01:23.540644Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:01:23.540738Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:23.541191Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:23.541223Z	error	sds	Remote side closed connection
2020-08-31T01:01:23.541362Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bb9048c3-7088-4fba-bc42-f4faae619abb".sock: use of closed network connection
2020-08-31T01:01:23.541587Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a1f8c5a0-2cc1-4b04-8f86-50d2297ab3ca\".sock" 

2020-08-31T01:01:23.541662Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6cb84052-432e-4e32-87ef-c1211fabd6c3\".sock" 

2020-08-31T01:01:23.541658Z	info	sds	Start SDS grpc server
2020-08-31T01:01:23.541710Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:23.842948Z	info	sds	resource:default new connection
2020-08-31T01:01:23.843032Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:01:23.843143Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:23.843548Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:23.843571Z	error	sds	Remote side closed connection
2020-08-31T01:01:23.844348Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:01:23.844391Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:01:23.844438Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:01:23.844643Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:23.844699Z	error	sds	Remote side closed connection
2020-08-31T01:01:23.933234Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:24.145988Z	info	sds	resource:default new connection
2020-08-31T01:01:24.146053Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:01:24.146107Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:24.146437Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:24.146452Z	error	sds	Remote side closed connection
2020-08-31T01:01:24.146897Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a1f8c5a0-2cc1-4b04-8f86-50d2297ab3ca".sock: use of closed network connection
2020-08-31T01:01:24.147018Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6cb84052-432e-4e32-87ef-c1211fabd6c3".sock: use of closed network connection
2020-08-31T01:01:24.147281Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"58629675-e44e-4141-9c85-52b25fb91e7e\".sock" 

2020-08-31T01:01:24.147316Z	info	sds	Start SDS grpc server
2020-08-31T01:01:24.237471Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:24.239354Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:01:24.450402Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"58629675-e44e-4141-9c85-52b25fb91e7e".sock: use of closed network connection
2020-08-31T01:01:24.450667Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6c61f3f0-6a41-43a6-9041-c8c2a8224fe8\".sock" 

2020-08-31T01:01:24.450696Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:24.541622Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:01:24.752933Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6c61f3f0-6a41-43a6-9041-c8c2a8224fe8".sock: use of closed network connection
2020-08-31T01:01:24.753190Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest883db76e-44f6-4de9-9129-40c44cd56abf.sock" 

2020-08-31T01:01:24.753248Z	info	sds	Start SDS grpc server
2020-08-31T01:01:24.753282Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"50f1a7af-9633-47f2-8990-719e8e4fa44d\".sock" 

2020-08-31T01:01:24.753301Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:01:25.147228Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:25.147293Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:01:25.358141Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest883db76e-44f6-4de9-9129-40c44cd56abf.sock: use of closed network connection
2020-08-31T01:01:25.358193Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"50f1a7af-9633-47f2-8990-719e8e4fa44d".sock: use of closed network connection
2020-08-31T01:01:25.358430Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste64349ba-e05c-4c8a-976e-46484150c4e0.sock" 

2020-08-31T01:01:25.358467Z	info	sds	Start SDS grpc server
2020-08-31T01:01:25.450706Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:25.659731Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:01:25.659852Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:25.660088Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste64349ba-e05c-4c8a-976e-46484150c4e0.sock: use of closed network connection
2020-08-31T01:01:25.660368Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd98bd351-2e02-4cee-b4f3-a438ee04156c.sock" 

2020-08-31T01:01:25.660412Z	info	sds	Start SDS grpc server
2020-08-31T01:01:25.661278Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:01:25.661324Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:01:25.661369Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:25.661706Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:01:25.661777Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:01:25.661820Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:01:25.753147Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:25.933491Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:26.237707Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:26.239563Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:26.358351Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:26.358372Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:26.541912Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:26.660290Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:26.661608Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:26.661641Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:01:27.147459Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:27.147517Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:27.450941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:27.662462Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:27.662864Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:27.662892Z	error	sds	Remote side closed connection
2020-08-31T01:01:27.662918Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:27.662939Z	error	sds	Remote side closed connection
2020-08-31T01:01:27.663105Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta32a6b31-906a-4b87-acd1-f2a5556a1913.sock" 

2020-08-31T01:01:27.663192Z	info	sds	Start SDS grpc server
2020-08-31T01:01:27.665714Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:01:27.665792Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:01:27.665852Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:27.666872Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:01:27.665850975 +0000 UTC m=+6.822061120 and is waiting for next SDS request
2020-08-31T01:01:27.666904Z	info	sds	Dynamic push for secret default
2020-08-31T01:01:27.666915Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta32a6b31-906a-4b87-acd1-f2a5556a1913.sock: use of closed network connection
2020-08-31T01:01:27.666991Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:27.667023Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:27.667015Z	error	sds	Remote side closed connection
2020-08-31T01:01:27.667036Z	error	sds	Remote side closed connection
2020-08-31T01:01:27.667127Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6d7de06f-12cb-4e67-8f8b-99c134ce7937.sock" 

2020-08-31T01:01:27.667157Z	info	sds	Start SDS grpc server
2020-08-31T01:01:27.667801Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:01:27.667843Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:01:27.667879Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:27.668384Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:01:27.753395Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:28.168607Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:28.168724Z	info	sds	Dynamic push for secret default
2020-08-31T01:01:28.169333Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6d7de06f-12cb-4e67-8f8b-99c134ce7937.sock: use of closed network connection
2020-08-31T01:01:28.169418Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:28.169443Z	error	sds	Remote side closed connection
2020-08-31T01:01:28.169478Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:28.169505Z	error	sds	Remote side closed connection
2020-08-31T01:01:28.169594Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest471cb491-0f8f-47b2-b45a-9f887bc13ccc.sock" 

2020-08-31T01:01:28.169658Z	info	sds	Start SDS grpc server
2020-08-31T01:01:28.169842Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest471cb491-0f8f-47b2-b45a-9f887bc13ccc.sock: use of closed network connection
2020-08-31T01:01:28.169951Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdafae964-6305-4cce-be6e-fe16b82c99ae.sock" 

2020-08-31T01:01:28.169981Z	info	sds	Start SDS grpc server
2020-08-31T01:01:28.358654Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:28.358694Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:28.470841Z	info	sds	resource:default new connection
2020-08-31T01:01:28.470902Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:01:28.470972Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:28.471273Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:28.471299Z	error	sds	Remote side closed connection
2020-08-31T01:01:28.660471Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:28.667101Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:28.772252Z	info	sds	resource:default new connection
2020-08-31T01:01:28.772321Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:01:28.772374Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:28.772696Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:28.772730Z	error	sds	Remote side closed connection
2020-08-31T01:01:28.773061Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdafae964-6305-4cce-be6e-fe16b82c99ae.sock: use of closed network connection
2020-08-31T01:01:28.773190Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestef12d0d2-ff3e-47d1-90f3-607855eac5f7.sock" 

2020-08-31T01:01:28.773204Z	info	sds	Start SDS grpc server
2020-08-31T01:01:29.074212Z	info	sds	resource:default new connection
2020-08-31T01:01:29.074287Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:01:29.074349Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:29.074695Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:29.074713Z	error	sds	Remote side closed connection
2020-08-31T01:01:29.074978Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestef12d0d2-ff3e-47d1-90f3-607855eac5f7.sock: use of closed network connection
2020-08-31T01:01:29.169547Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:29.169937Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:29.773280Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:29.933802Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:30.075220Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:01:30.237939Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:30.239755Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:30.542198Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:30.667332Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:01:31.105959Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4ba50aed-7353-46b5-88dd-c9c9a965c571.sock" 

2020-08-31T01:01:31.106009Z	info	sds	Start SDS grpc server
2020-08-31T01:01:31.147702Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:31.147736Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:31.169866Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:31.170096Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:31.451180Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:31.753639Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:31.773518Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:32.075457Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:32.106931Z	info	sds	resource:default new connection
2020-08-31T01:01:32.107004Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:01:32.110643Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:01:32.169607Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:01:32.169653Z	info	cache	GenerateSecret default
2020-08-31T01:01:32.169718Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:32.170228Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4ba50aed-7353-46b5-88dd-c9c9a965c571.sock: use of closed network connection
PASS
2020-08-31T01:01:32.170357Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:32.170392Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.578s
2020-08-31T01:01:37.362021Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2678efb8-538e-4c59-8b45-cbb11e5af49f.sock" 

2020-08-31T01:01:37.362104Z	info	sds	Start SDS grpc server
2020-08-31T01:01:37.363340Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:01:37.363441Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:01:37.363918Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:38.363210Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:38.363261Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:01:39.364077Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:01:39.364163Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:01:39.364192Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:01:39.364340Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:39.364627Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2678efb8-538e-4c59-8b45-cbb11e5af49f.sock: use of closed network connection
2020-08-31T01:01:39.364739Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:39.364756Z	error	sds	Remote side closed connection
2020-08-31T01:01:39.364922Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"fa4dd555-a1de-4088-9af4-bb8def1c3009\".sock" 

2020-08-31T01:01:39.364968Z	info	sds	Start SDS grpc server
2020-08-31T01:01:39.666099Z	info	sds	resource:default new connection
2020-08-31T01:01:39.666165Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:01:39.666231Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:39.666557Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:39.666591Z	error	sds	Remote side closed connection
2020-08-31T01:01:39.667377Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:01:39.667446Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:01:39.667636Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:01:39.667909Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:39.667933Z	error	sds	Remote side closed connection
2020-08-31T01:01:39.668125Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"fa4dd555-a1de-4088-9af4-bb8def1c3009".sock: use of closed network connection
2020-08-31T01:01:39.668375Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e00b0cae-9979-415f-88f5-27a6ea7301ec\".sock" 

2020-08-31T01:01:39.668425Z	info	sds	Start SDS grpc server
2020-08-31T01:01:39.668929Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:01:39.668963Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:01:39.669004Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:01:39.669316Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:39.669334Z	error	sds	Remote side closed connection
2020-08-31T01:01:39.669483Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e00b0cae-9979-415f-88f5-27a6ea7301ec".sock: use of closed network connection
2020-08-31T01:01:39.669645Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"28b46cde-0385-44f2-bce7-28fa3702a1b1\".sock" 

2020-08-31T01:01:39.669689Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:39.970725Z	info	sds	resource:default new connection
2020-08-31T01:01:39.970794Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:01:39.970881Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:39.971260Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:39.971298Z	error	sds	Remote side closed connection
2020-08-31T01:01:39.971352Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"28b46cde-0385-44f2-bce7-28fa3702a1b1".sock: use of closed network connection
2020-08-31T01:01:39.971565Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"125c8af9-416b-459a-80f1-2c82171a7303\".sock" 

2020-08-31T01:01:39.971602Z	info	sds	Start SDS grpc server
2020-08-31T01:01:39.971630Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:39.971625Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d2df5321-aba0-4778-915f-ab65f0497780\".sock" 

2020-08-31T01:01:40.272538Z	info	sds	resource:default new connection
2020-08-31T01:01:40.272601Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:01:40.272732Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:40.273118Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:40.273144Z	error	sds	Remote side closed connection
2020-08-31T01:01:40.273642Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:01:40.273679Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:01:40.273728Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:01:40.273930Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:40.273951Z	error	sds	Remote side closed connection
2020-08-31T01:01:40.364906Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:40.575016Z	info	sds	resource:default new connection
2020-08-31T01:01:40.575093Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:01:40.575171Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:40.575467Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:40.575492Z	error	sds	Remote side closed connection
2020-08-31T01:01:40.575743Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"125c8af9-416b-459a-80f1-2c82171a7303".sock: use of closed network connection
2020-08-31T01:01:40.575788Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d2df5321-aba0-4778-915f-ab65f0497780".sock: use of closed network connection
2020-08-31T01:01:40.576066Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e25742f0-7e14-4550-b410-cf7147e61374\".sock" 

2020-08-31T01:01:40.576094Z	info	sds	Start SDS grpc server
2020-08-31T01:01:40.668358Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:40.669685Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:01:40.879365Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e25742f0-7e14-4550-b410-cf7147e61374".sock: use of closed network connection
2020-08-31T01:01:40.879622Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c7bc9938-525e-413b-84ab-d2f1701e966c\".sock" 

2020-08-31T01:01:40.879655Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:40.971555Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:01:41.181299Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c7bc9938-525e-413b-84ab-d2f1701e966c".sock: use of closed network connection
2020-08-31T01:01:41.181503Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta8c91752-d300-4b54-9a0a-1590a707d6c9.sock" 

2020-08-31T01:01:41.181571Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"82ca0e31-6949-4aa6-9959-5ac2be281034\".sock" 

2020-08-31T01:01:41.181611Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:41.181614Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:01:41.575950Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:41.575989Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:01:41.785822Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta8c91752-d300-4b54-9a0a-1590a707d6c9.sock: use of closed network connection
2020-08-31T01:01:41.785875Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"82ca0e31-6949-4aa6-9959-5ac2be281034".sock: use of closed network connection
2020-08-31T01:01:41.786136Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestb92e83de-d1fa-453d-9aee-1d46b485f353.sock" 

2020-08-31T01:01:41.786175Z	info	sds	Start SDS grpc server
2020-08-31T01:01:41.879613Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:42.087159Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:01:42.087271Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:42.087495Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestb92e83de-d1fa-453d-9aee-1d46b485f353.sock: use of closed network connection
2020-08-31T01:01:42.087753Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta8e412c1-efc4-488f-b1c6-c5baa3c2b70a.sock" 

2020-08-31T01:01:42.087769Z	info	sds	Start SDS grpc server
2020-08-31T01:01:42.089612Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:01:42.089709Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:01:42.089791Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:42.090431Z	info	sds	resource:default new connection
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:01:42.090516Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:01:42.090589Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:42.181550Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:42.365171Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:42.668709Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:42.669873Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:42.786023Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:42.786057Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:42.971858Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:43.087751Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:43.090448Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:43.090503Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:01:43.576192Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:43.576248Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:43.879882Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:44.091474Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:44.091885Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta8e412c1-efc4-488f-b1c6-c5baa3c2b70a.sock: use of closed network connection
2020-08-31T01:01:44.091940Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:44.091969Z	error	sds	Remote side closed connection
2020-08-31T01:01:44.092018Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:44.092036Z	error	sds	Remote side closed connection
2020-08-31T01:01:44.092124Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9e427fa0-fc19-4a00-bc02-7a15fe456ddf.sock" 

2020-08-31T01:01:44.092166Z	info	sds	Start SDS grpc server
2020-08-31T01:01:44.093101Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:01:44.093158Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:01:44.093238Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:44.093793Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:01:44.093237233 +0000 UTC m=+6.808512583 and is waiting for next SDS request
2020-08-31T01:01:44.093816Z	info	sds	Dynamic push for secret default
2020-08-31T01:01:44.093797Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9e427fa0-fc19-4a00-bc02-7a15fe456ddf.sock: use of closed network connection
2020-08-31T01:01:44.093867Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:44.093890Z	error	sds	Remote side closed connection
2020-08-31T01:01:44.093912Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:44.093935Z	error	sds	Remote side closed connection
2020-08-31T01:01:44.093991Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest19b51f50-f9e5-4314-91c0-ee9bdd32b7e6.sock" 

2020-08-31T01:01:44.094015Z	info	sds	Start SDS grpc server
2020-08-31T01:01:44.094771Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:01:44.094824Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:01:44.094862Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:44.095321Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:01:44.181778Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:44.595536Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:44.595603Z	info	sds	Dynamic push for secret default
2020-08-31T01:01:44.596188Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest19b51f50-f9e5-4314-91c0-ee9bdd32b7e6.sock: use of closed network connection
2020-08-31T01:01:44.596258Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:44.596282Z	error	sds	Remote side closed connection
2020-08-31T01:01:44.596326Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:44.596332Z	error	sds	Remote side closed connection
2020-08-31T01:01:44.596421Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest010ee2c4-025b-4502-a542-dfe218549b34.sock" 

2020-08-31T01:01:44.596518Z	info	sds	Start SDS grpc server
2020-08-31T01:01:44.596729Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest010ee2c4-025b-4502-a542-dfe218549b34.sock: use of closed network connection
2020-08-31T01:01:44.596867Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9f4a7b9d-cc7b-4c63-9b68-d79b43ddeb7f.sock" 

2020-08-31T01:01:44.596889Z	info	sds	Start SDS grpc server
2020-08-31T01:01:44.786266Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:44.786229Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:44.897911Z	info	sds	resource:default new connection
2020-08-31T01:01:44.897976Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:01:44.898028Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:44.898212Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:44.898234Z	error	sds	Remote side closed connection
2020-08-31T01:01:45.087996Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:45.092024Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:45.094000Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:45.199241Z	info	sds	resource:default new connection
2020-08-31T01:01:45.199318Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:01:45.199435Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:45.199782Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:45.199808Z	error	sds	Remote side closed connection
2020-08-31T01:01:45.200054Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9f4a7b9d-cc7b-4c63-9b68-d79b43ddeb7f.sock: use of closed network connection
2020-08-31T01:01:45.200186Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest55b92a57-09ab-427f-95ea-799ea1a7cbed.sock" 

2020-08-31T01:01:45.200209Z	info	sds	Start SDS grpc server
2020-08-31T01:01:45.501288Z	info	sds	resource:default new connection
2020-08-31T01:01:45.501349Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:01:45.501403Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:45.501650Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:45.501687Z	error	sds	Remote side closed connection
2020-08-31T01:01:45.502112Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest55b92a57-09ab-427f-95ea-799ea1a7cbed.sock: use of closed network connection
2020-08-31T01:01:45.596392Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:45.596930Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:46.200254Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:46.365444Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:46.502282Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:01:46.669008Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:46.670065Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:46.972107Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:47.092203Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:47.094144Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:01:47.534453Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta89b8752-e240-4862-aced-0d1e2ec7f8d7.sock" 

2020-08-31T01:01:47.534500Z	info	sds	Start SDS grpc server
2020-08-31T01:01:47.576362Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:47.576419Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:47.596564Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:47.597084Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:47.880213Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:48.182021Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:48.200513Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:48.502536Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:48.535514Z	info	sds	resource:default new connection
2020-08-31T01:01:48.535575Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:01:48.545162Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:01:48.614070Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:01:48.614118Z	info	cache	GenerateSecret default
2020-08-31T01:01:48.614192Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:48.614593Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta89b8752-e240-4862-aced-0d1e2ec7f8d7.sock: use of closed network connection
PASS
2020-08-31T01:01:48.614724Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.574s
2020-08-31T01:01:53.806722Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5638a1e6-04ff-4beb-bece-cbb6deb953de.sock" 

2020-08-31T01:01:53.806838Z	info	sds	Start SDS grpc server
2020-08-31T01:01:53.808145Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:01:53.808200Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:01:53.808590Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:54.808130Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:54.808194Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:01:55.809019Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:01:55.809088Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:01:55.809112Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:01:55.809284Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:55.809570Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5638a1e6-04ff-4beb-bece-cbb6deb953de.sock: use of closed network connection
2020-08-31T01:01:55.809755Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:55.809785Z	error	sds	Remote side closed connection
2020-08-31T01:01:55.809937Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b980cf72-3e14-4f64-9d59-9aa35e963159\".sock" 

2020-08-31T01:01:55.809956Z	info	sds	Start SDS grpc server
2020-08-31T01:01:56.110900Z	info	sds	resource:default new connection
2020-08-31T01:01:56.110959Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:01:56.111038Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:56.111340Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:56.111367Z	error	sds	Remote side closed connection
2020-08-31T01:01:56.111965Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:01:56.112011Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:01:56.112186Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:01:56.112440Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:56.112477Z	error	sds	Remote side closed connection
2020-08-31T01:01:56.112752Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b980cf72-3e14-4f64-9d59-9aa35e963159".sock: use of closed network connection
2020-08-31T01:01:56.112952Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"17e35151-29b6-49b8-9343-acaaad1dcd00\".sock" 

2020-08-31T01:01:56.113049Z	info	sds	Start SDS grpc server
2020-08-31T01:01:56.113525Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:01:56.113578Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:01:56.113621Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:01:56.113815Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:56.113838Z	error	sds	Remote side closed connection
2020-08-31T01:01:56.114042Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"17e35151-29b6-49b8-9343-acaaad1dcd00".sock: use of closed network connection
2020-08-31T01:01:56.114180Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f026ebf2-69a5-420a-87f7-4794af132fd9\".sock" 

2020-08-31T01:01:56.114202Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:56.415194Z	info	sds	resource:default new connection
2020-08-31T01:01:56.415243Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:01:56.415303Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:56.415596Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:56.415623Z	error	sds	Remote side closed connection
2020-08-31T01:01:56.415865Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f026ebf2-69a5-420a-87f7-4794af132fd9".sock: use of closed network connection
2020-08-31T01:01:56.416064Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3ce5cc88-57aa-4c18-a30a-e3544b45f289\".sock" 

2020-08-31T01:01:56.416120Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"011939e1-3ea7-488c-87a7-05d94f621696\".sock" 

2020-08-31T01:01:56.416150Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:56.416142Z	info	sds	Start SDS grpc server
2020-08-31T01:01:56.717111Z	info	sds	resource:default new connection
2020-08-31T01:01:56.717170Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:01:56.717236Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:56.717512Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:56.717525Z	error	sds	Remote side closed connection
2020-08-31T01:01:56.718063Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:01:56.718114Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:01:56.718149Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:01:56.718370Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:56.718419Z	error	sds	Remote side closed connection
2020-08-31T01:01:56.809793Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:57.019957Z	info	sds	resource:default new connection
2020-08-31T01:01:57.020066Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:01:57.020123Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:57.020462Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:57.020488Z	error	sds	Remote side closed connection
2020-08-31T01:01:57.020748Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3ce5cc88-57aa-4c18-a30a-e3544b45f289".sock: use of closed network connection
2020-08-31T01:01:57.020816Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"011939e1-3ea7-488c-87a7-05d94f621696".sock: use of closed network connection
2020-08-31T01:01:57.020991Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9af1c5a0-58bd-4e3f-b7a6-6ea1bffdbe4f\".sock" 

2020-08-31T01:01:57.021013Z	info	sds	Start SDS grpc server
2020-08-31T01:01:57.112947Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:57.114232Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:01:57.323542Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9af1c5a0-58bd-4e3f-b7a6-6ea1bffdbe4f".sock: use of closed network connection
2020-08-31T01:01:57.323742Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0f8cf371-8ea9-413e-b7d7-4b666a6cf8a8\".sock" 

2020-08-31T01:01:57.323769Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:01:57.416079Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:01:57.625422Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0f8cf371-8ea9-413e-b7d7-4b666a6cf8a8".sock: use of closed network connection
2020-08-31T01:01:57.625608Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest985a16d1-2fd6-4344-8d2b-537b60544db2.sock" 

2020-08-31T01:01:57.625658Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b59a4d28-5f28-43db-acf9-2375bd2e16c0\".sock" 

2020-08-31T01:01:57.625670Z	info	sds	Start SDS grpc server
2020-08-31T01:01:57.625679Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:01:58.020992Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:58.020975Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:01:58.229618Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest985a16d1-2fd6-4344-8d2b-537b60544db2.sock: use of closed network connection
2020-08-31T01:01:58.229675Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b59a4d28-5f28-43db-acf9-2375bd2e16c0".sock: use of closed network connection
2020-08-31T01:01:58.229845Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste2aecb3c-5fea-42f6-b053-46f4f70dc004.sock" 

2020-08-31T01:01:58.229867Z	info	sds	Start SDS grpc server
2020-08-31T01:01:58.323751Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:58.530976Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:01:58.531065Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:01:58.531373Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste2aecb3c-5fea-42f6-b053-46f4f70dc004.sock: use of closed network connection
2020-08-31T01:01:58.531645Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc78b0d1c-6c29-45e0-9073-b09b3c5af72c.sock" 

2020-08-31T01:01:58.531751Z	info	sds	Start SDS grpc server
2020-08-31T01:01:58.533168Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:01:58.533238Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:01:58.533310Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:58.533837Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:01:58.533907Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:01:58.533964Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:01:58.625654Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:58.810067Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:59.113209Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:59.114409Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:59.229849Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:59.229903Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:59.416369Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:01:59.531563Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:01:59.533784Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:01:59.533824Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:02:00.021124Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:00.021147Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:00.324090Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:00.534655Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:00.535029Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc78b0d1c-6c29-45e0-9073-b09b3c5af72c.sock: use of closed network connection
2020-08-31T01:02:00.535107Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:00.535142Z	error	sds	Remote side closed connection
2020-08-31T01:02:00.535176Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:00.535202Z	error	sds	Remote side closed connection
2020-08-31T01:02:00.535354Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9e37f0e4-8a3a-4c02-bdc1-3e393542a886.sock" 

2020-08-31T01:02:00.535467Z	info	sds	Start SDS grpc server
2020-08-31T01:02:00.536086Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:02:00.536136Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:02:00.536190Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:00.536743Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:02:00.536189366 +0000 UTC m=+6.803540181 and is waiting for next SDS request
2020-08-31T01:02:00.536763Z	info	sds	Dynamic push for secret default
2020-08-31T01:02:00.536824Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9e37f0e4-8a3a-4c02-bdc1-3e393542a886.sock: use of closed network connection
2020-08-31T01:02:00.536898Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:00.536899Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:00.536923Z	error	sds	Remote side closed connection
2020-08-31T01:02:00.537000Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest22cc3a06-a319-4e28-a1e7-053648609780.sock" 

2020-08-31T01:02:00.536985Z	error	sds	Remote side closed connection
2020-08-31T01:02:00.537071Z	info	sds	Start SDS grpc server
2020-08-31T01:02:00.537646Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:02:00.537698Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:02:00.537734Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:00.538201Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:02:00.625913Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:01.038397Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:01.038453Z	info	sds	Dynamic push for secret default
2020-08-31T01:02:01.039067Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest22cc3a06-a319-4e28-a1e7-053648609780.sock: use of closed network connection
2020-08-31T01:02:01.039152Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:01.039206Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:01.039184Z	error	sds	Remote side closed connection
2020-08-31T01:02:01.039229Z	error	sds	Remote side closed connection
2020-08-31T01:02:01.039323Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1f9064a1-36ef-4c75-b6b2-97f46b66acaa.sock" 

2020-08-31T01:02:01.039391Z	info	sds	Start SDS grpc server
2020-08-31T01:02:01.039580Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1f9064a1-36ef-4c75-b6b2-97f46b66acaa.sock: use of closed network connection
2020-08-31T01:02:01.039666Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesteabfe4c3-747a-46a7-a5cf-6aad1abe0b78.sock" 

2020-08-31T01:02:01.039677Z	info	sds	Start SDS grpc server
2020-08-31T01:02:01.230109Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:01.230172Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:01.340609Z	info	sds	resource:default new connection
2020-08-31T01:02:01.340711Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:02:01.340768Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:01.341194Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:01.341226Z	error	sds	Remote side closed connection
2020-08-31T01:02:01.531820Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:01.535234Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:01.536894Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:01.642309Z	info	sds	resource:default new connection
2020-08-31T01:02:01.642391Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:02:01.642458Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:01.642764Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:01.642790Z	error	sds	Remote side closed connection
2020-08-31T01:02:01.643143Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesteabfe4c3-747a-46a7-a5cf-6aad1abe0b78.sock: use of closed network connection
2020-08-31T01:02:01.643311Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1ee26dd7-f1e8-4433-8507-ec46bc3261dc.sock" 

2020-08-31T01:02:01.643345Z	info	sds	Start SDS grpc server
2020-08-31T01:02:01.944318Z	info	sds	resource:default new connection
2020-08-31T01:02:01.944380Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:02:01.944450Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:01.944762Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:01.944792Z	error	sds	Remote side closed connection
2020-08-31T01:02:01.945038Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1ee26dd7-f1e8-4433-8507-ec46bc3261dc.sock: use of closed network connection
2020-08-31T01:02:02.039326Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:02.039658Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:02.643390Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:02.810343Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:02.945235Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:02:03.113453Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:03.114611Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:03.416558Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:03.535499Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:03.537011Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:02:03.976473Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf9b8221b-e62d-425d-8967-9eef8712f79a.sock" 

2020-08-31T01:02:03.976523Z	info	sds	Start SDS grpc server
2020-08-31T01:02:04.021402Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:04.021448Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:04.039571Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:04.039870Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:04.324386Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:04.626147Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:04.643641Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:04.945493Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:04.977471Z	info	sds	resource:default new connection
2020-08-31T01:02:04.977544Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:02:04.982137Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:02:05.182075Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:02:05.182123Z	info	cache	GenerateSecret default
2020-08-31T01:02:05.182179Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:05.182998Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf9b8221b-e62d-425d-8967-9eef8712f79a.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.693s
2020-08-31T01:02:10.440522Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste72af48d-c839-4dff-8d27-8e6c7ea9510e.sock" 

2020-08-31T01:02:10.440611Z	info	sds	Start SDS grpc server
2020-08-31T01:02:10.441823Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:02:10.441909Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:02:10.442366Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:11.441737Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:11.441817Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:02:12.442462Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:02:12.442556Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:02:12.442581Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:02:12.442660Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:12.442942Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste72af48d-c839-4dff-8d27-8e6c7ea9510e.sock: use of closed network connection
2020-08-31T01:02:12.443078Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:12.443103Z	error	sds	Remote side closed connection
2020-08-31T01:02:12.443226Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5139834e-1067-4418-a172-df24978e55be\".sock" 

2020-08-31T01:02:12.443276Z	info	sds	Start SDS grpc server
2020-08-31T01:02:12.745165Z	info	sds	resource:default new connection
2020-08-31T01:02:12.745233Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:02:12.745338Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:12.745759Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:12.745794Z	error	sds	Remote side closed connection
2020-08-31T01:02:12.746441Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:02:12.746516Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:02:12.746707Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:02:12.746997Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:12.747027Z	error	sds	Remote side closed connection
2020-08-31T01:02:12.747218Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5139834e-1067-4418-a172-df24978e55be".sock: use of closed network connection
2020-08-31T01:02:12.747431Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0802b39f-f004-4b01-8e20-e28416cc03b6\".sock" 

2020-08-31T01:02:12.747501Z	info	sds	Start SDS grpc server
2020-08-31T01:02:12.748008Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:02:12.748044Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:02:12.748080Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:02:12.748341Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:12.748376Z	error	sds	Remote side closed connection
2020-08-31T01:02:12.748460Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0802b39f-f004-4b01-8e20-e28416cc03b6".sock: use of closed network connection
2020-08-31T01:02:12.748606Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d6cc016b-f049-42f2-8084-5f5c29785a83\".sock" 

2020-08-31T01:02:12.748637Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:13.049679Z	info	sds	resource:default new connection
2020-08-31T01:02:13.049754Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:02:13.049848Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:13.050165Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:13.050193Z	error	sds	Remote side closed connection
2020-08-31T01:02:13.050445Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d6cc016b-f049-42f2-8084-5f5c29785a83".sock: use of closed network connection
2020-08-31T01:02:13.050657Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"02e0e8f3-fb65-4b08-8368-c24d46e51668\".sock" 

2020-08-31T01:02:13.050730Z	info	sds	Start SDS grpc server
2020-08-31T01:02:13.050750Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"08b8c36f-3f9d-41cf-b972-a19dd5882583\".sock" 

2020-08-31T01:02:13.050788Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:13.351695Z	info	sds	resource:default new connection
2020-08-31T01:02:13.351756Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:02:13.351818Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:13.352085Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:13.352113Z	error	sds	Remote side closed connection
2020-08-31T01:02:13.353147Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:02:13.353211Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:02:13.353260Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:02:13.353493Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:13.353517Z	error	sds	Remote side closed connection
2020-08-31T01:02:13.443137Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:13.654520Z	info	sds	resource:default new connection
2020-08-31T01:02:13.654585Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:02:13.654640Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:13.654906Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:13.655011Z	error	sds	Remote side closed connection
2020-08-31T01:02:13.655154Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"02e0e8f3-fb65-4b08-8368-c24d46e51668".sock: use of closed network connection
2020-08-31T01:02:13.655239Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"08b8c36f-3f9d-41cf-b972-a19dd5882583".sock: use of closed network connection
2020-08-31T01:02:13.655468Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"da87a185-40d8-460c-9b28-617d926d0fd0\".sock" 

2020-08-31T01:02:13.655504Z	info	sds	Start SDS grpc server
2020-08-31T01:02:13.747472Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:13.748602Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:02:13.957945Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"da87a185-40d8-460c-9b28-617d926d0fd0".sock: use of closed network connection
2020-08-31T01:02:13.958119Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1b835864-9897-42aa-bfe8-079b83ed7e2b\".sock" 

2020-08-31T01:02:13.958144Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:14.050664Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:02:14.261433Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1b835864-9897-42aa-bfe8-079b83ed7e2b".sock: use of closed network connection
2020-08-31T01:02:14.261643Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest909b2ef3-c6d6-4ce0-af3a-dba62045acb3.sock" 

2020-08-31T01:02:14.261698Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"eb0285d4-99ee-45fb-bdfc-22634aa78f04\".sock" 

2020-08-31T01:02:14.261729Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:14.261733Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:02:14.655363Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:14.655372Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:02:14.865955Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest909b2ef3-c6d6-4ce0-af3a-dba62045acb3.sock: use of closed network connection
2020-08-31T01:02:14.866037Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"eb0285d4-99ee-45fb-bdfc-22634aa78f04".sock: use of closed network connection
2020-08-31T01:02:14.866235Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestdba384b8-b6cd-4bd7-8fc5-788ac497bd28.sock" 

2020-08-31T01:02:14.866260Z	info	sds	Start SDS grpc server
2020-08-31T01:02:14.958178Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:15.167347Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:02:15.167432Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:15.167668Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestdba384b8-b6cd-4bd7-8fc5-788ac497bd28.sock: use of closed network connection
2020-08-31T01:02:15.167896Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd1bab15d-9c51-4991-ba0b-2d732dc881fa.sock" 

2020-08-31T01:02:15.168005Z	info	sds	Start SDS grpc server
2020-08-31T01:02:15.168791Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:02:15.168893Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:02:15.168944Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:15.169107Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:02:15.169163Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:02:15.169201Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:02:15.261636Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:15.443389Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:15.747717Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:15.748760Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:15.866192Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:15.866227Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:16.050906Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:16.167867Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:16.169182Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:16.169223Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:02:16.655556Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:16.655607Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:16.958427Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:17.170076Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:17.170483Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd1bab15d-9c51-4991-ba0b-2d732dc881fa.sock: use of closed network connection
2020-08-31T01:02:17.170516Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:17.170540Z	error	sds	Remote side closed connection
2020-08-31T01:02:17.170610Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:17.170630Z	error	sds	Remote side closed connection
2020-08-31T01:02:17.170704Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest734a7ee8-b9ea-4064-9d69-f5afb685e73b.sock" 

2020-08-31T01:02:17.170741Z	info	sds	Start SDS grpc server
2020-08-31T01:02:17.171551Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:02:17.171591Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:02:17.171635Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:17.172005Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:02:17.171634747 +0000 UTC m=+6.807727217 and is waiting for next SDS request
2020-08-31T01:02:17.172030Z	info	sds	Dynamic push for secret default
2020-08-31T01:02:17.172070Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest734a7ee8-b9ea-4064-9d69-f5afb685e73b.sock: use of closed network connection
2020-08-31T01:02:17.172153Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:17.172175Z	error	sds	Remote side closed connection
2020-08-31T01:02:17.172198Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:17.172213Z	error	sds	Remote side closed connection
2020-08-31T01:02:17.172319Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest62b1bca9-4ef4-449d-9bac-1c7d1f09566d.sock" 

2020-08-31T01:02:17.172336Z	info	sds	Start SDS grpc server
2020-08-31T01:02:17.173113Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:02:17.173156Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:02:17.173194Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:17.173754Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:02:17.261889Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:17.673844Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:17.673897Z	info	sds	Dynamic push for secret default
2020-08-31T01:02:17.674599Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest62b1bca9-4ef4-449d-9bac-1c7d1f09566d.sock: use of closed network connection
2020-08-31T01:02:17.674694Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:17.674735Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:17.674756Z	error	sds	Remote side closed connection
2020-08-31T01:02:17.674728Z	error	sds	Remote side closed connection
2020-08-31T01:02:17.674890Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6813ae7e-4bfb-4ed5-9d83-1c111ec83a75.sock" 

2020-08-31T01:02:17.674901Z	info	sds	Start SDS grpc server
2020-08-31T01:02:17.675158Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6813ae7e-4bfb-4ed5-9d83-1c111ec83a75.sock: use of closed network connection
2020-08-31T01:02:17.675257Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7c537c8d-a793-4610-8911-aaa15eb15894.sock" 

2020-08-31T01:02:17.675278Z	info	sds	Start SDS grpc server
2020-08-31T01:02:17.866361Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:17.866405Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:17.976176Z	info	sds	resource:default new connection
2020-08-31T01:02:17.976250Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:02:17.976315Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:17.976641Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:17.976711Z	error	sds	Remote side closed connection
2020-08-31T01:02:18.168115Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:18.170682Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:18.172256Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:18.277754Z	info	sds	resource:default new connection
2020-08-31T01:02:18.277835Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:02:18.277894Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:18.278176Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:18.278206Z	error	sds	Remote side closed connection
2020-08-31T01:02:18.278577Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7c537c8d-a793-4610-8911-aaa15eb15894.sock: use of closed network connection
2020-08-31T01:02:18.278746Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdd7ebcfa-0ee6-404b-a586-9795fdd27678.sock" 

2020-08-31T01:02:18.278783Z	info	sds	Start SDS grpc server
2020-08-31T01:02:18.579749Z	info	sds	resource:default new connection
2020-08-31T01:02:18.579835Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:02:18.579915Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:18.580206Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:18.580235Z	error	sds	Remote side closed connection
2020-08-31T01:02:18.580472Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdd7ebcfa-0ee6-404b-a586-9795fdd27678.sock: use of closed network connection
2020-08-31T01:02:18.674865Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:18.675369Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:19.278811Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:19.443668Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:19.580740Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:02:19.748019Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:19.748961Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:20.051161Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:20.170924Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:20.172445Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:02:20.614250Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest137c211b-6e86-4f7b-b44e-0d3a135ae86e.sock" 

2020-08-31T01:02:20.614320Z	info	sds	Start SDS grpc server
2020-08-31T01:02:20.655742Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:20.655740Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:20.675094Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:20.675594Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:20.958663Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:21.262114Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:21.279076Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:21.581000Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:21.615230Z	info	sds	resource:default new connection
2020-08-31T01:02:21.615288Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:02:21.616748Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:02:21.842587Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:02:21.842636Z	info	cache	GenerateSecret default
2020-08-31T01:02:21.842708Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:21.843096Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest137c211b-6e86-4f7b-b44e-0d3a135ae86e.sock: use of closed network connection
PASS
2020-08-31T01:02:21.843207Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:21.843248Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.730s
2020-08-31T01:02:27.147086Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest629491f5-1a0d-49d2-8dab-8184527a0876.sock" 

2020-08-31T01:02:27.147201Z	info	sds	Start SDS grpc server
2020-08-31T01:02:27.148810Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:02:27.148876Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:02:27.149411Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:28.148694Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:28.148773Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:02:29.149268Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:02:29.149377Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:02:29.149405Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:02:29.149510Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:29.149733Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest629491f5-1a0d-49d2-8dab-8184527a0876.sock: use of closed network connection
2020-08-31T01:02:29.149861Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:29.149886Z	error	sds	Remote side closed connection
2020-08-31T01:02:29.150082Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d29c6606-23f8-4ea1-850d-a4349b1c7857\".sock" 

2020-08-31T01:02:29.150138Z	info	sds	Start SDS grpc server
2020-08-31T01:02:29.451142Z	info	sds	resource:default new connection
2020-08-31T01:02:29.451201Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:02:29.451258Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:29.451512Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:29.451542Z	error	sds	Remote side closed connection
2020-08-31T01:02:29.452282Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:02:29.452331Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:02:29.452500Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:02:29.452738Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:29.452758Z	error	sds	Remote side closed connection
2020-08-31T01:02:29.452949Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d29c6606-23f8-4ea1-850d-a4349b1c7857".sock: use of closed network connection
2020-08-31T01:02:29.453134Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"17004616-f964-4d91-b46e-045b939f6908\".sock" 

2020-08-31T01:02:29.453155Z	info	sds	Start SDS grpc server
2020-08-31T01:02:29.453671Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:02:29.453704Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:02:29.453744Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:02:29.453948Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:29.453968Z	error	sds	Remote side closed connection
2020-08-31T01:02:29.454141Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"17004616-f964-4d91-b46e-045b939f6908".sock: use of closed network connection
2020-08-31T01:02:29.454415Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"15f86359-9ce3-4bb5-b11f-74454c7daeff\".sock" 

2020-08-31T01:02:29.454451Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:29.755373Z	info	sds	resource:default new connection
2020-08-31T01:02:29.755438Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:02:29.755490Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:29.755742Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:29.755781Z	error	sds	Remote side closed connection
2020-08-31T01:02:29.756003Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"15f86359-9ce3-4bb5-b11f-74454c7daeff".sock: use of closed network connection
2020-08-31T01:02:29.756186Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2a72d699-c05b-4efc-bda4-6613a7417d01\".sock" 

2020-08-31T01:02:29.756255Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"abd8c94b-7a62-4412-9bdb-b8264d37129e\".sock" 

2020-08-31T01:02:29.756287Z	info	sds	Start SDS grpc server
2020-08-31T01:02:29.756314Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:30.057287Z	info	sds	resource:default new connection
2020-08-31T01:02:30.057351Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:02:30.057408Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:30.057630Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:30.057642Z	error	sds	Remote side closed connection
2020-08-31T01:02:30.058276Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:02:30.058324Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:02:30.058359Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:02:30.058642Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:30.058657Z	error	sds	Remote side closed connection
2020-08-31T01:02:30.149823Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:30.359686Z	info	sds	resource:default new connection
2020-08-31T01:02:30.359745Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:02:30.359796Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:30.360109Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:30.360137Z	error	sds	Remote side closed connection
2020-08-31T01:02:30.360296Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2a72d699-c05b-4efc-bda4-6613a7417d01".sock: use of closed network connection
2020-08-31T01:02:30.360338Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"abd8c94b-7a62-4412-9bdb-b8264d37129e".sock: use of closed network connection
2020-08-31T01:02:30.360504Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b77b8078-573b-44b4-a4a8-25b8c4a68ce2\".sock" 

2020-08-31T01:02:30.360524Z	info	sds	Start SDS grpc server
2020-08-31T01:02:30.453174Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:30.454330Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:02:30.663372Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b77b8078-573b-44b4-a4a8-25b8c4a68ce2".sock: use of closed network connection
2020-08-31T01:02:30.663550Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e071b376-f931-4d0e-b8ac-8f684652406b\".sock" 

2020-08-31T01:02:30.663578Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:30.756205Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:02:30.965022Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e071b376-f931-4d0e-b8ac-8f684652406b".sock: use of closed network connection
2020-08-31T01:02:30.965235Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1f1a9c65-ab9c-436d-9c95-1d3b30126c5b.sock" 

2020-08-31T01:02:30.965300Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"48c6bdcc-0882-443c-8138-ea79bd7264d1\".sock" 

2020-08-31T01:02:30.965331Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:30.965331Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:02:31.360530Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:31.360542Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:02:31.569151Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1f1a9c65-ab9c-436d-9c95-1d3b30126c5b.sock: use of closed network connection
2020-08-31T01:02:31.569205Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"48c6bdcc-0882-443c-8138-ea79bd7264d1".sock: use of closed network connection
2020-08-31T01:02:31.569452Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest4ae07ba9-3c22-446c-b1f8-557a24ce395c.sock" 

2020-08-31T01:02:31.569473Z	info	sds	Start SDS grpc server
2020-08-31T01:02:31.663602Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:31.870705Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:02:31.870858Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:31.871076Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest4ae07ba9-3c22-446c-b1f8-557a24ce395c.sock: use of closed network connection
2020-08-31T01:02:31.871313Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta034f12c-3fa1-4b0d-8951-765210414778.sock" 

2020-08-31T01:02:31.871332Z	info	sds	Start SDS grpc server
2020-08-31T01:02:31.873939Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:02:31.874032Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:02:31.874497Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:31.874547Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:02:31.874601Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:02:31.874647Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:02:31.965259Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:32.149979Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:32.453399Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:32.454498Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:32.569393Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:32.569377Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:32.756453Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:32.871320Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:32.874278Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:32.874316Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:02:33.360855Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:33.360884Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:33.663901Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:33.875146Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:33.875567Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta034f12c-3fa1-4b0d-8951-765210414778.sock: use of closed network connection
2020-08-31T01:02:33.875637Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:33.875660Z	error	sds	Remote side closed connection
2020-08-31T01:02:33.875703Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:33.875723Z	error	sds	Remote side closed connection
2020-08-31T01:02:33.875968Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta84e6716-a973-4c20-896a-7fa9405eabbe.sock" 

2020-08-31T01:02:33.876064Z	info	sds	Start SDS grpc server
2020-08-31T01:02:33.876848Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:02:33.876894Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:02:33.876949Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:33.877461Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:02:33.876948513 +0000 UTC m=+6.808068131 and is waiting for next SDS request
2020-08-31T01:02:33.877482Z	info	sds	Dynamic push for secret default
2020-08-31T01:02:33.877506Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta84e6716-a973-4c20-896a-7fa9405eabbe.sock: use of closed network connection
2020-08-31T01:02:33.877614Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:33.877624Z	error	sds	Remote side closed connection
2020-08-31T01:02:33.877625Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:33.877638Z	error	sds	Remote side closed connection
2020-08-31T01:02:33.877693Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest339880e8-48fc-404f-903d-fbfb0409cfd6.sock" 

2020-08-31T01:02:33.877739Z	info	sds	Start SDS grpc server
2020-08-31T01:02:33.878347Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:02:33.878388Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:02:33.878420Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:33.878939Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:02:33.965535Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:34.379099Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:34.379154Z	info	sds	Dynamic push for secret default
2020-08-31T01:02:34.379732Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest339880e8-48fc-404f-903d-fbfb0409cfd6.sock: use of closed network connection
2020-08-31T01:02:34.379805Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:34.379829Z	error	sds	Remote side closed connection
2020-08-31T01:02:34.379870Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:34.379893Z	error	sds	Remote side closed connection
2020-08-31T01:02:34.379990Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf6f9a22c-7e52-4d65-bd96-84cd55f66182.sock" 

2020-08-31T01:02:34.380065Z	info	sds	Start SDS grpc server
2020-08-31T01:02:34.380234Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf6f9a22c-7e52-4d65-bd96-84cd55f66182.sock: use of closed network connection
2020-08-31T01:02:34.380379Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4defc222-a22d-4256-8f28-3d5385cd70c0.sock" 

2020-08-31T01:02:34.380410Z	info	sds	Start SDS grpc server
2020-08-31T01:02:34.569643Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:34.569687Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:34.681413Z	info	sds	resource:default new connection
2020-08-31T01:02:34.681466Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:02:34.681517Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:34.681818Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:34.681851Z	error	sds	Remote side closed connection
2020-08-31T01:02:34.871595Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:34.875777Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:34.877754Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:34.982767Z	info	sds	resource:default new connection
2020-08-31T01:02:34.982826Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:02:34.982876Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:34.983153Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:34.983178Z	error	sds	Remote side closed connection
2020-08-31T01:02:34.983454Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4defc222-a22d-4256-8f28-3d5385cd70c0.sock: use of closed network connection
2020-08-31T01:02:34.983579Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest97572b34-1294-457f-b8bc-98c2def8c248.sock" 

2020-08-31T01:02:34.983586Z	info	sds	Start SDS grpc server
2020-08-31T01:02:35.284528Z	info	sds	resource:default new connection
2020-08-31T01:02:35.284611Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:02:35.284713Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:35.285047Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:35.285074Z	error	sds	Remote side closed connection
2020-08-31T01:02:35.285272Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest97572b34-1294-457f-b8bc-98c2def8c248.sock: use of closed network connection
2020-08-31T01:02:35.379928Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:35.380299Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:35.983682Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:36.150230Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:36.285456Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:02:36.453681Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:36.454686Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:36.756703Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:36.876018Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:36.877944Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:02:37.314839Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd1079bd8-5845-450f-8dcf-474c48e773a6.sock" 

2020-08-31T01:02:37.314885Z	info	sds	Start SDS grpc server
2020-08-31T01:02:37.361178Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:37.361204Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:37.380193Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:37.380373Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:37.664154Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:37.965788Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:37.983927Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:38.285691Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:38.315843Z	info	sds	resource:default new connection
2020-08-31T01:02:38.315922Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:02:38.326515Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:02:38.569894Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:38.569955Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:38.587769Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:02:38.587812Z	info	cache	GenerateSecret default
2020-08-31T01:02:38.588427Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:38.589002Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd1079bd8-5845-450f-8dcf-474c48e773a6.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.765s
2020-08-31T01:02:43.904813Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest51806311-b857-4874-b560-82c02488284b.sock" 

2020-08-31T01:02:43.904846Z	info	sds	Start SDS grpc server
2020-08-31T01:02:43.906336Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:02:43.906417Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:02:43.906926Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:44.906200Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:44.906263Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:02:45.907220Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:02:45.907292Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:02:45.907320Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:02:45.907381Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:45.907611Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest51806311-b857-4874-b560-82c02488284b.sock: use of closed network connection
2020-08-31T01:02:45.907716Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:45.907728Z	error	sds	Remote side closed connection
2020-08-31T01:02:45.907916Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"afc1a2cf-bcb1-4d8c-8cb5-b0df91b018bf\".sock" 

2020-08-31T01:02:45.907952Z	info	sds	Start SDS grpc server
2020-08-31T01:02:46.209004Z	info	sds	resource:default new connection
2020-08-31T01:02:46.209077Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:02:46.209143Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:46.209547Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:46.209620Z	error	sds	Remote side closed connection
2020-08-31T01:02:46.210089Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:02:46.210137Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:02:46.210338Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:02:46.210672Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:46.210691Z	error	sds	Remote side closed connection
2020-08-31T01:02:46.210893Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"afc1a2cf-bcb1-4d8c-8cb5-b0df91b018bf".sock: use of closed network connection
2020-08-31T01:02:46.211084Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"abd3c3bc-31cf-445c-9356-b23b33471e44\".sock" 

2020-08-31T01:02:46.211171Z	info	sds	Start SDS grpc server
2020-08-31T01:02:46.211627Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:02:46.211667Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:02:46.211709Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:02:46.211935Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:46.211963Z	error	sds	Remote side closed connection
2020-08-31T01:02:46.212142Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"abd3c3bc-31cf-445c-9356-b23b33471e44".sock: use of closed network connection
2020-08-31T01:02:46.212403Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"82de509c-0049-4913-86e6-0dd5b3044025\".sock" 

2020-08-31T01:02:46.212436Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:46.513400Z	info	sds	resource:default new connection
2020-08-31T01:02:46.513454Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:02:46.513509Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:46.513812Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:46.513873Z	error	sds	Remote side closed connection
2020-08-31T01:02:46.514067Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"82de509c-0049-4913-86e6-0dd5b3044025".sock: use of closed network connection
2020-08-31T01:02:46.514250Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5d384cc4-dc80-42fd-9c1a-70b9f495d078\".sock" 

2020-08-31T01:02:46.514274Z	info	sds	Start SDS grpc server
2020-08-31T01:02:46.514315Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"510378ea-a3ec-4674-a416-c18dce52b375\".sock" 

2020-08-31T01:02:46.514332Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:46.815308Z	info	sds	resource:default new connection
2020-08-31T01:02:46.815370Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:02:46.815427Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:46.815657Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:46.815692Z	error	sds	Remote side closed connection
2020-08-31T01:02:46.816402Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:02:46.816441Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:02:46.816484Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:02:46.816831Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:46.816858Z	error	sds	Remote side closed connection
2020-08-31T01:02:46.907828Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:47.117831Z	info	sds	resource:default new connection
2020-08-31T01:02:47.117885Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:02:47.117937Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:47.118241Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:47.118266Z	error	sds	Remote side closed connection
2020-08-31T01:02:47.118429Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5d384cc4-dc80-42fd-9c1a-70b9f495d078".sock: use of closed network connection
2020-08-31T01:02:47.118479Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"510378ea-a3ec-4674-a416-c18dce52b375".sock: use of closed network connection
2020-08-31T01:02:47.118650Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f56e6ef6-1344-4ee1-b5a2-67e72b4472b2\".sock" 

2020-08-31T01:02:47.118671Z	info	sds	Start SDS grpc server
2020-08-31T01:02:47.211095Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:47.212302Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:02:47.423284Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f56e6ef6-1344-4ee1-b5a2-67e72b4472b2".sock: use of closed network connection
2020-08-31T01:02:47.423550Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"94f127dd-fb7c-4dff-bb61-8ebb45800f33\".sock" 

2020-08-31T01:02:47.423588Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:02:47.514312Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:02:47.725180Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"94f127dd-fb7c-4dff-bb61-8ebb45800f33".sock: use of closed network connection
2020-08-31T01:02:47.725509Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest4e5df577-a110-4f8c-a54a-9b898cac7d7a.sock" 

2020-08-31T01:02:47.725573Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1bdd9394-d8f2-4632-aa18-28fb72ba85a1\".sock" 

2020-08-31T01:02:47.725589Z	info	sds	Start SDS grpc server
2020-08-31T01:02:47.725614Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:02:48.118613Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:48.118648Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:02:48.329521Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest4e5df577-a110-4f8c-a54a-9b898cac7d7a.sock: use of closed network connection
2020-08-31T01:02:48.329571Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1bdd9394-d8f2-4632-aa18-28fb72ba85a1".sock: use of closed network connection
2020-08-31T01:02:48.329797Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestb25ee79f-cfae-4820-b11f-c73dfefcbd4d.sock" 

2020-08-31T01:02:48.329836Z	info	sds	Start SDS grpc server
2020-08-31T01:02:48.423514Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:48.630987Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:02:48.631081Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:48.631296Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestb25ee79f-cfae-4820-b11f-c73dfefcbd4d.sock: use of closed network connection
2020-08-31T01:02:48.631667Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste5db893f-988b-49ab-9935-fe3884f8152e.sock" 

2020-08-31T01:02:48.631732Z	info	sds	Start SDS grpc server
2020-08-31T01:02:48.632432Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:02:48.632499Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:02:48.632546Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:48.632745Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:02:48.632799Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:02:48.632855Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:02:48.725300Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:48.908076Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:49.211325Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:49.212526Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:49.329725Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:49.329743Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:49.514580Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:49.631524Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:49.632804Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:49.632839Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:02:50.118855Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:50.118911Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:50.423795Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:50.633711Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:50.634109Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste5db893f-988b-49ab-9935-fe3884f8152e.sock: use of closed network connection
2020-08-31T01:02:50.634180Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:50.634210Z	error	sds	Remote side closed connection
2020-08-31T01:02:50.634218Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:50.634255Z	error	sds	Remote side closed connection
2020-08-31T01:02:50.634363Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest648d8b27-f4d9-40bd-b7f0-8184e37c85d4.sock" 

2020-08-31T01:02:50.634445Z	info	sds	Start SDS grpc server
2020-08-31T01:02:50.635209Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:02:50.635251Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:02:50.635296Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:50.635736Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:02:50.635295879 +0000 UTC m=+6.809098767 and is waiting for next SDS request
2020-08-31T01:02:50.635753Z	info	sds	Dynamic push for secret default
2020-08-31T01:02:50.635818Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest648d8b27-f4d9-40bd-b7f0-8184e37c85d4.sock: use of closed network connection
2020-08-31T01:02:50.635844Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:50.635866Z	error	sds	Remote side closed connection
2020-08-31T01:02:50.635911Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:50.635944Z	error	sds	Remote side closed connection
2020-08-31T01:02:50.636111Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1d810964-32ae-4bce-8c2e-742638c90f70.sock" 

2020-08-31T01:02:50.636223Z	info	sds	Start SDS grpc server
2020-08-31T01:02:50.636936Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:02:50.636984Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:02:50.637036Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:50.637569Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:02:50.725535Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:51.137766Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:51.137819Z	info	sds	Dynamic push for secret default
2020-08-31T01:02:51.138465Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1d810964-32ae-4bce-8c2e-742638c90f70.sock: use of closed network connection
2020-08-31T01:02:51.138580Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:51.138607Z	error	sds	Remote side closed connection
2020-08-31T01:02:51.138636Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:51.138658Z	error	sds	Remote side closed connection
2020-08-31T01:02:51.138738Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestedc3eab6-20d3-4542-9b3a-2dc210d22aa9.sock" 

2020-08-31T01:02:51.138794Z	info	sds	Start SDS grpc server
2020-08-31T01:02:51.139011Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestedc3eab6-20d3-4542-9b3a-2dc210d22aa9.sock: use of closed network connection
2020-08-31T01:02:51.139119Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0ee50a3a-ce67-459e-9613-3b3842f0bcea.sock" 

2020-08-31T01:02:51.139144Z	info	sds	Start SDS grpc server
2020-08-31T01:02:51.329999Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:51.329989Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:51.440249Z	info	sds	resource:default new connection
2020-08-31T01:02:51.440324Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:02:51.440405Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:51.440705Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:51.440749Z	error	sds	Remote side closed connection
2020-08-31T01:02:51.631842Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:51.634375Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:51.636109Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:51.741816Z	info	sds	resource:default new connection
2020-08-31T01:02:51.741915Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:02:51.742011Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:51.742389Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:51.742415Z	error	sds	Remote side closed connection
2020-08-31T01:02:51.742696Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0ee50a3a-ce67-459e-9613-3b3842f0bcea.sock: use of closed network connection
2020-08-31T01:02:51.742819Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb34bedf7-0711-4017-8251-507db75097c1.sock" 

2020-08-31T01:02:51.742848Z	info	sds	Start SDS grpc server
2020-08-31T01:02:52.043682Z	info	sds	resource:default new connection
2020-08-31T01:02:52.043755Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:02:52.043809Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:52.044102Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:02:52.044129Z	error	sds	Remote side closed connection
2020-08-31T01:02:52.044461Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb34bedf7-0711-4017-8251-507db75097c1.sock: use of closed network connection
2020-08-31T01:02:52.138698Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:52.139066Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:52.743022Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:52.908265Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:53.044569Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:02:53.211559Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:53.212710Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:53.514813Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:53.634611Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:53.636364Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:02:54.078403Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0188eea3-235c-40be-959d-7da3728631ad.sock" 

2020-08-31T01:02:54.078458Z	info	sds	Start SDS grpc server
2020-08-31T01:02:54.119133Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:54.119166Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:54.138974Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:54.139209Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:54.424063Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:54.725819Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:02:54.743258Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:55.044872Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:02:55.079262Z	info	sds	resource:default new connection
2020-08-31T01:02:55.079362Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:02:55.088074Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:02:55.266582Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:02:55.266624Z	info	cache	GenerateSecret default
2020-08-31T01:02:55.266707Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:02:55.267152Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0188eea3-235c-40be-959d-7da3728631ad.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.689s
2020-08-31T01:03:00.490028Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9af958b0-cc56-456c-ad5e-150ecd5ab7b2.sock" 

2020-08-31T01:03:00.490138Z	info	sds	Start SDS grpc server
2020-08-31T01:03:00.491396Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:03:00.491464Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:03:00.491925Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:01.491333Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:01.491388Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:03:02.492187Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:03:02.492264Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:03:02.492294Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:03:02.492486Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:02.492748Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9af958b0-cc56-456c-ad5e-150ecd5ab7b2.sock: use of closed network connection
2020-08-31T01:03:02.492974Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:02.492992Z	error	sds	Remote side closed connection
2020-08-31T01:03:02.493116Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3de42834-d5ba-4820-90bd-65da03726246\".sock" 

2020-08-31T01:03:02.493150Z	info	sds	Start SDS grpc server
2020-08-31T01:03:02.794128Z	info	sds	resource:default new connection
2020-08-31T01:03:02.794192Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:03:02.794247Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:02.794607Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:02.794643Z	error	sds	Remote side closed connection
2020-08-31T01:03:02.795233Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:03:02.795296Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:03:02.795481Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:03:02.795862Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:02.795901Z	error	sds	Remote side closed connection
2020-08-31T01:03:02.796134Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3de42834-d5ba-4820-90bd-65da03726246".sock: use of closed network connection
2020-08-31T01:03:02.796356Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"06084ed4-83aa-407f-8ccd-b066a02fe08c\".sock" 

2020-08-31T01:03:02.796450Z	info	sds	Start SDS grpc server
2020-08-31T01:03:02.797003Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:03:02.797037Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:03:02.797073Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:03:02.797293Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:02.797312Z	error	sds	Remote side closed connection
2020-08-31T01:03:02.797522Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"06084ed4-83aa-407f-8ccd-b066a02fe08c".sock: use of closed network connection
2020-08-31T01:03:02.797674Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"40e43595-a99e-43b5-9321-06fdc6ed9e5b\".sock" 

2020-08-31T01:03:02.797709Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:03.098662Z	info	sds	resource:default new connection
2020-08-31T01:03:03.098722Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:03:03.098780Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:03.099068Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:03.099097Z	error	sds	Remote side closed connection
2020-08-31T01:03:03.099258Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"40e43595-a99e-43b5-9321-06fdc6ed9e5b".sock: use of closed network connection
2020-08-31T01:03:03.099427Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3c48f57b-a237-412c-9bb9-c5c8bf1d0ea6\".sock" 

2020-08-31T01:03:03.099434Z	info	sds	Start SDS grpc server
2020-08-31T01:03:03.099496Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8394222d-55be-47d8-962e-c83976ca6ba3\".sock" 

2020-08-31T01:03:03.099527Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:03.400481Z	info	sds	resource:default new connection
2020-08-31T01:03:03.400549Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:03:03.400603Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:03.400889Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:03.400918Z	error	sds	Remote side closed connection
2020-08-31T01:03:03.401761Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:03:03.401820Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:03:03.401872Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:03:03.402146Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:03.402183Z	error	sds	Remote side closed connection
2020-08-31T01:03:03.493017Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:03.703163Z	info	sds	resource:default new connection
2020-08-31T01:03:03.703231Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:03:03.703286Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:03.703530Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:03.703555Z	error	sds	Remote side closed connection
2020-08-31T01:03:03.703822Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3c48f57b-a237-412c-9bb9-c5c8bf1d0ea6".sock: use of closed network connection
2020-08-31T01:03:03.703915Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8394222d-55be-47d8-962e-c83976ca6ba3".sock: use of closed network connection
2020-08-31T01:03:03.704108Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e2436047-b76b-4e17-aa70-9254d005ca09\".sock" 

2020-08-31T01:03:03.704130Z	info	sds	Start SDS grpc server
2020-08-31T01:03:03.796372Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:03.797754Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:03:04.007077Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e2436047-b76b-4e17-aa70-9254d005ca09".sock: use of closed network connection
2020-08-31T01:03:04.007287Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d9cab2aa-d4fe-4cef-9ded-031ce1970104\".sock" 

2020-08-31T01:03:04.007311Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:04.099457Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:03:04.308749Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d9cab2aa-d4fe-4cef-9ded-031ce1970104".sock: use of closed network connection
2020-08-31T01:03:04.308938Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest208b69e1-be3f-4218-8c70-607f12b3dba2.sock" 

2020-08-31T01:03:04.308988Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4abb9544-f14f-49ff-986e-07d71067c240\".sock" 

2020-08-31T01:03:04.308983Z	info	sds	Start SDS grpc server
2020-08-31T01:03:04.309023Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:03:04.704072Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:04.704111Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:03:04.913124Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest208b69e1-be3f-4218-8c70-607f12b3dba2.sock: use of closed network connection
2020-08-31T01:03:04.913256Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4abb9544-f14f-49ff-986e-07d71067c240".sock: use of closed network connection
2020-08-31T01:03:04.913454Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest9f34b6e1-33dd-41dd-a162-7aa325594ac0.sock" 

2020-08-31T01:03:04.913481Z	info	sds	Start SDS grpc server
2020-08-31T01:03:05.007347Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:05.214728Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:03:05.214826Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:05.215108Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest9f34b6e1-33dd-41dd-a162-7aa325594ac0.sock: use of closed network connection
2020-08-31T01:03:05.215380Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest82d2f733-160d-4ac5-b1bd-c37792fd1520.sock" 

2020-08-31T01:03:05.215404Z	info	sds	Start SDS grpc server
2020-08-31T01:03:05.216250Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:03:05.216302Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:03:05.216348Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:03:05.216971Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:03:05.217022Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:03:05.217063Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:05.308973Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:05.493307Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:05.796651Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:05.797939Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:05.913363Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:05.913436Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:06.099750Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:06.215304Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:06.217058Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:06.217094Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:03:06.704349Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:06.704381Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:07.007620Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:07.217958Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:07.218350Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest82d2f733-160d-4ac5-b1bd-c37792fd1520.sock: use of closed network connection
2020-08-31T01:03:07.218410Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:07.218433Z	error	sds	Remote side closed connection
2020-08-31T01:03:07.218477Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:07.218512Z	error	sds	Remote side closed connection
2020-08-31T01:03:07.218662Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2f7fc530-d74b-480b-839b-eb92fe234163.sock" 

2020-08-31T01:03:07.218786Z	info	sds	Start SDS grpc server
2020-08-31T01:03:07.221204Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:03:07.221303Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:03:07.221368Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:07.221839Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:03:07.221367474 +0000 UTC m=+6.808640280 and is waiting for next SDS request
2020-08-31T01:03:07.221857Z	info	sds	Dynamic push for secret default
2020-08-31T01:03:07.221909Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2f7fc530-d74b-480b-839b-eb92fe234163.sock: use of closed network connection
2020-08-31T01:03:07.221960Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:07.221990Z	error	sds	Remote side closed connection
2020-08-31T01:03:07.222001Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:07.222011Z	error	sds	Remote side closed connection
2020-08-31T01:03:07.222211Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest35042295-afdd-401b-8b52-3f8e7a7842fd.sock" 

2020-08-31T01:03:07.222232Z	info	sds	Start SDS grpc server
2020-08-31T01:03:07.222962Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:03:07.223003Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:03:07.223046Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:07.223663Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:03:07.309247Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:07.723907Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:07.723958Z	info	sds	Dynamic push for secret default
2020-08-31T01:03:07.724547Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest35042295-afdd-401b-8b52-3f8e7a7842fd.sock: use of closed network connection
2020-08-31T01:03:07.724686Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:07.724719Z	error	sds	Remote side closed connection
2020-08-31T01:03:07.724715Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:07.724778Z	error	sds	Remote side closed connection
2020-08-31T01:03:07.724831Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest21bbf6fa-2dcc-4791-b564-884e6a91e3ec.sock" 

2020-08-31T01:03:07.724854Z	info	sds	Start SDS grpc server
2020-08-31T01:03:07.725063Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest21bbf6fa-2dcc-4791-b564-884e6a91e3ec.sock: use of closed network connection
2020-08-31T01:03:07.725140Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8d17b929-b404-4f1a-829a-9e72cc396d55.sock" 

2020-08-31T01:03:07.725161Z	info	sds	Start SDS grpc server
2020-08-31T01:03:07.913636Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:07.913765Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:08.026139Z	info	sds	resource:default new connection
2020-08-31T01:03:08.026214Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:03:08.026271Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:08.026571Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:08.026598Z	error	sds	Remote side closed connection
2020-08-31T01:03:08.215515Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:08.218548Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:08.222082Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:08.327622Z	info	sds	resource:default new connection
2020-08-31T01:03:08.327681Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:03:08.327743Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:08.328039Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:08.328073Z	error	sds	Remote side closed connection
2020-08-31T01:03:08.328365Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8d17b929-b404-4f1a-829a-9e72cc396d55.sock: use of closed network connection
2020-08-31T01:03:08.328492Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotested809d7c-9df9-4675-87aa-3bdfe18d02ff.sock" 

2020-08-31T01:03:08.328526Z	info	sds	Start SDS grpc server
2020-08-31T01:03:08.629495Z	info	sds	resource:default new connection
2020-08-31T01:03:08.629561Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:03:08.629620Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:08.629984Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:08.630016Z	error	sds	Remote side closed connection
2020-08-31T01:03:08.630256Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotested809d7c-9df9-4675-87aa-3bdfe18d02ff.sock: use of closed network connection
2020-08-31T01:03:08.724792Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:08.725137Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:09.328580Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:09.493590Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:09.630459Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:03:09.796932Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:09.798103Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:10.099979Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:10.218763Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:10.222287Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:03:10.660979Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestce42adc7-68e5-411c-a09f-0a1aa7d8a749.sock" 

2020-08-31T01:03:10.661035Z	info	sds	Start SDS grpc server
2020-08-31T01:03:10.704608Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:10.704635Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:10.725026Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:10.725277Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:11.007880Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:11.309489Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:11.328825Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:11.630693Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:11.662029Z	info	sds	resource:default new connection
2020-08-31T01:03:11.662092Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:03:11.669303Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:03:11.733922Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:03:11.733975Z	info	cache	GenerateSecret default
2020-08-31T01:03:11.734040Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:11.734401Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestce42adc7-68e5-411c-a09f-0a1aa7d8a749.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.567s
2020-08-31T01:03:17.006435Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9119f62c-b64f-41ed-8739-6d6d8e0e8d38.sock" 

2020-08-31T01:03:17.006539Z	info	sds	Start SDS grpc server
2020-08-31T01:03:17.008000Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:03:17.008072Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:03:17.008414Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:18.007822Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:18.007886Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:03:19.008436Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:03:19.008523Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:03:19.008550Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:03:19.008608Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:19.008838Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9119f62c-b64f-41ed-8739-6d6d8e0e8d38.sock: use of closed network connection
2020-08-31T01:03:19.009084Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:19.009100Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2558cb0e-0374-4105-a6e6-46b2ddef5156\".sock" 

2020-08-31T01:03:19.009112Z	error	sds	Remote side closed connection
2020-08-31T01:03:19.009137Z	info	sds	Start SDS grpc server
2020-08-31T01:03:19.310103Z	info	sds	resource:default new connection
2020-08-31T01:03:19.310183Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:03:19.310239Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:19.310529Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:19.310555Z	error	sds	Remote side closed connection
2020-08-31T01:03:19.311192Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:03:19.311234Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:03:19.311398Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:03:19.311639Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:19.311665Z	error	sds	Remote side closed connection
2020-08-31T01:03:19.311859Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2558cb0e-0374-4105-a6e6-46b2ddef5156".sock: use of closed network connection
2020-08-31T01:03:19.312074Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"abe1f324-7d1b-4d0c-b24f-50cd0c60cffd\".sock" 

2020-08-31T01:03:19.312161Z	info	sds	Start SDS grpc server
2020-08-31T01:03:19.312512Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:03:19.312544Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:03:19.312585Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:03:19.312817Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:19.312836Z	error	sds	Remote side closed connection
2020-08-31T01:03:19.312982Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"abe1f324-7d1b-4d0c-b24f-50cd0c60cffd".sock: use of closed network connection
2020-08-31T01:03:19.313135Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bc8348ac-786a-4b65-8d09-c7d194a1d279\".sock" 

2020-08-31T01:03:19.313169Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:19.614116Z	info	sds	resource:default new connection
2020-08-31T01:03:19.614202Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:03:19.614260Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:19.614563Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:19.614595Z	error	sds	Remote side closed connection
2020-08-31T01:03:19.614814Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bc8348ac-786a-4b65-8d09-c7d194a1d279".sock: use of closed network connection
2020-08-31T01:03:19.615005Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"95bc8097-e009-4463-a97b-1ce0551917b1\".sock" 

2020-08-31T01:03:19.615060Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"913d8417-64b8-4fad-b876-bb9dcbb17000\".sock" 

2020-08-31T01:03:19.615094Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:19.615096Z	info	sds	Start SDS grpc server
2020-08-31T01:03:19.915959Z	info	sds	resource:default new connection
2020-08-31T01:03:19.916016Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:03:19.916089Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:19.916361Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:19.916390Z	error	sds	Remote side closed connection
2020-08-31T01:03:19.916920Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:03:19.916968Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:03:19.917014Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:03:19.917265Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:19.917288Z	error	sds	Remote side closed connection
2020-08-31T01:03:20.009086Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:20.218315Z	info	sds	resource:default new connection
2020-08-31T01:03:20.218380Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:03:20.218435Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:20.218707Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:20.218740Z	error	sds	Remote side closed connection
2020-08-31T01:03:20.218896Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"95bc8097-e009-4463-a97b-1ce0551917b1".sock: use of closed network connection
2020-08-31T01:03:20.218963Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"913d8417-64b8-4fad-b876-bb9dcbb17000".sock: use of closed network connection
2020-08-31T01:03:20.219133Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6960d3db-d63e-4a22-84fb-8a6842c58242\".sock" 

2020-08-31T01:03:20.219159Z	info	sds	Start SDS grpc server
2020-08-31T01:03:20.312060Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:20.313175Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:03:20.522102Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6960d3db-d63e-4a22-84fb-8a6842c58242".sock: use of closed network connection
2020-08-31T01:03:20.522281Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e869274e-80d2-4366-8815-461cd1ee65e7\".sock" 

2020-08-31T01:03:20.522303Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:20.615027Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:03:20.824393Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e869274e-80d2-4366-8815-461cd1ee65e7".sock: use of closed network connection
2020-08-31T01:03:20.824583Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestfa7d31bc-3357-4df8-9fd9-e6a948830958.sock" 

2020-08-31T01:03:20.824639Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"14697d50-1812-4b2a-9dce-f99dd7868902\".sock" 

2020-08-31T01:03:20.824632Z	info	sds	Start SDS grpc server
2020-08-31T01:03:20.824712Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:03:21.219112Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:21.219142Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:03:21.429240Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestfa7d31bc-3357-4df8-9fd9-e6a948830958.sock: use of closed network connection
2020-08-31T01:03:21.429292Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"14697d50-1812-4b2a-9dce-f99dd7868902".sock: use of closed network connection
2020-08-31T01:03:21.429497Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0a29b9ad-f224-42ef-a1a0-6995d1083d15.sock" 

2020-08-31T01:03:21.429531Z	info	sds	Start SDS grpc server
2020-08-31T01:03:21.522346Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:21.730628Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:03:21.730723Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:21.731000Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0a29b9ad-f224-42ef-a1a0-6995d1083d15.sock: use of closed network connection
2020-08-31T01:03:21.731208Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd186ae6e-0467-4fbc-bed7-b75d5b95b54a.sock" 

2020-08-31T01:03:21.731330Z	info	sds	Start SDS grpc server
2020-08-31T01:03:21.731858Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:03:21.731901Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:03:21.731945Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:21.732081Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:03:21.732121Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:03:21.732146Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:03:21.824628Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:22.009368Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:22.312333Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:22.313362Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:22.429433Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:22.429483Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:22.615278Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:22.731202Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:22.732165Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:22.732187Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:03:23.219398Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:23.219445Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:23.522591Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:23.733174Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:23.733580Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd186ae6e-0467-4fbc-bed7-b75d5b95b54a.sock: use of closed network connection
2020-08-31T01:03:23.733705Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:23.733732Z	error	sds	Remote side closed connection
2020-08-31T01:03:23.733743Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:23.733787Z	error	sds	Remote side closed connection
2020-08-31T01:03:23.733866Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcef75e8b-7bc6-4448-8c10-39bcc36da362.sock" 

2020-08-31T01:03:23.733953Z	info	sds	Start SDS grpc server
2020-08-31T01:03:23.734711Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:03:23.734780Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:03:23.734832Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:23.735468Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:03:23.73483107 +0000 UTC m=+6.806310280 and is waiting for next SDS request
2020-08-31T01:03:23.735488Z	info	sds	Dynamic push for secret default
2020-08-31T01:03:23.735522Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcef75e8b-7bc6-4448-8c10-39bcc36da362.sock: use of closed network connection
2020-08-31T01:03:23.735586Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:23.735596Z	error	sds	Remote side closed connection
2020-08-31T01:03:23.735698Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:23.735720Z	error	sds	Remote side closed connection
2020-08-31T01:03:23.735833Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbbb59777-39de-455f-8a84-0bc285e8011a.sock" 

2020-08-31T01:03:23.735939Z	info	sds	Start SDS grpc server
2020-08-31T01:03:23.736466Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:03:23.736506Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:03:23.736543Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:23.737139Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:03:23.824948Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:24.237282Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:24.237336Z	info	sds	Dynamic push for secret default
2020-08-31T01:03:24.237948Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbbb59777-39de-455f-8a84-0bc285e8011a.sock: use of closed network connection
2020-08-31T01:03:24.238044Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:24.238070Z	error	sds	Remote side closed connection
2020-08-31T01:03:24.238108Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:24.238147Z	error	sds	Remote side closed connection
2020-08-31T01:03:24.238226Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4bdc6096-97e5-43ab-ba14-8d4959ce1172.sock" 

2020-08-31T01:03:24.238268Z	info	sds	Start SDS grpc server
2020-08-31T01:03:24.238608Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4bdc6096-97e5-43ab-ba14-8d4959ce1172.sock: use of closed network connection
2020-08-31T01:03:24.238708Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc0a18225-c882-4cba-9f70-0de04d3e28bf.sock" 

2020-08-31T01:03:24.238729Z	info	sds	Start SDS grpc server
2020-08-31T01:03:24.429654Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:24.429681Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:24.539629Z	info	sds	resource:default new connection
2020-08-31T01:03:24.539711Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:03:24.539817Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:24.540095Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:24.540206Z	error	sds	Remote side closed connection
2020-08-31T01:03:24.731383Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:24.733785Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:24.735699Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:24.841188Z	info	sds	resource:default new connection
2020-08-31T01:03:24.841250Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:03:24.841319Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:24.841739Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:24.841765Z	error	sds	Remote side closed connection
2020-08-31T01:03:24.841876Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc0a18225-c882-4cba-9f70-0de04d3e28bf.sock: use of closed network connection
2020-08-31T01:03:24.842025Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4e7061fd-60f7-4443-813c-b394371be012.sock" 

2020-08-31T01:03:24.842059Z	info	sds	Start SDS grpc server
2020-08-31T01:03:25.142993Z	info	sds	resource:default new connection
2020-08-31T01:03:25.143045Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:03:25.143096Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:25.143419Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:25.143444Z	error	sds	Remote side closed connection
2020-08-31T01:03:25.143742Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4e7061fd-60f7-4443-813c-b394371be012.sock: use of closed network connection
2020-08-31T01:03:25.238169Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:25.238755Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:25.842111Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:26.009618Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:26.143855Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:03:26.312442Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:26.313525Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:26.615504Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:26.734025Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:26.735928Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:03:27.172822Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest58697655-bd9d-4028-85b9-74b32a142424.sock" 

2020-08-31T01:03:27.172871Z	info	sds	Start SDS grpc server
2020-08-31T01:03:27.219660Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:27.219719Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:27.238460Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:27.238922Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:27.522831Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:27.825237Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:27.842380Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:28.144040Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:28.173673Z	info	sds	resource:default new connection
2020-08-31T01:03:28.173742Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:03:28.184271Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:03:28.429840Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:28.429854Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:28.443619Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:03:28.443662Z	info	cache	GenerateSecret default
2020-08-31T01:03:28.443722Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:28.444114Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest58697655-bd9d-4028-85b9-74b32a142424.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.773s
2020-08-31T01:03:33.684651Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf558b6d5-e50f-4de6-8c4a-0e0c86e064cb.sock" 

2020-08-31T01:03:33.684752Z	info	sds	Start SDS grpc server
2020-08-31T01:03:33.685951Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:03:33.686034Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:03:33.686437Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:34.685959Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:34.686017Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:03:35.686773Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:03:35.686871Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:03:35.686895Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:03:35.687009Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:35.687233Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf558b6d5-e50f-4de6-8c4a-0e0c86e064cb.sock: use of closed network connection
2020-08-31T01:03:35.687358Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:35.687378Z	error	sds	Remote side closed connection
2020-08-31T01:03:35.687538Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d34c8b3f-2fca-478b-a4b5-0ba8fc1053d7\".sock" 

2020-08-31T01:03:35.687573Z	info	sds	Start SDS grpc server
2020-08-31T01:03:35.988454Z	info	sds	resource:default new connection
2020-08-31T01:03:35.988514Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:03:35.988567Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:35.988857Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:35.988899Z	error	sds	Remote side closed connection
2020-08-31T01:03:35.989582Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:03:35.989628Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:03:35.989787Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:03:35.990030Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:35.990056Z	error	sds	Remote side closed connection
2020-08-31T01:03:35.990227Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d34c8b3f-2fca-478b-a4b5-0ba8fc1053d7".sock: use of closed network connection
2020-08-31T01:03:35.990461Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b14b2e85-c368-4f81-85ab-40222341f02b\".sock" 

2020-08-31T01:03:35.990524Z	info	sds	Start SDS grpc server
2020-08-31T01:03:35.991106Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:03:35.991187Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:03:35.991270Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:03:35.991532Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:35.991555Z	error	sds	Remote side closed connection
2020-08-31T01:03:35.991635Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b14b2e85-c368-4f81-85ab-40222341f02b".sock: use of closed network connection
2020-08-31T01:03:35.991774Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f0b99b75-2e0d-4b20-8d9b-6f6b0c7ad5cd\".sock" 

2020-08-31T01:03:35.991802Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:36.292818Z	info	sds	resource:default new connection
2020-08-31T01:03:36.292874Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:03:36.292932Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:36.293168Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:36.293198Z	error	sds	Remote side closed connection
2020-08-31T01:03:36.293395Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f0b99b75-2e0d-4b20-8d9b-6f6b0c7ad5cd".sock: use of closed network connection
2020-08-31T01:03:36.293583Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"25a68af7-b43e-45fd-af5a-c0a8bffa840e\".sock" 

2020-08-31T01:03:36.293668Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9d6296dd-0838-47f8-b50d-91dbcd691b4e\".sock" 

2020-08-31T01:03:36.293672Z	info	sds	Start SDS grpc server
2020-08-31T01:03:36.293699Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:36.594783Z	info	sds	resource:default new connection
2020-08-31T01:03:36.594868Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:03:36.594929Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:36.595282Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:36.595325Z	error	sds	Remote side closed connection
2020-08-31T01:03:36.595792Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:03:36.595844Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:03:36.595887Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:03:36.596120Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:36.596132Z	error	sds	Remote side closed connection
2020-08-31T01:03:36.687319Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:36.897157Z	info	sds	resource:default new connection
2020-08-31T01:03:36.897224Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:03:36.897346Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:36.897656Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:36.897685Z	error	sds	Remote side closed connection
2020-08-31T01:03:36.897881Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"25a68af7-b43e-45fd-af5a-c0a8bffa840e".sock: use of closed network connection
2020-08-31T01:03:36.897924Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9d6296dd-0838-47f8-b50d-91dbcd691b4e".sock: use of closed network connection
2020-08-31T01:03:36.898092Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"8869074b-33b9-4b44-a933-8277e7f3d688\".sock" 

2020-08-31T01:03:36.898114Z	info	sds	Start SDS grpc server
2020-08-31T01:03:36.990475Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:36.991806Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:03:37.201237Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"8869074b-33b9-4b44-a933-8277e7f3d688".sock: use of closed network connection
2020-08-31T01:03:37.201418Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c9fd49f8-3caf-4f70-bcf2-f7fdf1677251\".sock" 

2020-08-31T01:03:37.201429Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:37.293599Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:03:37.502985Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c9fd49f8-3caf-4f70-bcf2-f7fdf1677251".sock: use of closed network connection
2020-08-31T01:03:37.503185Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest5c9f61c7-58b8-40f2-91ce-b041639ea868.sock" 

2020-08-31T01:03:37.503242Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e7ffe148-17fa-423a-9037-3646723f4a15\".sock" 

2020-08-31T01:03:37.503277Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:37.503281Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:03:37.898081Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:37.898113Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:03:38.107251Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest5c9f61c7-58b8-40f2-91ce-b041639ea868.sock: use of closed network connection
2020-08-31T01:03:38.107368Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e7ffe148-17fa-423a-9037-3646723f4a15".sock: use of closed network connection
2020-08-31T01:03:38.107557Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest052b91f1-9bc8-4de7-8abd-346b449e8057.sock" 

2020-08-31T01:03:38.107580Z	info	sds	Start SDS grpc server
2020-08-31T01:03:38.201506Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:38.409169Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:03:38.409274Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:38.409573Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest052b91f1-9bc8-4de7-8abd-346b449e8057.sock: use of closed network connection
2020-08-31T01:03:38.409836Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcc340112-2d4c-408e-99e7-741123b5db39.sock" 

2020-08-31T01:03:38.409939Z	info	sds	Start SDS grpc server
2020-08-31T01:03:38.411985Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:03:38.412254Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:03:38.412714Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:38.412748Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:03:38.412796Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:03:38.412866Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:03:38.503227Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:38.687582Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:38.990818Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:38.991970Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:39.107532Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:39.107567Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:39.293864Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:39.409878Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:39.412257Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:39.412304Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:03:39.898322Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:39.898358Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:40.201615Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:40.413097Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:40.413482Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcc340112-2d4c-408e-99e7-741123b5db39.sock: use of closed network connection
2020-08-31T01:03:40.413526Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:40.413551Z	error	sds	Remote side closed connection
2020-08-31T01:03:40.413622Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:40.413645Z	error	sds	Remote side closed connection
2020-08-31T01:03:40.413753Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest17840aa0-2139-4dc0-b0f4-8b40ed2d15ff.sock" 

2020-08-31T01:03:40.413820Z	info	sds	Start SDS grpc server
2020-08-31T01:03:40.414684Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:03:40.414726Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:03:40.414781Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:40.415224Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:03:40.414780224 +0000 UTC m=+6.804864153 and is waiting for next SDS request
2020-08-31T01:03:40.415243Z	info	sds	Dynamic push for secret default
2020-08-31T01:03:40.415267Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest17840aa0-2139-4dc0-b0f4-8b40ed2d15ff.sock: use of closed network connection
2020-08-31T01:03:40.415352Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:40.415349Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:40.415381Z	error	sds	Remote side closed connection
2020-08-31T01:03:40.415372Z	error	sds	Remote side closed connection
2020-08-31T01:03:40.415481Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta83ef9eb-aaa6-4d4a-b0ed-d6bed841dc0f.sock" 

2020-08-31T01:03:40.415498Z	info	sds	Start SDS grpc server
2020-08-31T01:03:40.416324Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:03:40.416381Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:03:40.416420Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:40.416942Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:03:40.503470Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:40.917101Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:40.917170Z	info	sds	Dynamic push for secret default
2020-08-31T01:03:40.917720Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta83ef9eb-aaa6-4d4a-b0ed-d6bed841dc0f.sock: use of closed network connection
2020-08-31T01:03:40.917844Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:40.917858Z	error	sds	Remote side closed connection
2020-08-31T01:03:40.917941Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:40.917950Z	error	sds	Remote side closed connection
2020-08-31T01:03:40.918062Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest785bc858-aaea-4b29-92bb-8508c47a89a9.sock" 

2020-08-31T01:03:40.918073Z	info	sds	Start SDS grpc server
2020-08-31T01:03:40.918308Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest785bc858-aaea-4b29-92bb-8508c47a89a9.sock: use of closed network connection
2020-08-31T01:03:40.918414Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfc4aeb1f-e2e6-48ca-8b72-6083289f967a.sock" 

2020-08-31T01:03:40.918434Z	info	sds	Start SDS grpc server
2020-08-31T01:03:41.107755Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:41.107831Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:41.219285Z	info	sds	resource:default new connection
2020-08-31T01:03:41.219343Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:03:41.219396Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:41.219771Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:41.219797Z	error	sds	Remote side closed connection
2020-08-31T01:03:41.410098Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:41.413685Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:41.415416Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:41.520777Z	info	sds	resource:default new connection
2020-08-31T01:03:41.520844Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:03:41.520898Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:41.521205Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:41.521232Z	error	sds	Remote side closed connection
2020-08-31T01:03:41.521502Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfc4aeb1f-e2e6-48ca-8b72-6083289f967a.sock: use of closed network connection
2020-08-31T01:03:41.521627Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb741ada2-bc4d-4522-9a88-269c641176e1.sock" 

2020-08-31T01:03:41.521673Z	info	sds	Start SDS grpc server
2020-08-31T01:03:41.822522Z	info	sds	resource:default new connection
2020-08-31T01:03:41.822603Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:03:41.822661Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:41.823022Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:41.823059Z	error	sds	Remote side closed connection
2020-08-31T01:03:41.823216Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb741ada2-bc4d-4522-9a88-269c641176e1.sock: use of closed network connection
2020-08-31T01:03:41.917955Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:41.918466Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:42.521745Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:42.687856Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:42.823426Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:03:42.991075Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:42.992135Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:43.294099Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:43.413979Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:43.415570Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:03:43.854453Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0bd52b06-e8c5-4884-807b-8085d84abc08.sock" 

2020-08-31T01:03:43.854498Z	info	sds	Start SDS grpc server
2020-08-31T01:03:43.898479Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:43.898517Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:43.918184Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:43.918649Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:44.201816Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:44.503719Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:44.521886Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:44.823716Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:44.855423Z	info	sds	resource:default new connection
2020-08-31T01:03:44.855503Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:03:44.864133Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:03:44.936371Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:03:44.936417Z	info	cache	GenerateSecret default
2020-08-31T01:03:44.936476Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:44.936864Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0bd52b06-e8c5-4884-807b-8085d84abc08.sock: use of closed network connection
PASS
2020-08-31T01:03:44.936955Z	info	sds	resource:default connection is termok  	istio.io/istio/security/pkg/nodeagent/sds	11.572s
2020-08-31T01:03:50.194971Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste8adaf5c-adc7-4b38-bfe1-78b724bb9116.sock" 

2020-08-31T01:03:50.195070Z	info	sds	Start SDS grpc server
2020-08-31T01:03:50.196304Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:03:50.196363Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:03:50.196807Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:51.196203Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:51.196300Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:03:52.197607Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:03:52.197723Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:03:52.197769Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:03:52.197849Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:52.198120Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste8adaf5c-adc7-4b38-bfe1-78b724bb9116.sock: use of closed network connection
2020-08-31T01:03:52.198326Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:52.198350Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b3297fc6-b5bf-4702-995f-0a997da33ad9\".sock" 

2020-08-31T01:03:52.198368Z	error	sds	Remote side closed connection
2020-08-31T01:03:52.198422Z	info	sds	Start SDS grpc server
2020-08-31T01:03:52.499531Z	info	sds	resource:default new connection
2020-08-31T01:03:52.499599Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:03:52.499653Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:52.499927Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:52.499972Z	error	sds	Remote side closed connection
2020-08-31T01:03:52.500474Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:03:52.500515Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:03:52.500703Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:03:52.500918Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:52.500946Z	error	sds	Remote side closed connection
2020-08-31T01:03:52.501088Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b3297fc6-b5bf-4702-995f-0a997da33ad9".sock: use of closed network connection
2020-08-31T01:03:52.501270Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"210734a3-1ae9-4918-bcb9-35bbe2131cee\".sock" 

2020-08-31T01:03:52.501348Z	info	sds	Start SDS grpc server
2020-08-31T01:03:52.501732Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:03:52.501758Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:03:52.501807Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:03:52.502003Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:52.502021Z	error	sds	Remote side closed connection
2020-08-31T01:03:52.502123Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"210734a3-1ae9-4918-bcb9-35bbe2131cee".sock: use of closed network connection
2020-08-31T01:03:52.502368Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a6f6be53-ad27-401a-8739-f8e50a5bda83\".sock" 

2020-08-31T01:03:52.502410Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:52.803446Z	info	sds	resource:default new connection
2020-08-31T01:03:52.803501Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:03:52.803559Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:52.803793Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:52.803826Z	error	sds	Remote side closed connection
2020-08-31T01:03:52.804151Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a6f6be53-ad27-401a-8739-f8e50a5bda83".sock: use of closed network connection
2020-08-31T01:03:52.804419Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"82b50e9b-a630-479d-8a2d-607f5ad3044c\".sock" 

2020-08-31T01:03:52.804489Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4bff7638-0ba8-447c-adc0-961d0c9c75b9\".sock" 

2020-08-31T01:03:52.804524Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:52.804527Z	info	sds	Start SDS grpc server
2020-08-31T01:03:53.105851Z	info	sds	resource:default new connection
2020-08-31T01:03:53.105913Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:03:53.105968Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:53.106236Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:53.106263Z	error	sds	Remote side closed connection
2020-08-31T01:03:53.106790Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:03:53.106836Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:03:53.106880Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:03:53.107094Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:53.107120Z	error	sds	Remote side closed connection
2020-08-31T01:03:53.198290Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:53.408115Z	info	sds	resource:default new connection
2020-08-31T01:03:53.408177Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:03:53.408238Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:53.408444Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:53.408471Z	error	sds	Remote side closed connection
2020-08-31T01:03:53.408822Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"82b50e9b-a630-479d-8a2d-607f5ad3044c".sock: use of closed network connection
2020-08-31T01:03:53.408907Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4bff7638-0ba8-447c-adc0-961d0c9c75b9".sock: use of closed network connection
2020-08-31T01:03:53.409119Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c921a4f1-165d-4170-9273-21fd1c5f71a1\".sock" 

2020-08-31T01:03:53.409146Z	info	sds	Start SDS grpc server
2020-08-31T01:03:53.501313Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:53.502293Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:03:53.711486Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c921a4f1-165d-4170-9273-21fd1c5f71a1".sock: use of closed network connection
2020-08-31T01:03:53.711688Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"64f7c949-8420-4927-8eb9-e85b3b1cede1\".sock" 

2020-08-31T01:03:53.711750Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:03:53.804367Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:03:54.013603Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"64f7c949-8420-4927-8eb9-e85b3b1cede1".sock: use of closed network connection
2020-08-31T01:03:54.014199Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest610b8306-2d29-456d-99eb-01a8c9feec12.sock" 

2020-08-31T01:03:54.014244Z	info	sds	Start SDS grpc server
2020-08-31T01:03:54.014428Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4b67886d-5650-4d8f-891a-ece4928f6401\".sock" 

2020-08-31T01:03:54.014501Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:03:54.409070Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:54.409103Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:03:54.619374Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest610b8306-2d29-456d-99eb-01a8c9feec12.sock: use of closed network connection
2020-08-31T01:03:54.619428Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4b67886d-5650-4d8f-891a-ece4928f6401".sock: use of closed network connection
2020-08-31T01:03:54.619668Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest63cd6cbc-3af1-46a1-b24b-e6fb79a99500.sock" 

2020-08-31T01:03:54.619688Z	info	sds	Start SDS grpc server
2020-08-31T01:03:54.711683Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:54.920759Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:03:54.920853Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:54.921097Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest63cd6cbc-3af1-46a1-b24b-e6fb79a99500.sock: use of closed network connection
2020-08-31T01:03:54.921360Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest41f0a805-e5e0-46e9-a3e7-91c046f1aef9.sock" 

2020-08-31T01:03:54.921419Z	info	sds	Start SDS grpc server
2020-08-31T01:03:54.922173Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:03:54.922217Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:03:54.922280Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:54.922449Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:03:54.922483Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:03:54.922512Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:03:55.013851Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:55.198579Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:55.501581Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:55.502518Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:55.619594Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:55.619634Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:55.804492Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:55.921320Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:55.922497Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:55.922534Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:03:56.409303Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:56.409391Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:56.711937Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:56.923448Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:56.923717Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest41f0a805-e5e0-46e9-a3e7-91c046f1aef9.sock: use of closed network connection
2020-08-31T01:03:56.923810Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:56.923835Z	error	sds	Remote side closed connection
2020-08-31T01:03:56.923876Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:56.923900Z	error	sds	Remote side closed connection
2020-08-31T01:03:56.924094Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbe903d3a-cfca-4df1-bc3a-c53878cecbc2.sock" 

2020-08-31T01:03:56.924238Z	info	sds	Start SDS grpc server
2020-08-31T01:03:56.925029Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:03:56.925094Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:03:56.925150Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:56.925690Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:03:56.925149883 +0000 UTC m=+6.805605958 and is waiting for next SDS request
2020-08-31T01:03:56.925710Z	info	sds	Dynamic push for secret default
2020-08-31T01:03:56.925739Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbe903d3a-cfca-4df1-bc3a-c53878cecbc2.sock: use of closed network connection
2020-08-31T01:03:56.925850Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:56.925866Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:56.925877Z	error	sds	Remote side closed connection
2020-08-31T01:03:56.925872Z	error	sds	Remote side closed connection
2020-08-31T01:03:56.925981Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf9451c38-f453-456c-afa5-af35efd7b193.sock" 

2020-08-31T01:03:56.926013Z	info	sds	Start SDS grpc server
2020-08-31T01:03:56.926708Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:03:56.926744Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:03:56.926783Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:56.927322Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:03:57.014127Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:57.427556Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:57.427612Z	info	sds	Dynamic push for secret default
2020-08-31T01:03:57.428150Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf9451c38-f453-456c-afa5-af35efd7b193.sock: use of closed network connection
2020-08-31T01:03:57.428264Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:57.428293Z	error	sds	Remote side closed connection
2020-08-31T01:03:57.428295Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:57.428331Z	error	sds	Remote side closed connection
2020-08-31T01:03:57.428402Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest37d31dbc-135f-42da-abf6-f0b57355ca89.sock" 

2020-08-31T01:03:57.428447Z	info	sds	Start SDS grpc server
2020-08-31T01:03:57.428701Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest37d31dbc-135f-42da-abf6-f0b57355ca89.sock: use of closed network connection
2020-08-31T01:03:57.428833Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesteb331c83-36ba-4833-a650-e24fea8bc8d9.sock" 

2020-08-31T01:03:57.428861Z	info	sds	Start SDS grpc server
2020-08-31T01:03:57.619830Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:57.619827Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:57.729763Z	info	sds	resource:default new connection
2020-08-31T01:03:57.729825Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:03:57.729890Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:57.730089Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:57.730127Z	error	sds	Remote side closed connection
2020-08-31T01:03:57.921578Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:57.923942Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:57.925899Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:58.031112Z	info	sds	resource:default new connection
2020-08-31T01:03:58.031176Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:03:58.031230Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:58.031507Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:58.031528Z	error	sds	Remote side closed connection
2020-08-31T01:03:58.031803Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesteb331c83-36ba-4833-a650-e24fea8bc8d9.sock: use of closed network connection
2020-08-31T01:03:58.031944Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest20997628-7799-407e-b49a-74b58397c696.sock" 

2020-08-31T01:03:58.031949Z	info	sds	Start SDS grpc server
2020-08-31T01:03:58.332939Z	info	sds	resource:default new connection
2020-08-31T01:03:58.333003Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:03:58.333059Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:03:58.333422Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:03:58.333448Z	error	sds	Remote side closed connection
2020-08-31T01:03:58.333759Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest20997628-7799-407e-b49a-74b58397c696.sock: use of closed network connection
2020-08-31T01:03:58.428358Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:58.428935Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:59.032033Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:59.198706Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:59.333969Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:03:59.501877Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:59.502644Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:59.804789Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:03:59.937185Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:03:59.937242Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:04:00.366847Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesteb4d5cce-84dd-4327-b265-78b48e66c05f.sock" 

2020-08-31T01:04:00.366902Z	info	sds	Start SDS grpc server
2020-08-31T01:04:00.409563Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:00.409561Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:00.428589Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:00.429020Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:00.712174Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:01.014380Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:01.032297Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:01.334169Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:01.367842Z	info	sds	resource:default new connection
2020-08-31T01:04:01.368637Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:04:01.377381Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:04:01.467957Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:04:01.468001Z	info	cache	GenerateSecret default
2020-08-31T01:04:01.468062Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:01.468429Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesteb4d5cce-84dd-4327-b265-78b48e66c05f.sock: use of closed network connection
PASS
2020-08-31T01:04:01.468548Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:01.468586Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.595s
2020-08-31T01:04:06.691460Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdce4e3fe-4735-44e9-87aa-12320e7c6ee2.sock" 

2020-08-31T01:04:06.691561Z	info	sds	Start SDS grpc server
2020-08-31T01:04:06.692888Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:04:06.692945Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:04:06.693349Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:07.692861Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:07.692935Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:04:08.693711Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:04:08.693845Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:04:08.693871Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:04:08.693942Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:08.694182Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdce4e3fe-4735-44e9-87aa-12320e7c6ee2.sock: use of closed network connection
2020-08-31T01:04:08.694337Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:08.694362Z	error	sds	Remote side closed connection
2020-08-31T01:04:08.694533Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cffde892-f6ec-45df-ac03-df3b7dbb9978\".sock" 

2020-08-31T01:04:08.694576Z	info	sds	Start SDS grpc server
2020-08-31T01:04:08.995790Z	info	sds	resource:default new connection
2020-08-31T01:04:08.995861Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:04:08.995936Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:08.996363Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:08.996390Z	error	sds	Remote side closed connection
2020-08-31T01:04:08.997304Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:04:08.997344Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:04:08.997492Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:04:08.997719Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:08.997753Z	error	sds	Remote side closed connection
2020-08-31T01:04:08.997974Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cffde892-f6ec-45df-ac03-df3b7dbb9978".sock: use of closed network connection
2020-08-31T01:04:08.998147Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"115de2cb-d3f7-4f63-ba5c-b8b163e7fb07\".sock" 

2020-08-31T01:04:08.998286Z	info	sds	Start SDS grpc server
2020-08-31T01:04:08.998807Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:04:08.998894Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:04:08.998937Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:04:08.999290Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:08.999324Z	error	sds	Remote side closed connection
2020-08-31T01:04:08.999593Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"115de2cb-d3f7-4f63-ba5c-b8b163e7fb07".sock: use of closed network connection
2020-08-31T01:04:08.999776Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7aabcae4-f039-4a26-b11b-afb60cc86eec\".sock" 

2020-08-31T01:04:08.999790Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:09.301167Z	info	sds	resource:default new connection
2020-08-31T01:04:09.301247Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:04:09.301324Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:09.301753Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:09.301777Z	error	sds	Remote side closed connection
2020-08-31T01:04:09.302015Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7aabcae4-f039-4a26-b11b-afb60cc86eec".sock: use of closed network connection
2020-08-31T01:04:09.302206Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9dca2a52-9e68-4a45-8adc-f2e0e1b0d610\".sock" 

2020-08-31T01:04:09.302301Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7ca81d13-1a55-4543-8b58-696389946e1f\".sock" 

2020-08-31T01:04:09.302336Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:09.302334Z	info	sds	Start SDS grpc server
2020-08-31T01:04:09.603528Z	info	sds	resource:default new connection
2020-08-31T01:04:09.603583Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:04:09.603636Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:09.603984Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:09.604010Z	error	sds	Remote side closed connection
2020-08-31T01:04:09.604814Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:04:09.604901Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:04:09.604969Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:04:09.605261Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:09.605286Z	error	sds	Remote side closed connection
2020-08-31T01:04:09.694447Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:09.906524Z	info	sds	resource:default new connection
2020-08-31T01:04:09.906593Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:04:09.906663Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:09.907045Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:09.907070Z	error	sds	Remote side closed connection
2020-08-31T01:04:09.907315Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9dca2a52-9e68-4a45-8adc-f2e0e1b0d610".sock: use of closed network connection
2020-08-31T01:04:09.907379Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7ca81d13-1a55-4543-8b58-696389946e1f".sock: use of closed network connection
2020-08-31T01:04:09.907572Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e71fb01e-49b8-438c-881a-0acb2645725c\".sock" 

2020-08-31T01:04:09.907598Z	info	sds	Start SDS grpc server
2020-08-31T01:04:09.998197Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:09.999841Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:04:10.210060Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e71fb01e-49b8-438c-881a-0acb2645725c".sock: use of closed network connection
2020-08-31T01:04:10.210302Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"534b8d8b-307e-4b37-bab5-7e5b5b4280de\".sock" 

2020-08-31T01:04:10.210339Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:10.302158Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:04:10.512116Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"534b8d8b-307e-4b37-bab5-7e5b5b4280de".sock: use of closed network connection
2020-08-31T01:04:10.512299Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesteb394537-166f-4320-8e49-3af2a2d0f219.sock" 

2020-08-31T01:04:10.512354Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e07757be-9f41-46da-8b7c-65ca25ac70e0\".sock" 

2020-08-31T01:04:10.512394Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:10.512393Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:04:10.907557Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:10.907557Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:04:11.117758Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesteb394537-166f-4320-8e49-3af2a2d0f219.sock: use of closed network connection
2020-08-31T01:04:11.117841Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e07757be-9f41-46da-8b7c-65ca25ac70e0".sock: use of closed network connection
2020-08-31T01:04:11.118109Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestadd74de0-9ad1-4521-800e-497a6a6c300c.sock" 

2020-08-31T01:04:11.118158Z	info	sds	Start SDS grpc server
2020-08-31T01:04:11.210389Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:11.419382Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:04:11.419525Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:11.419725Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestadd74de0-9ad1-4521-800e-497a6a6c300c.sock: use of closed network connection
2020-08-31T01:04:11.419986Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfa4e9d27-8999-4cd2-a737-4a743204272b.sock" 

2020-08-31T01:04:11.420057Z	info	sds	Start SDS grpc server
2020-08-31T01:04:11.420752Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:04:11.420819Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:04:11.420879Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:11.421015Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:04:11.421049Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:04:11.421084Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:04:11.512458Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:11.694708Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:11.998335Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:12.000166Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:12.118028Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:12.118085Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:12.302432Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:12.420008Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:12.421145Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:12.421190Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:04:12.907814Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:12.907893Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:13.210648Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:13.422026Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:13.422371Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfa4e9d27-8999-4cd2-a737-4a743204272b.sock: use of closed network connection
2020-08-31T01:04:13.422479Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:13.422510Z	error	sds	Remote side closed connection
2020-08-31T01:04:13.422528Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:13.422559Z	error	sds	Remote side closed connection
2020-08-31T01:04:13.422613Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb9c00915-db53-4cea-b8e2-e110d63cf6ac.sock" 

2020-08-31T01:04:13.422729Z	info	sds	Start SDS grpc server
2020-08-31T01:04:13.423512Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:04:13.423557Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:04:13.423614Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:13.424028Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:04:13.423613641 +0000 UTC m=+6.808636333 and is waiting for next SDS request
2020-08-31T01:04:13.424038Z	info	sds	Dynamic push for secret default
2020-08-31T01:04:13.424101Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb9c00915-db53-4cea-b8e2-e110d63cf6ac.sock: use of closed network connection
2020-08-31T01:04:13.424142Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:13.424162Z	error	sds	Remote side closed connection
2020-08-31T01:04:13.424204Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:13.424217Z	error	sds	Remote side closed connection
2020-08-31T01:04:13.424301Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5dc56cf7-55c7-4486-a59a-5894e17245ca.sock" 

2020-08-31T01:04:13.424398Z	info	sds	Start SDS grpc server
2020-08-31T01:04:13.426593Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:04:13.426735Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:04:13.426797Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:13.427988Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:04:13.512722Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:13.928132Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:13.928201Z	info	sds	Dynamic push for secret default
2020-08-31T01:04:13.928937Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5dc56cf7-55c7-4486-a59a-5894e17245ca.sock: use of closed network connection
2020-08-31T01:04:13.929018Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:13.929059Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:13.929047Z	error	sds	Remote side closed connection
2020-08-31T01:04:13.929092Z	error	sds	Remote side closed connection
2020-08-31T01:04:13.929194Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest46429f21-b52f-4fa9-8554-f6b5edce0487.sock" 

2020-08-31T01:04:13.929227Z	info	sds	Start SDS grpc server
2020-08-31T01:04:13.929452Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest46429f21-b52f-4fa9-8554-f6b5edce0487.sock: use of closed network connection
2020-08-31T01:04:13.929552Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5c77b8a6-3678-451e-8794-858ff02ee3cc.sock" 

2020-08-31T01:04:13.929571Z	info	sds	Start SDS grpc server
2020-08-31T01:04:14.118252Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:14.118315Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:14.230568Z	info	sds	resource:default new connection
2020-08-31T01:04:14.230647Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:04:14.230721Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:14.231105Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:14.231127Z	error	sds	Remote side closed connection
2020-08-31T01:04:14.420271Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:14.422444Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:14.424270Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:14.532230Z	info	sds	resource:default new connection
2020-08-31T01:04:14.532304Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:04:14.532447Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:14.532847Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:14.532874Z	error	sds	Remote side closed connection
2020-08-31T01:04:14.533131Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5c77b8a6-3678-451e-8794-858ff02ee3cc.sock: use of closed network connection
2020-08-31T01:04:14.533306Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta6d0014f-8337-4674-a987-62fa6499dcef.sock" 

2020-08-31T01:04:14.533390Z	info	sds	Start SDS grpc server
2020-08-31T01:04:14.834192Z	info	sds	resource:default new connection
2020-08-31T01:04:14.834257Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:04:14.834325Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:14.834628Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:14.834657Z	error	sds	Remote side closed connection
2020-08-31T01:04:14.834882Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta6d0014f-8337-4674-a987-62fa6499dcef.sock: use of closed network connection
2020-08-31T01:04:14.929130Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:14.929571Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:15.533350Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:15.694982Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:15.835070Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:04:15.998602Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:16.000391Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:16.302730Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:16.422686Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:16.424430Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:04:16.863162Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest98ddb132-cfa9-4e90-aa69-ee13f44c78c0.sock" 

2020-08-31T01:04:16.863213Z	info	sds	Start SDS grpc server
2020-08-31T01:04:16.908039Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:16.908094Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:16.929346Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:16.929723Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:17.210816Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:17.512972Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:17.533613Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:17.835295Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:17.864436Z	info	sds	resource:default new connection
2020-08-31T01:04:17.864515Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:04:17.871010Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:04:17.998375Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:04:17.998427Z	info	cache	GenerateSecret default
2020-08-31T01:04:17.998489Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:17.998856Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest98ddb132-cfa9-4e90-aa69-ee13f44c78c0.sock: use of closed network connection
PASS
2020-08-31T01:04:17.998945Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:17.998964Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.629s
2020-08-31T01:04:23.207315Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcc3e1ef2-7bd8-411c-ac32-83b522456ef8.sock" 

2020-08-31T01:04:23.207417Z	info	sds	Start SDS grpc server
2020-08-31T01:04:23.208602Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:04:23.208689Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:04:23.209119Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:24.208510Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:24.208573Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:04:25.209474Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:04:25.209555Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:04:25.209578Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:04:25.209632Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:25.209905Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcc3e1ef2-7bd8-411c-ac32-83b522456ef8.sock: use of closed network connection
2020-08-31T01:04:25.210035Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:25.210060Z	error	sds	Remote side closed connection
2020-08-31T01:04:25.210177Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"541484ec-5807-4f0d-83c7-cd1f1fde4f2a\".sock" 

2020-08-31T01:04:25.210225Z	info	sds	Start SDS grpc server
2020-08-31T01:04:25.511335Z	info	sds	resource:default new connection
2020-08-31T01:04:25.511393Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:04:25.511455Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:25.511767Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:25.511794Z	error	sds	Remote side closed connection
2020-08-31T01:04:25.512487Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:04:25.512521Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:04:25.512719Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:04:25.513000Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:25.513028Z	error	sds	Remote side closed connection
2020-08-31T01:04:25.513318Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"541484ec-5807-4f0d-83c7-cd1f1fde4f2a".sock: use of closed network connection
2020-08-31T01:04:25.513519Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"260d8edd-e841-4999-a40b-a2c8abb64156\".sock" 

2020-08-31T01:04:25.513586Z	info	sds	Start SDS grpc server
2020-08-31T01:04:25.514027Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:04:25.514057Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:04:25.514095Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:04:25.514284Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:25.514294Z	error	sds	Remote side closed connection
2020-08-31T01:04:25.514544Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"260d8edd-e841-4999-a40b-a2c8abb64156".sock: use of closed network connection
2020-08-31T01:04:25.514697Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4111de17-ae87-4836-adf3-b098ede4f0a1\".sock" 

2020-08-31T01:04:25.514715Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:25.816145Z	info	sds	resource:default new connection
2020-08-31T01:04:25.816220Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:04:25.816286Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:25.816543Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:25.816568Z	error	sds	Remote side closed connection
2020-08-31T01:04:25.816819Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4111de17-ae87-4836-adf3-b098ede4f0a1".sock: use of closed network connection
2020-08-31T01:04:25.817038Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c3e53c21-9714-49cf-90bf-c25cb1334eed\".sock" 

2020-08-31T01:04:25.817095Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0407ac9c-d9a2-4888-8b69-3df1b71ddd47\".sock" 

2020-08-31T01:04:25.817088Z	info	sds	Start SDS grpc server
2020-08-31T01:04:25.817136Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:26.118135Z	info	sds	resource:default new connection
2020-08-31T01:04:26.118191Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:04:26.118252Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:26.118534Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:26.118591Z	error	sds	Remote side closed connection
2020-08-31T01:04:26.119056Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:04:26.119156Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:04:26.119196Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:04:26.119452Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:26.119466Z	error	sds	Remote side closed connection
2020-08-31T01:04:26.210091Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:26.420616Z	info	sds	resource:default new connection
2020-08-31T01:04:26.420692Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:04:26.420757Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:26.420962Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:26.421033Z	error	sds	Remote side closed connection
2020-08-31T01:04:26.421213Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c3e53c21-9714-49cf-90bf-c25cb1334eed".sock: use of closed network connection
2020-08-31T01:04:26.421254Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0407ac9c-d9a2-4888-8b69-3df1b71ddd47".sock: use of closed network connection
2020-08-31T01:04:26.421423Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"13aa143e-25a5-41c6-a3b4-428492a0d210\".sock" 

2020-08-31T01:04:26.421444Z	info	sds	Start SDS grpc server
2020-08-31T01:04:26.513538Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:26.514690Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:04:26.723753Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"13aa143e-25a5-41c6-a3b4-428492a0d210".sock: use of closed network connection
2020-08-31T01:04:26.723986Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5a553cbc-20ed-4ba1-aa0d-77a2215766f1\".sock" 

2020-08-31T01:04:26.724021Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:26.817029Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:04:27.025873Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5a553cbc-20ed-4ba1-aa0d-77a2215766f1".sock: use of closed network connection
2020-08-31T01:04:27.026091Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1540e71e-cc76-4971-8a79-5a8c2c352414.sock" 

2020-08-31T01:04:27.026114Z	info	sds	Start SDS grpc server
2020-08-31T01:04:27.026154Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"76408e5f-ffd4-4e62-9ca6-e679c84d21df\".sock" 

2020-08-31T01:04:27.026191Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:04:27.421478Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:27.421463Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:04:27.630279Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1540e71e-cc76-4971-8a79-5a8c2c352414.sock: use of closed network connection
2020-08-31T01:04:27.630354Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"76408e5f-ffd4-4e62-9ca6-e679c84d21df".sock: use of closed network connection
2020-08-31T01:04:27.630555Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest2ff88712-732a-40bf-9f7a-5607e5ff24d2.sock" 

2020-08-31T01:04:27.630575Z	info	sds	Start SDS grpc server
2020-08-31T01:04:27.723948Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:27.932009Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:04:27.932101Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:27.932305Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest2ff88712-732a-40bf-9f7a-5607e5ff24d2.sock: use of closed network connection
2020-08-31T01:04:27.932499Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3753650c-9f84-4459-a55d-50301f24e986.sock" 

2020-08-31T01:04:27.932519Z	info	sds	Start SDS grpc server
2020-08-31T01:04:27.933199Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:04:27.933248Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:04:27.933297Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:27.933427Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:04:27.933477Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:04:27.933520Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:04:28.026107Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:28.210358Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:28.513828Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:28.514844Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:28.630529Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:28.630567Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:28.817325Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:28.932557Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:28.933549Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:28.933576Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:04:29.421747Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:29.421776Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:29.724187Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:29.934459Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:29.934824Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3753650c-9f84-4459-a55d-50301f24e986.sock: use of closed network connection
2020-08-31T01:04:29.934854Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:29.934888Z	error	sds	Remote side closed connection
2020-08-31T01:04:29.934956Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:29.934985Z	error	sds	Remote side closed connection
2020-08-31T01:04:29.935153Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb931c25b-0f07-4d40-8e9d-07db5fca7bbc.sock" 

2020-08-31T01:04:29.935224Z	info	sds	Start SDS grpc server
2020-08-31T01:04:29.936529Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:04:29.936607Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:04:29.936704Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:29.937576Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:04:29.936703125 +0000 UTC m=+6.806661141 and is waiting for next SDS request
2020-08-31T01:04:29.937613Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb931c25b-0f07-4d40-8e9d-07db5fca7bbc.sock: use of closed network connection
2020-08-31T01:04:29.937660Z	info	sds	Dynamic push for secret default
2020-08-31T01:04:29.937897Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:29.937887Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:29.937945Z	error	sds	Remote side closed connection
2020-08-31T01:04:29.937968Z	error	sds	Remote side closed connection
2020-08-31T01:04:29.938518Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest028f7d86-cfe4-402e-b7c1-ea50cab133a4.sock" 

2020-08-31T01:04:29.938605Z	info	sds	Start SDS grpc server
2020-08-31T01:04:29.939351Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:04:29.939418Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:04:29.939469Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:29.940272Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:04:30.026380Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:30.440521Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:30.440584Z	info	sds	Dynamic push for secret default
2020-08-31T01:04:30.441313Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest028f7d86-cfe4-402e-b7c1-ea50cab133a4.sock: use of closed network connection
2020-08-31T01:04:30.441434Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:30.441468Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:30.441492Z	error	sds	Remote side closed connection
2020-08-31T01:04:30.441470Z	error	sds	Remote side closed connection
2020-08-31T01:04:30.441608Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7af28de3-f9b6-4e87-808c-8ca0bfd09726.sock" 

2020-08-31T01:04:30.441685Z	info	sds	Start SDS grpc server
2020-08-31T01:04:30.441909Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7af28de3-f9b6-4e87-808c-8ca0bfd09726.sock: use of closed network connection
2020-08-31T01:04:30.442006Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9a01a92f-b205-4f02-8688-92004b298e19.sock" 

2020-08-31T01:04:30.442030Z	info	sds	Start SDS grpc server
2020-08-31T01:04:30.630795Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:30.630848Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:30.742883Z	info	sds	resource:default new connection
2020-08-31T01:04:30.742969Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:04:30.743036Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:30.743324Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:30.743348Z	error	sds	Remote side closed connection
2020-08-31T01:04:30.932821Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:30.935000Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:30.937875Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:31.044515Z	info	sds	resource:default new connection
2020-08-31T01:04:31.044582Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:04:31.044639Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:31.045053Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:31.045070Z	error	sds	Remote side closed connection
2020-08-31T01:04:31.045248Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9a01a92f-b205-4f02-8688-92004b298e19.sock: use of closed network connection
2020-08-31T01:04:31.045399Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest457cb799-543a-46a3-a8f6-c40e0d5083ed.sock" 

2020-08-31T01:04:31.045412Z	info	sds	Start SDS grpc server
2020-08-31T01:04:31.346332Z	info	sds	resource:default new connection
2020-08-31T01:04:31.346388Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:04:31.346475Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:31.346746Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:31.346789Z	error	sds	Remote side closed connection
2020-08-31T01:04:31.347085Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest457cb799-543a-46a3-a8f6-c40e0d5083ed.sock: use of closed network connection
2020-08-31T01:04:31.441600Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:31.442036Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:32.045473Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:32.210608Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:32.347291Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:04:32.514069Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:32.515030Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:32.817604Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:32.935250Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:32.938104Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:04:33.375987Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta616fef1-01ef-40cb-a972-a7be668b0349.sock" 

2020-08-31T01:04:33.376039Z	info	sds	Start SDS grpc server
2020-08-31T01:04:33.422027Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:33.422080Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:33.441819Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:33.442173Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:33.724431Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:34.026654Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:34.045722Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:34.347538Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:34.376889Z	info	sds	resource:default new connection
2020-08-31T01:04:34.376956Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:04:34.381491Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:04:34.478074Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:04:34.478119Z	info	cache	GenerateSecret default
2020-08-31T01:04:34.478622Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:34.478960Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta616fef1-01ef-40cb-a972-a7be668b0349.sock: use of closed network connection
PASS
2020-08-31T01:04:34.479031Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.595s
2020-08-31T01:04:39.760249Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest87c734aa-ecd5-4ba9-b50a-878440309510.sock" 

2020-08-31T01:04:39.760343Z	info	sds	Start SDS grpc server
2020-08-31T01:04:39.761601Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:04:39.761658Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:04:39.762061Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:40.761614Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:40.761677Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:04:41.762352Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:04:41.762438Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:04:41.762462Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:04:41.762534Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:41.762724Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest87c734aa-ecd5-4ba9-b50a-878440309510.sock: use of closed network connection
2020-08-31T01:04:41.762890Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:41.762940Z	error	sds	Remote side closed connection
2020-08-31T01:04:41.763032Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"19867591-4034-4986-8236-57473fb7ba53\".sock" 

2020-08-31T01:04:41.763073Z	info	sds	Start SDS grpc server
2020-08-31T01:04:42.064046Z	info	sds	resource:default new connection
2020-08-31T01:04:42.064103Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:04:42.064162Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:42.064405Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:42.064417Z	error	sds	Remote side closed connection
2020-08-31T01:04:42.065557Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:04:42.065616Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:04:42.065773Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:04:42.066026Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:42.066053Z	error	sds	Remote side closed connection
2020-08-31T01:04:42.066293Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"19867591-4034-4986-8236-57473fb7ba53".sock: use of closed network connection
2020-08-31T01:04:42.066582Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"af132963-9861-4eef-b55f-0f8dd4f822a1\".sock" 

2020-08-31T01:04:42.066677Z	info	sds	Start SDS grpc server
2020-08-31T01:04:42.067132Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:04:42.067161Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:04:42.067194Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:04:42.067525Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:42.067556Z	error	sds	Remote side closed connection
2020-08-31T01:04:42.067776Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"af132963-9861-4eef-b55f-0f8dd4f822a1".sock: use of closed network connection
2020-08-31T01:04:42.067966Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e3499a1e-31f3-4904-bce6-1d9cad0d8087\".sock" 

2020-08-31T01:04:42.068003Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:42.369146Z	info	sds	resource:default new connection
2020-08-31T01:04:42.369199Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:04:42.369249Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:42.369575Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:42.369604Z	error	sds	Remote side closed connection
2020-08-31T01:04:42.369815Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e3499a1e-31f3-4904-bce6-1d9cad0d8087".sock: use of closed network connection
2020-08-31T01:04:42.370011Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"eca41062-a2b3-4c08-be86-7e58a19c4f84\".sock" 

2020-08-31T01:04:42.370063Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2668f54f-a897-40f3-a3ff-8d55c2538d91\".sock" 

2020-08-31T01:04:42.370086Z	info	sds	Start SDS grpc server
2020-08-31T01:04:42.370104Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:42.670993Z	info	sds	resource:default new connection
2020-08-31T01:04:42.671047Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:04:42.671097Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:42.671393Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:42.671430Z	error	sds	Remote side closed connection
2020-08-31T01:04:42.672113Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:04:42.672148Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:04:42.672205Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:04:42.672514Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:42.672537Z	error	sds	Remote side closed connection
2020-08-31T01:04:42.762912Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:42.973550Z	info	sds	resource:default new connection
2020-08-31T01:04:42.973615Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:04:42.973690Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:42.973939Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:42.973966Z	error	sds	Remote side closed connection
2020-08-31T01:04:42.974305Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"eca41062-a2b3-4c08-be86-7e58a19c4f84".sock: use of closed network connection
2020-08-31T01:04:42.974348Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2668f54f-a897-40f3-a3ff-8d55c2538d91".sock: use of closed network connection
2020-08-31T01:04:42.974551Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"592c4183-cd2c-4128-be19-f64dbbc7fade\".sock" 

2020-08-31T01:04:42.974574Z	info	sds	Start SDS grpc server
2020-08-31T01:04:43.066519Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:43.068004Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:04:43.279354Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"592c4183-cd2c-4128-be19-f64dbbc7fade".sock: use of closed network connection
2020-08-31T01:04:43.279645Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e5d2863d-be97-4475-8cf1-58c6e3639140\".sock" 

2020-08-31T01:04:43.279673Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:43.370034Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:04:43.581187Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e5d2863d-be97-4475-8cf1-58c6e3639140".sock: use of closed network connection
2020-08-31T01:04:43.581460Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest3358f305-ac31-4156-966f-987d7a0cdd63.sock" 

2020-08-31T01:04:43.581523Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"76373c85-6aad-4504-a1c5-8cd30350625d\".sock" 

2020-08-31T01:04:43.581553Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:43.581539Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:04:43.974538Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:43.974557Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:04:44.185487Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest3358f305-ac31-4156-966f-987d7a0cdd63.sock: use of closed network connection
2020-08-31T01:04:44.185545Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"76373c85-6aad-4504-a1c5-8cd30350625d".sock: use of closed network connection
2020-08-31T01:04:44.185734Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest3646c639-e696-4f63-b298-8d54d90e29c8.sock" 

2020-08-31T01:04:44.185758Z	info	sds	Start SDS grpc server
2020-08-31T01:04:44.279445Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:44.493509Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:04:44.493625Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:44.493852Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest3646c639-e696-4f63-b298-8d54d90e29c8.sock: use of closed network connection
2020-08-31T01:04:44.494098Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc57e12c1-70cf-434a-aae4-f6dfabce49ef.sock" 

2020-08-31T01:04:44.494186Z	info	sds	Start SDS grpc server
2020-08-31T01:04:44.495033Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:04:44.495099Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:04:44.495181Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:44.495417Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:04:44.495469Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:04:44.495511Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:04:44.581435Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:44.763144Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:45.066641Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:45.068208Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:45.185718Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:45.185772Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:45.370304Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:45.494130Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:45.495536Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:45.495571Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:04:45.974764Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:45.974795Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:46.279695Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:46.496261Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:46.496601Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc57e12c1-70cf-434a-aae4-f6dfabce49ef.sock: use of closed network connection
2020-08-31T01:04:46.496609Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:46.496641Z	error	sds	Remote side closed connection
2020-08-31T01:04:46.496724Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:46.496737Z	error	sds	Remote side closed connection
2020-08-31T01:04:46.496883Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest302a7ba1-fa89-4d11-8c30-15e901600247.sock" 

2020-08-31T01:04:46.496958Z	info	sds	Start SDS grpc server
2020-08-31T01:04:46.497735Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:04:46.497778Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:04:46.497822Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:46.498465Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:04:46.497821783 +0000 UTC m=+6.813640650 and is waiting for next SDS request
2020-08-31T01:04:46.498486Z	info	sds	Dynamic push for secret default
2020-08-31T01:04:46.498521Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest302a7ba1-fa89-4d11-8c30-15e901600247.sock: use of closed network connection
2020-08-31T01:04:46.498580Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:46.498599Z	error	sds	Remote side closed connection
2020-08-31T01:04:46.498639Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:46.498660Z	error	sds	Remote side closed connection
2020-08-31T01:04:46.498763Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest12da4ebf-ff4c-4dc0-9797-f79ae58c6777.sock" 

2020-08-31T01:04:46.498779Z	info	sds	Start SDS grpc server
2020-08-31T01:04:46.499496Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:04:46.499532Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:04:46.499565Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:46.500209Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:04:46.581676Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:47.000361Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:47.000419Z	info	sds	Dynamic push for secret default
2020-08-31T01:04:47.001083Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest12da4ebf-ff4c-4dc0-9797-f79ae58c6777.sock: use of closed network connection
2020-08-31T01:04:47.001174Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:47.001208Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:47.001202Z	error	sds	Remote side closed connection
2020-08-31T01:04:47.001238Z	error	sds	Remote side closed connection
2020-08-31T01:04:47.001320Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5dd8c197-deb6-49ce-a029-0aff6588a79f.sock" 

2020-08-31T01:04:47.001367Z	info	sds	Start SDS grpc server
2020-08-31T01:04:47.001553Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5dd8c197-deb6-49ce-a029-0aff6588a79f.sock: use of closed network connection
2020-08-31T01:04:47.001640Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcbbaac50-5f66-4042-887d-f4840a98e1c8.sock" 

2020-08-31T01:04:47.001653Z	info	sds	Start SDS grpc server
2020-08-31T01:04:47.185962Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:47.186013Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:47.302686Z	info	sds	resource:default new connection
2020-08-31T01:04:47.302768Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:04:47.302839Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:47.303118Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:47.303144Z	error	sds	Remote side closed connection
2020-08-31T01:04:47.494355Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:47.496788Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:47.498697Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:47.604251Z	info	sds	resource:default new connection
2020-08-31T01:04:47.604315Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:04:47.604367Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:47.604614Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:47.604632Z	error	sds	Remote side closed connection
2020-08-31T01:04:47.604986Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcbbaac50-5f66-4042-887d-f4840a98e1c8.sock: use of closed network connection
2020-08-31T01:04:47.605132Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0a1a582f-154d-4d68-8ebe-5ef3d317afa0.sock" 

2020-08-31T01:04:47.605183Z	info	sds	Start SDS grpc server
2020-08-31T01:04:47.906134Z	info	sds	resource:default new connection
2020-08-31T01:04:47.906204Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:04:47.906262Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:47.906554Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:47.906586Z	error	sds	Remote side closed connection
2020-08-31T01:04:47.906820Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0a1a582f-154d-4d68-8ebe-5ef3d317afa0.sock: use of closed network connection
2020-08-31T01:04:48.001309Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:48.001616Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:48.605202Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:48.763410Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:48.907037Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:04:49.066920Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:49.068426Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:49.370572Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:49.497015Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:49.498877Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:04:49.940158Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf16a2991-0560-40da-9eb6-fff022cde4a5.sock" 

2020-08-31T01:04:49.940211Z	info	sds	Start SDS grpc server
2020-08-31T01:04:49.975034Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:49.975107Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:50.001552Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:50.001701Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:50.279940Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:50.581867Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:04:50.605461Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:50.907272Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:50.941173Z	info	sds	resource:default new connection
2020-08-31T01:04:50.941242Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:04:50.944880Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:04:51.085409Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:04:51.085457Z	info	cache	GenerateSecret default
2020-08-31T01:04:51.085522Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:51.085919Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf16a2991-0560-40da-9eb6-fff022cde4a5.sock: use of closed network connection
PASS
2020-08-31T01:04:51.086003Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:51.086026Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.657s
2020-08-31T01:04:56.346725Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9c08a73d-f270-4f02-abf2-ca47941f6a93.sock" 

2020-08-31T01:04:56.346762Z	info	sds	Start SDS grpc server
2020-08-31T01:04:56.348193Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:04:56.348260Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:04:56.348720Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:57.347979Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:57.348061Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:04:58.348608Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:04:58.348791Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:04:58.348828Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:04:58.348889Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:58.349117Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9c08a73d-f270-4f02-abf2-ca47941f6a93.sock: use of closed network connection
2020-08-31T01:04:58.349290Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:58.349317Z	error	sds	Remote side closed connection
2020-08-31T01:04:58.349419Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c8c87b5e-bef6-4fc4-a3bb-fd76c973f4fa\".sock" 

2020-08-31T01:04:58.349450Z	info	sds	Start SDS grpc server
2020-08-31T01:04:58.650671Z	info	sds	resource:default new connection
2020-08-31T01:04:58.650752Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:04:58.650821Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:58.651211Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:58.651228Z	error	sds	Remote side closed connection
2020-08-31T01:04:58.651890Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:04:58.651940Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:04:58.652128Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:04:58.652505Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:58.652531Z	error	sds	Remote side closed connection
2020-08-31T01:04:58.652631Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c8c87b5e-bef6-4fc4-a3bb-fd76c973f4fa".sock: use of closed network connection
2020-08-31T01:04:58.652887Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"29fe0e67-1a9c-48d6-9d76-23d6c6ea026f\".sock" 

2020-08-31T01:04:58.652964Z	info	sds	Start SDS grpc server
2020-08-31T01:04:58.653534Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:04:58.653563Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:04:58.653600Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:04:58.653800Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:58.653845Z	error	sds	Remote side closed connection
2020-08-31T01:04:58.653984Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"29fe0e67-1a9c-48d6-9d76-23d6c6ea026f".sock: use of closed network connection
2020-08-31T01:04:58.654167Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f21f3ccb-335e-4c93-8878-f0d541212989\".sock" 

2020-08-31T01:04:58.654200Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:58.955152Z	info	sds	resource:default new connection
2020-08-31T01:04:58.955224Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:04:58.955294Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:58.955762Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:58.955803Z	error	sds	Remote side closed connection
2020-08-31T01:04:58.956020Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f21f3ccb-335e-4c93-8878-f0d541212989".sock: use of closed network connection
2020-08-31T01:04:58.956227Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f30b1a51-aab6-4381-8e2c-4b78c988cabd\".sock" 

2020-08-31T01:04:58.956296Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8209c8e7-fa53-4dbe-a1b8-f09d08994dda\".sock" 

2020-08-31T01:04:58.956320Z	info	sds	Start SDS grpc server
2020-08-31T01:04:58.956334Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:59.257388Z	info	sds	resource:default new connection
2020-08-31T01:04:59.257446Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:04:59.257501Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:59.257804Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:59.257834Z	error	sds	Remote side closed connection
2020-08-31T01:04:59.258528Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:04:59.258567Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:04:59.258612Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:04:59.258962Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:59.258992Z	error	sds	Remote side closed connection
2020-08-31T01:04:59.349313Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:59.560134Z	info	sds	resource:default new connection
2020-08-31T01:04:59.560199Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:04:59.560261Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:04:59.560583Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:04:59.560621Z	error	sds	Remote side closed connection
2020-08-31T01:04:59.560819Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f30b1a51-aab6-4381-8e2c-4b78c988cabd".sock: use of closed network connection
2020-08-31T01:04:59.560871Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8209c8e7-fa53-4dbe-a1b8-f09d08994dda".sock: use of closed network connection
2020-08-31T01:04:59.561136Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e5908fe4-a30b-4ad3-9e93-e2eec63f4580\".sock" 

2020-08-31T01:04:59.561164Z	info	sds	Start SDS grpc server
2020-08-31T01:04:59.652776Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:04:59.654135Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:04:59.864168Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e5908fe4-a30b-4ad3-9e93-e2eec63f4580".sock: use of closed network connection
2020-08-31T01:04:59.864387Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"20d417da-b47a-42da-8485-c86515d2b55e\".sock" 

2020-08-31T01:04:59.864401Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:04:59.956183Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:05:00.166019Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"20d417da-b47a-42da-8485-c86515d2b55e".sock: use of closed network connection
2020-08-31T01:05:00.166205Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestbf65a062-e4ae-4bb1-9b1c-786f72dd216a.sock" 

2020-08-31T01:05:00.166294Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1a893b80-f7b3-4a98-b807-e19154827909\".sock" 

2020-08-31T01:05:00.166327Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:00.166326Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:05:00.561012Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:00.561011Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:05:00.770904Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestbf65a062-e4ae-4bb1-9b1c-786f72dd216a.sock: use of closed network connection
2020-08-31T01:05:00.770967Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1a893b80-f7b3-4a98-b807-e19154827909".sock: use of closed network connection
2020-08-31T01:05:00.771133Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest442d1dd4-3add-479b-a5e4-404e48d1c1d9.sock" 

2020-08-31T01:05:00.771155Z	info	sds	Start SDS grpc server
2020-08-31T01:05:00.864408Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:01.072392Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:05:01.072504Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:01.072813Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest442d1dd4-3add-479b-a5e4-404e48d1c1d9.sock: use of closed network connection
2020-08-31T01:05:01.073047Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestac0fe9a8-7769-4cb0-b040-563305fe0576.sock" 

2020-08-31T01:05:01.073072Z	info	sds	Start SDS grpc server
2020-08-31T01:05:01.075454Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:05:01.075579Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:05:01.075693Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:05:01.087215Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:05:01.087342Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:05:01.087398Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:01.166203Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:01.349618Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:01.653003Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:01.654299Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:01.771136Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:01.771181Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:01.956466Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:02.073038Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:02.087284Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:02.087383Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:05:02.561339Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:02.561363Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:02.864725Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:03.088125Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:03.088543Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestac0fe9a8-7769-4cb0-b040-563305fe0576.sock: use of closed network connection
2020-08-31T01:05:03.088597Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:03.088624Z	error	sds	Remote side closed connection
2020-08-31T01:05:03.088686Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:03.088710Z	error	sds	Remote side closed connection
2020-08-31T01:05:03.088879Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8a3447b7-ef4c-4273-8fda-b8e4623ffbcd.sock" 

2020-08-31T01:05:03.088956Z	info	sds	Start SDS grpc server
2020-08-31T01:05:03.089756Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:05:03.089816Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:05:03.089867Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:03.090428Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:05:03.08986714 +0000 UTC m=+6.819262019 and is waiting for next SDS request
2020-08-31T01:05:03.090448Z	info	sds	Dynamic push for secret default
2020-08-31T01:05:03.090483Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8a3447b7-ef4c-4273-8fda-b8e4623ffbcd.sock: use of closed network connection
2020-08-31T01:05:03.090564Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:03.090582Z	error	sds	Remote side closed connection
2020-08-31T01:05:03.090633Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:03.090663Z	error	sds	Remote side closed connection
2020-08-31T01:05:03.090702Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest82a49fce-ae58-443a-9960-8fd8b285e226.sock" 

2020-08-31T01:05:03.090712Z	info	sds	Start SDS grpc server
2020-08-31T01:05:03.091558Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:05:03.091598Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:05:03.091636Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:03.092159Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:05:03.166331Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:03.592429Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:03.592481Z	info	sds	Dynamic push for secret default
2020-08-31T01:05:03.593141Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest82a49fce-ae58-443a-9960-8fd8b285e226.sock: use of closed network connection
2020-08-31T01:05:03.593250Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:03.593246Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:03.593281Z	error	sds	Remote side closed connection
2020-08-31T01:05:03.593293Z	error	sds	Remote side closed connection
2020-08-31T01:05:03.593391Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0215d639-e098-49eb-86f5-0742925846e0.sock" 

2020-08-31T01:05:03.593398Z	info	sds	Start SDS grpc server
2020-08-31T01:05:03.593623Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0215d639-e098-49eb-86f5-0742925846e0.sock: use of closed network connection
2020-08-31T01:05:03.593701Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest86541e00-69c1-42c9-96bc-71259838d89d.sock" 

2020-08-31T01:05:03.593713Z	info	sds	Start SDS grpc server
2020-08-31T01:05:03.771412Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:03.771454Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:03.894606Z	info	sds	resource:default new connection
2020-08-31T01:05:03.894660Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:05:03.894712Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:03.895011Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:03.895038Z	error	sds	Remote side closed connection
2020-08-31T01:05:04.073298Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:04.088732Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:04.090681Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:04.196265Z	info	sds	resource:default new connection
2020-08-31T01:05:04.196334Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:05:04.196389Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:04.196873Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:04.196899Z	error	sds	Remote side closed connection
2020-08-31T01:05:04.197161Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest86541e00-69c1-42c9-96bc-71259838d89d.sock: use of closed network connection
2020-08-31T01:05:04.197287Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4427de32-d7a1-4bd1-b42b-72b768138035.sock" 

2020-08-31T01:05:04.197328Z	info	sds	Start SDS grpc server
2020-08-31T01:05:04.498195Z	info	sds	resource:default new connection
2020-08-31T01:05:04.498255Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:05:04.498313Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:04.498632Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:04.498658Z	error	sds	Remote side closed connection
2020-08-31T01:05:04.498849Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4427de32-d7a1-4bd1-b42b-72b768138035.sock: use of closed network connection
2020-08-31T01:05:04.593388Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:04.593703Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:05.197374Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:05.349884Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:05.499083Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:05:05.653278Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:05.654523Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:05.956734Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:06.089015Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:06.090846Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:05:06.528757Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestacb5d503-8b9f-487e-b563-7662b0c5fdb2.sock" 

2020-08-31T01:05:06.528809Z	info	sds	Start SDS grpc server
2020-08-31T01:05:06.561644Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:06.561696Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:06.593659Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:06.593818Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:06.864909Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:07.166605Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:07.197669Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:07.499345Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:07.530270Z	info	sds	resource:default new connection
2020-08-31T01:05:07.530362Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:05:07.536296Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:05:07.649932Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:05:07.649981Z	info	cache	GenerateSecret default
2020-08-31T01:05:07.650043Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:07.650407Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestacb5d503-8b9f-487e-b563-7662b0c5fdb2.sock: use of closed network connection
PASS
2020-08-31T01:05:07.650503Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:07.650528Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.626s
2020-08-31T01:05:12.933053Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestccb44f3b-d4b9-4919-98b2-1e262a913e9d.sock" 

2020-08-31T01:05:12.933089Z	info	sds	Start SDS grpc server
2020-08-31T01:05:12.934591Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:05:12.934666Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:05:12.935109Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:13.934440Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:13.934506Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:05:14.935079Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:05:14.935152Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:05:14.935176Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:05:14.935237Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:14.935460Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestccb44f3b-d4b9-4919-98b2-1e262a913e9d.sock: use of closed network connection
2020-08-31T01:05:14.935674Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:14.935690Z	error	sds	Remote side closed connection
2020-08-31T01:05:14.935754Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d6e978d2-b524-4a8a-9b16-002ca0db2baa\".sock" 

2020-08-31T01:05:14.935816Z	info	sds	Start SDS grpc server
2020-08-31T01:05:15.236691Z	info	sds	resource:default new connection
2020-08-31T01:05:15.236765Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:05:15.236829Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:15.237204Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:15.237220Z	error	sds	Remote side closed connection
2020-08-31T01:05:15.237636Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:05:15.237684Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:05:15.237853Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:05:15.238124Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:15.238152Z	error	sds	Remote side closed connection
2020-08-31T01:05:15.238377Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d6e978d2-b524-4a8a-9b16-002ca0db2baa".sock: use of closed network connection
2020-08-31T01:05:15.238586Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e2fa98ae-9494-423c-8e4e-1a53af287537\".sock" 

2020-08-31T01:05:15.238619Z	info	sds	Start SDS grpc server
2020-08-31T01:05:15.239636Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:05:15.239676Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:05:15.239717Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:05:15.239984Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:15.240013Z	error	sds	Remote side closed connection
2020-08-31T01:05:15.240362Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e2fa98ae-9494-423c-8e4e-1a53af287537".sock: use of closed network connection
2020-08-31T01:05:15.240565Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"84494f17-52f6-41f0-8638-fd18526cb69b\".sock" 

2020-08-31T01:05:15.240606Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:15.541614Z	info	sds	resource:default new connection
2020-08-31T01:05:15.541671Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:05:15.541743Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:15.541987Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:15.542033Z	error	sds	Remote side closed connection
2020-08-31T01:05:15.542264Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"84494f17-52f6-41f0-8638-fd18526cb69b".sock: use of closed network connection
2020-08-31T01:05:15.542481Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"87f18744-74ac-490d-acea-069df5894d49\".sock" 

2020-08-31T01:05:15.542552Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"09bbe375-ddf0-4757-895b-0c483a2658b7\".sock" 

2020-08-31T01:05:15.542554Z	info	sds	Start SDS grpc server
2020-08-31T01:05:15.542580Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:15.843616Z	info	sds	resource:default new connection
2020-08-31T01:05:15.843686Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:05:15.843740Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:15.844086Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:15.844123Z	error	sds	Remote side closed connection
2020-08-31T01:05:15.844612Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:05:15.844641Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:05:15.844740Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:05:15.844991Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:15.845017Z	error	sds	Remote side closed connection
2020-08-31T01:05:15.935721Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:16.146222Z	info	sds	resource:default new connection
2020-08-31T01:05:16.146331Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:05:16.146399Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:16.146705Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:16.146723Z	error	sds	Remote side closed connection
2020-08-31T01:05:16.146981Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"87f18744-74ac-490d-acea-069df5894d49".sock: use of closed network connection
2020-08-31T01:05:16.147033Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"09bbe375-ddf0-4757-895b-0c483a2658b7".sock: use of closed network connection
2020-08-31T01:05:16.147299Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"36d5fd01-5a00-4b2b-8a89-b9919d232d03\".sock" 

2020-08-31T01:05:16.147333Z	info	sds	Start SDS grpc server
2020-08-31T01:05:16.238565Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:16.240548Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:05:16.449843Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"36d5fd01-5a00-4b2b-8a89-b9919d232d03".sock: use of closed network connection
2020-08-31T01:05:16.450021Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bd9bbb5e-a0ca-4edb-aba1-e3277f6c84ce\".sock" 

2020-08-31T01:05:16.450043Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:16.542475Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:05:16.751640Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bd9bbb5e-a0ca-4edb-aba1-e3277f6c84ce".sock: use of closed network connection
2020-08-31T01:05:16.751844Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest4823e9fd-a01b-4284-b7f9-5fac81a26025.sock" 

2020-08-31T01:05:16.751917Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"31360d8f-9890-4270-9f12-356f22d3077b\".sock" 

2020-08-31T01:05:16.751950Z	info	sds	Start SDS grpc server
2020-08-31T01:05:16.751977Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:05:17.147209Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:17.147251Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:05:17.357458Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest4823e9fd-a01b-4284-b7f9-5fac81a26025.sock: use of closed network connection
2020-08-31T01:05:17.357513Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"31360d8f-9890-4270-9f12-356f22d3077b".sock: use of closed network connection
2020-08-31T01:05:17.357683Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest45cb9272-e303-4a5c-8d0d-1892e4f1bc10.sock" 

2020-08-31T01:05:17.357712Z	info	sds	Start SDS grpc server
2020-08-31T01:05:17.450057Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:17.658658Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:05:17.658763Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:17.658993Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest45cb9272-e303-4a5c-8d0d-1892e4f1bc10.sock: use of closed network connection
2020-08-31T01:05:17.659194Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd837b061-25ba-4e0e-99c1-e701478a92c0.sock" 

2020-08-31T01:05:17.659207Z	info	sds	Start SDS grpc server
2020-08-31T01:05:17.659926Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:05:17.659968Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:05:17.660013Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:17.660147Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:05:17.660189Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:05:17.660222Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:05:17.751865Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:17.935978Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:18.238806Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:18.240752Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:18.357720Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:18.357729Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:18.542624Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:18.659230Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:18.660260Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:18.660291Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:05:19.147460Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:19.147503Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:19.450357Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:19.661204Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:19.661564Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd837b061-25ba-4e0e-99c1-e701478a92c0.sock: use of closed network connection
2020-08-31T01:05:19.661570Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:19.661594Z	error	sds	Remote side closed connection
2020-08-31T01:05:19.661649Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:19.661658Z	error	sds	Remote side closed connection
2020-08-31T01:05:19.661821Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7a2f5a67-7c37-415c-80d2-f45910dedf40.sock" 

2020-08-31T01:05:19.661915Z	info	sds	Start SDS grpc server
2020-08-31T01:05:19.662619Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:05:19.662664Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:05:19.662716Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:19.663118Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:05:19.662715139 +0000 UTC m=+6.807583998 and is waiting for next SDS request
2020-08-31T01:05:19.663139Z	info	sds	Dynamic push for secret default
2020-08-31T01:05:19.663164Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7a2f5a67-7c37-415c-80d2-f45910dedf40.sock: use of closed network connection
2020-08-31T01:05:19.663224Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:19.663248Z	error	sds	Remote side closed connection
2020-08-31T01:05:19.663278Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:19.663293Z	error	sds	Remote side closed connection
2020-08-31T01:05:19.663433Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4e3510b9-829b-40d6-a116-4588f66efef3.sock" 

2020-08-31T01:05:19.663504Z	info	sds	Start SDS grpc server
2020-08-31T01:05:19.664104Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:05:19.664148Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:05:19.664186Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:19.664761Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:05:19.752063Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:20.164926Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:20.164984Z	info	sds	Dynamic push for secret default
2020-08-31T01:05:20.165590Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4e3510b9-829b-40d6-a116-4588f66efef3.sock: use of closed network connection
2020-08-31T01:05:20.165703Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:20.165728Z	error	sds	Remote side closed connection
2020-08-31T01:05:20.165808Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:20.165828Z	error	sds	Remote side closed connection
2020-08-31T01:05:20.165908Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestee72e89c-7de3-466e-baf4-1fa3323c4ce7.sock" 

2020-08-31T01:05:20.165947Z	info	sds	Start SDS grpc server
2020-08-31T01:05:20.166139Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestee72e89c-7de3-466e-baf4-1fa3323c4ce7.sock: use of closed network connection
2020-08-31T01:05:20.166219Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest861ed6be-2d67-4115-8c53-02def995bcc1.sock" 

2020-08-31T01:05:20.166239Z	info	sds	Start SDS grpc server
2020-08-31T01:05:20.357980Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:20.357993Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:20.467029Z	info	sds	resource:default new connection
2020-08-31T01:05:20.467085Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:05:20.467139Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:20.467629Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:20.467656Z	error	sds	Remote side closed connection
2020-08-31T01:05:20.659475Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:20.661754Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:20.663265Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:20.768703Z	info	sds	resource:default new connection
2020-08-31T01:05:20.768788Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:05:20.768859Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:20.769180Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:20.769208Z	error	sds	Remote side closed connection
2020-08-31T01:05:20.769587Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest861ed6be-2d67-4115-8c53-02def995bcc1.sock: use of closed network connection
2020-08-31T01:05:20.769720Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb6626543-19fe-4b2a-9303-00edd0829042.sock" 

2020-08-31T01:05:20.769747Z	info	sds	Start SDS grpc server
2020-08-31T01:05:21.070705Z	info	sds	resource:default new connection
2020-08-31T01:05:21.070797Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:05:21.070857Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:21.071116Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:21.071205Z	error	sds	Remote side closed connection
2020-08-31T01:05:21.071419Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb6626543-19fe-4b2a-9303-00edd0829042.sock: use of closed network connection
2020-08-31T01:05:21.165851Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:21.166180Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:21.769779Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:21.936132Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:22.071652Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:05:22.238945Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:22.240971Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:22.542818Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:22.662008Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:22.663466Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:05:23.103923Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest375e7510-d15a-42f7-84d8-bfa8a19a11de.sock" 

2020-08-31T01:05:23.103977Z	info	sds	Start SDS grpc server
2020-08-31T01:05:23.147687Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:23.147685Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:23.166090Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:23.166359Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:23.450555Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:23.752363Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:23.770105Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:24.071792Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:24.104930Z	info	sds	resource:default new connection
2020-08-31T01:05:24.105020Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:05:24.106489Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:05:24.217680Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:05:24.217727Z	info	cache	GenerateSecret default
2020-08-31T01:05:24.217785Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:24.218089Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest375e7510-d15a-42f7-84d8-bfa8a19a11de.sock: use of closed network connection
PASS
2020-08-31T01:05:24.218173Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.609s
2020-08-31T01:05:29.462698Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest00d38150-213e-47c9-9c74-484b8b68d7fe.sock" 

2020-08-31T01:05:29.462788Z	info	sds	Start SDS grpc server
2020-08-31T01:05:29.464157Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:05:29.464212Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:05:29.464577Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:30.464051Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:30.464114Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:05:31.464748Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:05:31.464823Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:05:31.464874Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:05:31.464943Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:31.465161Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest00d38150-213e-47c9-9c74-484b8b68d7fe.sock: use of closed network connection
2020-08-31T01:05:31.465277Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:31.465307Z	error	sds	Remote side closed connection
2020-08-31T01:05:31.465428Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d5069332-77ea-4aa5-a56a-90a4306c019b\".sock" 

2020-08-31T01:05:31.465460Z	info	sds	Start SDS grpc server
2020-08-31T01:05:31.766438Z	info	sds	resource:default new connection
2020-08-31T01:05:31.766500Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:05:31.766552Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:31.766825Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:31.766850Z	error	sds	Remote side closed connection
2020-08-31T01:05:31.767477Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:05:31.767514Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:05:31.767665Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:05:31.767864Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:31.767880Z	error	sds	Remote side closed connection
2020-08-31T01:05:31.768112Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d5069332-77ea-4aa5-a56a-90a4306c019b".sock: use of closed network connection
2020-08-31T01:05:31.768289Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d59eb609-2699-4b71-9a66-05ca333b38c7\".sock" 

2020-08-31T01:05:31.768381Z	info	sds	Start SDS grpc server
2020-08-31T01:05:31.768783Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:05:31.768811Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:05:31.768850Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:05:31.769058Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:31.769088Z	error	sds	Remote side closed connection
2020-08-31T01:05:31.769213Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d59eb609-2699-4b71-9a66-05ca333b38c7".sock: use of closed network connection
2020-08-31T01:05:31.769443Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"43f5d37b-ba9d-4719-b2e8-55bf8bf1d2b9\".sock" 

2020-08-31T01:05:31.769466Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:32.070417Z	info	sds	resource:default new connection
2020-08-31T01:05:32.070469Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:05:32.070522Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:32.070936Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:32.070969Z	error	sds	Remote side closed connection
2020-08-31T01:05:32.071120Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"43f5d37b-ba9d-4719-b2e8-55bf8bf1d2b9".sock: use of closed network connection
2020-08-31T01:05:32.071323Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"82334c6a-d075-4b26-bc6c-d2ebf97162cc\".sock" 

2020-08-31T01:05:32.071381Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8bd99bb4-058f-4f6b-8d07-f2e218d58fa6\".sock" 

2020-08-31T01:05:32.071395Z	info	sds	Start SDS grpc server
2020-08-31T01:05:32.071416Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:32.372447Z	info	sds	resource:default new connection
2020-08-31T01:05:32.372516Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:05:32.372570Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:32.372788Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:32.372812Z	error	sds	Remote side closed connection
2020-08-31T01:05:32.373406Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:05:32.373451Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:05:32.373487Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:05:32.373697Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:32.373726Z	error	sds	Remote side closed connection
2020-08-31T01:05:32.465349Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:32.674669Z	info	sds	resource:default new connection
2020-08-31T01:05:32.674732Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:05:32.674782Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:32.675234Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:32.675275Z	error	sds	Remote side closed connection
2020-08-31T01:05:32.675290Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8bd99bb4-058f-4f6b-8d07-f2e218d58fa6".sock: use of closed network connection
2020-08-31T01:05:32.675251Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"82334c6a-d075-4b26-bc6c-d2ebf97162cc".sock: use of closed network connection
2020-08-31T01:05:32.675456Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"025558e3-d7f1-449d-b794-209efbe465bb\".sock" 

2020-08-31T01:05:32.675483Z	info	sds	Start SDS grpc server
2020-08-31T01:05:32.768333Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:32.769415Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:05:32.978702Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"025558e3-d7f1-449d-b794-209efbe465bb".sock: use of closed network connection
2020-08-31T01:05:32.978935Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6c1c23f5-52df-449e-8d79-37f7bb45bc3b\".sock" 

2020-08-31T01:05:32.978960Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:33.071354Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:05:33.280477Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6c1c23f5-52df-449e-8d79-37f7bb45bc3b".sock: use of closed network connection
2020-08-31T01:05:33.280717Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest9180fd72-c043-4daa-b7bf-d959b9abe9c8.sock" 

2020-08-31T01:05:33.280731Z	info	sds	Start SDS grpc server
2020-08-31T01:05:33.280795Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7e6324e5-3d65-47d3-9a2a-a1e97e4300dc\".sock" 

2020-08-31T01:05:33.280829Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:05:33.675474Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:33.675507Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:05:33.884785Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest9180fd72-c043-4daa-b7bf-d959b9abe9c8.sock: use of closed network connection
2020-08-31T01:05:33.884836Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7e6324e5-3d65-47d3-9a2a-a1e97e4300dc".sock: use of closed network connection
2020-08-31T01:05:33.885058Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestb8b69b05-7439-4940-b064-ef368620fbe7.sock" 

2020-08-31T01:05:33.885082Z	info	sds	Start SDS grpc server
2020-08-31T01:05:33.978949Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:34.187445Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:05:34.188122Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:34.188367Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestb8b69b05-7439-4940-b064-ef368620fbe7.sock: use of closed network connection
2020-08-31T01:05:34.188634Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest41ef7a54-9e77-4559-b9ce-81d8a8d9c9a7.sock" 

2020-08-31T01:05:34.188728Z	info	sds	Start SDS grpc server
2020-08-31T01:05:34.189476Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:05:34.189532Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:05:34.189577Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:34.189672Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:05:34.189717Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:05:34.189750Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:05:34.280736Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:34.465587Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:34.768614Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:34.769587Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:34.885027Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:34.885011Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:35.071600Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:35.188621Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:35.189787Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:35.189825Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:05:35.675814Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:35.675796Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:35.979185Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:36.190601Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:36.190974Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest41ef7a54-9e77-4559-b9ce-81d8a8d9c9a7.sock: use of closed network connection
2020-08-31T01:05:36.191064Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:36.191097Z	error	sds	Remote side closed connection
2020-08-31T01:05:36.191115Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:36.191151Z	error	sds	Remote side closed connection
2020-08-31T01:05:36.191263Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1e1afe9a-1371-4ad1-a25d-e320dcffeece.sock" 

2020-08-31T01:05:36.191325Z	info	sds	Start SDS grpc server
2020-08-31T01:05:36.192196Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:05:36.192246Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:05:36.192291Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:36.192744Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:05:36.192290786 +0000 UTC m=+6.803708445 and is waiting for next SDS request
2020-08-31T01:05:36.192765Z	info	sds	Dynamic push for secret default
2020-08-31T01:05:36.192800Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1e1afe9a-1371-4ad1-a25d-e320dcffeece.sock: use of closed network connection
2020-08-31T01:05:36.192899Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:36.192915Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:36.192938Z	error	sds	Remote side closed connection
2020-08-31T01:05:36.192929Z	error	sds	Remote side closed connection
2020-08-31T01:05:36.193060Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestccb9ea35-5ac5-4dda-abc9-8b7602bc200e.sock" 

2020-08-31T01:05:36.193076Z	info	sds	Start SDS grpc server
2020-08-31T01:05:36.193848Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:05:36.193893Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:05:36.193932Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:36.194426Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:05:36.281000Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:36.694559Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:36.694614Z	info	sds	Dynamic push for secret default
2020-08-31T01:05:36.695182Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestccb9ea35-5ac5-4dda-abc9-8b7602bc200e.sock: use of closed network connection
2020-08-31T01:05:36.695337Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:36.695373Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:36.695365Z	error	sds	Remote side closed connection
2020-08-31T01:05:36.695399Z	error	sds	Remote side closed connection
2020-08-31T01:05:36.695492Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0798bc3b-f7d3-45a3-b661-5eee37f3f9c2.sock" 

2020-08-31T01:05:36.695556Z	info	sds	Start SDS grpc server
2020-08-31T01:05:36.695715Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0798bc3b-f7d3-45a3-b661-5eee37f3f9c2.sock: use of closed network connection
2020-08-31T01:05:36.695798Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6a60f7fb-61cf-485a-a1e6-bbf394c49def.sock" 

2020-08-31T01:05:36.695809Z	info	sds	Start SDS grpc server
2020-08-31T01:05:36.885291Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:36.885338Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:36.996936Z	info	sds	resource:default new connection
2020-08-31T01:05:36.997001Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:05:36.997056Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:36.997394Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:36.997415Z	error	sds	Remote side closed connection
2020-08-31T01:05:37.188941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:37.191165Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:37.193019Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:37.298410Z	info	sds	resource:default new connection
2020-08-31T01:05:37.298468Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:05:37.298519Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:37.298794Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:37.298808Z	error	sds	Remote side closed connection
2020-08-31T01:05:37.299082Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6a60f7fb-61cf-485a-a1e6-bbf394c49def.sock: use of closed network connection
2020-08-31T01:05:37.299232Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7f0ff324-4390-41df-93d7-2a628f635d82.sock" 

2020-08-31T01:05:37.299305Z	info	sds	Start SDS grpc server
2020-08-31T01:05:37.600242Z	info	sds	resource:default new connection
2020-08-31T01:05:37.600332Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:05:37.600396Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:37.600845Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:37.600873Z	error	sds	Remote side closed connection
2020-08-31T01:05:37.601106Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7f0ff324-4390-41df-93d7-2a628f635d82.sock: use of closed network connection
2020-08-31T01:05:37.695352Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:37.695769Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:38.299359Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:38.465879Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:38.601330Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:05:38.768924Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:38.769725Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:39.071835Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:39.191357Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:39.193116Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:05:39.634064Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3869afe6-fa0e-40f2-88b9-3d8a957c885a.sock" 

2020-08-31T01:05:39.634129Z	info	sds	Start SDS grpc server
2020-08-31T01:05:39.676045Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:39.676087Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:39.695615Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:39.695941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:39.979329Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:40.281282Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:40.299467Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:40.601542Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:40.635017Z	info	sds	resource:default new connection
2020-08-31T01:05:40.635120Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:05:40.639581Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:05:40.725958Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:05:40.726020Z	info	cache	GenerateSecret default
2020-08-31T01:05:40.726097Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:40.726493Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3869afe6-fa0e-40f2-88b9-3d8a957c885a.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.583s
2020-08-31T01:05:45.962111Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb68e3833-6586-4b69-8169-e9c95465b5f3.sock" 

2020-08-31T01:05:45.962220Z	info	sds	Start SDS grpc server
2020-08-31T01:05:45.963445Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:05:45.963526Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:05:45.963976Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:46.963286Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:46.963342Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:05:47.964097Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:05:47.964181Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:05:47.964214Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:05:47.964289Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:47.964504Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb68e3833-6586-4b69-8169-e9c95465b5f3.sock: use of closed network connection
2020-08-31T01:05:47.964628Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:47.964678Z	error	sds	Remote side closed connection
2020-08-31T01:05:47.964835Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"744ff37d-82d2-4be0-80c3-a78b38cd7b6e\".sock" 

2020-08-31T01:05:47.964882Z	info	sds	Start SDS grpc server
2020-08-31T01:05:48.265789Z	info	sds	resource:default new connection
2020-08-31T01:05:48.265852Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:05:48.265914Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:48.266229Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:48.266242Z	error	sds	Remote side closed connection
2020-08-31T01:05:48.266905Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:05:48.266955Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:05:48.267118Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:05:48.267386Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:48.267421Z	error	sds	Remote side closed connection
2020-08-31T01:05:48.267600Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"744ff37d-82d2-4be0-80c3-a78b38cd7b6e".sock: use of closed network connection
2020-08-31T01:05:48.267762Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2d186133-a548-41fd-8e31-2a4e99aa506d\".sock" 

2020-08-31T01:05:48.267854Z	info	sds	Start SDS grpc server
2020-08-31T01:05:48.268295Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:05:48.268344Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:05:48.268501Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:05:48.268811Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:48.268830Z	error	sds	Remote side closed connection
2020-08-31T01:05:48.269033Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2d186133-a548-41fd-8e31-2a4e99aa506d".sock: use of closed network connection
2020-08-31T01:05:48.269197Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d2fbb5c4-ee1b-434a-8953-02096e3b5cee\".sock" 

2020-08-31T01:05:48.269229Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:48.570177Z	info	sds	resource:default new connection
2020-08-31T01:05:48.570234Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:05:48.570296Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:48.570632Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:48.570676Z	error	sds	Remote side closed connection
2020-08-31T01:05:48.570922Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d2fbb5c4-ee1b-434a-8953-02096e3b5cee".sock: use of closed network connection
2020-08-31T01:05:48.571152Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"20724b9c-7c77-4821-9370-bbf8ca327925\".sock" 

2020-08-31T01:05:48.571207Z	info	sds	Start SDS grpc server
2020-08-31T01:05:48.571238Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a8381ae3-cfed-4b3e-9d06-66d044070f8a\".sock" 

2020-08-31T01:05:48.571278Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:48.872307Z	info	sds	resource:default new connection
2020-08-31T01:05:48.872419Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:05:48.872494Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:48.872831Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:48.872849Z	error	sds	Remote side closed connection
2020-08-31T01:05:48.873385Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:05:48.873425Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:05:48.873470Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:05:48.873639Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:48.873651Z	error	sds	Remote side closed connection
2020-08-31T01:05:48.964802Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:49.174669Z	info	sds	resource:default new connection
2020-08-31T01:05:49.174723Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:05:49.174803Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:49.175057Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:49.175084Z	error	sds	Remote side closed connection
2020-08-31T01:05:49.175249Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"20724b9c-7c77-4821-9370-bbf8ca327925".sock: use of closed network connection
2020-08-31T01:05:49.175303Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a8381ae3-cfed-4b3e-9d06-66d044070f8a".sock: use of closed network connection
2020-08-31T01:05:49.175539Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"92425084-d40d-4ec4-99dc-6d3f591bdaaf\".sock" 

2020-08-31T01:05:49.175570Z	info	sds	Start SDS grpc server
2020-08-31T01:05:49.267823Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:49.269222Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:05:49.478516Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"92425084-d40d-4ec4-99dc-6d3f591bdaaf".sock: use of closed network connection
2020-08-31T01:05:49.478689Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0e922b43-3688-438f-b64b-66ef6a62f71f\".sock" 

2020-08-31T01:05:49.478709Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:05:49.571134Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:05:49.780308Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0e922b43-3688-438f-b64b-66ef6a62f71f".sock: use of closed network connection
2020-08-31T01:05:49.780529Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest38701fb8-2012-40f3-9ec2-206555f2a1f0.sock" 

2020-08-31T01:05:49.780547Z	info	sds	Start SDS grpc server
2020-08-31T01:05:49.780582Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"156c001b-03fe-4ab6-ae1f-81cf24df78bd\".sock" 

2020-08-31T01:05:49.780615Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:05:50.175483Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:50.175510Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:05:50.384454Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest38701fb8-2012-40f3-9ec2-206555f2a1f0.sock: use of closed network connection
2020-08-31T01:05:50.384552Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"156c001b-03fe-4ab6-ae1f-81cf24df78bd".sock: use of closed network connection
2020-08-31T01:05:50.384827Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest265eae06-6ae2-4cae-b924-beebceff63a7.sock" 

2020-08-31T01:05:50.384842Z	info	sds	Start SDS grpc server
2020-08-31T01:05:50.478730Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:50.685984Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:05:50.686081Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:50.686756Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest265eae06-6ae2-4cae-b924-beebceff63a7.sock: use of closed network connection
2020-08-31T01:05:50.687076Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest24715777-8888-4e54-8204-82ddb5752138.sock" 

2020-08-31T01:05:50.687174Z	info	sds	Start SDS grpc server
2020-08-31T01:05:50.689075Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:05:50.689137Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:05:50.689200Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:50.689416Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:05:50.689471Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:05:50.689511Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:05:50.780543Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:50.965037Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:51.268117Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:51.269310Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:51.384541Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:51.384605Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:51.571380Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:51.686997Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:51.689459Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:51.689503Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:05:52.175715Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:52.175761Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:52.478997Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:52.690217Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:52.690618Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest24715777-8888-4e54-8204-82ddb5752138.sock: use of closed network connection
2020-08-31T01:05:52.690640Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:52.690666Z	error	sds	Remote side closed connection
2020-08-31T01:05:52.690782Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:52.690820Z	error	sds	Remote side closed connection
2020-08-31T01:05:52.690975Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest37467481-3247-4327-b663-8fb49bdd7a2e.sock" 

2020-08-31T01:05:52.691055Z	info	sds	Start SDS grpc server
2020-08-31T01:05:52.692021Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:05:52.692074Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:05:52.692140Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:52.692619Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:05:52.692139321 +0000 UTC m=+6.809657957 and is waiting for next SDS request
2020-08-31T01:05:52.692646Z	info	sds	Dynamic push for secret default
2020-08-31T01:05:52.692650Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest37467481-3247-4327-b663-8fb49bdd7a2e.sock: use of closed network connection
2020-08-31T01:05:52.692805Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:52.692815Z	error	sds	Remote side closed connection
2020-08-31T01:05:52.692808Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:52.692834Z	error	sds	Remote side closed connection
2020-08-31T01:05:52.692929Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbb8f5629-ab7b-4db1-8bfd-9f51c6935af9.sock" 

2020-08-31T01:05:52.692996Z	info	sds	Start SDS grpc server
2020-08-31T01:05:52.693625Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:05:52.693663Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:05:52.693708Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:52.694261Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:05:52.780877Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:53.194427Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:53.194486Z	info	sds	Dynamic push for secret default
2020-08-31T01:05:53.195042Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbb8f5629-ab7b-4db1-8bfd-9f51c6935af9.sock: use of closed network connection
2020-08-31T01:05:53.195141Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:53.195171Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:53.195168Z	error	sds	Remote side closed connection
2020-08-31T01:05:53.195194Z	error	sds	Remote side closed connection
2020-08-31T01:05:53.195250Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb70311a7-1143-4e2d-b922-80e1a3a4cea9.sock" 

2020-08-31T01:05:53.195334Z	info	sds	Start SDS grpc server
2020-08-31T01:05:53.195483Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb70311a7-1143-4e2d-b922-80e1a3a4cea9.sock: use of closed network connection
2020-08-31T01:05:53.195562Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest52c7ce8a-728e-4097-a01a-8df5cdb7c4ef.sock" 

2020-08-31T01:05:53.195580Z	info	sds	Start SDS grpc server
2020-08-31T01:05:53.384814Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:53.384798Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:53.496526Z	info	sds	resource:default new connection
2020-08-31T01:05:53.496594Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:05:53.496687Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:53.496966Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:53.496991Z	error	sds	Remote side closed connection
2020-08-31T01:05:53.687251Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:53.690856Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:53.692844Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:53.798126Z	info	sds	resource:default new connection
2020-08-31T01:05:53.798195Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:05:53.798255Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:53.798498Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:53.798527Z	error	sds	Remote side closed connection
2020-08-31T01:05:53.798955Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest52c7ce8a-728e-4097-a01a-8df5cdb7c4ef.sock: use of closed network connection
2020-08-31T01:05:53.799137Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest13c9d6e8-24c8-4fc9-a1c0-09f026ad1c2e.sock" 

2020-08-31T01:05:53.799177Z	info	sds	Start SDS grpc server
2020-08-31T01:05:54.100176Z	info	sds	resource:default new connection
2020-08-31T01:05:54.100230Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:05:54.100282Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:54.100586Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:54.100614Z	error	sds	Remote side closed connection
2020-08-31T01:05:54.100939Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest13c9d6e8-24c8-4fc9-a1c0-09f026ad1c2e.sock: use of closed network connection
2020-08-31T01:05:54.195250Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:54.195674Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:54.799196Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:54.965298Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:55.101135Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:05:55.268433Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:55.269509Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:55.571622Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:55.691073Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:55.693016Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:05:56.131760Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6b9602e6-530f-4b29-bbaf-0dc139b50573.sock" 

2020-08-31T01:05:56.131825Z	info	sds	Start SDS grpc server
2020-08-31T01:05:56.175994Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:56.176029Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:56.195498Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:56.195864Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:56.479194Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:56.781150Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:05:56.799328Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:57.101384Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:05:57.133297Z	info	sds	resource:default new connection
2020-08-31T01:05:57.133416Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:05:57.135777Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:05:57.297056Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:05:57.297105Z	info	cache	GenerateSecret default
2020-08-31T01:05:57.297168Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:05:57.297657Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6b9602e6-530f-4b29-bbaf-0dc139b50573.sock: use of closed network connection
PASS
2020-08-31T01:05:57.297752Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:05:57.297768Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.666s
2020-08-31T01:06:02.543766Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestae871ced-6f4a-459e-bf10-1620dbde9f79.sock" 

2020-08-31T01:06:02.543802Z	info	sds	Start SDS grpc server
2020-08-31T01:06:02.545206Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:06:02.545304Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:06:02.545654Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:03.545174Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:03.545222Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:06:04.546138Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:06:04.546225Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:06:04.546253Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:06:04.546308Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:04.546552Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestae871ced-6f4a-459e-bf10-1620dbde9f79.sock: use of closed network connection
2020-08-31T01:06:04.546720Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:04.546738Z	error	sds	Remote side closed connection
2020-08-31T01:06:04.546792Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7cd00485-fc6e-401e-a052-73a5a6bd3fba\".sock" 

2020-08-31T01:06:04.546822Z	info	sds	Start SDS grpc server
2020-08-31T01:06:04.847774Z	info	sds	resource:default new connection
2020-08-31T01:06:04.847847Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:06:04.847901Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:04.848214Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:04.848242Z	error	sds	Remote side closed connection
2020-08-31T01:06:04.848898Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:06:04.848959Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:06:04.849551Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:06:04.849865Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:04.849878Z	error	sds	Remote side closed connection
2020-08-31T01:06:04.850149Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7cd00485-fc6e-401e-a052-73a5a6bd3fba".sock: use of closed network connection
2020-08-31T01:06:04.850346Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0625a326-926b-4fc0-a8cd-6806791d2b63\".sock" 

2020-08-31T01:06:04.850454Z	info	sds	Start SDS grpc server
2020-08-31T01:06:04.850843Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:06:04.850899Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:06:04.850942Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:06:04.851217Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:04.851240Z	error	sds	Remote side closed connection
2020-08-31T01:06:04.851384Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0625a326-926b-4fc0-a8cd-6806791d2b63".sock: use of closed network connection
2020-08-31T01:06:04.851520Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"81e7135e-363c-49c2-bc67-b68d69e82ce4\".sock" 

2020-08-31T01:06:04.851541Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:05.152602Z	info	sds	resource:default new connection
2020-08-31T01:06:05.152698Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:06:05.152760Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:05.152991Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:05.153017Z	error	sds	Remote side closed connection
2020-08-31T01:06:05.153250Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"81e7135e-363c-49c2-bc67-b68d69e82ce4".sock: use of closed network connection
2020-08-31T01:06:05.153458Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f8394d8b-e2d5-40b3-9572-4b969e1a3e41\".sock" 

2020-08-31T01:06:05.153517Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9eafad47-4f35-45b4-83a4-8bd457ba20ad\".sock" 

2020-08-31T01:06:05.153537Z	info	sds	Start SDS grpc server
2020-08-31T01:06:05.153551Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:05.454565Z	info	sds	resource:default new connection
2020-08-31T01:06:05.454635Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:06:05.454703Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:05.455013Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:05.455043Z	error	sds	Remote side closed connection
2020-08-31T01:06:05.455541Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:06:05.455601Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:06:05.455642Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:06:05.455842Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:05.455861Z	error	sds	Remote side closed connection
2020-08-31T01:06:05.546805Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:05.756737Z	info	sds	resource:default new connection
2020-08-31T01:06:05.756787Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:06:05.756836Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:05.757022Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:05.757041Z	error	sds	Remote side closed connection
2020-08-31T01:06:05.757306Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f8394d8b-e2d5-40b3-9572-4b969e1a3e41".sock: use of closed network connection
2020-08-31T01:06:05.757353Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9eafad47-4f35-45b4-83a4-8bd457ba20ad".sock: use of closed network connection
2020-08-31T01:06:05.757568Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"43cdd340-910f-47d5-b0b5-15a8261a7460\".sock" 

2020-08-31T01:06:05.757597Z	info	sds	Start SDS grpc server
2020-08-31T01:06:05.850398Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:05.851540Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:06:06.059879Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"43cdd340-910f-47d5-b0b5-15a8261a7460".sock: use of closed network connection
2020-08-31T01:06:06.060149Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b6448f06-3729-46d9-bdf5-0e82257ad747\".sock" 

2020-08-31T01:06:06.060169Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:06.153471Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:06:06.363074Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b6448f06-3729-46d9-bdf5-0e82257ad747".sock: use of closed network connection
2020-08-31T01:06:06.363841Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0f13a6da-1ed2-482f-957e-83709de2e633.sock" 

2020-08-31T01:06:06.363943Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e1a91737-496f-4d26-bb11-da44526a14c1\".sock" 

2020-08-31T01:06:06.363965Z	info	sds	Start SDS grpc server
2020-08-31T01:06:06.363989Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:06:06.757554Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:06.757575Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:06:06.968121Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0f13a6da-1ed2-482f-957e-83709de2e633.sock: use of closed network connection
2020-08-31T01:06:06.968195Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e1a91737-496f-4d26-bb11-da44526a14c1".sock: use of closed network connection
2020-08-31T01:06:06.968381Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest78038ddb-58f8-4afb-9658-56b9ea14b0a9.sock" 

2020-08-31T01:06:06.968404Z	info	sds	Start SDS grpc server
2020-08-31T01:06:07.060108Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:07.269641Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:06:07.269775Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:07.270029Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest78038ddb-58f8-4afb-9658-56b9ea14b0a9.sock: use of closed network connection
2020-08-31T01:06:07.270311Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5176716f-9647-4861-a20f-7eba91c31134.sock" 

2020-08-31T01:06:07.270377Z	info	sds	Start SDS grpc server
2020-08-31T01:06:07.271156Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:06:07.271202Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:06:07.271247Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:07.271413Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:06:07.271474Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:06:07.271516Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:06:07.363378Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:07.547068Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:07.850654Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:07.851724Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:07.968327Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:07.968371Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:08.153643Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:08.270323Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:08.271504Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:08.271545Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:06:08.757864Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:08.757885Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:09.060365Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:09.272492Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:09.272863Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5176716f-9647-4861-a20f-7eba91c31134.sock: use of closed network connection
2020-08-31T01:06:09.272969Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:09.273002Z	error	sds	Remote side closed connection
2020-08-31T01:06:09.273000Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:09.273050Z	error	sds	Remote side closed connection
2020-08-31T01:06:09.273232Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest46dece94-3bb4-4766-afca-20510b4ae76b.sock" 

2020-08-31T01:06:09.273302Z	info	sds	Start SDS grpc server
2020-08-31T01:06:09.274108Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:06:09.274165Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:06:09.274232Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:09.274653Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:06:09.27423097 +0000 UTC m=+6.806393708 and is waiting for next SDS request
2020-08-31T01:06:09.274667Z	info	sds	Dynamic push for secret default
2020-08-31T01:06:09.274709Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest46dece94-3bb4-4766-afca-20510b4ae76b.sock: use of closed network connection
2020-08-31T01:06:09.274785Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:09.274799Z	error	sds	Remote side closed connection
2020-08-31T01:06:09.274798Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:09.274816Z	error	sds	Remote side closed connection
2020-08-31T01:06:09.274968Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest72ce3398-947d-4f73-955b-43eda952d4df.sock" 

2020-08-31T01:06:09.274987Z	info	sds	Start SDS grpc server
2020-08-31T01:06:09.275791Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:06:09.275839Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:06:09.275915Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:09.276563Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:06:09.365723Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:09.776733Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:09.776784Z	info	sds	Dynamic push for secret default
2020-08-31T01:06:09.777372Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest72ce3398-947d-4f73-955b-43eda952d4df.sock: use of closed network connection
2020-08-31T01:06:09.777475Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:09.777481Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:09.777503Z	error	sds	Remote side closed connection
2020-08-31T01:06:09.777484Z	error	sds	Remote side closed connection
2020-08-31T01:06:09.777640Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0c03d91f-b819-445f-958f-09bf710cdd48.sock" 

2020-08-31T01:06:09.777731Z	info	sds	Start SDS grpc server
2020-08-31T01:06:09.777964Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0c03d91f-b819-445f-958f-09bf710cdd48.sock: use of closed network connection
2020-08-31T01:06:09.778085Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1efeeabf-ac24-4aa6-8bec-8a4aca605a25.sock" 

2020-08-31T01:06:09.778106Z	info	sds	Start SDS grpc server
2020-08-31T01:06:09.968571Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:09.968608Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:10.079196Z	info	sds	resource:default new connection
2020-08-31T01:06:10.079278Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:06:10.079355Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:10.079670Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:10.079711Z	error	sds	Remote side closed connection
2020-08-31T01:06:10.270582Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:10.273070Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:10.274878Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:10.380824Z	info	sds	resource:default new connection
2020-08-31T01:06:10.380902Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:06:10.380957Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:10.381400Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:10.381440Z	error	sds	Remote side closed connection
2020-08-31T01:06:10.381800Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1efeeabf-ac24-4aa6-8bec-8a4aca605a25.sock: use of closed network connection
2020-08-31T01:06:10.381962Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest80729628-dea9-40ce-ac2b-278d9d95c371.sock" 

2020-08-31T01:06:10.382011Z	info	sds	Start SDS grpc server
2020-08-31T01:06:10.683016Z	info	sds	resource:default new connection
2020-08-31T01:06:10.683079Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:06:10.683152Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:10.683475Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:10.683518Z	error	sds	Remote side closed connection
2020-08-31T01:06:10.683869Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest80729628-dea9-40ce-ac2b-278d9d95c371.sock: use of closed network connection
2020-08-31T01:06:10.777578Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:10.778157Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:11.382009Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:11.547305Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:11.684078Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:06:11.850883Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:11.851901Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:12.153971Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:12.273303Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:12.275057Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:06:12.719463Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest307f4c06-23c6-4f62-a879-090090185c02.sock" 

2020-08-31T01:06:12.719521Z	info	sds	Start SDS grpc server
2020-08-31T01:06:12.758138Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:12.758149Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:12.777884Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:12.778305Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:13.060746Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:13.366000Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:13.382286Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:13.684334Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:13.720457Z	info	sds	resource:default new connection
2020-08-31T01:06:13.720519Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:06:13.721838Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:06:13.843637Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:06:13.843682Z	info	cache	GenerateSecret default
2020-08-31T01:06:13.843742Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:13.844191Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest307f4c06-23c6-4f62-a879-090090185c02.sock: use of closed network connection
PASS
2020-08-31T01:06:13.844341Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.626s
2020-08-31T01:06:19.097271Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1a0f6a2f-6684-4122-b415-73e8ce6bb9e6.sock" 

2020-08-31T01:06:19.097316Z	info	sds	Start SDS grpc server
2020-08-31T01:06:19.098646Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:06:19.098703Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:06:19.099096Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:20.098581Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:20.098646Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:06:21.099384Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:06:21.099483Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:06:21.099512Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:06:21.099593Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:21.099820Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1a0f6a2f-6684-4122-b415-73e8ce6bb9e6.sock: use of closed network connection
2020-08-31T01:06:21.099953Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:21.099992Z	error	sds	Remote side closed connection
2020-08-31T01:06:21.100256Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a1b06c93-f577-41b7-b602-ab97c7cfcae9\".sock" 

2020-08-31T01:06:21.100310Z	info	sds	Start SDS grpc server
2020-08-31T01:06:21.401266Z	info	sds	resource:default new connection
2020-08-31T01:06:21.401352Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:06:21.401416Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:21.401817Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:21.401850Z	error	sds	Remote side closed connection
2020-08-31T01:06:21.402327Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:06:21.402377Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:06:21.402534Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:06:21.402782Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:21.402804Z	error	sds	Remote side closed connection
2020-08-31T01:06:21.402987Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a1b06c93-f577-41b7-b602-ab97c7cfcae9".sock: use of closed network connection
2020-08-31T01:06:21.403165Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e1ce0887-8dca-4080-95d4-5655d6355855\".sock" 

2020-08-31T01:06:21.403207Z	info	sds	Start SDS grpc server
2020-08-31T01:06:21.403658Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:06:21.403688Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:06:21.403724Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:06:21.403928Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:21.403945Z	error	sds	Remote side closed connection
2020-08-31T01:06:21.404137Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e1ce0887-8dca-4080-95d4-5655d6355855".sock: use of closed network connection
2020-08-31T01:06:21.404369Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"978262e8-9ee0-4661-874e-f99b4bad4b20\".sock" 

2020-08-31T01:06:21.404407Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:21.705841Z	info	sds	resource:default new connection
2020-08-31T01:06:21.705936Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:06:21.705992Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:21.706263Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:21.706301Z	error	sds	Remote side closed connection
2020-08-31T01:06:21.706607Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"978262e8-9ee0-4661-874e-f99b4bad4b20".sock: use of closed network connection
2020-08-31T01:06:21.706802Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0c0079e4-31ff-47cd-8c5e-225ddafeb746\".sock" 

2020-08-31T01:06:21.706889Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d4b69f59-31bb-437b-b308-217a7a0a7dfe\".sock" 

2020-08-31T01:06:21.706897Z	info	sds	Start SDS grpc server
2020-08-31T01:06:21.706920Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:22.007909Z	info	sds	resource:default new connection
2020-08-31T01:06:22.007975Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:06:22.008047Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:22.008413Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:22.008438Z	error	sds	Remote side closed connection
2020-08-31T01:06:22.009207Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:06:22.009262Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:06:22.009314Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:06:22.009526Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:22.009544Z	error	sds	Remote side closed connection
2020-08-31T01:06:22.100110Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:22.310599Z	info	sds	resource:default new connection
2020-08-31T01:06:22.310669Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:06:22.310732Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:22.310924Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:22.310954Z	error	sds	Remote side closed connection
2020-08-31T01:06:22.311205Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0c0079e4-31ff-47cd-8c5e-225ddafeb746".sock: use of closed network connection
2020-08-31T01:06:22.311258Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d4b69f59-31bb-437b-b308-217a7a0a7dfe".sock: use of closed network connection
2020-08-31T01:06:22.311437Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c56c2020-c768-463c-b891-ac772a33e059\".sock" 

2020-08-31T01:06:22.311457Z	info	sds	Start SDS grpc server
2020-08-31T01:06:22.403149Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:22.404284Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:06:22.614019Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c56c2020-c768-463c-b891-ac772a33e059".sock: use of closed network connection
2020-08-31T01:06:22.614199Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b6585194-8294-4933-b0b8-0a73d380a59a\".sock" 

2020-08-31T01:06:22.614221Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:22.706829Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:06:22.915491Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b6585194-8294-4933-b0b8-0a73d380a59a".sock: use of closed network connection
2020-08-31T01:06:22.915701Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest656dd77e-5155-40c6-a2c3-857d307b284f.sock" 

2020-08-31T01:06:22.915720Z	info	sds	Start SDS grpc server
2020-08-31T01:06:22.915797Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9a408c8c-f2d0-4904-a6f1-cd62e78c0165\".sock" 

2020-08-31T01:06:22.915832Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:06:23.311411Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:23.311450Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:06:23.520307Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest656dd77e-5155-40c6-a2c3-857d307b284f.sock: use of closed network connection
2020-08-31T01:06:23.520356Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9a408c8c-f2d0-4904-a6f1-cd62e78c0165".sock: use of closed network connection
2020-08-31T01:06:23.520508Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestdec46968-f217-4e38-a6e9-457f7725ea4f.sock" 

2020-08-31T01:06:23.520513Z	info	sds	Start SDS grpc server
2020-08-31T01:06:23.614206Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:23.822537Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:06:23.822656Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:23.822969Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestdec46968-f217-4e38-a6e9-457f7725ea4f.sock: use of closed network connection
2020-08-31T01:06:23.823556Z	info	sds	Start SDS grpc server
2020-08-31T01:06:23.823580Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste44eb61e-9070-4861-88de-5b56c93a8841.sock" 

2020-08-31T01:06:23.824542Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:06:23.824593Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:06:23.824649Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:23.824636Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:06:23.824729Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:06:23.824776Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:06:23.915770Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:24.100401Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:24.403399Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:24.404477Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:24.520519Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:24.520588Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:24.707052Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:24.823188Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:24.824813Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:24.824860Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:06:25.311684Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:25.311727Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:25.614454Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:25.825647Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:25.826103Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste44eb61e-9070-4861-88de-5b56c93a8841.sock: use of closed network connection
2020-08-31T01:06:25.826141Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:25.826177Z	error	sds	Remote side closed connection
2020-08-31T01:06:25.826227Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:25.826254Z	error	sds	Remote side closed connection
2020-08-31T01:06:25.826338Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf4309db8-3a0e-4bfc-9430-aed006508a7c.sock" 

2020-08-31T01:06:25.826460Z	info	sds	Start SDS grpc server
2020-08-31T01:06:25.827217Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:06:25.827259Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:06:25.827310Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:25.827811Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:06:25.827309801 +0000 UTC m=+6.808696327 and is waiting for next SDS request
2020-08-31T01:06:25.827881Z	info	sds	Dynamic push for secret default
2020-08-31T01:06:25.827858Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf4309db8-3a0e-4bfc-9430-aed006508a7c.sock: use of closed network connection
2020-08-31T01:06:25.827916Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:25.827941Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:25.827950Z	error	sds	Remote side closed connection
2020-08-31T01:06:25.827938Z	error	sds	Remote side closed connection
2020-08-31T01:06:25.828067Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest42552603-10e7-44e3-b7ee-128e9b44f786.sock" 

2020-08-31T01:06:25.828073Z	info	sds	Start SDS grpc server
2020-08-31T01:06:25.828820Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:06:25.828856Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:06:25.828894Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:25.829424Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:06:25.916013Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:26.329592Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:26.329648Z	info	sds	Dynamic push for secret default
2020-08-31T01:06:26.330292Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest42552603-10e7-44e3-b7ee-128e9b44f786.sock: use of closed network connection
2020-08-31T01:06:26.330418Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:26.330434Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:26.330456Z	error	sds	Remote side closed connection
2020-08-31T01:06:26.330444Z	error	sds	Remote side closed connection
2020-08-31T01:06:26.330568Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta1a1e75e-33ef-488b-9931-39446108d8e0.sock" 

2020-08-31T01:06:26.330591Z	info	sds	Start SDS grpc server
2020-08-31T01:06:26.330783Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta1a1e75e-33ef-488b-9931-39446108d8e0.sock: use of closed network connection
2020-08-31T01:06:26.330858Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest79d2e816-8fd1-4344-a097-4b1d71a7d1eb.sock" 

2020-08-31T01:06:26.330868Z	info	sds	Start SDS grpc server
2020-08-31T01:06:26.520774Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:26.520831Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:26.632032Z	info	sds	resource:default new connection
2020-08-31T01:06:26.632097Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:06:26.632151Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:26.632560Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:26.632591Z	error	sds	Remote side closed connection
2020-08-31T01:06:26.823491Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:26.826453Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:26.828083Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:26.933881Z	info	sds	resource:default new connection
2020-08-31T01:06:26.933954Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:06:26.934009Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:26.934309Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:26.934337Z	error	sds	Remote side closed connection
2020-08-31T01:06:26.934666Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest79d2e816-8fd1-4344-a097-4b1d71a7d1eb.sock: use of closed network connection
2020-08-31T01:06:26.934802Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc1893b84-6a21-436b-9572-037bfcb159df.sock" 

2020-08-31T01:06:26.934836Z	info	sds	Start SDS grpc server
2020-08-31T01:06:27.236003Z	info	sds	resource:default new connection
2020-08-31T01:06:27.236071Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:06:27.236141Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:27.236485Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:27.236509Z	error	sds	Remote side closed connection
2020-08-31T01:06:27.236749Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc1893b84-6a21-436b-9572-037bfcb159df.sock: use of closed network connection
2020-08-31T01:06:27.330506Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:27.330859Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:27.934973Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:28.100737Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:28.236990Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:06:28.403714Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:28.404756Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:28.707225Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:28.826783Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:28.828358Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:06:29.270508Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaaa64ef9-0eb0-4242-8d7e-73e05f0b2a56.sock" 

2020-08-31T01:06:29.270573Z	info	sds	Start SDS grpc server
2020-08-31T01:06:29.311967Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:29.311967Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:29.330620Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:29.331043Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:29.614675Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:29.916390Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:29.935345Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:30.237330Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:30.271533Z	info	sds	resource:default new connection
2020-08-31T01:06:30.271594Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:06:30.277682Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:06:30.485693Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:06:30.485746Z	info	cache	GenerateSecret default
2020-08-31T01:06:30.485812Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:30.486232Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaaa64ef9-0eb0-4242-8d7e-73e05f0b2a56.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.713s
2020-08-31T01:06:35.933355Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestecff66ad-5a9c-40a6-b232-6f5a6ae5b64f.sock" 

2020-08-31T01:06:35.933389Z	info	sds	Start SDS grpc server
2020-08-31T01:06:35.934704Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:06:35.934763Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:06:35.935206Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:36.934655Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:36.934708Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:06:37.935506Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:06:37.935599Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:06:37.935633Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:06:37.935713Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:37.935901Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestecff66ad-5a9c-40a6-b232-6f5a6ae5b64f.sock: use of closed network connection
2020-08-31T01:06:37.936006Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:37.936044Z	error	sds	Remote side closed connection
2020-08-31T01:06:37.936163Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1d277a27-9901-4816-8f19-617d9556c768\".sock" 

2020-08-31T01:06:37.936172Z	info	sds	Start SDS grpc server
2020-08-31T01:06:38.237146Z	info	sds	resource:default new connection
2020-08-31T01:06:38.237206Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:06:38.237267Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:38.237684Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:38.237713Z	error	sds	Remote side closed connection
2020-08-31T01:06:38.238243Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:06:38.238382Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:06:38.238594Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:06:38.238855Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:38.238893Z	error	sds	Remote side closed connection
2020-08-31T01:06:38.239043Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1d277a27-9901-4816-8f19-617d9556c768".sock: use of closed network connection
2020-08-31T01:06:38.239219Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7f95e70b-53fc-4cfe-82f5-4eec96477c47\".sock" 

2020-08-31T01:06:38.239322Z	info	sds	Start SDS grpc server
2020-08-31T01:06:38.239672Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:06:38.239706Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:06:38.239750Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:06:38.239987Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:38.240005Z	error	sds	Remote side closed connection
2020-08-31T01:06:38.240322Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7f95e70b-53fc-4cfe-82f5-4eec96477c47".sock: use of closed network connection
2020-08-31T01:06:38.240524Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d8d9ce82-fbe4-43a3-ad71-0dfb008f4a6d\".sock" 

2020-08-31T01:06:38.240568Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:38.541500Z	info	sds	resource:default new connection
2020-08-31T01:06:38.541623Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:06:38.541678Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:38.541975Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:38.542061Z	error	sds	Remote side closed connection
2020-08-31T01:06:38.542182Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d8d9ce82-fbe4-43a3-ad71-0dfb008f4a6d".sock: use of closed network connection
2020-08-31T01:06:38.542401Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a737a968-ea28-4caa-ac25-1d9f4a485c42\".sock" 

2020-08-31T01:06:38.542466Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7b2dd806-affa-4931-8449-7f0e6ebecce1\".sock" 

2020-08-31T01:06:38.542468Z	info	sds	Start SDS grpc server
2020-08-31T01:06:38.542498Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:38.843888Z	info	sds	resource:default new connection
2020-08-31T01:06:38.843958Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:06:38.844014Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:38.844348Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:38.844376Z	error	sds	Remote side closed connection
2020-08-31T01:06:38.844907Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:06:38.844962Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:06:38.845002Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:06:38.845182Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:38.845211Z	error	sds	Remote side closed connection
2020-08-31T01:06:38.936092Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:39.146243Z	info	sds	resource:default new connection
2020-08-31T01:06:39.146310Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:06:39.146381Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:39.146674Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:39.146714Z	error	sds	Remote side closed connection
2020-08-31T01:06:39.147136Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a737a968-ea28-4caa-ac25-1d9f4a485c42".sock: use of closed network connection
2020-08-31T01:06:39.147183Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7b2dd806-affa-4931-8449-7f0e6ebecce1".sock: use of closed network connection
2020-08-31T01:06:39.147401Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"53713bc5-2ef3-4267-828c-9055e690e244\".sock" 

2020-08-31T01:06:39.147420Z	info	sds	Start SDS grpc server
2020-08-31T01:06:39.239245Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:39.240503Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:06:39.450192Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"53713bc5-2ef3-4267-828c-9055e690e244".sock: use of closed network connection
2020-08-31T01:06:39.450385Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4d81ffad-6a75-4244-84bd-6aa16415d2d8\".sock" 

2020-08-31T01:06:39.450402Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:39.542395Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:06:39.752067Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4d81ffad-6a75-4244-84bd-6aa16415d2d8".sock: use of closed network connection
2020-08-31T01:06:39.752254Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest584ccfc8-ce59-4959-b4db-c82c965ce13c.sock" 

2020-08-31T01:06:39.752321Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"fc274090-3991-4978-bb4d-d7b2ac2c9ed0\".sock" 

2020-08-31T01:06:39.752363Z	info	sds	Start SDS grpc server
2020-08-31T01:06:39.752393Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:06:40.147336Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:40.147349Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:06:40.356891Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest584ccfc8-ce59-4959-b4db-c82c965ce13c.sock: use of closed network connection
2020-08-31T01:06:40.356942Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"fc274090-3991-4978-bb4d-d7b2ac2c9ed0".sock: use of closed network connection
2020-08-31T01:06:40.357113Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestcbd2e08c-a7cb-4da7-8bb2-906ff8dba708.sock" 

2020-08-31T01:06:40.357134Z	info	sds	Start SDS grpc server
2020-08-31T01:06:40.450393Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:40.659111Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:06:40.659276Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:40.659606Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestcbd2e08c-a7cb-4da7-8bb2-906ff8dba708.sock: use of closed network connection
2020-08-31T01:06:40.659914Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0a2b4f66-882d-4ca2-b858-63e149097bd6.sock" 

2020-08-31T01:06:40.659950Z	info	sds	Start SDS grpc server
2020-08-31T01:06:40.661699Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:06:40.661762Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:06:40.661847Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:40.662013Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:06:40.662078Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:06:40.662130Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:06:40.752296Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:40.936376Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:41.239367Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:41.240686Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:41.357109Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:41.357140Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:41.542633Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:41.659840Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:41.662019Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:41.662047Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:06:42.147619Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:42.147678Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:42.450506Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:42.662960Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:42.663287Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:42.663295Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0a2b4f66-882d-4ca2-b858-63e149097bd6.sock: use of closed network connection
2020-08-31T01:06:42.663313Z	error	sds	Remote side closed connection
2020-08-31T01:06:42.663495Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:42.663520Z	error	sds	Remote side closed connection
2020-08-31T01:06:42.663571Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2adb81d7-5b9f-422a-98f7-819e1da3d14e.sock" 

2020-08-31T01:06:42.663639Z	info	sds	Start SDS grpc server
2020-08-31T01:06:42.664639Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:06:42.664713Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:06:42.664760Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:42.665213Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:06:42.664759169 +0000 UTC m=+6.814397489 and is waiting for next SDS request
2020-08-31T01:06:42.665232Z	info	sds	Dynamic push for secret default
2020-08-31T01:06:42.665260Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2adb81d7-5b9f-422a-98f7-819e1da3d14e.sock: use of closed network connection
2020-08-31T01:06:42.665366Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:42.665401Z	error	sds	Remote side closed connection
2020-08-31T01:06:42.665413Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:42.665438Z	error	sds	Remote side closed connection
2020-08-31T01:06:42.665472Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest45863d88-5767-49d2-8cf2-02a1d6bb16f2.sock" 

2020-08-31T01:06:42.665497Z	info	sds	Start SDS grpc server
2020-08-31T01:06:42.666171Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:06:42.666245Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:06:42.666290Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:42.666876Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:06:42.752542Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:43.167030Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:43.167087Z	info	sds	Dynamic push for secret default
2020-08-31T01:06:43.167748Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest45863d88-5767-49d2-8cf2-02a1d6bb16f2.sock: use of closed network connection
2020-08-31T01:06:43.167832Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:43.167858Z	error	sds	Remote side closed connection
2020-08-31T01:06:43.167887Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:43.167908Z	error	sds	Remote side closed connection
2020-08-31T01:06:43.168025Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestefb4bd61-4d1b-403f-b12d-147c1e2f967f.sock" 

2020-08-31T01:06:43.168135Z	info	sds	Start SDS grpc server
2020-08-31T01:06:43.168289Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestefb4bd61-4d1b-403f-b12d-147c1e2f967f.sock: use of closed network connection
2020-08-31T01:06:43.168454Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestac2c0330-7f74-41ad-8eb9-4635a55d0417.sock" 

2020-08-31T01:06:43.168481Z	info	sds	Start SDS grpc server
2020-08-31T01:06:43.357393Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:43.357444Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:43.469440Z	info	sds	resource:default new connection
2020-08-31T01:06:43.469529Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:06:43.469590Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:43.469850Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:43.469880Z	error	sds	Remote side closed connection
2020-08-31T01:06:43.660075Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:43.663501Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:43.665402Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:43.770982Z	info	sds	resource:default new connection
2020-08-31T01:06:43.771047Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:06:43.771101Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:43.771390Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:43.771449Z	error	sds	Remote side closed connection
2020-08-31T01:06:43.771674Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestac2c0330-7f74-41ad-8eb9-4635a55d0417.sock: use of closed network connection
2020-08-31T01:06:43.771819Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3fe3fec4-eee8-4e4a-b3b8-f04d741ea0d2.sock" 

2020-08-31T01:06:43.771830Z	info	sds	Start SDS grpc server
2020-08-31T01:06:44.072858Z	info	sds	resource:default new connection
2020-08-31T01:06:44.072940Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:06:44.073009Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:44.073293Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:44.073310Z	error	sds	Remote side closed connection
2020-08-31T01:06:44.073788Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3fe3fec4-eee8-4e4a-b3b8-f04d741ea0d2.sock: use of closed network connection
2020-08-31T01:06:44.167971Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:44.168475Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:44.771912Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:44.936542Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:45.074014Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:06:45.239604Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:45.240878Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:45.542853Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:45.663728Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:45.665616Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:06:46.105734Z	info	sds	Start SDS grpc server
2020-08-31T01:06:46.105811Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb0a19a57-82d9-4df9-8809-3b196668a89b.sock" 

2020-08-31T01:06:46.147854Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:46.147854Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:46.168120Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:46.168639Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:46.450759Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:46.752772Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:46.772136Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:47.074270Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:47.107112Z	info	sds	resource:default new connection
2020-08-31T01:06:47.107222Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:06:47.111965Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:06:47.321106Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:06:47.321167Z	info	cache	GenerateSecret default
2020-08-31T01:06:47.321229Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:47.321581Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb0a19a57-82d9-4df9-8809-3b196668a89b.sock: use of closed network connection
PASS
2020-08-31T01:06:47.321688Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:47.321711Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.721s
2020-08-31T01:06:52.516649Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6a523764-99fb-41ed-81ba-f4821747c3c8.sock" 

2020-08-31T01:06:52.516744Z	info	sds	Start SDS grpc server
2020-08-31T01:06:52.518123Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:06:52.518191Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:06:52.518623Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:53.518042Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:53.518196Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:06:54.518768Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:06:54.518869Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:06:54.518896Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:06:54.518988Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:54.519290Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6a523764-99fb-41ed-81ba-f4821747c3c8.sock: use of closed network connection
2020-08-31T01:06:54.519437Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:54.519460Z	error	sds	Remote side closed connection
2020-08-31T01:06:54.519600Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ab52862b-3c78-4591-86fc-d7eaec5f786a\".sock" 

2020-08-31T01:06:54.519646Z	info	sds	Start SDS grpc server
2020-08-31T01:06:54.820514Z	info	sds	resource:default new connection
2020-08-31T01:06:54.820573Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:06:54.820626Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:54.821000Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:54.821030Z	error	sds	Remote side closed connection
2020-08-31T01:06:54.821618Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:06:54.821659Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:06:54.821812Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:06:54.822032Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:54.822059Z	error	sds	Remote side closed connection
2020-08-31T01:06:54.822241Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ab52862b-3c78-4591-86fc-d7eaec5f786a".sock: use of closed network connection
2020-08-31T01:06:54.822446Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"edf50589-b0bd-430d-911b-d13db3315b4d\".sock" 

2020-08-31T01:06:54.822545Z	info	sds	Start SDS grpc server
2020-08-31T01:06:54.823338Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:06:54.823377Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:06:54.823423Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:06:54.823713Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:54.823732Z	error	sds	Remote side closed connection
2020-08-31T01:06:54.823986Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"edf50589-b0bd-430d-911b-d13db3315b4d".sock: use of closed network connection
2020-08-31T01:06:54.824236Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"aac1d0f4-6998-4f55-b214-00545bdd01aa\".sock" 

2020-08-31T01:06:54.824270Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:55.125265Z	info	sds	resource:default new connection
2020-08-31T01:06:55.125319Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:06:55.125368Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:55.125673Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:55.125704Z	error	sds	Remote side closed connection
2020-08-31T01:06:55.125839Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"aac1d0f4-6998-4f55-b214-00545bdd01aa".sock: use of closed network connection
2020-08-31T01:06:55.126056Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7e6dccc7-2374-4a2d-af09-5f20a998abf8\".sock" 

2020-08-31T01:06:55.126116Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0115b87f-449a-4799-b842-9c325d7953c2\".sock" 

2020-08-31T01:06:55.126105Z	info	sds	Start SDS grpc server
2020-08-31T01:06:55.126126Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:55.427334Z	info	sds	resource:default new connection
2020-08-31T01:06:55.427408Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:06:55.427461Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:55.427740Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:55.427770Z	error	sds	Remote side closed connection
2020-08-31T01:06:55.428558Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:06:55.428603Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:06:55.428644Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:06:55.429075Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:55.429104Z	error	sds	Remote side closed connection
2020-08-31T01:06:55.519599Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:55.730186Z	info	sds	resource:default new connection
2020-08-31T01:06:55.730241Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:06:55.730304Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:55.730709Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:55.730744Z	error	sds	Remote side closed connection
2020-08-31T01:06:55.730893Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7e6dccc7-2374-4a2d-af09-5f20a998abf8".sock: use of closed network connection
2020-08-31T01:06:55.731005Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0115b87f-449a-4799-b842-9c325d7953c2".sock: use of closed network connection
2020-08-31T01:06:55.731199Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"41af3a33-2600-47fa-9a2f-a1ec286ccc96\".sock" 

2020-08-31T01:06:55.731224Z	info	sds	Start SDS grpc server
2020-08-31T01:06:55.822451Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:55.824135Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:06:56.034859Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"41af3a33-2600-47fa-9a2f-a1ec286ccc96".sock: use of closed network connection
2020-08-31T01:06:56.035028Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0f7e5ab7-1f09-4640-91a2-4a0dd982fb81\".sock" 

2020-08-31T01:06:56.035048Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:06:56.126029Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:06:56.336534Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0f7e5ab7-1f09-4640-91a2-4a0dd982fb81".sock: use of closed network connection
2020-08-31T01:06:56.336781Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestcd2bad17-1bde-48d4-820c-5024909ebb3a.sock" 

2020-08-31T01:06:56.336800Z	info	sds	Start SDS grpc server
2020-08-31T01:06:56.336858Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7a3d4c9a-60f5-4527-84ff-6cb8c6ff66f2\".sock" 

2020-08-31T01:06:56.336892Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:06:56.731099Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:56.731133Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:06:56.941071Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestcd2bad17-1bde-48d4-820c-5024909ebb3a.sock: use of closed network connection
2020-08-31T01:06:56.941125Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7a3d4c9a-60f5-4527-84ff-6cb8c6ff66f2".sock: use of closed network connection
2020-08-31T01:06:56.941322Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestd274db19-b3d1-4434-bf4d-9e1ff309077f.sock" 

2020-08-31T01:06:56.941357Z	info	sds	Start SDS grpc server
2020-08-31T01:06:57.035038Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:57.242370Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:06:57.242480Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:57.242729Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestd274db19-b3d1-4434-bf4d-9e1ff309077f.sock: use of closed network connection
2020-08-31T01:06:57.242982Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1d36ce70-4f3e-484e-bf82-c175d805b188.sock" 

2020-08-31T01:06:57.243077Z	info	sds	Start SDS grpc server
2020-08-31T01:06:57.243799Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:06:57.243847Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:06:57.243892Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:57.244024Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:06:57.244049Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:06:57.244071Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:06:57.336754Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:57.519872Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:57.822714Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:57.824333Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:57.941152Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:57.941216Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:58.126279Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:58.242979Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:58.244156Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:58.244188Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:06:58.731372Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:58.731355Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:59.035282Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:59.245068Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:59.245397Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1d36ce70-4f3e-484e-bf82-c175d805b188.sock: use of closed network connection
2020-08-31T01:06:59.245453Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:59.245469Z	error	sds	Remote side closed connection
2020-08-31T01:06:59.245484Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:59.245510Z	error	sds	Remote side closed connection
2020-08-31T01:06:59.245599Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd677eece-4151-46d8-add4-4b0c826ff7d2.sock" 

2020-08-31T01:06:59.245705Z	info	sds	Start SDS grpc server
2020-08-31T01:06:59.246345Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:06:59.246388Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:06:59.246443Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:59.246852Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:06:59.246442365 +0000 UTC m=+6.804883084 and is waiting for next SDS request
2020-08-31T01:06:59.246872Z	info	sds	Dynamic push for secret default
2020-08-31T01:06:59.246905Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd677eece-4151-46d8-add4-4b0c826ff7d2.sock: use of closed network connection
2020-08-31T01:06:59.246963Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:59.246978Z	error	sds	Remote side closed connection
2020-08-31T01:06:59.246999Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:59.247024Z	error	sds	Remote side closed connection
2020-08-31T01:06:59.247152Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta0ba4036-0fa8-488e-95b2-89ee4be1d1b5.sock" 

2020-08-31T01:06:59.247171Z	info	sds	Start SDS grpc server
2020-08-31T01:06:59.247934Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:06:59.247977Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:06:59.248013Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:59.248618Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:06:59.336876Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:06:59.748880Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:06:59.748936Z	info	sds	Dynamic push for secret default
2020-08-31T01:06:59.749540Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta0ba4036-0fa8-488e-95b2-89ee4be1d1b5.sock: use of closed network connection
2020-08-31T01:06:59.749645Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:59.749659Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:06:59.749687Z	error	sds	Remote side closed connection
2020-08-31T01:06:59.749682Z	error	sds	Remote side closed connection
2020-08-31T01:06:59.749824Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4fc77151-2f61-427e-8e5a-2fe7116a6d69.sock" 

2020-08-31T01:06:59.749911Z	info	sds	Start SDS grpc server
2020-08-31T01:06:59.750030Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4fc77151-2f61-427e-8e5a-2fe7116a6d69.sock: use of closed network connection
2020-08-31T01:06:59.750110Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbc78deae-eb7f-4584-a3cd-5d72c5baf00f.sock" 

2020-08-31T01:06:59.750115Z	info	sds	Start SDS grpc server
2020-08-31T01:06:59.941409Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:06:59.941456Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:00.050943Z	info	sds	resource:default new connection
2020-08-31T01:07:00.051005Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:07:00.051082Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:00.051468Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:00.051498Z	error	sds	Remote side closed connection
2020-08-31T01:07:00.243232Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:00.245603Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:00.247085Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:00.352551Z	info	sds	resource:default new connection
2020-08-31T01:07:00.352623Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:07:00.352731Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:00.352997Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:00.353026Z	error	sds	Remote side closed connection
2020-08-31T01:07:00.353324Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbc78deae-eb7f-4584-a3cd-5d72c5baf00f.sock: use of closed network connection
2020-08-31T01:07:00.353475Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest16997b86-e91e-45f7-94f0-21d33e3f7459.sock" 

2020-08-31T01:07:00.353517Z	info	sds	Start SDS grpc server
2020-08-31T01:07:00.654458Z	info	sds	resource:default new connection
2020-08-31T01:07:00.654526Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:07:00.654588Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:00.654950Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:00.654976Z	error	sds	Remote side closed connection
2020-08-31T01:07:00.655277Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest16997b86-e91e-45f7-94f0-21d33e3f7459.sock: use of closed network connection
2020-08-31T01:07:00.749749Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:00.750118Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:01.353549Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:01.520018Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:01.655493Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:07:01.822914Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:01.824530Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:02.126546Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:02.245821Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:02.247286Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:07:02.687255Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb384adfc-860a-433c-bf87-c5e1b482f0fd.sock" 

2020-08-31T01:07:02.687317Z	info	sds	Start SDS grpc server
2020-08-31T01:07:02.731612Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:02.731675Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:02.749987Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:02.750256Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:03.035549Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:03.337102Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:03.353814Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:03.655752Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:03.688379Z	info	sds	resource:default new connection
2020-08-31T01:07:03.688456Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:07:03.694227Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:07:03.859718Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:07:03.859788Z	info	cache	GenerateSecret default
2020-08-31T01:07:03.859872Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:03.860334Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb384adfc-860a-433c-bf87-c5e1b482f0fd.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.663s
2020-08-31T01:07:09.094821Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc3a13511-54ae-44a0-9302-3cca9dfd025c.sock" 

2020-08-31T01:07:09.094913Z	info	sds	Start SDS grpc server
2020-08-31T01:07:09.096272Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:07:09.096335Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:07:09.096744Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:10.096202Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:10.096273Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:07:11.096893Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:07:11.096972Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:07:11.097000Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:07:11.097063Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:11.097239Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc3a13511-54ae-44a0-9302-3cca9dfd025c.sock: use of closed network connection
2020-08-31T01:07:11.097354Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:11.097378Z	error	sds	Remote side closed connection
2020-08-31T01:07:11.097525Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1dba3817-089f-4a2a-a00f-87b0318d63f9\".sock" 

2020-08-31T01:07:11.097544Z	info	sds	Start SDS grpc server
2020-08-31T01:07:11.398472Z	info	sds	resource:default new connection
2020-08-31T01:07:11.398531Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:07:11.398604Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:11.398872Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:11.398892Z	error	sds	Remote side closed connection
2020-08-31T01:07:11.399459Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:07:11.399495Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:07:11.399654Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:07:11.399917Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:11.399929Z	error	sds	Remote side closed connection
2020-08-31T01:07:11.400154Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1dba3817-089f-4a2a-a00f-87b0318d63f9".sock: use of closed network connection
2020-08-31T01:07:11.400381Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d15d85ad-8e05-4c44-85e5-a5be6491b5ec\".sock" 

2020-08-31T01:07:11.400453Z	info	sds	Start SDS grpc server
2020-08-31T01:07:11.401052Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:07:11.401085Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:07:11.401120Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:07:11.401304Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:11.401324Z	error	sds	Remote side closed connection
2020-08-31T01:07:11.401500Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d15d85ad-8e05-4c44-85e5-a5be6491b5ec".sock: use of closed network connection
2020-08-31T01:07:11.401672Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"fc982162-1610-4698-bcd1-3d665e06b0d4\".sock" 

2020-08-31T01:07:11.401712Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:11.703061Z	info	sds	resource:default new connection
2020-08-31T01:07:11.703128Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:07:11.703183Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:11.703437Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:11.703464Z	error	sds	Remote side closed connection
2020-08-31T01:07:11.703807Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"fc982162-1610-4698-bcd1-3d665e06b0d4".sock: use of closed network connection
2020-08-31T01:07:11.704253Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"db140ea4-7762-484b-aa3e-9def32fc72de\".sock" 

2020-08-31T01:07:11.704363Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0421e656-4d55-4df5-b04d-a2f1fe90e23a\".sock" 

2020-08-31T01:07:11.704378Z	info	sds	Start SDS grpc server
2020-08-31T01:07:11.704419Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:12.005455Z	info	sds	resource:default new connection
2020-08-31T01:07:12.005518Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:07:12.005597Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:12.005977Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:12.006011Z	error	sds	Remote side closed connection
2020-08-31T01:07:12.006703Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:07:12.006760Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:07:12.006830Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:07:12.007193Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:12.007215Z	error	sds	Remote side closed connection
2020-08-31T01:07:12.097395Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:12.308048Z	info	sds	resource:default new connection
2020-08-31T01:07:12.308131Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:07:12.308193Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:12.308455Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:12.308467Z	error	sds	Remote side closed connection
2020-08-31T01:07:12.308758Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"db140ea4-7762-484b-aa3e-9def32fc72de".sock: use of closed network connection
2020-08-31T01:07:12.308813Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0421e656-4d55-4df5-b04d-a2f1fe90e23a".sock: use of closed network connection
2020-08-31T01:07:12.308987Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1afe88db-3880-4f4b-a7e3-a8327f7a1aab\".sock" 

2020-08-31T01:07:12.309010Z	info	sds	Start SDS grpc server
2020-08-31T01:07:12.400363Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:12.401711Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:07:12.611410Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1afe88db-3880-4f4b-a7e3-a8327f7a1aab".sock: use of closed network connection
2020-08-31T01:07:12.611616Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bb7314f5-ea8e-4aab-87f6-ed9e6b1f1184\".sock" 

2020-08-31T01:07:12.611642Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:12.704040Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:07:12.913211Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bb7314f5-ea8e-4aab-87f6-ed9e6b1f1184".sock: use of closed network connection
2020-08-31T01:07:12.913492Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1556879b-81de-4325-a22a-574f75e0010a.sock" 

2020-08-31T01:07:12.913563Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"371a51db-7496-4af6-b3e5-a13f3c62f398\".sock" 

2020-08-31T01:07:12.913601Z	info	sds	Start SDS grpc server
2020-08-31T01:07:12.913617Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:07:13.309001Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:13.309051Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:07:13.517468Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1556879b-81de-4325-a22a-574f75e0010a.sock: use of closed network connection
2020-08-31T01:07:13.517521Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"371a51db-7496-4af6-b3e5-a13f3c62f398".sock: use of closed network connection
2020-08-31T01:07:13.517717Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest314ff4f8-e5d5-4788-808b-8dbeceb803a1.sock" 

2020-08-31T01:07:13.517742Z	info	sds	Start SDS grpc server
2020-08-31T01:07:13.611501Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:13.819180Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:07:13.819286Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:13.819494Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest314ff4f8-e5d5-4788-808b-8dbeceb803a1.sock: use of closed network connection
2020-08-31T01:07:13.819702Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest72b76299-e7c3-4c05-9a74-3aa8219ea9e1.sock" 

2020-08-31T01:07:13.819796Z	info	sds	Start SDS grpc server
2020-08-31T01:07:13.820442Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:07:13.820489Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:07:13.820533Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:13.820693Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:07:13.820718Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:07:13.820741Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:07:13.913460Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:14.097650Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:14.400636Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:14.401939Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:14.517636Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:14.517658Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:14.704294Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:14.819703Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:14.820876Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:14.820915Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:07:15.309252Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:15.309302Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:15.611739Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:15.821669Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:15.822082Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest72b76299-e7c3-4c05-9a74-3aa8219ea9e1.sock: use of closed network connection
2020-08-31T01:07:15.822113Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:15.822146Z	error	sds	Remote side closed connection
2020-08-31T01:07:15.822185Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:15.822207Z	error	sds	Remote side closed connection
2020-08-31T01:07:15.822302Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcf404bad-91e2-422d-a3d0-af62631e1fb5.sock" 

2020-08-31T01:07:15.822376Z	info	sds	Start SDS grpc server
2020-08-31T01:07:15.823018Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:07:15.823497Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:07:15.823574Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:15.824942Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:07:15.823573137 +0000 UTC m=+6.806717807 and is waiting for next SDS request
2020-08-31T01:07:15.824974Z	info	sds	Dynamic push for secret default
2020-08-31T01:07:15.825401Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:15.825436Z	error	sds	Remote side closed connection
2020-08-31T01:07:15.825400Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcf404bad-91e2-422d-a3d0-af62631e1fb5.sock: use of closed network connection
2020-08-31T01:07:15.825487Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:15.825497Z	error	sds	Remote side closed connection
2020-08-31T01:07:15.825701Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestec0de1e4-5296-42f0-9774-80abf82bf81e.sock" 

2020-08-31T01:07:15.825773Z	info	sds	Start SDS grpc server
2020-08-31T01:07:15.826459Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:07:15.826505Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:07:15.826552Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:15.827130Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:07:15.913693Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:16.327364Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:16.327439Z	info	sds	Dynamic push for secret default
2020-08-31T01:07:16.328056Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestec0de1e4-5296-42f0-9774-80abf82bf81e.sock: use of closed network connection
2020-08-31T01:07:16.328135Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:16.328164Z	error	sds	Remote side closed connection
2020-08-31T01:07:16.328178Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:16.328199Z	error	sds	Remote side closed connection
2020-08-31T01:07:16.328421Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest39422f7b-a0d0-4553-8b4d-9a551f6fdbfa.sock" 

2020-08-31T01:07:16.328469Z	info	sds	Start SDS grpc server
2020-08-31T01:07:16.328711Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest39422f7b-a0d0-4553-8b4d-9a551f6fdbfa.sock: use of closed network connection
2020-08-31T01:07:16.328800Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4e6de754-b919-430a-a7e9-c9a4839326fa.sock" 

2020-08-31T01:07:16.328819Z	info	sds	Start SDS grpc server
2020-08-31T01:07:16.517854Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:16.517907Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:16.629906Z	info	sds	resource:default new connection
2020-08-31T01:07:16.629972Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:07:16.630034Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:16.630256Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:16.630283Z	error	sds	Remote side closed connection
2020-08-31T01:07:16.819946Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:16.822278Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:16.825679Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:16.931418Z	info	sds	resource:default new connection
2020-08-31T01:07:16.931486Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:07:16.931544Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:16.931736Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:16.931748Z	error	sds	Remote side closed connection
2020-08-31T01:07:16.932112Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4e6de754-b919-430a-a7e9-c9a4839326fa.sock: use of closed network connection
2020-08-31T01:07:16.932250Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest80874336-b3cd-45e6-a892-9bca6eb596e7.sock" 

2020-08-31T01:07:16.932282Z	info	sds	Start SDS grpc server
2020-08-31T01:07:17.233274Z	info	sds	resource:default new connection
2020-08-31T01:07:17.233332Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:07:17.233385Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:17.233633Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:17.233659Z	error	sds	Remote side closed connection
2020-08-31T01:07:17.233918Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest80874336-b3cd-45e6-a892-9bca6eb596e7.sock: use of closed network connection
2020-08-31T01:07:17.328346Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:17.328849Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:17.932328Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:18.097790Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:18.234133Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:07:18.400944Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:18.402135Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:18.704553Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:18.822511Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:18.825887Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:07:19.263484Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest852a09cb-336b-4237-98f0-212bce6d0108.sock" 

2020-08-31T01:07:19.263501Z	info	sds	Start SDS grpc server
2020-08-31T01:07:19.309529Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:19.309567Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:19.328618Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:19.329028Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:19.611981Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:19.913923Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:19.932627Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:20.234431Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:20.264321Z	info	sds	resource:default new connection
2020-08-31T01:07:20.264387Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:07:20.267997Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:07:20.518104Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:20.518150Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:20.648220Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:07:20.648297Z	info	cache	GenerateSecret default
2020-08-31T01:07:20.648366Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:20.648810Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest852a09cb-336b-4237-98f0-212bce6d0108.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.879s
2020-08-31T01:07:25.888926Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest09d540f1-6ac5-4509-a6cf-8df45b4499eb.sock" 

2020-08-31T01:07:25.889027Z	info	sds	Start SDS grpc server
2020-08-31T01:07:25.890349Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:07:25.890416Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:07:25.890793Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:26.890229Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:26.890290Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:07:27.891066Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:07:27.891147Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:07:27.891187Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:07:27.891257Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:27.891462Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest09d540f1-6ac5-4509-a6cf-8df45b4499eb.sock: use of closed network connection
2020-08-31T01:07:27.891662Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:27.891697Z	error	sds	Remote side closed connection
2020-08-31T01:07:27.891777Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"144632af-bc49-4177-9fdc-c663ca080d96\".sock" 

2020-08-31T01:07:27.891814Z	info	sds	Start SDS grpc server
2020-08-31T01:07:28.192919Z	info	sds	resource:default new connection
2020-08-31T01:07:28.192992Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:07:28.193053Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:28.193393Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:28.193418Z	error	sds	Remote side closed connection
2020-08-31T01:07:28.193933Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:07:28.193979Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:07:28.194129Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:07:28.194401Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:28.194424Z	error	sds	Remote side closed connection
2020-08-31T01:07:28.194576Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"144632af-bc49-4177-9fdc-c663ca080d96".sock: use of closed network connection
2020-08-31T01:07:28.194752Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f708369e-9495-46b4-9831-ca495b7732ef\".sock" 

2020-08-31T01:07:28.194820Z	info	sds	Start SDS grpc server
2020-08-31T01:07:28.195665Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:07:28.195697Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:07:28.195733Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:07:28.195948Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:28.195971Z	error	sds	Remote side closed connection
2020-08-31T01:07:28.196239Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f708369e-9495-46b4-9831-ca495b7732ef".sock: use of closed network connection
2020-08-31T01:07:28.196418Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9a7176ad-ce88-494e-b85d-d08b7b13566e\".sock" 

2020-08-31T01:07:28.196450Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:28.497351Z	info	sds	resource:default new connection
2020-08-31T01:07:28.497419Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:07:28.497500Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:28.497849Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:28.497875Z	error	sds	Remote side closed connection
2020-08-31T01:07:28.498077Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9a7176ad-ce88-494e-b85d-d08b7b13566e".sock: use of closed network connection
2020-08-31T01:07:28.498314Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"20f4ec61-0381-4b13-bfd6-634b7cd932c5\".sock" 

2020-08-31T01:07:28.498329Z	info	sds	Start SDS grpc server
2020-08-31T01:07:28.498390Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5e999691-bebf-4ae9-a565-5e703d5d451e\".sock" 

2020-08-31T01:07:28.498428Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:28.799360Z	info	sds	resource:default new connection
2020-08-31T01:07:28.799431Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:07:28.799499Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:28.799806Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:28.799855Z	error	sds	Remote side closed connection
2020-08-31T01:07:28.800447Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:07:28.800493Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:07:28.800531Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:07:28.800765Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:28.800786Z	error	sds	Remote side closed connection
2020-08-31T01:07:28.891693Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:29.101715Z	info	sds	resource:default new connection
2020-08-31T01:07:29.101781Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:07:29.101840Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:29.102155Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:29.102213Z	error	sds	Remote side closed connection
2020-08-31T01:07:29.102358Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"20f4ec61-0381-4b13-bfd6-634b7cd932c5".sock: use of closed network connection
2020-08-31T01:07:29.102403Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5e999691-bebf-4ae9-a565-5e703d5d451e".sock: use of closed network connection
2020-08-31T01:07:29.102618Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"55963110-e9b8-4d64-aabe-f6189d3f855b\".sock" 

2020-08-31T01:07:29.102660Z	info	sds	Start SDS grpc server
2020-08-31T01:07:29.194784Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:29.196456Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:07:29.405075Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"55963110-e9b8-4d64-aabe-f6189d3f855b".sock: use of closed network connection
2020-08-31T01:07:29.405254Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6495ae44-79f6-408b-90d0-d3d5da85b20a\".sock" 

2020-08-31T01:07:29.405323Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:29.498284Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:07:29.706864Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6495ae44-79f6-408b-90d0-d3d5da85b20a".sock: use of closed network connection
2020-08-31T01:07:29.707050Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest6df1ae37-6252-4568-a0de-119a8119f5ac.sock" 

2020-08-31T01:07:29.707102Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2091b950-848c-4031-81ba-444486ade8a3\".sock" 

2020-08-31T01:07:29.707123Z	info	sds	Start SDS grpc server
2020-08-31T01:07:29.707141Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:07:30.102584Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:30.102626Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:07:30.311756Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest6df1ae37-6252-4568-a0de-119a8119f5ac.sock: use of closed network connection
2020-08-31T01:07:30.311954Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2091b950-848c-4031-81ba-444486ade8a3".sock: use of closed network connection
2020-08-31T01:07:30.312147Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1365d0fa-bcc0-40ab-9283-bde69e9e3777.sock" 

2020-08-31T01:07:30.312172Z	info	sds	Start SDS grpc server
2020-08-31T01:07:30.405334Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:30.613270Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:07:30.613387Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:30.613624Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1365d0fa-bcc0-40ab-9283-bde69e9e3777.sock: use of closed network connection
2020-08-31T01:07:30.614042Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestefbfb4a5-1ec6-43c8-95f3-4f516eb999e9.sock" 

2020-08-31T01:07:30.614090Z	info	sds	Start SDS grpc server
2020-08-31T01:07:30.614846Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:07:30.615336Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:07:30.615432Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:30.615871Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:07:30.615941Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:07:30.615994Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:07:30.707081Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:30.891929Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:31.195031Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:31.196556Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:31.311987Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:31.312027Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:31.498512Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:31.613854Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:31.615896Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:31.615944Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:07:32.102942Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:32.102924Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:32.405600Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:32.616950Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:32.617295Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestefbfb4a5-1ec6-43c8-95f3-4f516eb999e9.sock: use of closed network connection
2020-08-31T01:07:32.617320Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:32.617342Z	error	sds	Remote side closed connection
2020-08-31T01:07:32.617412Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:32.617448Z	error	sds	Remote side closed connection
2020-08-31T01:07:32.617566Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest594f4bc3-56fb-4178-8ce7-7d1c9aadb775.sock" 

2020-08-31T01:07:32.617637Z	info	sds	Start SDS grpc server
2020-08-31T01:07:32.618399Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:07:32.618487Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:07:32.618536Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:32.619010Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:07:32.618535202 +0000 UTC m=+6.803526377 and is waiting for next SDS request
2020-08-31T01:07:32.619037Z	info	sds	Dynamic push for secret default
2020-08-31T01:07:32.619046Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest594f4bc3-56fb-4178-8ce7-7d1c9aadb775.sock: use of closed network connection
2020-08-31T01:07:32.619158Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:32.619159Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:32.619175Z	error	sds	Remote side closed connection
2020-08-31T01:07:32.619217Z	error	sds	Remote side closed connection
2020-08-31T01:07:32.619273Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta01ff2ca-5da1-4a13-9332-38d419532d1d.sock" 

2020-08-31T01:07:32.619410Z	info	sds	Start SDS grpc server
2020-08-31T01:07:32.620091Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:07:32.620140Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:07:32.620176Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:32.620646Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:07:32.707374Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:33.120875Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:33.120949Z	info	sds	Dynamic push for secret default
2020-08-31T01:07:33.121536Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta01ff2ca-5da1-4a13-9332-38d419532d1d.sock: use of closed network connection
2020-08-31T01:07:33.121610Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:33.121637Z	error	sds	Remote side closed connection
2020-08-31T01:07:33.121657Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:33.121686Z	error	sds	Remote side closed connection
2020-08-31T01:07:33.121766Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest77d7361c-c31e-4965-bc4b-a71a530790a9.sock" 

2020-08-31T01:07:33.121796Z	info	sds	Start SDS grpc server
2020-08-31T01:07:33.121987Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest77d7361c-c31e-4965-bc4b-a71a530790a9.sock: use of closed network connection
2020-08-31T01:07:33.122070Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1f4bb29c-1dda-428c-bf68-16cd10fb3cc9.sock" 

2020-08-31T01:07:33.122086Z	info	sds	Start SDS grpc server
2020-08-31T01:07:33.312181Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:33.312211Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:33.423175Z	info	sds	resource:default new connection
2020-08-31T01:07:33.423244Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:07:33.423302Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:33.423588Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:33.423611Z	error	sds	Remote side closed connection
2020-08-31T01:07:33.614186Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:33.617503Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:33.619208Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:33.724643Z	info	sds	resource:default new connection
2020-08-31T01:07:33.724734Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:07:33.724786Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:33.724953Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:33.724964Z	error	sds	Remote side closed connection
2020-08-31T01:07:33.725358Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1f4bb29c-1dda-428c-bf68-16cd10fb3cc9.sock: use of closed network connection
2020-08-31T01:07:33.725487Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0af4b480-95ca-4a0a-9b41-e8d7363849f6.sock" 

2020-08-31T01:07:33.725520Z	info	sds	Start SDS grpc server
2020-08-31T01:07:34.026435Z	info	sds	resource:default new connection
2020-08-31T01:07:34.026515Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:07:34.026571Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:34.026916Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:34.026952Z	error	sds	Remote side closed connection
2020-08-31T01:07:34.027196Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0af4b480-95ca-4a0a-9b41-e8d7363849f6.sock: use of closed network connection
2020-08-31T01:07:34.121874Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:34.122129Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:34.725560Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:34.892077Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:35.027409Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:07:35.195261Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:35.196735Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:35.498647Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:35.617700Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:35.619408Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:07:36.057889Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7ff7b2fc-dbe4-4408-b777-73f2ebe8de86.sock" 

2020-08-31T01:07:36.057936Z	info	sds	Start SDS grpc server
2020-08-31T01:07:36.103103Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:36.103165Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:36.122163Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:36.122193Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:36.405828Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:36.707630Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:36.725792Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:37.027684Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:37.058928Z	info	sds	resource:default new connection
2020-08-31T01:07:37.058997Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:07:37.065795Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:07:37.249635Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:07:37.249689Z	info	cache	GenerateSecret default
2020-08-31T01:07:37.249791Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:37.250156Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7ff7b2fc-dbe4-4408-b777-73f2ebe8de86.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.680s
2020-08-31T01:07:42.503034Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest056c566c-93a2-48e9-8365-e3742f1e0265.sock" 

2020-08-31T01:07:42.503124Z	info	sds	Start SDS grpc server
2020-08-31T01:07:42.504416Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:07:42.504498Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:07:42.505370Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:43.504359Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:43.504435Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:07:44.505023Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:07:44.505116Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:07:44.505149Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:07:44.505219Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:44.505418Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest056c566c-93a2-48e9-8365-e3742f1e0265.sock: use of closed network connection
2020-08-31T01:07:44.505520Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:44.505543Z	error	sds	Remote side closed connection
2020-08-31T01:07:44.505678Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d07db238-6cd8-4428-a8db-30a4471e4188\".sock" 

2020-08-31T01:07:44.505697Z	info	sds	Start SDS grpc server
2020-08-31T01:07:44.806665Z	info	sds	resource:default new connection
2020-08-31T01:07:44.806738Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:07:44.806794Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:44.807103Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:44.807121Z	error	sds	Remote side closed connection
2020-08-31T01:07:44.807650Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:07:44.807687Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:07:44.807876Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:07:44.808088Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:44.808114Z	error	sds	Remote side closed connection
2020-08-31T01:07:44.808322Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d07db238-6cd8-4428-a8db-30a4471e4188".sock: use of closed network connection
2020-08-31T01:07:44.808495Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"44b6fc06-27ff-45c9-817d-4d2e68d0d6d2\".sock" 

2020-08-31T01:07:44.808565Z	info	sds	Start SDS grpc server
2020-08-31T01:07:44.808957Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:07:44.808991Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:07:44.809029Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:07:44.809231Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:44.809264Z	error	sds	Remote side closed connection
2020-08-31T01:07:44.809403Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"44b6fc06-27ff-45c9-817d-4d2e68d0d6d2".sock: use of closed network connection
2020-08-31T01:07:44.809536Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3b391bb6-c53e-4bf1-8423-5d92fcb7a043\".sock" 

2020-08-31T01:07:44.809565Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:45.110637Z	info	sds	resource:default new connection
2020-08-31T01:07:45.110708Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:07:45.110761Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:45.111222Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:45.111268Z	error	sds	Remote side closed connection
2020-08-31T01:07:45.111421Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3b391bb6-c53e-4bf1-8423-5d92fcb7a043".sock: use of closed network connection
2020-08-31T01:07:45.111598Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4d6f03cc-d9bb-4063-86b1-9191c62ea5ba\".sock" 

2020-08-31T01:07:45.111620Z	info	sds	Start SDS grpc server
2020-08-31T01:07:45.111666Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a6c649e4-8653-47cb-9c26-64a257c58510\".sock" 

2020-08-31T01:07:45.111701Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:45.412765Z	info	sds	resource:default new connection
2020-08-31T01:07:45.412833Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:07:45.412890Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:45.413212Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:45.413237Z	error	sds	Remote side closed connection
2020-08-31T01:07:45.413838Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:07:45.413902Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:07:45.413941Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:07:45.414126Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:45.414151Z	error	sds	Remote side closed connection
2020-08-31T01:07:45.505615Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:45.715288Z	info	sds	resource:default new connection
2020-08-31T01:07:45.715350Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:07:45.715418Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:45.715708Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:45.715743Z	error	sds	Remote side closed connection
2020-08-31T01:07:45.716017Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4d6f03cc-d9bb-4063-86b1-9191c62ea5ba".sock: use of closed network connection
2020-08-31T01:07:45.716079Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a6c649e4-8653-47cb-9c26-64a257c58510".sock: use of closed network connection
2020-08-31T01:07:45.716309Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"67f6347e-78ec-4627-9b39-b3cb913c8860\".sock" 

2020-08-31T01:07:45.716353Z	info	sds	Start SDS grpc server
2020-08-31T01:07:45.808496Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:45.809550Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:07:46.019745Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"67f6347e-78ec-4627-9b39-b3cb913c8860".sock: use of closed network connection
2020-08-31T01:07:46.020038Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2d5b89f9-c620-405b-8892-f7e5ca5bfc54\".sock" 

2020-08-31T01:07:46.020056Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:07:46.111593Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:07:46.321731Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2d5b89f9-c620-405b-8892-f7e5ca5bfc54".sock: use of closed network connection
2020-08-31T01:07:46.321917Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest02445eda-bc9b-4c74-a101-b06945579f24.sock" 

2020-08-31T01:07:46.321937Z	info	sds	Start SDS grpc server
2020-08-31T01:07:46.322012Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"46286a14-4c4e-4aea-9aa7-4a9ec33b2335\".sock" 

2020-08-31T01:07:46.322056Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:07:46.716282Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:46.716283Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:07:46.926052Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest02445eda-bc9b-4c74-a101-b06945579f24.sock: use of closed network connection
2020-08-31T01:07:46.926103Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"46286a14-4c4e-4aea-9aa7-4a9ec33b2335".sock: use of closed network connection
2020-08-31T01:07:46.926309Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1a1cba0b-5132-4f59-8c9c-cdcc7d11228d.sock" 

2020-08-31T01:07:46.926331Z	info	sds	Start SDS grpc server
2020-08-31T01:07:47.019907Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:47.228879Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:07:47.229329Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:47.229581Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1a1cba0b-5132-4f59-8c9c-cdcc7d11228d.sock: use of closed network connection
2020-08-31T01:07:47.229889Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9f3eac86-1664-45ed-8fcf-c8a60a7d8fca.sock" 

2020-08-31T01:07:47.229916Z	info	sds	Start SDS grpc server
2020-08-31T01:07:47.230670Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:07:47.230726Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:07:47.230770Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:47.230929Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:07:47.231007Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:07:47.231051Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:07:47.321930Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:47.505834Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:47.808837Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:47.809775Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:47.926282Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:47.926311Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:48.111880Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:48.229780Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:48.231006Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:48.231054Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:07:48.716550Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:48.716583Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:49.020158Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:49.231924Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:49.232223Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:49.232246Z	error	sds	Remote side closed connection
2020-08-31T01:07:49.232255Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9f3eac86-1664-45ed-8fcf-c8a60a7d8fca.sock: use of closed network connection
2020-08-31T01:07:49.232357Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:49.232381Z	error	sds	Remote side closed connection
2020-08-31T01:07:49.232497Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest01f786de-e39b-4d83-b553-f483d65db874.sock" 

2020-08-31T01:07:49.232545Z	info	sds	Start SDS grpc server
2020-08-31T01:07:49.233463Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:07:49.233516Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:07:49.233573Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:49.234234Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:07:49.233572058 +0000 UTC m=+6.811606367 and is waiting for next SDS request
2020-08-31T01:07:49.234272Z	info	sds	Dynamic push for secret default
2020-08-31T01:07:49.234294Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest01f786de-e39b-4d83-b553-f483d65db874.sock: use of closed network connection
2020-08-31T01:07:49.234371Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:49.234384Z	error	sds	Remote side closed connection
2020-08-31T01:07:49.234428Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:49.234436Z	error	sds	Remote side closed connection
2020-08-31T01:07:49.234566Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest10f2755a-d99a-466d-a3bf-271dc053338a.sock" 

2020-08-31T01:07:49.234642Z	info	sds	Start SDS grpc server
2020-08-31T01:07:49.235290Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:07:49.235338Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:07:49.235384Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:49.236013Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:07:49.322244Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:49.736185Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:49.736243Z	info	sds	Dynamic push for secret default
2020-08-31T01:07:49.736802Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest10f2755a-d99a-466d-a3bf-271dc053338a.sock: use of closed network connection
2020-08-31T01:07:49.736897Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:49.736921Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:49.736941Z	error	sds	Remote side closed connection
2020-08-31T01:07:49.736935Z	error	sds	Remote side closed connection
2020-08-31T01:07:49.737090Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste81be9aa-5768-4f30-ba6a-038cf229e408.sock" 

2020-08-31T01:07:49.737182Z	info	sds	Start SDS grpc server
2020-08-31T01:07:49.737396Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste81be9aa-5768-4f30-ba6a-038cf229e408.sock: use of closed network connection
2020-08-31T01:07:49.737489Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7e19b7dd-006f-404e-bffd-19c1e821664f.sock" 

2020-08-31T01:07:49.737505Z	info	sds	Start SDS grpc server
2020-08-31T01:07:49.926479Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:49.926535Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:50.038263Z	info	sds	resource:default new connection
2020-08-31T01:07:50.038332Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:07:50.038387Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:50.038605Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:50.038618Z	error	sds	Remote side closed connection
2020-08-31T01:07:50.229880Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:50.232473Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:50.234450Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:50.339827Z	info	sds	resource:default new connection
2020-08-31T01:07:50.339897Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:07:50.339956Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:50.340244Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:50.340258Z	error	sds	Remote side closed connection
2020-08-31T01:07:50.340696Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7e19b7dd-006f-404e-bffd-19c1e821664f.sock: use of closed network connection
2020-08-31T01:07:50.340919Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb0175e47-4ba2-4bb1-b035-450bc31c6e2f.sock" 

2020-08-31T01:07:50.340973Z	info	sds	Start SDS grpc server
2020-08-31T01:07:50.641935Z	info	sds	resource:default new connection
2020-08-31T01:07:50.642016Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:07:50.642069Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:50.642393Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:50.642427Z	error	sds	Remote side closed connection
2020-08-31T01:07:50.642715Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb0175e47-4ba2-4bb1-b035-450bc31c6e2f.sock: use of closed network connection
2020-08-31T01:07:50.736988Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:50.737558Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:51.340956Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:51.506078Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:51.642932Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:07:51.809066Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:51.809975Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:52.112141Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:52.232762Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:52.234604Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:07:52.673817Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest936dab88-a412-4bd8-83a9-813cdb11bd3f.sock" 

2020-08-31T01:07:52.673906Z	info	sds	Start SDS grpc server
2020-08-31T01:07:52.716746Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:52.716786Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:52.737236Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:52.737722Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:53.020402Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:53.322504Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:07:53.341222Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:53.643244Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:07:53.674827Z	info	sds	resource:default new connection
2020-08-31T01:07:53.674890Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:07:53.685589Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:07:53.911264Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:07:53.911339Z	info	cache	GenerateSecret default
2020-08-31T01:07:53.911397Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:07:53.911774Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest936dab88-a412-4bd8-83a9-813cdb11bd3f.sock: use of closed network connection
PASS
2020-08-31T01:07:53.911889Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:07:53.911919Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.738s
2020-08-31T01:07:59.166951Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5b52d24f-e914-4fec-bce2-6d8839a90dd5.sock" 

2020-08-31T01:07:59.167067Z	info	sds	Start SDS grpc server
2020-08-31T01:07:59.168311Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:07:59.168394Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:07:59.168887Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:00.168252Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:00.168332Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:08:01.169048Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:08:01.169144Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:08:01.169174Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:08:01.169275Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:01.169483Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5b52d24f-e914-4fec-bce2-6d8839a90dd5.sock: use of closed network connection
2020-08-31T01:08:01.169604Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:01.169629Z	error	sds	Remote side closed connection
2020-08-31T01:08:01.169770Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"48b384d0-3b9c-49b7-8fc3-4b9e73514fa1\".sock" 

2020-08-31T01:08:01.169789Z	info	sds	Start SDS grpc server
2020-08-31T01:08:01.470933Z	info	sds	resource:default new connection
2020-08-31T01:08:01.471024Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:08:01.471108Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:01.471343Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:01.471371Z	error	sds	Remote side closed connection
2020-08-31T01:08:01.472096Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:08:01.472141Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:08:01.472353Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:08:01.472636Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:01.472692Z	error	sds	Remote side closed connection
2020-08-31T01:08:01.472956Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"48b384d0-3b9c-49b7-8fc3-4b9e73514fa1".sock: use of closed network connection
2020-08-31T01:08:01.473298Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a3024ad0-7851-462c-bb1c-01ed366fa228\".sock" 

2020-08-31T01:08:01.473373Z	info	sds	Start SDS grpc server
2020-08-31T01:08:01.473864Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:08:01.473904Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:08:01.473944Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:08:01.474163Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:01.474187Z	error	sds	Remote side closed connection
2020-08-31T01:08:01.474462Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a3024ad0-7851-462c-bb1c-01ed366fa228".sock: use of closed network connection
2020-08-31T01:08:01.474653Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"728dc661-6a91-4475-babd-71146b34c09c\".sock" 

2020-08-31T01:08:01.474687Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:01.775996Z	info	sds	resource:default new connection
2020-08-31T01:08:01.776059Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:08:01.776117Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:01.776433Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:01.776463Z	error	sds	Remote side closed connection
2020-08-31T01:08:01.776698Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"728dc661-6a91-4475-babd-71146b34c09c".sock: use of closed network connection
2020-08-31T01:08:01.776920Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cf45f457-c878-4af6-9cf6-aefa253e66d6\".sock" 

2020-08-31T01:08:01.776972Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1e18161f-da57-4e5f-8da3-9c61cfe4ce94\".sock" 

2020-08-31T01:08:01.776990Z	info	sds	Start SDS grpc server
2020-08-31T01:08:01.777002Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:02.077888Z	info	sds	resource:default new connection
2020-08-31T01:08:02.077949Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:08:02.078014Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:02.078324Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:02.078362Z	error	sds	Remote side closed connection
2020-08-31T01:08:02.079117Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:08:02.079175Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:08:02.079222Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:08:02.079582Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:02.079608Z	error	sds	Remote side closed connection
2020-08-31T01:08:02.169705Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:02.380751Z	info	sds	resource:default new connection
2020-08-31T01:08:02.380812Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:08:02.380875Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:02.381307Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:02.381352Z	error	sds	Remote side closed connection
2020-08-31T01:08:02.381426Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cf45f457-c878-4af6-9cf6-aefa253e66d6".sock: use of closed network connection
2020-08-31T01:08:02.381478Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1e18161f-da57-4e5f-8da3-9c61cfe4ce94".sock: use of closed network connection
2020-08-31T01:08:02.381698Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"bfdbe7e6-5dd6-4417-b60c-cb7f585e96e5\".sock" 

2020-08-31T01:08:02.381736Z	info	sds	Start SDS grpc server
2020-08-31T01:08:02.473174Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:02.474536Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:08:02.684011Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"bfdbe7e6-5dd6-4417-b60c-cb7f585e96e5".sock: use of closed network connection
2020-08-31T01:08:02.684218Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c2cc2d90-97a3-4f31-bd9c-2d1b059fbae1\".sock" 

2020-08-31T01:08:02.684268Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:02.776950Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:08:02.986027Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c2cc2d90-97a3-4f31-bd9c-2d1b059fbae1".sock: use of closed network connection
2020-08-31T01:08:02.986289Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest642f815e-f73b-4a1a-8e28-8789b73476da.sock" 

2020-08-31T01:08:02.986306Z	info	sds	Start SDS grpc server
2020-08-31T01:08:02.986477Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"79574a62-2b23-4e76-997b-e95aaf617d17\".sock" 

2020-08-31T01:08:02.986534Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:08:03.381521Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:03.381577Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:08:03.591020Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest642f815e-f73b-4a1a-8e28-8789b73476da.sock: use of closed network connection
2020-08-31T01:08:03.591075Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"79574a62-2b23-4e76-997b-e95aaf617d17".sock: use of closed network connection
2020-08-31T01:08:03.591337Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest23e84f80-9a36-4942-b7bd-b68a33c75958.sock" 

2020-08-31T01:08:03.591375Z	info	sds	Start SDS grpc server
2020-08-31T01:08:03.684274Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:03.892392Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:08:03.892496Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:03.892722Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest23e84f80-9a36-4942-b7bd-b68a33c75958.sock: use of closed network connection
2020-08-31T01:08:03.892961Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2dd5d2c0-d232-410d-b820-8584918fe5b8.sock" 

2020-08-31T01:08:03.893033Z	info	sds	Start SDS grpc server
2020-08-31T01:08:03.893615Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:08:03.893664Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:08:03.893730Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:03.893798Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:08:03.893844Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:08:03.893888Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:08:03.986302Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:04.169995Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:04.473457Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:04.474696Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:04.591263Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:04.591310Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:04.777276Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:04.892958Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:04.893909Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:04.893940Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:08:05.381761Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:05.381809Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:05.684503Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:05.894870Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:05.895217Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2dd5d2c0-d232-410d-b820-8584918fe5b8.sock: use of closed network connection
2020-08-31T01:08:05.895315Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:05.895340Z	error	sds	Remote side closed connection
2020-08-31T01:08:05.895320Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:05.895379Z	error	sds	Remote side closed connection
2020-08-31T01:08:05.895471Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb2f11362-b3ac-45ad-a576-2e9af109194d.sock" 

2020-08-31T01:08:05.895517Z	info	sds	Start SDS grpc server
2020-08-31T01:08:05.897134Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:08:05.897198Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:08:05.897273Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:05.898707Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:08:05.897272104 +0000 UTC m=+6.804821209 and is waiting for next SDS request
2020-08-31T01:08:05.898735Z	info	sds	Dynamic push for secret default
2020-08-31T01:08:05.898759Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb2f11362-b3ac-45ad-a576-2e9af109194d.sock: use of closed network connection
2020-08-31T01:08:05.898822Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:05.898847Z	error	sds	Remote side closed connection
2020-08-31T01:08:05.898871Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:05.898898Z	error	sds	Remote side closed connection
2020-08-31T01:08:05.899009Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc691900f-23ce-418e-afc6-4924b730e6f6.sock" 

2020-08-31T01:08:05.899108Z	info	sds	Start SDS grpc server
2020-08-31T01:08:05.899753Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:08:05.899811Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:08:05.899858Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:05.900411Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:08:05.986552Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:06.400607Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:06.400688Z	info	sds	Dynamic push for secret default
2020-08-31T01:08:06.401420Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc691900f-23ce-418e-afc6-4924b730e6f6.sock: use of closed network connection
2020-08-31T01:08:06.401526Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:06.401544Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:06.401573Z	error	sds	Remote side closed connection
2020-08-31T01:08:06.401562Z	error	sds	Remote side closed connection
2020-08-31T01:08:06.401680Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestec59a8f6-c829-43ff-87a0-7441b87962db.sock" 

2020-08-31T01:08:06.401760Z	info	sds	Start SDS grpc server
2020-08-31T01:08:06.401988Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestec59a8f6-c829-43ff-87a0-7441b87962db.sock: use of closed network connection
2020-08-31T01:08:06.402075Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest80fab21b-99cc-4f87-87f4-c60deefaf3a7.sock" 

2020-08-31T01:08:06.402102Z	info	sds	Start SDS grpc server
2020-08-31T01:08:06.591532Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:06.591592Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:06.703103Z	info	sds	resource:default new connection
2020-08-31T01:08:06.703169Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:08:06.703233Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:06.703577Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:06.703603Z	error	sds	Remote side closed connection
2020-08-31T01:08:06.893192Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:06.895412Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:06.898948Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:07.004519Z	info	sds	resource:default new connection
2020-08-31T01:08:07.004576Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:08:07.004627Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:07.004907Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:07.004934Z	error	sds	Remote side closed connection
2020-08-31T01:08:07.005203Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest80fab21b-99cc-4f87-87f4-c60deefaf3a7.sock: use of closed network connection
2020-08-31T01:08:07.005436Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0ce8703c-a67d-45a8-97f0-5b068a44d313.sock" 

2020-08-31T01:08:07.005455Z	info	sds	Start SDS grpc server
2020-08-31T01:08:07.306512Z	info	sds	resource:default new connection
2020-08-31T01:08:07.306573Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:08:07.306635Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:07.306917Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:07.306948Z	error	sds	Remote side closed connection
2020-08-31T01:08:07.307164Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0ce8703c-a67d-45a8-97f0-5b068a44d313.sock: use of closed network connection
2020-08-31T01:08:07.401683Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:07.402141Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:08.005428Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:08.170252Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:08.307366Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:08:08.473720Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:08.474866Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:08.777540Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:08.895665Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:08.899158Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:08:09.336149Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest89c7cba9-7556-4f97-85a0-44d4cd46f3cc.sock" 

2020-08-31T01:08:09.336223Z	info	sds	Start SDS grpc server
2020-08-31T01:08:09.381937Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:09.381978Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:09.401962Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:09.402381Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:09.684812Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:09.986851Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:10.005601Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:10.307600Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:10.337480Z	info	sds	resource:default new connection
2020-08-31T01:08:10.337545Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:08:10.343214Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:08:10.398183Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:08:10.398239Z	info	cache	GenerateSecret default
2020-08-31T01:08:10.398299Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:10.398689Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest89c7cba9-7556-4f97-85a0-44d4cd46f3cc.sock: use of closed network connection
PASS
2020-08-31T01:08:10.398803Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:10.398828Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.553s
2020-08-31T01:08:15.837654Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbc24c169-4bfd-44e4-8600-1d9b577e591f.sock" 

2020-08-31T01:08:15.837770Z	info	sds	Start SDS grpc server
2020-08-31T01:08:15.839146Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:08:15.839241Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:08:15.839671Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:16.838848Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:16.838903Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:08:17.839977Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:08:17.840058Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:08:17.840082Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:08:17.840143Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:17.840400Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbc24c169-4bfd-44e4-8600-1d9b577e591f.sock: use of closed network connection
2020-08-31T01:08:17.840511Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:17.840521Z	error	sds	Remote side closed connection
2020-08-31T01:08:17.840690Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e2373db6-2a2c-48be-8cef-d83f3bbe8b3e\".sock" 

2020-08-31T01:08:17.840731Z	info	sds	Start SDS grpc server
2020-08-31T01:08:18.141763Z	info	sds	resource:default new connection
2020-08-31T01:08:18.141830Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:08:18.141895Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:18.142184Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:18.142211Z	error	sds	Remote side closed connection
2020-08-31T01:08:18.142855Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:08:18.142894Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:08:18.143056Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:08:18.143340Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:18.143388Z	error	sds	Remote side closed connection
2020-08-31T01:08:18.143512Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e2373db6-2a2c-48be-8cef-d83f3bbe8b3e".sock: use of closed network connection
2020-08-31T01:08:18.143701Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"8becfc09-6a6d-4eca-b061-37faad5f2920\".sock" 

2020-08-31T01:08:18.143784Z	info	sds	Start SDS grpc server
2020-08-31T01:08:18.144139Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:08:18.144168Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:08:18.144216Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:08:18.144387Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:18.144398Z	error	sds	Remote side closed connection
2020-08-31T01:08:18.144562Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"8becfc09-6a6d-4eca-b061-37faad5f2920".sock: use of closed network connection
2020-08-31T01:08:18.144731Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"94558d4e-b0cb-4e34-85a5-dd16e9f95cb8\".sock" 

2020-08-31T01:08:18.144765Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:18.445698Z	info	sds	resource:default new connection
2020-08-31T01:08:18.445756Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:08:18.445812Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:18.446093Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:18.446160Z	error	sds	Remote side closed connection
2020-08-31T01:08:18.446326Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"94558d4e-b0cb-4e34-85a5-dd16e9f95cb8".sock: use of closed network connection
2020-08-31T01:08:18.446527Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4039e638-7a3a-48d0-b111-c9e25709cd5f\".sock" 

2020-08-31T01:08:18.446538Z	info	sds	Start SDS grpc server
2020-08-31T01:08:18.446608Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6e7180ab-9554-4a29-88e0-d90840669ee2\".sock" 

2020-08-31T01:08:18.446638Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:18.747629Z	info	sds	resource:default new connection
2020-08-31T01:08:18.747691Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:08:18.747745Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:18.748059Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:18.748085Z	error	sds	Remote side closed connection
2020-08-31T01:08:18.748814Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:08:18.748852Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:08:18.748888Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:08:18.749244Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:18.749271Z	error	sds	Remote side closed connection
2020-08-31T01:08:18.840609Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:19.050199Z	info	sds	resource:default new connection
2020-08-31T01:08:19.050254Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:08:19.050306Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:19.050656Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:19.050683Z	error	sds	Remote side closed connection
2020-08-31T01:08:19.051113Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4039e638-7a3a-48d0-b111-c9e25709cd5f".sock: use of closed network connection
2020-08-31T01:08:19.051288Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6e7180ab-9554-4a29-88e0-d90840669ee2".sock: use of closed network connection
2020-08-31T01:08:19.051529Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3414cf87-a621-4675-8290-fd81d276f83a\".sock" 

2020-08-31T01:08:19.051544Z	info	sds	Start SDS grpc server
2020-08-31T01:08:19.143733Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:19.144752Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:08:19.356311Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3414cf87-a621-4675-8290-fd81d276f83a".sock: use of closed network connection
2020-08-31T01:08:19.356584Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0bdb6a35-4c93-47e5-87a6-191ce175c837\".sock" 

2020-08-31T01:08:19.356644Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:19.446508Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:08:19.658491Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0bdb6a35-4c93-47e5-87a6-191ce175c837".sock: use of closed network connection
2020-08-31T01:08:19.658839Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest45790d74-c9d2-4fa5-975f-5d09a4c5cccd.sock" 

2020-08-31T01:08:19.658924Z	info	sds	Start SDS grpc server
2020-08-31T01:08:19.659027Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2ebaf8f1-d47c-4931-a4ad-09ada00cc793\".sock" 

2020-08-31T01:08:19.659074Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:08:20.051327Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:20.051357Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:08:20.263210Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest45790d74-c9d2-4fa5-975f-5d09a4c5cccd.sock: use of closed network connection
2020-08-31T01:08:20.263272Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2ebaf8f1-d47c-4931-a4ad-09ada00cc793".sock: use of closed network connection
2020-08-31T01:08:20.263485Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest9773934a-6450-4998-8860-4723d8a71cb9.sock" 

2020-08-31T01:08:20.263521Z	info	sds	Start SDS grpc server
2020-08-31T01:08:20.356584Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:20.564690Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:08:20.564788Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:20.565019Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest9773934a-6450-4998-8860-4723d8a71cb9.sock: use of closed network connection
2020-08-31T01:08:20.565392Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0e621a47-58ca-4816-887e-5ea95b9278a6.sock" 

2020-08-31T01:08:20.565408Z	info	sds	Start SDS grpc server
2020-08-31T01:08:20.566432Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:08:20.566480Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:08:20.566538Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:20.566828Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:08:20.566879Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:08:20.566919Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:08:20.658749Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:20.840863Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:21.144013Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:21.144936Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:21.263430Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:21.263489Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:21.446768Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:21.565227Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:21.566959Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:21.566997Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:08:22.051615Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:22.051649Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:22.356944Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:22.567849Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:22.568198Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0e621a47-58ca-4816-887e-5ea95b9278a6.sock: use of closed network connection
2020-08-31T01:08:22.568226Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:22.568255Z	error	sds	Remote side closed connection
2020-08-31T01:08:22.568287Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:22.568303Z	error	sds	Remote side closed connection
2020-08-31T01:08:22.568418Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestecc8d4b5-8077-4d23-81f2-1ecd19194873.sock" 

2020-08-31T01:08:22.568455Z	info	sds	Start SDS grpc server
2020-08-31T01:08:22.569293Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:08:22.569355Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:08:22.569423Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:22.569988Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:08:22.569422257 +0000 UTC m=+6.813165862 and is waiting for next SDS request
2020-08-31T01:08:22.570011Z	info	sds	Dynamic push for secret default
2020-08-31T01:08:22.570039Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestecc8d4b5-8077-4d23-81f2-1ecd19194873.sock: use of closed network connection
2020-08-31T01:08:22.570110Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:22.570122Z	error	sds	Remote side closed connection
2020-08-31T01:08:22.570164Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:22.570172Z	error	sds	Remote side closed connection
2020-08-31T01:08:22.570295Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest53903432-63a8-4f1b-ba79-3f8bd6019661.sock" 

2020-08-31T01:08:22.570336Z	info	sds	Start SDS grpc server
2020-08-31T01:08:22.571120Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:08:22.571157Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:08:22.571192Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:22.571789Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:08:22.658986Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:23.071927Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:23.072002Z	info	sds	Dynamic push for secret default
2020-08-31T01:08:23.072572Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest53903432-63a8-4f1b-ba79-3f8bd6019661.sock: use of closed network connection
2020-08-31T01:08:23.072711Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:23.072737Z	error	sds	Remote side closed connection
2020-08-31T01:08:23.072858Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:23.072867Z	error	sds	Remote side closed connection
2020-08-31T01:08:23.072969Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdf290ef4-9ee7-4279-a101-307194d12233.sock" 

2020-08-31T01:08:23.073082Z	info	sds	Start SDS grpc server
2020-08-31T01:08:23.073214Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdf290ef4-9ee7-4279-a101-307194d12233.sock: use of closed network connection
2020-08-31T01:08:23.073322Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1cbe2d01-c58a-4ff6-b1cd-d4ed85216e19.sock" 

2020-08-31T01:08:23.073344Z	info	sds	Start SDS grpc server
2020-08-31T01:08:23.263677Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:23.263725Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:23.374181Z	info	sds	resource:default new connection
2020-08-31T01:08:23.374244Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:08:23.374296Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:23.374728Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:23.374764Z	error	sds	Remote side closed connection
2020-08-31T01:08:23.565417Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:23.568407Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:23.570195Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:23.675804Z	info	sds	resource:default new connection
2020-08-31T01:08:23.675904Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:08:23.675978Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:23.676238Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:23.676257Z	error	sds	Remote side closed connection
2020-08-31T01:08:23.676597Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1cbe2d01-c58a-4ff6-b1cd-d4ed85216e19.sock: use of closed network connection
2020-08-31T01:08:23.676840Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcdb99368-7054-4258-91ba-02bdbfb918b8.sock" 

2020-08-31T01:08:23.676896Z	info	sds	Start SDS grpc server
2020-08-31T01:08:23.977746Z	info	sds	resource:default new connection
2020-08-31T01:08:23.977811Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:08:23.977871Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:23.978146Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:23.978178Z	error	sds	Remote side closed connection
2020-08-31T01:08:23.978544Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcdb99368-7054-4258-91ba-02bdbfb918b8.sock: use of closed network connection
2020-08-31T01:08:24.072805Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:24.073385Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:24.676790Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:24.847546Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:24.978717Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:08:25.144229Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:25.145105Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:25.446985Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:25.568678Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:25.570387Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:08:26.011575Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest64553d7c-1fe9-49af-8f80-767698d56b74.sock" 

2020-08-31T01:08:26.011628Z	info	sds	Start SDS grpc server
2020-08-31T01:08:26.051837Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:26.051892Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:26.073061Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:26.073622Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:26.357154Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:26.659259Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:26.677064Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:26.978946Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:27.012472Z	info	sds	resource:default new connection
2020-08-31T01:08:27.012534Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:08:27.023411Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:08:27.108783Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:08:27.108829Z	info	cache	GenerateSecret default
2020-08-31T01:08:27.108887Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:27.109227Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest64553d7c-1fe9-49af-8f80-767698d56b74.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.599s
2020-08-31T01:08:32.329474Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest663b4fd0-d27d-4744-9b71-fb4d7d3ff3c8.sock" 

2020-08-31T01:08:32.329560Z	info	sds	Start SDS grpc server
2020-08-31T01:08:32.330941Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:08:32.331048Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:08:32.331488Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:33.330808Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:33.330887Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:08:34.331571Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:08:34.331650Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:08:34.331684Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:08:34.331765Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:34.331975Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest663b4fd0-d27d-4744-9b71-fb4d7d3ff3c8.sock: use of closed network connection
2020-08-31T01:08:34.332078Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:34.332107Z	error	sds	Remote side closed connection
2020-08-31T01:08:34.332226Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2277880f-9c70-429d-b4cb-06fbe5452651\".sock" 

2020-08-31T01:08:34.332261Z	info	sds	Start SDS grpc server
2020-08-31T01:08:34.633367Z	info	sds	resource:default new connection
2020-08-31T01:08:34.633431Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:08:34.633505Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:34.633805Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:34.633819Z	error	sds	Remote side closed connection
2020-08-31T01:08:34.634400Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:08:34.634455Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:08:34.634627Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:08:34.634829Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:34.634839Z	error	sds	Remote side closed connection
2020-08-31T01:08:34.635082Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2277880f-9c70-429d-b4cb-06fbe5452651".sock: use of closed network connection
2020-08-31T01:08:34.635261Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f892674c-b030-4ae2-b2f4-b7b7dbc13ba1\".sock" 

2020-08-31T01:08:34.635349Z	info	sds	Start SDS grpc server
2020-08-31T01:08:34.635817Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:08:34.635854Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:08:34.635897Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:08:34.636145Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:34.636161Z	error	sds	Remote side closed connection
2020-08-31T01:08:34.636307Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f892674c-b030-4ae2-b2f4-b7b7dbc13ba1".sock: use of closed network connection
2020-08-31T01:08:34.636495Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"aa221221-8a1a-4151-859f-f6570f420c14\".sock" 

2020-08-31T01:08:34.636525Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:34.937459Z	info	sds	resource:default new connection
2020-08-31T01:08:34.937512Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:08:34.937566Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:34.937880Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:34.937910Z	error	sds	Remote side closed connection
2020-08-31T01:08:34.938056Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"aa221221-8a1a-4151-859f-f6570f420c14".sock: use of closed network connection
2020-08-31T01:08:34.938222Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"8680daed-c09d-457c-a503-d1ec3a7be237\".sock" 

2020-08-31T01:08:34.938250Z	info	sds	Start SDS grpc server
2020-08-31T01:08:34.938273Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"46e9e386-8972-481a-a94c-565c7af624da\".sock" 

2020-08-31T01:08:34.938342Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:35.239775Z	info	sds	resource:default new connection
2020-08-31T01:08:35.239833Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:08:35.239890Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:35.240196Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:35.240222Z	error	sds	Remote side closed connection
2020-08-31T01:08:35.240887Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:08:35.240926Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:08:35.240967Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:08:35.241196Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:35.241217Z	error	sds	Remote side closed connection
2020-08-31T01:08:35.332171Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:35.542269Z	info	sds	resource:default new connection
2020-08-31T01:08:35.542333Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:08:35.542387Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:35.542652Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:35.542677Z	error	sds	Remote side closed connection
2020-08-31T01:08:35.542959Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"8680daed-c09d-457c-a503-d1ec3a7be237".sock: use of closed network connection
2020-08-31T01:08:35.543002Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"46e9e386-8972-481a-a94c-565c7af624da".sock: use of closed network connection
2020-08-31T01:08:35.543191Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e632d535-52de-4b5a-85cb-08b0d4ccc123\".sock" 

2020-08-31T01:08:35.543204Z	info	sds	Start SDS grpc server
2020-08-31T01:08:35.635304Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:35.636508Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:08:35.845966Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e632d535-52de-4b5a-85cb-08b0d4ccc123".sock: use of closed network connection
2020-08-31T01:08:35.846139Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"51507519-38f6-4357-a2fa-769977bb1532\".sock" 

2020-08-31T01:08:35.846161Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:35.938305Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:08:36.147664Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"51507519-38f6-4357-a2fa-769977bb1532".sock: use of closed network connection
2020-08-31T01:08:36.147912Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest7aa0de53-eb45-444f-8831-b9de5df38fba.sock" 

2020-08-31T01:08:36.147938Z	info	sds	Start SDS grpc server
2020-08-31T01:08:36.147976Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e6eaadec-c019-4c99-a694-f596c848ecf5\".sock" 

2020-08-31T01:08:36.147981Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:08:36.543219Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:36.543230Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:08:36.751576Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest7aa0de53-eb45-444f-8831-b9de5df38fba.sock: use of closed network connection
2020-08-31T01:08:36.751625Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e6eaadec-c019-4c99-a694-f596c848ecf5".sock: use of closed network connection
2020-08-31T01:08:36.751780Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest2805825f-8bcc-4523-a301-d3f6c956346b.sock" 

2020-08-31T01:08:36.751800Z	info	sds	Start SDS grpc server
2020-08-31T01:08:36.846196Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:37.052866Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:08:37.052975Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:37.053271Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest2805825f-8bcc-4523-a301-d3f6c956346b.sock: use of closed network connection
2020-08-31T01:08:37.053478Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb88c3235-749e-46e5-b29e-8738df70400f.sock" 

2020-08-31T01:08:37.053548Z	info	sds	Start SDS grpc server
2020-08-31T01:08:37.054856Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:08:37.054909Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:08:37.054955Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:37.055118Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:08:37.055317Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:08:37.055362Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:08:37.147736Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:37.332419Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:37.635519Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:37.636633Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:37.751793Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:37.751831Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:37.938535Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:38.053516Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:38.055090Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:38.055120Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:08:38.543344Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:38.543387Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:38.846500Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:39.056028Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:39.056412Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb88c3235-749e-46e5-b29e-8738df70400f.sock: use of closed network connection
2020-08-31T01:08:39.056509Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:39.056527Z	error	sds	Remote side closed connection
2020-08-31T01:08:39.056599Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:39.056637Z	error	sds	Remote side closed connection
2020-08-31T01:08:39.056723Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest713c7c09-9a79-4444-8450-6662563cef68.sock" 

2020-08-31T01:08:39.056762Z	info	sds	Start SDS grpc server
2020-08-31T01:08:39.057653Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:08:39.057704Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:08:39.057753Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:39.058202Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:08:39.05775288 +0000 UTC m=+6.802314972 and is waiting for next SDS request
2020-08-31T01:08:39.058226Z	info	sds	Dynamic push for secret default
2020-08-31T01:08:39.058323Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest713c7c09-9a79-4444-8450-6662563cef68.sock: use of closed network connection
2020-08-31T01:08:39.058416Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:39.058424Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:39.058435Z	error	sds	Remote side closed connection
2020-08-31T01:08:39.058445Z	error	sds	Remote side closed connection
2020-08-31T01:08:39.058501Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest82784c7f-6b9f-46ea-b6de-c497257b54a4.sock" 

2020-08-31T01:08:39.058547Z	info	sds	Start SDS grpc server
2020-08-31T01:08:39.060935Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:08:39.061034Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:08:39.061111Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:39.062101Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:08:39.148020Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:39.562190Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:39.562253Z	info	sds	Dynamic push for secret default
2020-08-31T01:08:39.562869Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest82784c7f-6b9f-46ea-b6de-c497257b54a4.sock: use of closed network connection
2020-08-31T01:08:39.562964Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:39.563010Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:39.562998Z	error	sds	Remote side closed connection
2020-08-31T01:08:39.563036Z	error	sds	Remote side closed connection
2020-08-31T01:08:39.563118Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest21ceb384-d903-4e58-bd2e-6ba3ce284b78.sock" 

2020-08-31T01:08:39.563184Z	info	sds	Start SDS grpc server
2020-08-31T01:08:39.563375Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest21ceb384-d903-4e58-bd2e-6ba3ce284b78.sock: use of closed network connection
2020-08-31T01:08:39.563474Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9d726ea3-569d-4d67-a61a-5e9ad9cae0fd.sock" 

2020-08-31T01:08:39.563478Z	info	sds	Start SDS grpc server
2020-08-31T01:08:39.752045Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:39.752075Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:39.864386Z	info	sds	resource:default new connection
2020-08-31T01:08:39.864448Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:08:39.864509Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:39.864841Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:39.864876Z	error	sds	Remote side closed connection
2020-08-31T01:08:40.053717Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:40.056611Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:40.058505Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:40.165842Z	info	sds	resource:default new connection
2020-08-31T01:08:40.165905Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:08:40.165955Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:40.166199Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:40.166226Z	error	sds	Remote side closed connection
2020-08-31T01:08:40.166657Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9d726ea3-569d-4d67-a61a-5e9ad9cae0fd.sock: use of closed network connection
2020-08-31T01:08:40.166827Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbbdbbbc6-2971-4eed-9bb5-47513bb975de.sock" 

2020-08-31T01:08:40.166872Z	info	sds	Start SDS grpc server
2020-08-31T01:08:40.467749Z	info	sds	resource:default new connection
2020-08-31T01:08:40.467806Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:08:40.467869Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:40.468167Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:40.468196Z	error	sds	Remote side closed connection
2020-08-31T01:08:40.468401Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbbdbbbc6-2971-4eed-9bb5-47513bb975de.sock: use of closed network connection
2020-08-31T01:08:40.563065Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:40.563549Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:41.166914Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:41.332524Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:41.468603Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:08:41.635751Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:41.636828Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:41.938836Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:42.056827Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:42.058663Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:08:42.504405Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest76b2d293-6da9-47b1-bba3-c43282f9a11d.sock" 

2020-08-31T01:08:42.504462Z	info	sds	Start SDS grpc server
2020-08-31T01:08:42.543644Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:42.543704Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:42.563250Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:42.563702Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:42.846755Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:43.148272Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:43.167169Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:43.468891Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:43.505527Z	info	sds	resource:default new connection
2020-08-31T01:08:43.505603Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:08:43.511384Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:08:43.594512Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:08:43.594622Z	info	cache	GenerateSecret default
2020-08-31T01:08:43.594709Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:43.595108Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest76b2d293-6da9-47b1-bba3-c43282f9a11d.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.585s
2020-08-31T01:08:48.845488Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4bfc2e39-c5d4-4380-9c72-3d448ed0b7c5.sock" 

2020-08-31T01:08:48.845590Z	info	sds	Start SDS grpc server
2020-08-31T01:08:48.846863Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:08:48.846913Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:08:48.847257Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:49.846666Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:49.846721Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:08:50.847476Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:08:50.847552Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:08:50.847581Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:08:50.847633Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:50.847835Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4bfc2e39-c5d4-4380-9c72-3d448ed0b7c5.sock: use of closed network connection
2020-08-31T01:08:50.847950Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:50.847975Z	error	sds	Remote side closed connection
2020-08-31T01:08:50.848106Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"bb35fc2e-e6ba-45c8-a0fc-30492669aaa9\".sock" 

2020-08-31T01:08:50.848114Z	info	sds	Start SDS grpc server
2020-08-31T01:08:51.149515Z	info	sds	resource:default new connection
2020-08-31T01:08:51.149565Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:08:51.149625Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:51.149971Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:51.150013Z	error	sds	Remote side closed connection
2020-08-31T01:08:51.150553Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:08:51.150600Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:08:51.150795Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:08:51.151217Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:51.151240Z	error	sds	Remote side closed connection
2020-08-31T01:08:51.151318Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"bb35fc2e-e6ba-45c8-a0fc-30492669aaa9".sock: use of closed network connection
2020-08-31T01:08:51.151552Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"361669de-c1ea-4c0c-befa-0781f55c6582\".sock" 

2020-08-31T01:08:51.151675Z	info	sds	Start SDS grpc server
2020-08-31T01:08:51.152094Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:08:51.152135Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:08:51.152170Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:08:51.152438Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:51.152466Z	error	sds	Remote side closed connection
2020-08-31T01:08:51.152618Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"361669de-c1ea-4c0c-befa-0781f55c6582".sock: use of closed network connection
2020-08-31T01:08:51.152860Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1fb22fc4-25a7-4706-ada2-fc6b3543eebb\".sock" 

2020-08-31T01:08:51.152896Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:51.453740Z	info	sds	resource:default new connection
2020-08-31T01:08:51.453806Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:08:51.453864Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:51.454135Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:51.454164Z	error	sds	Remote side closed connection
2020-08-31T01:08:51.454363Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1fb22fc4-25a7-4706-ada2-fc6b3543eebb".sock: use of closed network connection
2020-08-31T01:08:51.454536Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9750b21f-9001-43fa-83af-4e3ab88a04ff\".sock" 

2020-08-31T01:08:51.454557Z	info	sds	Start SDS grpc server
2020-08-31T01:08:51.454598Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"26cebd3f-39c2-4cdd-9bb3-482e17652e79\".sock" 

2020-08-31T01:08:51.454604Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:51.755723Z	info	sds	resource:default new connection
2020-08-31T01:08:51.755789Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:08:51.755868Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:51.756253Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:51.756269Z	error	sds	Remote side closed connection
2020-08-31T01:08:51.756917Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:08:51.756963Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:08:51.757013Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:08:51.757257Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:51.757278Z	error	sds	Remote side closed connection
2020-08-31T01:08:51.848071Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:52.058346Z	info	sds	resource:default new connection
2020-08-31T01:08:52.058404Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:08:52.058460Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:52.058672Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:52.058701Z	error	sds	Remote side closed connection
2020-08-31T01:08:52.058903Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9750b21f-9001-43fa-83af-4e3ab88a04ff".sock: use of closed network connection
2020-08-31T01:08:52.058945Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"26cebd3f-39c2-4cdd-9bb3-482e17652e79".sock: use of closed network connection
2020-08-31T01:08:52.059101Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6ca04f92-3123-4dc8-b594-b20323efd6d0\".sock" 

2020-08-31T01:08:52.059122Z	info	sds	Start SDS grpc server
2020-08-31T01:08:52.151531Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:52.152786Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:08:52.361514Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6ca04f92-3123-4dc8-b594-b20323efd6d0".sock: use of closed network connection
2020-08-31T01:08:52.361720Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"559b80ed-1d67-4427-a007-c10b27efd537\".sock" 

2020-08-31T01:08:52.361742Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:08:52.454510Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:08:52.663368Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"559b80ed-1d67-4427-a007-c10b27efd537".sock: use of closed network connection
2020-08-31T01:08:52.663555Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest211508dd-4f08-4a38-90f9-a500bca72ee9.sock" 

2020-08-31T01:08:52.663574Z	info	sds	Start SDS grpc server
2020-08-31T01:08:52.663620Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"38160886-07fa-41ab-8a0e-3e6daf0d5679\".sock" 

2020-08-31T01:08:52.663653Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:08:53.059126Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:53.059162Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:08:53.267653Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest211508dd-4f08-4a38-90f9-a500bca72ee9.sock: use of closed network connection
2020-08-31T01:08:53.267701Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"38160886-07fa-41ab-8a0e-3e6daf0d5679".sock: use of closed network connection
2020-08-31T01:08:53.267896Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestcb5c348b-c5a6-42e6-a894-944f9a691606.sock" 

2020-08-31T01:08:53.267922Z	info	sds	Start SDS grpc server
2020-08-31T01:08:53.361710Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:53.569025Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:08:53.569137Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:53.569358Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestcb5c348b-c5a6-42e6-a894-944f9a691606.sock: use of closed network connection
2020-08-31T01:08:53.569569Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3000b80b-f03a-44b4-8064-a05b80495565.sock" 

2020-08-31T01:08:53.569649Z	info	sds	Start SDS grpc server
2020-08-31T01:08:53.570117Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:08:53.570176Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:08:53.570244Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:53.570360Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:08:53.570402Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:08:53.570499Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:08:53.663598Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:53.848331Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:54.151795Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:54.152968Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:54.267903Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:54.267897Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:54.454792Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:54.569569Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:54.570357Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:54.570398Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:08:55.059359Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:55.059422Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:55.361923Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:55.571255Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:55.571619Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3000b80b-f03a-44b4-8064-a05b80495565.sock: use of closed network connection
2020-08-31T01:08:55.571661Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:55.571683Z	error	sds	Remote side closed connection
2020-08-31T01:08:55.571738Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:55.571760Z	error	sds	Remote side closed connection
2020-08-31T01:08:55.571869Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestba9b6e59-49e1-44dc-aa18-3e7cf631c368.sock" 

2020-08-31T01:08:55.571948Z	info	sds	Start SDS grpc server
2020-08-31T01:08:55.575373Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:08:55.575463Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:08:55.575521Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:55.576085Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:08:55.575520592 +0000 UTC m=+6.805000616 and is waiting for next SDS request
2020-08-31T01:08:55.576116Z	info	sds	Dynamic push for secret default
2020-08-31T01:08:55.576141Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestba9b6e59-49e1-44dc-aa18-3e7cf631c368.sock: use of closed network connection
2020-08-31T01:08:55.576250Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:55.576262Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:55.576281Z	error	sds	Remote side closed connection
2020-08-31T01:08:55.576261Z	error	sds	Remote side closed connection
2020-08-31T01:08:55.576408Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd746ae74-3e7b-4d88-a4f7-9a9c51ddb924.sock" 

2020-08-31T01:08:55.576502Z	info	sds	Start SDS grpc server
2020-08-31T01:08:55.577324Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:08:55.577366Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:08:55.577402Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:55.577843Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:08:55.663844Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:56.078033Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:56.078096Z	info	sds	Dynamic push for secret default
2020-08-31T01:08:56.078802Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd746ae74-3e7b-4d88-a4f7-9a9c51ddb924.sock: use of closed network connection
2020-08-31T01:08:56.078854Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:56.078884Z	error	sds	Remote side closed connection
2020-08-31T01:08:56.078928Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:56.078952Z	error	sds	Remote side closed connection
2020-08-31T01:08:56.079070Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest825c872e-1849-4a0e-9a99-eafc62537475.sock" 

2020-08-31T01:08:56.079093Z	info	sds	Start SDS grpc server
2020-08-31T01:08:56.079303Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest825c872e-1849-4a0e-9a99-eafc62537475.sock: use of closed network connection
2020-08-31T01:08:56.079420Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest71ac059e-b0f3-4dc6-8552-36c0e8ef64a8.sock" 

2020-08-31T01:08:56.079442Z	info	sds	Start SDS grpc server
2020-08-31T01:08:56.268170Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:56.268225Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:56.380350Z	info	sds	resource:default new connection
2020-08-31T01:08:56.380424Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:08:56.380498Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:56.380946Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:56.380997Z	error	sds	Remote side closed connection
2020-08-31T01:08:56.569845Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:56.571818Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:56.576316Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:56.682062Z	info	sds	resource:default new connection
2020-08-31T01:08:56.682140Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:08:56.682212Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:56.682681Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:56.682720Z	error	sds	Remote side closed connection
2020-08-31T01:08:56.682993Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest71ac059e-b0f3-4dc6-8552-36c0e8ef64a8.sock: use of closed network connection
2020-08-31T01:08:56.683163Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest09adf223-5e01-48a3-9d84-78a9cb0ea671.sock" 

2020-08-31T01:08:56.683205Z	info	sds	Start SDS grpc server
2020-08-31T01:08:56.984145Z	info	sds	resource:default new connection
2020-08-31T01:08:56.984222Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:08:56.984301Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:08:56.984742Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:08:56.984787Z	error	sds	Remote side closed connection
2020-08-31T01:08:56.984979Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest09adf223-5e01-48a3-9d84-78a9cb0ea671.sock: use of closed network connection
2020-08-31T01:08:57.078979Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:57.079439Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:57.683250Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:57.848600Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:57.985195Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:08:58.152118Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:58.153144Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:58.455054Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:58.571968Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:58.576528Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:08:59.013716Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5c061d3b-96d0-467d-8505-a99aaf30d5b7.sock" 

2020-08-31T01:08:59.013773Z	info	sds	Start SDS grpc server
2020-08-31T01:08:59.059610Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:59.059667Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:59.079223Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:59.079609Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:59.362180Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:59.664128Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:08:59.683443Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:08:59.985355Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:00.014635Z	info	sds	resource:default new connection
2020-08-31T01:09:00.014699Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:09:00.022395Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:09:00.098822Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:09:00.098867Z	info	cache	GenerateSecret default
2020-08-31T01:09:00.098931Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:00.099323Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5c061d3b-96d0-467d-8505-a99aaf30d5b7.sock: use of closed network connection
2020-08-31T01:09:00.099381Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:00.099402Z	error	sds	Remote side closed connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.573s
2020-08-31T01:09:05.375880Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest32cbe0ae-4af1-4d70-b1ad-13479f7c3d50.sock" 

2020-08-31T01:09:05.375923Z	info	sds	Start SDS grpc server
2020-08-31T01:09:05.377481Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:09:05.377558Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:09:05.378039Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:06.377491Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:06.377599Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:09:07.378422Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:09:07.378556Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:09:07.378598Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:09:07.378661Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:07.378897Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest32cbe0ae-4af1-4d70-b1ad-13479f7c3d50.sock: use of closed network connection
2020-08-31T01:09:07.379029Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:07.379057Z	error	sds	Remote side closed connection
2020-08-31T01:09:07.379309Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7a5b87f1-e438-4969-881b-622ce57a68ef\".sock" 

2020-08-31T01:09:07.379380Z	info	sds	Start SDS grpc server
2020-08-31T01:09:07.681030Z	info	sds	resource:default new connection
2020-08-31T01:09:07.681088Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:09:07.681173Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:07.681562Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:07.681636Z	error	sds	Remote side closed connection
2020-08-31T01:09:07.682270Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:09:07.682315Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:09:07.682704Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:09:07.683072Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:07.683091Z	error	sds	Remote side closed connection
2020-08-31T01:09:07.683233Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7a5b87f1-e438-4969-881b-622ce57a68ef".sock: use of closed network connection
2020-08-31T01:09:07.683410Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0c8fbf47-af69-40cb-b80f-897a08a83756\".sock" 

2020-08-31T01:09:07.683485Z	info	sds	Start SDS grpc server
2020-08-31T01:09:07.683889Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:09:07.683936Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:09:07.684012Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:09:07.684240Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:07.684268Z	error	sds	Remote side closed connection
2020-08-31T01:09:07.684533Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0c8fbf47-af69-40cb-b80f-897a08a83756".sock: use of closed network connection
2020-08-31T01:09:07.684755Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8ae073ba-8f68-4fca-b6c7-60059b9ed186\".sock" 

2020-08-31T01:09:07.684790Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:07.985668Z	info	sds	resource:default new connection
2020-08-31T01:09:07.985728Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:09:07.985785Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:07.986010Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:07.986037Z	error	sds	Remote side closed connection
2020-08-31T01:09:07.986330Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8ae073ba-8f68-4fca-b6c7-60059b9ed186".sock: use of closed network connection
2020-08-31T01:09:07.986606Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"553d9e55-0ea6-4d02-9082-feb4b50099e8\".sock" 

2020-08-31T01:09:07.986673Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1bbef8b2-2a64-4ffb-b613-4fa0949e4a47\".sock" 

2020-08-31T01:09:07.986678Z	info	sds	Start SDS grpc server
2020-08-31T01:09:07.986699Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:08.287583Z	info	sds	resource:default new connection
2020-08-31T01:09:08.287642Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:09:08.287699Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:08.287974Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:08.288018Z	error	sds	Remote side closed connection
2020-08-31T01:09:08.288505Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:09:08.288549Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:09:08.288593Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:09:08.288826Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:08.288846Z	error	sds	Remote side closed connection
2020-08-31T01:09:08.379039Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:08.589773Z	info	sds	resource:default new connection
2020-08-31T01:09:08.589839Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:09:08.589891Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:08.590158Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:08.590188Z	error	sds	Remote side closed connection
2020-08-31T01:09:08.590402Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"553d9e55-0ea6-4d02-9082-feb4b50099e8".sock: use of closed network connection
2020-08-31T01:09:08.590470Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1bbef8b2-2a64-4ffb-b613-4fa0949e4a47".sock: use of closed network connection
2020-08-31T01:09:08.590657Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"694bf4d5-5527-4cd5-998a-d3ac782e2264\".sock" 

2020-08-31T01:09:08.590677Z	info	sds	Start SDS grpc server
2020-08-31T01:09:08.683451Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:08.684734Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:09:08.893232Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"694bf4d5-5527-4cd5-998a-d3ac782e2264".sock: use of closed network connection
2020-08-31T01:09:08.893420Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2b1b43de-67f6-48d8-bba9-0b3c4803b801\".sock" 

2020-08-31T01:09:08.893471Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:08.986542Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:09:09.195695Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2b1b43de-67f6-48d8-bba9-0b3c4803b801".sock: use of closed network connection
2020-08-31T01:09:09.195935Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest8c4db79b-0fa3-4beb-82b3-34b936cac439.sock" 

2020-08-31T01:09:09.195991Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6c44b0d6-5eea-4230-9052-945fac91313c\".sock" 

2020-08-31T01:09:09.196024Z	info	sds	Start SDS grpc server
2020-08-31T01:09:09.196045Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:09:09.590610Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:09.590603Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:09:09.800442Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest8c4db79b-0fa3-4beb-82b3-34b936cac439.sock: use of closed network connection
2020-08-31T01:09:09.800498Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6c44b0d6-5eea-4230-9052-945fac91313c".sock: use of closed network connection
2020-08-31T01:09:09.800798Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0e81d3e7-776a-4bca-b0fd-ef69809f5c7c.sock" 

2020-08-31T01:09:09.800846Z	info	sds	Start SDS grpc server
2020-08-31T01:09:09.893425Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:10.102156Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:09:10.102258Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:10.102487Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0e81d3e7-776a-4bca-b0fd-ef69809f5c7c.sock: use of closed network connection
2020-08-31T01:09:10.102779Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8d127a97-470a-49b3-ab23-372174dad68f.sock" 

2020-08-31T01:09:10.102856Z	info	sds	Start SDS grpc server
2020-08-31T01:09:10.106617Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:09:10.106688Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:09:10.106761Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:10.106991Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:09:10.107051Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:09:10.107097Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:09:10.195909Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:10.379314Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:10.683708Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:10.684914Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:10.800710Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:10.800732Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:10.986795Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:11.102707Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:11.107032Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:11.107077Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:09:11.590928Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:11.590895Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:11.893672Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:12.107856Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:12.108194Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8d127a97-470a-49b3-ab23-372174dad68f.sock: use of closed network connection
2020-08-31T01:09:12.108260Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:12.108293Z	error	sds	Remote side closed connection
2020-08-31T01:09:12.108318Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:12.108336Z	error	sds	Remote side closed connection
2020-08-31T01:09:12.108398Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest566dc46a-572b-49f4-ac09-d396b77a36f8.sock" 

2020-08-31T01:09:12.108436Z	info	sds	Start SDS grpc server
2020-08-31T01:09:12.109180Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:09:12.109217Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:09:12.109268Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:12.109765Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:09:12.109267299 +0000 UTC m=+6.813312580 and is waiting for next SDS request
2020-08-31T01:09:12.109782Z	info	sds	Dynamic push for secret default
2020-08-31T01:09:12.109832Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest566dc46a-572b-49f4-ac09-d396b77a36f8.sock: use of closed network connection
2020-08-31T01:09:12.109873Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:12.109892Z	error	sds	Remote side closed connection
2020-08-31T01:09:12.109934Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:12.109950Z	error	sds	Remote side closed connection
2020-08-31T01:09:12.110050Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest47767bcd-1827-401d-86cf-ae2f7ae89853.sock" 

2020-08-31T01:09:12.110121Z	info	sds	Start SDS grpc server
2020-08-31T01:09:12.110783Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:09:12.110816Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:09:12.110848Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:12.111287Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:09:12.196142Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:12.611355Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:12.611416Z	info	sds	Dynamic push for secret default
2020-08-31T01:09:12.612061Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest47767bcd-1827-401d-86cf-ae2f7ae89853.sock: use of closed network connection
2020-08-31T01:09:12.612214Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:12.612224Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:12.612250Z	error	sds	Remote side closed connection
2020-08-31T01:09:12.612240Z	error	sds	Remote side closed connection
2020-08-31T01:09:12.612348Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest49c42091-3cc6-4df2-b45a-a8591683600b.sock" 

2020-08-31T01:09:12.612361Z	info	sds	Start SDS grpc server
2020-08-31T01:09:12.612757Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest49c42091-3cc6-4df2-b45a-a8591683600b.sock: use of closed network connection
2020-08-31T01:09:12.612929Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9392f916-a835-42c9-a4ef-12c9f47027cd.sock" 

2020-08-31T01:09:12.612956Z	info	sds	Start SDS grpc server
2020-08-31T01:09:12.800935Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:12.800973Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:12.913661Z	info	sds	resource:default new connection
2020-08-31T01:09:12.913713Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:09:12.913763Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:12.914063Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:12.914092Z	error	sds	Remote side closed connection
2020-08-31T01:09:13.102913Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:13.108381Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:13.109993Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:13.215256Z	info	sds	resource:default new connection
2020-08-31T01:09:13.215335Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:09:13.215401Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:13.215725Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:13.215757Z	error	sds	Remote side closed connection
2020-08-31T01:09:13.216051Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9392f916-a835-42c9-a4ef-12c9f47027cd.sock: use of closed network connection
2020-08-31T01:09:13.216193Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest313e45e6-8d63-402e-a762-11a525322365.sock" 

2020-08-31T01:09:13.216244Z	info	sds	Start SDS grpc server
2020-08-31T01:09:13.517332Z	info	sds	resource:default new connection
2020-08-31T01:09:13.517396Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:09:13.517463Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:13.517787Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:13.517814Z	error	sds	Remote side closed connection
2020-08-31T01:09:13.518211Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest313e45e6-8d63-402e-a762-11a525322365.sock: use of closed network connection
2020-08-31T01:09:13.612295Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:13.612903Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:14.216307Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:14.379627Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:14.518493Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:09:14.684031Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:14.685245Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:14.986982Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:15.108727Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:15.110242Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:09:15.548089Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest77e55eea-db5e-4773-81b6-f63fb5885785.sock" 

2020-08-31T01:09:15.548146Z	info	sds	Start SDS grpc server
2020-08-31T01:09:15.591250Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:15.591305Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:15.612700Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:15.613062Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:15.894071Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:16.196506Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:16.216649Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:16.518795Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:16.550915Z	info	sds	resource:default new connection
2020-08-31T01:09:16.551005Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:09:16.555965Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:09:16.655756Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:09:16.655812Z	info	cache	GenerateSecret default
2020-08-31T01:09:16.655885Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:16.656395Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest77e55eea-db5e-4773-81b6-f63fb5885785.sock: use of closed network connection
PASS
2020-08-31T01:09:16.656522Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:16.656554Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.613s
2020-08-31T01:09:22.110019Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest16ed002b-b111-4b10-b0af-6b84c81c1e8d.sock" 

2020-08-31T01:09:22.110116Z	info	sds	Start SDS grpc server
2020-08-31T01:09:22.111452Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:09:22.111521Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:09:22.111899Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:23.111456Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:23.111509Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:09:24.112622Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:09:24.112742Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:09:24.112767Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:09:24.112839Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:24.113102Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest16ed002b-b111-4b10-b0af-6b84c81c1e8d.sock: use of closed network connection
2020-08-31T01:09:24.113219Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:24.113228Z	error	sds	Remote side closed connection
2020-08-31T01:09:24.113371Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6d8c9150-bde1-4fc2-a64f-44abe2161ff0\".sock" 

2020-08-31T01:09:24.113413Z	info	sds	Start SDS grpc server
2020-08-31T01:09:24.414430Z	info	sds	resource:default new connection
2020-08-31T01:09:24.414505Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:09:24.414577Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:24.414865Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:24.414894Z	error	sds	Remote side closed connection
2020-08-31T01:09:24.415537Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:09:24.415574Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:09:24.415728Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:09:24.415983Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:24.416006Z	error	sds	Remote side closed connection
2020-08-31T01:09:24.416158Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6d8c9150-bde1-4fc2-a64f-44abe2161ff0".sock: use of closed network connection
2020-08-31T01:09:24.416341Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"160185c0-1149-4e60-838a-9aad79fa131e\".sock" 

2020-08-31T01:09:24.416420Z	info	sds	Start SDS grpc server
2020-08-31T01:09:24.416809Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:09:24.416865Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:09:24.416936Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:09:24.417204Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:24.417238Z	error	sds	Remote side closed connection
2020-08-31T01:09:24.417353Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"160185c0-1149-4e60-838a-9aad79fa131e".sock: use of closed network connection
2020-08-31T01:09:24.417533Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"71858f05-3531-410e-a3d3-ec093c32cd67\".sock" 

2020-08-31T01:09:24.417565Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:24.718449Z	info	sds	resource:default new connection
2020-08-31T01:09:24.718509Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:09:24.718566Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:24.718824Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:24.718851Z	error	sds	Remote side closed connection
2020-08-31T01:09:24.719063Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"71858f05-3531-410e-a3d3-ec093c32cd67".sock: use of closed network connection
2020-08-31T01:09:24.719260Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d3a3536d-3dbd-42c9-a1f5-b600a88a4f5b\".sock" 

2020-08-31T01:09:24.719316Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5c4593b8-6a0b-4d19-b1e5-3e4410ec27c9\".sock" 

2020-08-31T01:09:24.719347Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:24.719348Z	info	sds	Start SDS grpc server
2020-08-31T01:09:25.020403Z	info	sds	resource:default new connection
2020-08-31T01:09:25.020469Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:09:25.020538Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:25.020889Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:25.020916Z	error	sds	Remote side closed connection
2020-08-31T01:09:25.021438Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:09:25.021475Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:09:25.021513Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:09:25.021984Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:25.022006Z	error	sds	Remote side closed connection
2020-08-31T01:09:25.113321Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:25.322986Z	info	sds	resource:default new connection
2020-08-31T01:09:25.323059Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:09:25.323114Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:25.323522Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:25.323549Z	error	sds	Remote side closed connection
2020-08-31T01:09:25.323701Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d3a3536d-3dbd-42c9-a1f5-b600a88a4f5b".sock: use of closed network connection
2020-08-31T01:09:25.323743Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5c4593b8-6a0b-4d19-b1e5-3e4410ec27c9".sock: use of closed network connection
2020-08-31T01:09:25.323922Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0c19bb7c-3e86-4fb9-9da3-126ecaa48b0d\".sock" 

2020-08-31T01:09:25.323942Z	info	sds	Start SDS grpc server
2020-08-31T01:09:25.416390Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:25.417563Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:09:25.626519Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0c19bb7c-3e86-4fb9-9da3-126ecaa48b0d".sock: use of closed network connection
2020-08-31T01:09:25.626707Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9bcc98a7-79e9-4252-b5bd-0c3aacacd86e\".sock" 

2020-08-31T01:09:25.626728Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:25.719289Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:09:25.928270Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9bcc98a7-79e9-4252-b5bd-0c3aacacd86e".sock: use of closed network connection
2020-08-31T01:09:25.928468Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestdd7bae85-4849-469d-ace6-20756bfe48ba.sock" 

2020-08-31T01:09:25.928522Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1e5b24e5-df9d-40a1-9595-90686991a504\".sock" 

2020-08-31T01:09:25.928544Z	info	sds	Start SDS grpc server
2020-08-31T01:09:25.928557Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:09:26.323840Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:26.323893Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:09:26.533981Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestdd7bae85-4849-469d-ace6-20756bfe48ba.sock: use of closed network connection
2020-08-31T01:09:26.534077Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1e5b24e5-df9d-40a1-9595-90686991a504".sock: use of closed network connection
2020-08-31T01:09:26.534396Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestbfb8d163-8f82-40c7-9db1-c7ee73cb0f4a.sock" 

2020-08-31T01:09:26.534418Z	info	sds	Start SDS grpc server
2020-08-31T01:09:26.626751Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:26.835806Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:09:26.835934Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:26.836141Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestbfb8d163-8f82-40c7-9db1-c7ee73cb0f4a.sock: use of closed network connection
2020-08-31T01:09:26.836472Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest97220f0e-9dd3-4587-8a4c-31a3257ac9db.sock" 

2020-08-31T01:09:26.836619Z	info	sds	Start SDS grpc server
2020-08-31T01:09:26.837420Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:09:26.837473Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:09:26.837518Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:26.837672Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:09:26.837744Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:09:26.837784Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:09:26.928507Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:27.113568Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:27.416693Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:27.417728Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:27.534241Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:27.534227Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:27.719572Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:27.836320Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:27.837732Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:27.837763Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:09:28.323997Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:28.324062Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:28.626994Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:28.838572Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:28.839010Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest97220f0e-9dd3-4587-8a4c-31a3257ac9db.sock: use of closed network connection
2020-08-31T01:09:28.839024Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:28.839051Z	error	sds	Remote side closed connection
2020-08-31T01:09:28.839089Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:28.839114Z	error	sds	Remote side closed connection
2020-08-31T01:09:28.839427Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfb15b623-b266-4ef3-b311-ebec43ad910c.sock" 

2020-08-31T01:09:28.839530Z	info	sds	Start SDS grpc server
2020-08-31T01:09:28.840245Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:09:28.840295Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:09:28.840344Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:28.840917Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:09:28.840343109 +0000 UTC m=+6.810011607 and is waiting for next SDS request
2020-08-31T01:09:28.840936Z	info	sds	Dynamic push for secret default
2020-08-31T01:09:28.840934Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfb15b623-b266-4ef3-b311-ebec43ad910c.sock: use of closed network connection
2020-08-31T01:09:28.840994Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:28.841002Z	error	sds	Remote side closed connection
2020-08-31T01:09:28.841029Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:28.841051Z	error	sds	Remote side closed connection
2020-08-31T01:09:28.841140Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfd45beef-9ae9-4b82-a1c4-bbcd6e507395.sock" 

2020-08-31T01:09:28.841192Z	info	sds	Start SDS grpc server
2020-08-31T01:09:28.841858Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:09:28.841897Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:09:28.841942Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:28.842538Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:09:28.928819Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:29.342762Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:29.342818Z	info	sds	Dynamic push for secret default
2020-08-31T01:09:29.343517Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfd45beef-9ae9-4b82-a1c4-bbcd6e507395.sock: use of closed network connection
2020-08-31T01:09:29.343688Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:29.343727Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:29.343718Z	error	sds	Remote side closed connection
2020-08-31T01:09:29.343749Z	error	sds	Remote side closed connection
2020-08-31T01:09:29.343795Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf65e8a7a-51ce-4f95-92d5-073240c6f90e.sock" 

2020-08-31T01:09:29.343824Z	info	sds	Start SDS grpc server
2020-08-31T01:09:29.344074Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf65e8a7a-51ce-4f95-92d5-073240c6f90e.sock: use of closed network connection
2020-08-31T01:09:29.344161Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc92c9236-badc-4245-8a2f-04176131aa64.sock" 

2020-08-31T01:09:29.344181Z	info	sds	Start SDS grpc server
2020-08-31T01:09:29.534533Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:29.534573Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:29.645132Z	info	sds	resource:default new connection
2020-08-31T01:09:29.645198Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:09:29.645255Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:29.645551Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:29.645569Z	error	sds	Remote side closed connection
2020-08-31T01:09:29.836562Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:29.839235Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:29.841101Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:29.946676Z	info	sds	resource:default new connection
2020-08-31T01:09:29.946734Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:09:29.946786Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:29.947110Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:29.947140Z	error	sds	Remote side closed connection
2020-08-31T01:09:29.947410Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc92c9236-badc-4245-8a2f-04176131aa64.sock: use of closed network connection
2020-08-31T01:09:29.947548Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest102a85cc-effb-4eaf-989c-d38f4e7aeb25.sock" 

2020-08-31T01:09:29.947588Z	info	sds	Start SDS grpc server
2020-08-31T01:09:30.248629Z	info	sds	resource:default new connection
2020-08-31T01:09:30.248714Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:09:30.248769Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:30.249096Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:30.249126Z	error	sds	Remote side closed connection
2020-08-31T01:09:30.249316Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest102a85cc-effb-4eaf-989c-d38f4e7aeb25.sock: use of closed network connection
2020-08-31T01:09:30.343803Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:30.344151Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:30.947622Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:31.113824Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:31.249522Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:09:31.416915Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:31.417900Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:31.719842Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:31.839466Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:31.841289Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:09:32.279941Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta3da74c8-c3e6-4409-ab8d-753e250f7389.sock" 

2020-08-31T01:09:32.279993Z	info	sds	Start SDS grpc server
2020-08-31T01:09:32.324216Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:32.324262Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:32.344052Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:32.344360Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:32.627229Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:32.929064Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:32.947875Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:33.249743Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:33.280746Z	info	sds	resource:default new connection
2020-08-31T01:09:33.280804Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:09:33.283307Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:09:33.380991Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:09:33.381119Z	info	cache	GenerateSecret default
2020-08-31T01:09:33.381199Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:33.381618Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta3da74c8-c3e6-4409-ab8d-753e250f7389.sock: use of closed network connection
PASS
2020-08-31T01:09:33.381753Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.597s
2020-08-31T01:09:38.630080Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfb6f9962-ca20-4abe-818a-cfad775b4432.sock" 

2020-08-31T01:09:38.630177Z	info	sds	Start SDS grpc server
2020-08-31T01:09:38.631215Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:09:38.631354Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:09:38.631684Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:39.631150Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:39.631238Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:09:40.631926Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:09:40.632001Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:09:40.632034Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:09:40.632088Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:40.632330Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfb6f9962-ca20-4abe-818a-cfad775b4432.sock: use of closed network connection
2020-08-31T01:09:40.632440Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:40.632473Z	error	sds	Remote side closed connection
2020-08-31T01:09:40.632629Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"346a3085-ce0b-402f-b3ef-1a8ba406d201\".sock" 

2020-08-31T01:09:40.632719Z	info	sds	Start SDS grpc server
2020-08-31T01:09:40.933679Z	info	sds	resource:default new connection
2020-08-31T01:09:40.933754Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:09:40.933812Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:40.934070Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:40.934098Z	error	sds	Remote side closed connection
2020-08-31T01:09:40.934804Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:09:40.934843Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:09:40.935011Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:09:40.935287Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:40.935306Z	error	sds	Remote side closed connection
2020-08-31T01:09:40.935532Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"346a3085-ce0b-402f-b3ef-1a8ba406d201".sock: use of closed network connection
2020-08-31T01:09:40.935702Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5227a96d-e0c0-45b2-8d0d-ad47125908b5\".sock" 

2020-08-31T01:09:40.935778Z	info	sds	Start SDS grpc server
2020-08-31T01:09:40.936256Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:09:40.936295Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:09:40.936355Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:09:40.936650Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:40.936699Z	error	sds	Remote side closed connection
2020-08-31T01:09:40.936780Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5227a96d-e0c0-45b2-8d0d-ad47125908b5".sock: use of closed network connection
2020-08-31T01:09:40.936927Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8ee5f44c-ea31-4edd-bd53-ca1d0bc3f67e\".sock" 

2020-08-31T01:09:40.936957Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:41.237940Z	info	sds	resource:default new connection
2020-08-31T01:09:41.238017Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:09:41.238068Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:41.238353Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:41.238377Z	error	sds	Remote side closed connection
2020-08-31T01:09:41.238642Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8ee5f44c-ea31-4edd-bd53-ca1d0bc3f67e".sock: use of closed network connection
2020-08-31T01:09:41.238841Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1f866eb0-96cd-408f-90e8-d9ab7e0d16ac\".sock" 

2020-08-31T01:09:41.238916Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f7574f94-8763-4d9c-b873-d762574e7f9a\".sock" 

2020-08-31T01:09:41.238946Z	info	sds	Start SDS grpc server
2020-08-31T01:09:41.238957Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:41.539983Z	info	sds	resource:default new connection
2020-08-31T01:09:41.540060Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:09:41.540117Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:41.540441Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:41.540483Z	error	sds	Remote side closed connection
2020-08-31T01:09:41.541034Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:09:41.541077Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:09:41.541114Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:09:41.541348Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:41.541363Z	error	sds	Remote side closed connection
2020-08-31T01:09:41.632536Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:41.842369Z	info	sds	resource:default new connection
2020-08-31T01:09:41.842424Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:09:41.842476Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:41.842845Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:41.842877Z	error	sds	Remote side closed connection
2020-08-31T01:09:41.843139Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1f866eb0-96cd-408f-90e8-d9ab7e0d16ac".sock: use of closed network connection
2020-08-31T01:09:41.843182Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f7574f94-8763-4d9c-b873-d762574e7f9a".sock: use of closed network connection
2020-08-31T01:09:41.843479Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"bbc370a1-ed36-4a46-bbdf-14bf70d865a9\".sock" 

2020-08-31T01:09:41.843522Z	info	sds	Start SDS grpc server
2020-08-31T01:09:41.935770Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:41.936947Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:09:42.146237Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"bbc370a1-ed36-4a46-bbdf-14bf70d865a9".sock: use of closed network connection
2020-08-31T01:09:42.146454Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ef314e0e-ef49-42a3-bb77-dbd3389e45d7\".sock" 

2020-08-31T01:09:42.146480Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:42.238853Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:09:42.447915Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ef314e0e-ef49-42a3-bb77-dbd3389e45d7".sock: use of closed network connection
2020-08-31T01:09:42.448117Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest06036637-b11c-4f74-8497-9220b0175c1d.sock" 

2020-08-31T01:09:42.448138Z	info	sds	Start SDS grpc server
2020-08-31T01:09:42.448210Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"53c252ec-d2d3-4871-9a5e-41fd30289a15\".sock" 

2020-08-31T01:09:42.448239Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:09:42.843360Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:42.843412Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:09:43.052008Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest06036637-b11c-4f74-8497-9220b0175c1d.sock: use of closed network connection
2020-08-31T01:09:43.052060Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"53c252ec-d2d3-4871-9a5e-41fd30289a15".sock: use of closed network connection
2020-08-31T01:09:43.052259Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest252c3550-d37e-4199-a34a-58a2e168f156.sock" 

2020-08-31T01:09:43.052283Z	info	sds	Start SDS grpc server
2020-08-31T01:09:43.146469Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:43.353581Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:09:43.353667Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:43.353886Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest252c3550-d37e-4199-a34a-58a2e168f156.sock: use of closed network connection
2020-08-31T01:09:43.354092Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6e5c8ede-e84a-40dc-b288-cefaa419ddf4.sock" 

2020-08-31T01:09:43.354423Z	info	sds	Start SDS grpc server
2020-08-31T01:09:43.357512Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:09:43.357596Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:09:43.357654Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:43.357709Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:09:43.357767Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:09:43.357821Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:09:43.448155Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:43.632819Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:43.936038Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:43.937129Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:44.052168Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:44.052220Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:44.239102Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:44.354067Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:44.357896Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:44.357941Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:09:44.843575Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:44.843620Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:45.146716Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:45.358937Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:45.359258Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6e5c8ede-e84a-40dc-b288-cefaa419ddf4.sock: use of closed network connection
2020-08-31T01:09:45.359358Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:45.359380Z	error	sds	Remote side closed connection
2020-08-31T01:09:45.359398Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:45.359431Z	error	sds	Remote side closed connection
2020-08-31T01:09:45.359558Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc904b231-0bab-4bab-babd-5a836758a998.sock" 

2020-08-31T01:09:45.359621Z	info	sds	Start SDS grpc server
2020-08-31T01:09:45.360378Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:09:45.360429Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:09:45.360482Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:45.360974Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:09:45.360481191 +0000 UTC m=+6.811592620 and is waiting for next SDS request
2020-08-31T01:09:45.361009Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc904b231-0bab-4bab-babd-5a836758a998.sock: use of closed network connection
2020-08-31T01:09:45.361012Z	info	sds	Dynamic push for secret default
2020-08-31T01:09:45.361074Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:45.361086Z	error	sds	Remote side closed connection
2020-08-31T01:09:45.361128Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:45.361152Z	error	sds	Remote side closed connection
2020-08-31T01:09:45.361247Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb1a2aff8-f742-4a99-9332-13864d2fb880.sock" 

2020-08-31T01:09:45.361323Z	info	sds	Start SDS grpc server
2020-08-31T01:09:45.361988Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:09:45.362033Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:09:45.362073Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:45.362646Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:09:45.448364Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:45.862794Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:45.862850Z	info	sds	Dynamic push for secret default
2020-08-31T01:09:45.863485Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb1a2aff8-f742-4a99-9332-13864d2fb880.sock: use of closed network connection
2020-08-31T01:09:45.863570Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:45.863601Z	error	sds	Remote side closed connection
2020-08-31T01:09:45.863628Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:45.863649Z	error	sds	Remote side closed connection
2020-08-31T01:09:45.863781Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest458663b5-8aed-46c5-9521-6f7a8f3a3594.sock" 

2020-08-31T01:09:45.863874Z	info	sds	Start SDS grpc server
2020-08-31T01:09:45.864136Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest458663b5-8aed-46c5-9521-6f7a8f3a3594.sock: use of closed network connection
2020-08-31T01:09:45.864235Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest02a6e8ae-40fd-477d-a984-4454a41388d1.sock" 

2020-08-31T01:09:45.864249Z	info	sds	Start SDS grpc server
2020-08-31T01:09:46.052419Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:46.052484Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:46.165331Z	info	sds	resource:default new connection
2020-08-31T01:09:46.165406Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:09:46.165468Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:46.165922Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:46.165953Z	error	sds	Remote side closed connection
2020-08-31T01:09:46.354312Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:46.359456Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:46.361164Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:46.467047Z	info	sds	resource:default new connection
2020-08-31T01:09:46.467133Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:09:46.467220Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:46.467484Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:46.467508Z	error	sds	Remote side closed connection
2020-08-31T01:09:46.467799Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest02a6e8ae-40fd-477d-a984-4454a41388d1.sock: use of closed network connection
2020-08-31T01:09:46.467942Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd39ef0ea-fa67-47f7-a52a-7236cdc11ade.sock" 

2020-08-31T01:09:46.467975Z	info	sds	Start SDS grpc server
2020-08-31T01:09:46.768782Z	info	sds	resource:default new connection
2020-08-31T01:09:46.768838Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:09:46.768890Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:46.769302Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:46.769332Z	error	sds	Remote side closed connection
2020-08-31T01:09:46.769448Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd39ef0ea-fa67-47f7-a52a-7236cdc11ade.sock: use of closed network connection
2020-08-31T01:09:46.863710Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:46.864277Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:47.467999Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:47.633089Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:47.769676Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:09:47.936290Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:47.937318Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:48.239360Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:48.359677Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:48.361355Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:09:48.802576Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest67c0b046-d9f6-4250-80ad-af4b241696af.sock" 

2020-08-31T01:09:48.802628Z	info	sds	Start SDS grpc server
2020-08-31T01:09:48.843845Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:48.843844Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:48.863984Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:48.864453Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:49.146972Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:49.448593Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:49.468228Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:49.769904Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:49.803642Z	info	sds	resource:default new connection
2020-08-31T01:09:49.803718Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:09:49.812290Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:09:49.925536Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:09:49.925586Z	info	cache	GenerateSecret default
2020-08-31T01:09:49.925661Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:49.926056Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest67c0b046-d9f6-4250-80ad-af4b241696af.sock: use of closed network connection
PASS
2020-08-31T01:09:49.926201Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.631s
2020-08-31T01:09:55.228754Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8bc9520b-b12e-4745-b02a-024793f252ee.sock" 

2020-08-31T01:09:55.228851Z	info	sds	Start SDS grpc server
2020-08-31T01:09:55.232009Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:09:55.232193Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:09:55.233088Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:56.231664Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:56.231707Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:09:57.232414Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:09:57.232489Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:09:57.232512Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:09:57.232571Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:57.232834Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8bc9520b-b12e-4745-b02a-024793f252ee.sock: use of closed network connection
2020-08-31T01:09:57.233036Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:57.233067Z	error	sds	Remote side closed connection
2020-08-31T01:09:57.233121Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6409b1db-ea9d-4a78-b373-e18413f737a1\".sock" 

2020-08-31T01:09:57.233162Z	info	sds	Start SDS grpc server
2020-08-31T01:09:57.534216Z	info	sds	resource:default new connection
2020-08-31T01:09:57.534312Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:09:57.534371Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:57.534655Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:57.534706Z	error	sds	Remote side closed connection
2020-08-31T01:09:57.535267Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:09:57.535306Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:09:57.535484Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:09:57.535822Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:57.535856Z	error	sds	Remote side closed connection
2020-08-31T01:09:57.536081Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6409b1db-ea9d-4a78-b373-e18413f737a1".sock: use of closed network connection
2020-08-31T01:09:57.536350Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"94b25d19-d2a2-4213-857d-cdb1d5b077d7\".sock" 

2020-08-31T01:09:57.536388Z	info	sds	Start SDS grpc server
2020-08-31T01:09:57.537016Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:09:57.537054Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:09:57.537090Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:09:57.537330Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:57.537366Z	error	sds	Remote side closed connection
2020-08-31T01:09:57.537599Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"94b25d19-d2a2-4213-857d-cdb1d5b077d7".sock: use of closed network connection
2020-08-31T01:09:57.537782Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3cf346be-e8b4-4292-8473-7eee8e09fe40\".sock" 

2020-08-31T01:09:57.537822Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:57.838846Z	info	sds	resource:default new connection
2020-08-31T01:09:57.838905Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:09:57.838960Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:57.839218Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:57.839247Z	error	sds	Remote side closed connection
2020-08-31T01:09:57.839493Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3cf346be-e8b4-4292-8473-7eee8e09fe40".sock: use of closed network connection
2020-08-31T01:09:57.839716Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"beef7d56-96fc-42d3-8b26-8a88a425af75\".sock" 

2020-08-31T01:09:57.839773Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"265dbbb8-c4fb-4160-8172-dc1e6d0a68d3\".sock" 

2020-08-31T01:09:57.839810Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:57.839816Z	info	sds	Start SDS grpc server
2020-08-31T01:09:58.140935Z	info	sds	resource:default new connection
2020-08-31T01:09:58.141005Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:09:58.141067Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:58.141460Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:58.141491Z	error	sds	Remote side closed connection
2020-08-31T01:09:58.142067Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:09:58.142143Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:09:58.142186Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:09:58.142419Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:58.142496Z	error	sds	Remote side closed connection
2020-08-31T01:09:58.233066Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:58.443517Z	info	sds	resource:default new connection
2020-08-31T01:09:58.443592Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:09:58.443663Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:58.443992Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:58.444051Z	error	sds	Remote side closed connection
2020-08-31T01:09:58.444180Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"beef7d56-96fc-42d3-8b26-8a88a425af75".sock: use of closed network connection
2020-08-31T01:09:58.444217Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"265dbbb8-c4fb-4160-8172-dc1e6d0a68d3".sock: use of closed network connection
2020-08-31T01:09:58.444421Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6452a451-5132-4e4d-b86a-33543a9aa188\".sock" 

2020-08-31T01:09:58.444445Z	info	sds	Start SDS grpc server
2020-08-31T01:09:58.536221Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:58.537765Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:09:58.747053Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6452a451-5132-4e4d-b86a-33543a9aa188".sock: use of closed network connection
2020-08-31T01:09:58.747226Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"27f44c27-d3ff-4606-846d-0f84387fefe1\".sock" 

2020-08-31T01:09:58.747281Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:09:58.839692Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:09:59.048810Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"27f44c27-d3ff-4606-846d-0f84387fefe1".sock: use of closed network connection
2020-08-31T01:09:59.049009Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest72e16999-9534-4e39-a9a7-4a34c29bba39.sock" 

2020-08-31T01:09:59.049066Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"657c4626-419a-4d03-9c88-4745d9563407\".sock" 

2020-08-31T01:09:59.049098Z	info	sds	Start SDS grpc server
2020-08-31T01:09:59.049113Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:09:59.444389Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:09:59.444418Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:09:59.653120Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest72e16999-9534-4e39-a9a7-4a34c29bba39.sock: use of closed network connection
2020-08-31T01:09:59.653222Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"657c4626-419a-4d03-9c88-4745d9563407".sock: use of closed network connection
2020-08-31T01:09:59.653424Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest58ef2629-4429-4602-83e6-80f1de7d86ea.sock" 

2020-08-31T01:09:59.653463Z	info	sds	Start SDS grpc server
2020-08-31T01:09:59.747329Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:09:59.955105Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:09:59.955215Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:09:59.955507Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest58ef2629-4429-4602-83e6-80f1de7d86ea.sock: use of closed network connection
2020-08-31T01:09:59.955751Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9180a74c-e0b7-459e-b158-1cb225b3d7e1.sock" 

2020-08-31T01:09:59.955833Z	info	sds	Start SDS grpc server
2020-08-31T01:09:59.956493Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:09:59.956534Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:09:59.956578Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:09:59.956708Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:09:59.956731Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:09:59.956755Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:10:00.049061Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:00.233338Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:00.536454Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:00.538001Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:00.653356Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:00.653394Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:00.839991Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:00.955756Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:00.956851Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:00.956888Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:10:01.444781Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:01.444831Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:01.747628Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:01.957696Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:01.958112Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9180a74c-e0b7-459e-b158-1cb225b3d7e1.sock: use of closed network connection
2020-08-31T01:10:01.958194Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:01.958222Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:01.958275Z	error	sds	Remote side closed connection
2020-08-31T01:10:01.958235Z	error	sds	Remote side closed connection
2020-08-31T01:10:01.958395Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest36a76b39-8e05-4a74-b6c2-11b484549bef.sock" 

2020-08-31T01:10:01.958500Z	info	sds	Start SDS grpc server
2020-08-31T01:10:01.959349Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:10:01.959412Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:10:01.959470Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:01.960059Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:10:01.959468942 +0000 UTC m=+6.807323310 and is waiting for next SDS request
2020-08-31T01:10:01.960083Z	info	sds	Dynamic push for secret default
2020-08-31T01:10:01.960088Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest36a76b39-8e05-4a74-b6c2-11b484549bef.sock: use of closed network connection
2020-08-31T01:10:01.960158Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:01.960176Z	error	sds	Remote side closed connection
2020-08-31T01:10:01.960198Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:01.960222Z	error	sds	Remote side closed connection
2020-08-31T01:10:01.960298Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcf76aadc-ad58-4d86-a4af-7e1b820ee80b.sock" 

2020-08-31T01:10:01.960353Z	info	sds	Start SDS grpc server
2020-08-31T01:10:01.961030Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:10:01.961068Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:10:01.961101Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:01.961562Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:10:02.049344Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:02.461739Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:02.461801Z	info	sds	Dynamic push for secret default
2020-08-31T01:10:02.462399Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcf76aadc-ad58-4d86-a4af-7e1b820ee80b.sock: use of closed network connection
2020-08-31T01:10:02.462513Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:02.462524Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:02.462562Z	error	sds	Remote side closed connection
2020-08-31T01:10:02.462547Z	error	sds	Remote side closed connection
2020-08-31T01:10:02.462631Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0d648d4d-bcca-4511-96cc-ad1a6c63cd38.sock" 

2020-08-31T01:10:02.462652Z	info	sds	Start SDS grpc server
2020-08-31T01:10:02.462845Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0d648d4d-bcca-4511-96cc-ad1a6c63cd38.sock: use of closed network connection
2020-08-31T01:10:02.462923Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest51c77c50-d7f1-428d-9e24-661a244bad92.sock" 

2020-08-31T01:10:02.462944Z	info	sds	Start SDS grpc server
2020-08-31T01:10:02.653616Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:02.653671Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:02.763993Z	info	sds	resource:default new connection
2020-08-31T01:10:02.764060Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:10:02.764118Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:02.764432Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:02.764465Z	error	sds	Remote side closed connection
2020-08-31T01:10:02.956020Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:02.958335Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:02.960323Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:03.065543Z	info	sds	resource:default new connection
2020-08-31T01:10:03.065612Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:10:03.065666Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:03.065966Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:03.065999Z	error	sds	Remote side closed connection
2020-08-31T01:10:03.066310Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest51c77c50-d7f1-428d-9e24-661a244bad92.sock: use of closed network connection
2020-08-31T01:10:03.066473Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1e1fe735-453a-4cd7-aa2f-61d7fd8a5ed2.sock" 

2020-08-31T01:10:03.066515Z	info	sds	Start SDS grpc server
2020-08-31T01:10:03.367955Z	info	sds	resource:default new connection
2020-08-31T01:10:03.368022Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:10:03.368078Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:03.368469Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:03.368495Z	error	sds	Remote side closed connection
2020-08-31T01:10:03.368710Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1e1fe735-453a-4cd7-aa2f-61d7fd8a5ed2.sock: use of closed network connection
2020-08-31T01:10:03.462623Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:03.462934Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:04.066464Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:04.233603Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:04.368911Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:10:04.536741Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:04.538211Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:04.840202Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:04.958620Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:04.960547Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:10:05.400580Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta822332e-4ad0-4f30-8282-cc845ce314ed.sock" 

2020-08-31T01:10:05.400667Z	info	sds	Start SDS grpc server
2020-08-31T01:10:05.445021Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:05.445073Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:05.462910Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:05.462973Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:05.747882Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:06.049633Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:06.066693Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:06.369080Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:06.401690Z	info	sds	resource:default new connection
2020-08-31T01:10:06.401785Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:10:06.406342Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:10:06.653903Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:06.653933Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:06.755772Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:10:06.755820Z	info	cache	GenerateSecret default
2020-08-31T01:10:06.755876Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:06.756282Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta822332e-4ad0-4f30-8282-cc845ce314ed.sock: use of closed network connection
PASS
2020-08-31T01:10:06.756426Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.857s
2020-08-31T01:10:12.083884Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest14f041c2-3faf-4f89-90d4-dd9fada40546.sock" 

2020-08-31T01:10:12.083984Z	info	sds	Start SDS grpc server
2020-08-31T01:10:12.085318Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:10:12.085390Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:10:12.085826Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:13.085288Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:13.085339Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:10:14.086404Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:10:14.086496Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:10:14.086532Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:10:14.086594Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:14.086899Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest14f041c2-3faf-4f89-90d4-dd9fada40546.sock: use of closed network connection
2020-08-31T01:10:14.087052Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:14.087089Z	error	sds	Remote side closed connection
2020-08-31T01:10:14.087232Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"eb54a013-cafa-44dd-8dfa-18c37d5d255b\".sock" 

2020-08-31T01:10:14.087252Z	info	sds	Start SDS grpc server
2020-08-31T01:10:14.388429Z	info	sds	resource:default new connection
2020-08-31T01:10:14.388492Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:10:14.388551Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:14.388915Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:14.388937Z	error	sds	Remote side closed connection
2020-08-31T01:10:14.389521Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:10:14.389554Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:10:14.389709Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:10:14.389930Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:14.389953Z	error	sds	Remote side closed connection
2020-08-31T01:10:14.390173Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"eb54a013-cafa-44dd-8dfa-18c37d5d255b".sock: use of closed network connection
2020-08-31T01:10:14.390361Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"30da4525-7bfe-42c6-b374-26883d9de0fb\".sock" 

2020-08-31T01:10:14.390430Z	info	sds	Start SDS grpc server
2020-08-31T01:10:14.390814Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:10:14.390872Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:10:14.390929Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:10:14.391149Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:14.391231Z	error	sds	Remote side closed connection
2020-08-31T01:10:14.391318Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"30da4525-7bfe-42c6-b374-26883d9de0fb".sock: use of closed network connection
2020-08-31T01:10:14.391460Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"25da3cc8-4de8-4f93-ba39-364345e6fef4\".sock" 

2020-08-31T01:10:14.391497Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:14.692446Z	info	sds	resource:default new connection
2020-08-31T01:10:14.692511Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:10:14.692595Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:14.692968Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:14.692992Z	error	sds	Remote side closed connection
2020-08-31T01:10:14.693210Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"25da3cc8-4de8-4f93-ba39-364345e6fef4".sock: use of closed network connection
2020-08-31T01:10:14.693467Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"78161dd7-e1be-4bd1-a482-b8991908f760\".sock" 

2020-08-31T01:10:14.693483Z	info	sds	Start SDS grpc server
2020-08-31T01:10:14.693544Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b83c2c68-997f-473e-8089-1397532d538f\".sock" 

2020-08-31T01:10:14.693577Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:14.994859Z	info	sds	resource:default new connection
2020-08-31T01:10:14.994930Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:10:14.995001Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:14.995271Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:14.995297Z	error	sds	Remote side closed connection
2020-08-31T01:10:14.996018Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:10:14.996058Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:10:14.996097Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:10:14.996270Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:14.996280Z	error	sds	Remote side closed connection
2020-08-31T01:10:15.087144Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:15.297393Z	info	sds	resource:default new connection
2020-08-31T01:10:15.297454Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:10:15.297521Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:15.297842Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:15.297871Z	error	sds	Remote side closed connection
2020-08-31T01:10:15.298194Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"78161dd7-e1be-4bd1-a482-b8991908f760".sock: use of closed network connection
2020-08-31T01:10:15.298247Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b83c2c68-997f-473e-8089-1397532d538f".sock: use of closed network connection
2020-08-31T01:10:15.298449Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"326b877f-27c2-4020-b7fd-ebaae6692813\".sock" 

2020-08-31T01:10:15.298478Z	info	sds	Start SDS grpc server
2020-08-31T01:10:15.390420Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:15.391495Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:10:15.601826Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"326b877f-27c2-4020-b7fd-ebaae6692813".sock: use of closed network connection
2020-08-31T01:10:15.602568Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"baac933b-92b8-458b-b4dd-3dd222b830ab\".sock" 

2020-08-31T01:10:15.602612Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:15.693424Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:10:15.904560Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"baac933b-92b8-458b-b4dd-3dd222b830ab".sock: use of closed network connection
2020-08-31T01:10:15.904857Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste91f1605-6135-4fd8-ba32-d5c04c11840f.sock" 

2020-08-31T01:10:15.904945Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"12b09533-1b1e-4418-b0da-6f4c0235e5b3\".sock" 

2020-08-31T01:10:15.904929Z	info	sds	Start SDS grpc server
2020-08-31T01:10:15.904985Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:10:16.298391Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:16.298463Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:10:16.508836Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste91f1605-6135-4fd8-ba32-d5c04c11840f.sock: use of closed network connection
2020-08-31T01:10:16.508916Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"12b09533-1b1e-4418-b0da-6f4c0235e5b3".sock: use of closed network connection
2020-08-31T01:10:16.509139Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste34b2784-ee65-4764-b8cc-2473dbb6c1ca.sock" 

2020-08-31T01:10:16.509168Z	info	sds	Start SDS grpc server
2020-08-31T01:10:16.602067Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:16.810183Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:10:16.810267Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:16.810547Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste34b2784-ee65-4764-b8cc-2473dbb6c1ca.sock: use of closed network connection
2020-08-31T01:10:16.810784Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7fd2ca65-b8b5-4a90-b616-b5e9e12aa247.sock" 

2020-08-31T01:10:16.810858Z	info	sds	Start SDS grpc server
2020-08-31T01:10:16.811612Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:10:16.811658Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:10:16.811703Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:16.811954Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:10:16.812023Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:10:16.812063Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:10:16.904724Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:17.087416Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:17.390612Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:17.391766Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:17.508965Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:17.509025Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:17.693886Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:17.810790Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:17.811928Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:17.811959Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:10:18.298633Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:18.298681Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:18.602296Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:18.813230Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:18.813544Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7fd2ca65-b8b5-4a90-b616-b5e9e12aa247.sock: use of closed network connection
2020-08-31T01:10:18.813565Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:18.813591Z	error	sds	Remote side closed connection
2020-08-31T01:10:18.813647Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:18.813676Z	error	sds	Remote side closed connection
2020-08-31T01:10:18.813793Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest23afaa34-a11d-4700-bc2f-bcff6bac29c6.sock" 

2020-08-31T01:10:18.813870Z	info	sds	Start SDS grpc server
2020-08-31T01:10:18.814714Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:10:18.814763Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:10:18.814812Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:18.815418Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:10:18.814811821 +0000 UTC m=+6.808447226 and is waiting for next SDS request
2020-08-31T01:10:18.815436Z	info	sds	Dynamic push for secret default
2020-08-31T01:10:18.815450Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest23afaa34-a11d-4700-bc2f-bcff6bac29c6.sock: use of closed network connection
2020-08-31T01:10:18.815503Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:18.815523Z	error	sds	Remote side closed connection
2020-08-31T01:10:18.815564Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:18.815588Z	error	sds	Remote side closed connection
2020-08-31T01:10:18.815647Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4bb06189-24d7-40cb-8d28-302936932a5f.sock" 

2020-08-31T01:10:18.815666Z	info	sds	Start SDS grpc server
2020-08-31T01:10:18.816286Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:10:18.816342Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:10:18.816383Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:18.817082Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:10:18.904987Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:19.317173Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:19.317237Z	info	sds	Dynamic push for secret default
2020-08-31T01:10:19.318014Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4bb06189-24d7-40cb-8d28-302936932a5f.sock: use of closed network connection
2020-08-31T01:10:19.318117Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:19.318140Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:19.318163Z	error	sds	Remote side closed connection
2020-08-31T01:10:19.318149Z	error	sds	Remote side closed connection
2020-08-31T01:10:19.318256Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest806ba8d8-e2a5-4aba-b11c-b0fe945f7d59.sock" 

2020-08-31T01:10:19.318267Z	info	sds	Start SDS grpc server
2020-08-31T01:10:19.318545Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest806ba8d8-e2a5-4aba-b11c-b0fe945f7d59.sock: use of closed network connection
2020-08-31T01:10:19.318649Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2dbaf051-d2fb-48d0-8652-ea961fb62f0e.sock" 

2020-08-31T01:10:19.318674Z	info	sds	Start SDS grpc server
2020-08-31T01:10:19.509240Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:19.509284Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:19.619590Z	info	sds	resource:default new connection
2020-08-31T01:10:19.619648Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:10:19.619700Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:19.620040Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:19.620078Z	error	sds	Remote side closed connection
2020-08-31T01:10:19.811045Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:19.813725Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:19.815623Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:19.921133Z	info	sds	resource:default new connection
2020-08-31T01:10:19.921199Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:10:19.921305Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:19.921569Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:19.921611Z	error	sds	Remote side closed connection
2020-08-31T01:10:19.921933Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2dbaf051-d2fb-48d0-8652-ea961fb62f0e.sock: use of closed network connection
2020-08-31T01:10:19.922060Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5986277f-1aab-4ae8-a0f6-731fc7ed0151.sock" 

2020-08-31T01:10:19.922084Z	info	sds	Start SDS grpc server
2020-08-31T01:10:20.223101Z	info	sds	resource:default new connection
2020-08-31T01:10:20.223193Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:10:20.223253Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:20.223532Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:20.223567Z	error	sds	Remote side closed connection
2020-08-31T01:10:20.223880Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5986277f-1aab-4ae8-a0f6-731fc7ed0151.sock: use of closed network connection
2020-08-31T01:10:20.318247Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:20.318608Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:20.922149Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:21.087673Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:21.224001Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:10:21.390872Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:21.391960Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:21.694180Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:21.813933Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:21.815717Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:10:22.258099Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbb33df21-c1b0-4616-b28c-803e01e01dcc.sock" 

2020-08-31T01:10:22.258155Z	info	sds	Start SDS grpc server
2020-08-31T01:10:22.298889Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:22.298890Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:22.318551Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:22.318685Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:22.602574Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:22.905143Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:22.922314Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:23.224312Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:23.259090Z	info	sds	resource:default new connection
2020-08-31T01:10:23.259148Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:10:23.265770Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:10:23.440431Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:10:23.440474Z	info	cache	GenerateSecret default
2020-08-31T01:10:23.440536Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:23.441011Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbb33df21-c1b0-4616-b28c-803e01e01dcc.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.683s
2020-08-31T01:10:28.729726Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest19388292-ddc7-4ec8-ba16-2e48cd7906f3.sock" 

2020-08-31T01:10:28.729845Z	info	sds	Start SDS grpc server
2020-08-31T01:10:28.730993Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:10:28.731065Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:10:28.731621Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:29.731003Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:29.731081Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:10:30.731753Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:10:30.731824Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:10:30.731848Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:10:30.731940Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:30.732145Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest19388292-ddc7-4ec8-ba16-2e48cd7906f3.sock: use of closed network connection
2020-08-31T01:10:30.732297Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:30.732332Z	error	sds	Remote side closed connection
2020-08-31T01:10:30.732598Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c989c28a-e186-41df-a46f-daaea03f6718\".sock" 

2020-08-31T01:10:30.732693Z	info	sds	Start SDS grpc server
2020-08-31T01:10:31.033652Z	info	sds	resource:default new connection
2020-08-31T01:10:31.033714Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:10:31.033768Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:31.034056Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:31.034071Z	error	sds	Remote side closed connection
2020-08-31T01:10:31.034754Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:10:31.034794Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:10:31.034956Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:10:31.035186Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:31.035218Z	error	sds	Remote side closed connection
2020-08-31T01:10:31.035396Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c989c28a-e186-41df-a46f-daaea03f6718".sock: use of closed network connection
2020-08-31T01:10:31.035552Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"602d47b0-727f-43b8-9e4e-9c9d6bef0ff9\".sock" 

2020-08-31T01:10:31.035640Z	info	sds	Start SDS grpc server
2020-08-31T01:10:31.036026Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:10:31.036061Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:10:31.036108Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:10:31.036344Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:31.036365Z	error	sds	Remote side closed connection
2020-08-31T01:10:31.036583Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"602d47b0-727f-43b8-9e4e-9c9d6bef0ff9".sock: use of closed network connection
2020-08-31T01:10:31.036867Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2d2b9239-d9b7-4f1b-9356-3ed696cff777\".sock" 

2020-08-31T01:10:31.036891Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:31.337969Z	info	sds	resource:default new connection
2020-08-31T01:10:31.338028Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:10:31.338081Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:31.338376Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:31.338406Z	error	sds	Remote side closed connection
2020-08-31T01:10:31.338724Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2d2b9239-d9b7-4f1b-9356-3ed696cff777".sock: use of closed network connection
2020-08-31T01:10:31.339088Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ed3ccd8e-f2e7-4087-b9ab-2a1af0ec4e10\".sock" 

2020-08-31T01:10:31.339107Z	info	sds	Start SDS grpc server
2020-08-31T01:10:31.339156Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"37d262d7-42a6-4a6d-aca3-8cce72e70ebc\".sock" 

2020-08-31T01:10:31.339199Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:31.640107Z	info	sds	resource:default new connection
2020-08-31T01:10:31.640161Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:10:31.640214Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:31.640530Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:31.640559Z	error	sds	Remote side closed connection
2020-08-31T01:10:31.641046Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:10:31.641078Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:10:31.641114Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:10:31.641378Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:31.641418Z	error	sds	Remote side closed connection
2020-08-31T01:10:31.732385Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:31.943037Z	info	sds	resource:default new connection
2020-08-31T01:10:31.943131Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:10:31.943187Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:31.943567Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:31.943612Z	error	sds	Remote side closed connection
2020-08-31T01:10:31.943748Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ed3ccd8e-f2e7-4087-b9ab-2a1af0ec4e10".sock: use of closed network connection
2020-08-31T01:10:31.943782Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"37d262d7-42a6-4a6d-aca3-8cce72e70ebc".sock: use of closed network connection
2020-08-31T01:10:31.943983Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b2a0c462-e4bd-4347-adb0-f8812b80a8c6\".sock" 

2020-08-31T01:10:31.944003Z	info	sds	Start SDS grpc server
2020-08-31T01:10:32.035621Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:32.036756Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:10:32.246597Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b2a0c462-e4bd-4347-adb0-f8812b80a8c6".sock: use of closed network connection
2020-08-31T01:10:32.246776Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f4b7d976-d925-438b-a947-d9776ac20ebb\".sock" 

2020-08-31T01:10:32.246794Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:32.339015Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:10:32.548479Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f4b7d976-d925-438b-a947-d9776ac20ebb".sock: use of closed network connection
2020-08-31T01:10:32.548710Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest2ee1c295-7e07-4a8d-999c-8a93620780b6.sock" 

2020-08-31T01:10:32.548805Z	info	sds	Start SDS grpc server
2020-08-31T01:10:32.548837Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:32.548829Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"21ea7d41-fe42-4cf9-82d4-a9d8cb037a5b\".sock" 

Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:10:32.943980Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:32.943985Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:10:33.153003Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest2ee1c295-7e07-4a8d-999c-8a93620780b6.sock: use of closed network connection
2020-08-31T01:10:33.153060Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"21ea7d41-fe42-4cf9-82d4-a9d8cb037a5b".sock: use of closed network connection
2020-08-31T01:10:33.153448Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest70000546-d847-4bca-a363-27f39b79958d.sock" 

2020-08-31T01:10:33.153491Z	info	sds	Start SDS grpc server
2020-08-31T01:10:33.246798Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:33.456761Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:10:33.456865Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:33.457143Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest70000546-d847-4bca-a363-27f39b79958d.sock: use of closed network connection
2020-08-31T01:10:33.457388Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd71c95a2-c6c8-4e6b-8ecc-76fb352988a7.sock" 

2020-08-31T01:10:33.457428Z	info	sds	Start SDS grpc server
2020-08-31T01:10:33.458158Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:10:33.458202Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:10:33.458242Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:33.458340Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:10:33.458402Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:10:33.458439Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:10:33.548733Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:33.732524Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:34.035879Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:34.036938Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:34.153232Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:34.153303Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:34.339265Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:34.457335Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:34.458423Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:34.458454Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:10:34.944247Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:34.944293Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:35.247037Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:35.459205Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:35.459541Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd71c95a2-c6c8-4e6b-8ecc-76fb352988a7.sock: use of closed network connection
2020-08-31T01:10:35.459600Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:35.459627Z	error	sds	Remote side closed connection
2020-08-31T01:10:35.459641Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:35.459665Z	error	sds	Remote side closed connection
2020-08-31T01:10:35.459760Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest800a4e08-3a3c-4fcd-a4c5-121dca9ca0bb.sock" 

2020-08-31T01:10:35.459828Z	info	sds	Start SDS grpc server
2020-08-31T01:10:35.460711Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:10:35.460814Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:10:35.460875Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:35.461358Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:10:35.460874066 +0000 UTC m=+6.813396851 and is waiting for next SDS request
2020-08-31T01:10:35.461375Z	info	sds	Dynamic push for secret default
2020-08-31T01:10:35.461397Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest800a4e08-3a3c-4fcd-a4c5-121dca9ca0bb.sock: use of closed network connection
2020-08-31T01:10:35.461473Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:35.461491Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:35.461496Z	error	sds	Remote side closed connection
2020-08-31T01:10:35.461526Z	error	sds	Remote side closed connection
2020-08-31T01:10:35.461573Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestea5fb01e-ac58-428f-bccd-69280085213f.sock" 

2020-08-31T01:10:35.461634Z	info	sds	Start SDS grpc server
2020-08-31T01:10:35.462147Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:10:35.462193Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:10:35.462238Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:35.462803Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:10:35.548983Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:35.963015Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:35.963079Z	info	sds	Dynamic push for secret default
2020-08-31T01:10:35.963683Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestea5fb01e-ac58-428f-bccd-69280085213f.sock: use of closed network connection
2020-08-31T01:10:35.963849Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:35.963839Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:35.963873Z	error	sds	Remote side closed connection
2020-08-31T01:10:35.963886Z	error	sds	Remote side closed connection
2020-08-31T01:10:35.963977Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest984062c1-6446-4559-a07b-b88709cf95f1.sock" 

2020-08-31T01:10:35.963998Z	info	sds	Start SDS grpc server
2020-08-31T01:10:35.964206Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest984062c1-6446-4559-a07b-b88709cf95f1.sock: use of closed network connection
2020-08-31T01:10:35.964290Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6074d1ba-260a-4241-ad19-4002b4487887.sock" 

2020-08-31T01:10:35.964311Z	info	sds	Start SDS grpc server
2020-08-31T01:10:36.153484Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:36.153523Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:36.265308Z	info	sds	resource:default new connection
2020-08-31T01:10:36.265370Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:10:36.265423Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:36.265754Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:36.265782Z	error	sds	Remote side closed connection
2020-08-31T01:10:36.457552Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:36.459750Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:36.461547Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:36.566877Z	info	sds	resource:default new connection
2020-08-31T01:10:36.566943Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:10:36.566997Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:36.567349Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:36.567371Z	error	sds	Remote side closed connection
2020-08-31T01:10:36.567597Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6074d1ba-260a-4241-ad19-4002b4487887.sock: use of closed network connection
2020-08-31T01:10:36.567754Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbb923297-2a97-44c0-ad19-ed74c2b22673.sock" 

2020-08-31T01:10:36.567788Z	info	sds	Start SDS grpc server
2020-08-31T01:10:36.868808Z	info	sds	resource:default new connection
2020-08-31T01:10:36.868866Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:10:36.868919Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:36.869176Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:36.869218Z	error	sds	Remote side closed connection
2020-08-31T01:10:36.869536Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbb923297-2a97-44c0-ad19-ed74c2b22673.sock: use of closed network connection
2020-08-31T01:10:36.963888Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:36.964318Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:37.567847Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:37.732795Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:37.869619Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:10:38.036123Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:38.037117Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:38.339545Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:38.460010Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:38.461730Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:10:38.902061Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0bf543a3-e64f-416c-840a-25a5550be4e0.sock" 

2020-08-31T01:10:38.902115Z	info	sds	Start SDS grpc server
2020-08-31T01:10:38.944550Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:38.944554Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:38.964161Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:38.964552Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:39.247287Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:39.549230Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:39.567981Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:39.869908Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:39.903120Z	info	sds	resource:default new connection
2020-08-31T01:10:39.903182Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:10:39.910824Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:10:40.056234Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:10:40.056284Z	info	cache	GenerateSecret default
2020-08-31T01:10:40.056363Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:40.056795Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0bf543a3-e64f-416c-840a-25a5550be4e0.sock: use of closed network connection
PASS
2020-08-31T01:10:40.056859Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:40.056882Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.655s
2020-08-31T01:10:45.739869Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4a88d33c-2869-431c-8c14-d4bcffddc58d.sock" 

2020-08-31T01:10:45.739959Z	info	sds	Start SDS grpc server
2020-08-31T01:10:45.741187Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:10:45.741246Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:10:45.741669Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:46.741123Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:46.741179Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:10:47.741867Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:10:47.741952Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:10:47.741993Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:10:47.742055Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:47.742271Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4a88d33c-2869-431c-8c14-d4bcffddc58d.sock: use of closed network connection
2020-08-31T01:10:47.742430Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:47.742462Z	error	sds	Remote side closed connection
2020-08-31T01:10:47.742592Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e28fb6e0-c70c-490c-8943-7a7562ccbc78\".sock" 

2020-08-31T01:10:47.742638Z	info	sds	Start SDS grpc server
2020-08-31T01:10:48.043621Z	info	sds	resource:default new connection
2020-08-31T01:10:48.043686Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:10:48.043752Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:48.044140Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:48.044168Z	error	sds	Remote side closed connection
2020-08-31T01:10:48.044614Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:10:48.044693Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:10:48.044876Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:10:48.045104Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:48.045125Z	error	sds	Remote side closed connection
2020-08-31T01:10:48.045302Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e28fb6e0-c70c-490c-8943-7a7562ccbc78".sock: use of closed network connection
2020-08-31T01:10:48.045474Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cc2fff06-d7c4-4c26-be9a-540ed4166205\".sock" 

2020-08-31T01:10:48.045576Z	info	sds	Start SDS grpc server
2020-08-31T01:10:48.045910Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:10:48.045962Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:10:48.046006Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:10:48.046286Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:48.046304Z	error	sds	Remote side closed connection
2020-08-31T01:10:48.046527Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cc2fff06-d7c4-4c26-be9a-540ed4166205".sock: use of closed network connection
2020-08-31T01:10:48.046693Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d8024e24-6dae-4051-ade6-4491d01d0e2c\".sock" 

2020-08-31T01:10:48.046729Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:48.347835Z	info	sds	resource:default new connection
2020-08-31T01:10:48.347905Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:10:48.347972Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:48.348321Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:48.348357Z	error	sds	Remote side closed connection
2020-08-31T01:10:48.348612Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d8024e24-6dae-4051-ade6-4491d01d0e2c".sock: use of closed network connection
2020-08-31T01:10:48.348877Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3fd1c237-ceaa-4df1-9a16-f23f3fe89bc3\".sock" 

2020-08-31T01:10:48.348897Z	info	sds	Start SDS grpc server
2020-08-31T01:10:48.348948Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7b014af4-2dfe-432c-9437-c04b0c5caa59\".sock" 

2020-08-31T01:10:48.348983Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:48.649932Z	info	sds	resource:default new connection
2020-08-31T01:10:48.649996Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:10:48.650053Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:48.650375Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:48.650389Z	error	sds	Remote side closed connection
2020-08-31T01:10:48.651063Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:10:48.651110Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:10:48.651177Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:10:48.651416Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:48.651438Z	error	sds	Remote side closed connection
2020-08-31T01:10:48.742571Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:48.952365Z	info	sds	resource:default new connection
2020-08-31T01:10:48.952424Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:10:48.952501Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:48.952890Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:48.952918Z	error	sds	Remote side closed connection
2020-08-31T01:10:48.953057Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3fd1c237-ceaa-4df1-9a16-f23f3fe89bc3".sock: use of closed network connection
2020-08-31T01:10:48.953127Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7b014af4-2dfe-432c-9437-c04b0c5caa59".sock: use of closed network connection
2020-08-31T01:10:48.953300Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f771ca9f-3827-4aee-aa39-f19a33878995\".sock" 

2020-08-31T01:10:48.953323Z	info	sds	Start SDS grpc server
2020-08-31T01:10:49.045505Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:49.046667Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:10:49.255954Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f771ca9f-3827-4aee-aa39-f19a33878995".sock: use of closed network connection
2020-08-31T01:10:49.256149Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"25e3216d-963d-4bb0-ba97-755776b53cc7\".sock" 

2020-08-31T01:10:49.256172Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:10:49.348837Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:10:49.557821Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"25e3216d-963d-4bb0-ba97-755776b53cc7".sock: use of closed network connection
2020-08-31T01:10:49.558008Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta7d64ee0-1519-4456-942a-5f20197dc023.sock" 

2020-08-31T01:10:49.558032Z	info	sds	Start SDS grpc server
2020-08-31T01:10:49.558070Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"cf7dab48-e629-43fa-ad1b-25d50db41b43\".sock" 

2020-08-31T01:10:49.558097Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:10:49.953286Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:49.953322Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:10:50.161955Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta7d64ee0-1519-4456-942a-5f20197dc023.sock: use of closed network connection
2020-08-31T01:10:50.162007Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"cf7dab48-e629-43fa-ad1b-25d50db41b43".sock: use of closed network connection
2020-08-31T01:10:50.162176Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestfaf4aa05-34a5-4916-9fcf-abafb0b1845c.sock" 

2020-08-31T01:10:50.162201Z	info	sds	Start SDS grpc server
2020-08-31T01:10:50.256167Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:50.463248Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:10:50.463366Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:50.463550Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestfaf4aa05-34a5-4916-9fcf-abafb0b1845c.sock: use of closed network connection
2020-08-31T01:10:50.463765Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest15bcbb4e-7bf4-40ff-a8e7-f32c3c0f4370.sock" 

2020-08-31T01:10:50.463850Z	info	sds	Start SDS grpc server
2020-08-31T01:10:50.465025Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:10:50.465110Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:10:50.465176Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:50.465654Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:10:50.465715Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:10:50.465774Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:10:50.558018Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:50.742826Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:51.045765Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:51.046863Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:51.162168Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:51.162159Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:51.349138Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:51.463752Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:51.465611Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:51.465648Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:10:51.953537Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:51.953578Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:52.256430Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:52.466505Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:52.466924Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest15bcbb4e-7bf4-40ff-a8e7-f32c3c0f4370.sock: use of closed network connection
2020-08-31T01:10:52.466920Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:52.466953Z	error	sds	Remote side closed connection
2020-08-31T01:10:52.467046Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:52.467072Z	error	sds	Remote side closed connection
2020-08-31T01:10:52.467190Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1599cccf-4fb1-4716-9b7c-e253c00db457.sock" 

2020-08-31T01:10:52.467254Z	info	sds	Start SDS grpc server
2020-08-31T01:10:52.468074Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:10:52.468116Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:10:52.468162Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:52.468705Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:10:52.468162 +0000 UTC m=+6.804699862 and is waiting for next SDS request
2020-08-31T01:10:52.468732Z	info	sds	Dynamic push for secret default
2020-08-31T01:10:52.468750Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1599cccf-4fb1-4716-9b7c-e253c00db457.sock: use of closed network connection
2020-08-31T01:10:52.468825Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:52.468855Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:52.468846Z	error	sds	Remote side closed connection
2020-08-31T01:10:52.468873Z	error	sds	Remote side closed connection
2020-08-31T01:10:52.468984Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2fc7afe1-a1cb-40dd-8bcd-3322c7d49675.sock" 

2020-08-31T01:10:52.469004Z	info	sds	Start SDS grpc server
2020-08-31T01:10:52.469542Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:10:52.469576Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:10:52.469611Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:52.470132Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:10:52.558280Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:52.970217Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:52.970266Z	info	sds	Dynamic push for secret default
2020-08-31T01:10:52.970978Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2fc7afe1-a1cb-40dd-8bcd-3322c7d49675.sock: use of closed network connection
2020-08-31T01:10:52.971079Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:52.971108Z	error	sds	Remote side closed connection
2020-08-31T01:10:52.971166Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:52.971193Z	error	sds	Remote side closed connection
2020-08-31T01:10:52.971398Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6b641c4e-ffb4-44c4-ba0f-e8cfb813bdda.sock" 

2020-08-31T01:10:52.971486Z	info	sds	Start SDS grpc server
2020-08-31T01:10:52.971683Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6b641c4e-ffb4-44c4-ba0f-e8cfb813bdda.sock: use of closed network connection
2020-08-31T01:10:52.971796Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest57c63bb8-f845-4225-97a5-fb00e5b78297.sock" 

2020-08-31T01:10:52.971827Z	info	sds	Start SDS grpc server
2020-08-31T01:10:53.162473Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:53.162472Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:53.272823Z	info	sds	resource:default new connection
2020-08-31T01:10:53.272910Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:10:53.272985Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:53.273304Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:53.273315Z	error	sds	Remote side closed connection
2020-08-31T01:10:53.463978Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:53.467087Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:53.468915Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:53.574556Z	info	sds	resource:default new connection
2020-08-31T01:10:53.574626Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:10:53.574683Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:53.575032Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:53.575046Z	error	sds	Remote side closed connection
2020-08-31T01:10:53.575435Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest57c63bb8-f845-4225-97a5-fb00e5b78297.sock: use of closed network connection
2020-08-31T01:10:53.575563Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest44dfecf6-eefc-4854-bf01-90072b2466fd.sock" 

2020-08-31T01:10:53.575601Z	info	sds	Start SDS grpc server
2020-08-31T01:10:53.876782Z	info	sds	resource:default new connection
2020-08-31T01:10:53.876860Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:10:53.876929Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:53.877260Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:10:53.877323Z	error	sds	Remote side closed connection
2020-08-31T01:10:53.877704Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest44dfecf6-eefc-4854-bf01-90072b2466fd.sock: use of closed network connection
2020-08-31T01:10:53.971195Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:53.971857Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:54.575673Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:54.743070Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:54.877924Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:10:55.046046Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:55.047024Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:55.349375Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:55.467309Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:55.469025Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:10:55.907489Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest91497f25-4803-4459-8e13-3a3b0bf99224.sock" 

2020-08-31T01:10:55.907541Z	info	sds	Start SDS grpc server
2020-08-31T01:10:55.953811Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:55.953858Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:55.971467Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:55.972053Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:56.256709Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:56.558448Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:10:56.575936Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:56.878203Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:10:56.908344Z	info	sds	resource:default new connection
2020-08-31T01:10:56.908416Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:10:56.916028Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:10:57.053461Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:10:57.053511Z	info	cache	GenerateSecret default
2020-08-31T01:10:57.053572Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:10:57.054478Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest91497f25-4803-4459-8e13-3a3b0bf99224.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.637s
2020-08-31T01:11:02.299902Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest41fe5435-7db6-4692-b125-f5c9299b197f.sock" 

2020-08-31T01:11:02.299990Z	info	sds	Start SDS grpc server
2020-08-31T01:11:02.301237Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:11:02.301302Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:11:02.301801Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:03.301186Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:03.301259Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:11:04.301895Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:11:04.301992Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:11:04.302024Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:11:04.302136Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:04.302384Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest41fe5435-7db6-4692-b125-f5c9299b197f.sock: use of closed network connection
2020-08-31T01:11:04.302563Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:04.302592Z	error	sds	Remote side closed connection
2020-08-31T01:11:04.302652Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d87a226e-b0e4-4f7a-be8c-82c670ed1e40\".sock" 

2020-08-31T01:11:04.302685Z	info	sds	Start SDS grpc server
2020-08-31T01:11:04.603692Z	info	sds	resource:default new connection
2020-08-31T01:11:04.603758Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:11:04.603824Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:04.604294Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:04.604325Z	error	sds	Remote side closed connection
2020-08-31T01:11:04.604846Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:11:04.604892Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:11:04.605094Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:11:04.605340Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:04.605360Z	error	sds	Remote side closed connection
2020-08-31T01:11:04.605626Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d87a226e-b0e4-4f7a-be8c-82c670ed1e40".sock: use of closed network connection
2020-08-31T01:11:04.605819Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1615fc9f-aaf7-4115-b65c-9996e286069e\".sock" 

2020-08-31T01:11:04.605912Z	info	sds	Start SDS grpc server
2020-08-31T01:11:04.606301Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:11:04.606355Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:11:04.606390Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:11:04.606640Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:04.606696Z	error	sds	Remote side closed connection
2020-08-31T01:11:04.606844Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1615fc9f-aaf7-4115-b65c-9996e286069e".sock: use of closed network connection
2020-08-31T01:11:04.606982Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"fd36c169-5fd5-495d-861f-88332ee7efaa\".sock" 

2020-08-31T01:11:04.607013Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:04.907958Z	info	sds	resource:default new connection
2020-08-31T01:11:04.908011Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:11:04.908061Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:04.908317Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:04.908344Z	error	sds	Remote side closed connection
2020-08-31T01:11:04.908546Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"fd36c169-5fd5-495d-861f-88332ee7efaa".sock: use of closed network connection
2020-08-31T01:11:04.908793Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"268e0dbc-0b18-45c7-8469-e9d6a8f6f314\".sock" 

2020-08-31T01:11:04.908874Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"31cbf34b-eaff-4665-a010-4dd3f67096fd\".sock" 

2020-08-31T01:11:04.908866Z	info	sds	Start SDS grpc server
2020-08-31T01:11:04.908906Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:05.209918Z	info	sds	resource:default new connection
2020-08-31T01:11:05.209973Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:11:05.210042Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:05.210417Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:05.210446Z	error	sds	Remote side closed connection
2020-08-31T01:11:05.210956Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:11:05.210989Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:11:05.211027Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:11:05.211210Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:05.211239Z	error	sds	Remote side closed connection
2020-08-31T01:11:05.302482Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:05.512134Z	info	sds	resource:default new connection
2020-08-31T01:11:05.512196Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:11:05.512252Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:05.512540Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:05.512570Z	error	sds	Remote side closed connection
2020-08-31T01:11:05.512910Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"268e0dbc-0b18-45c7-8469-e9d6a8f6f314".sock: use of closed network connection
2020-08-31T01:11:05.512967Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"31cbf34b-eaff-4665-a010-4dd3f67096fd".sock: use of closed network connection
2020-08-31T01:11:05.513178Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2e251fb2-3efe-4079-92bf-190b432e7903\".sock" 

2020-08-31T01:11:05.513257Z	info	sds	Start SDS grpc server
2020-08-31T01:11:05.605697Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:05.607041Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:11:05.816014Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2e251fb2-3efe-4079-92bf-190b432e7903".sock: use of closed network connection
2020-08-31T01:11:05.816189Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0d2fbfcb-8c10-46b5-b78f-0b902af2064c\".sock" 

2020-08-31T01:11:05.816227Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:05.908770Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:11:06.117761Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0d2fbfcb-8c10-46b5-b78f-0b902af2064c".sock: use of closed network connection
2020-08-31T01:11:06.117959Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest078195f6-3f1d-4b06-bbd6-8861df6dada0.sock" 

2020-08-31T01:11:06.118019Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"33ad9b43-4279-4228-9d90-23dc8f128fd6\".sock" 

2020-08-31T01:11:06.118051Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:06.118050Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:11:06.513137Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:06.513127Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:11:06.721767Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest078195f6-3f1d-4b06-bbd6-8861df6dada0.sock: use of closed network connection
2020-08-31T01:11:06.721819Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"33ad9b43-4279-4228-9d90-23dc8f128fd6".sock: use of closed network connection
2020-08-31T01:11:06.722087Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestf7725baf-4f28-41b5-a7e9-ab18ca996620.sock" 

2020-08-31T01:11:06.722135Z	info	sds	Start SDS grpc server
2020-08-31T01:11:06.816234Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:07.023174Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:11:07.023266Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:07.023591Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestf7725baf-4f28-41b5-a7e9-ab18ca996620.sock: use of closed network connection
2020-08-31T01:11:07.023811Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf5b46544-fc60-41d7-99fc-3231608c3d05.sock" 

2020-08-31T01:11:07.023908Z	info	sds	Start SDS grpc server
2020-08-31T01:11:07.024618Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:11:07.024715Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:11:07.024770Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:07.025306Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:11:07.025357Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:11:07.025412Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:11:07.117989Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:07.302753Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:07.605931Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:07.607203Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:07.722004Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:07.721990Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:07.909046Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:08.023808Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:08.025366Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:08.025405Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:11:08.513445Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:08.513495Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:08.816485Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:09.026352Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:09.026730Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf5b46544-fc60-41d7-99fc-3231608c3d05.sock: use of closed network connection
2020-08-31T01:11:09.026759Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:09.026790Z	error	sds	Remote side closed connection
2020-08-31T01:11:09.026837Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:09.026844Z	error	sds	Remote side closed connection
2020-08-31T01:11:09.027013Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest56a08ea7-5e69-4596-9129-f065a133eb58.sock" 

2020-08-31T01:11:09.027152Z	info	sds	Start SDS grpc server
2020-08-31T01:11:09.027851Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:11:09.027896Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:11:09.027939Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:09.028452Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:11:09.027938557 +0000 UTC m=+6.806207195 and is waiting for next SDS request
2020-08-31T01:11:09.028473Z	info	sds	Dynamic push for secret default
2020-08-31T01:11:09.028457Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest56a08ea7-5e69-4596-9129-f065a133eb58.sock: use of closed network connection
2020-08-31T01:11:09.028540Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:09.028554Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:09.028560Z	error	sds	Remote side closed connection
2020-08-31T01:11:09.028573Z	error	sds	Remote side closed connection
2020-08-31T01:11:09.028714Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest15af4d2c-eb99-41f6-b59e-3876eb1e029c.sock" 

2020-08-31T01:11:09.028733Z	info	sds	Start SDS grpc server
2020-08-31T01:11:09.029461Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:11:09.029502Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:11:09.029537Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:09.030063Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:11:09.118236Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:09.530306Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:09.530364Z	info	sds	Dynamic push for secret default
2020-08-31T01:11:09.531123Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest15af4d2c-eb99-41f6-b59e-3876eb1e029c.sock: use of closed network connection
2020-08-31T01:11:09.531223Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:09.531255Z	error	sds	Remote side closed connection
2020-08-31T01:11:09.531275Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:09.531301Z	error	sds	Remote side closed connection
2020-08-31T01:11:09.531397Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest955ead67-896e-4c08-92db-0b446d8a80c8.sock" 

2020-08-31T01:11:09.531485Z	info	sds	Start SDS grpc server
2020-08-31T01:11:09.531661Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest955ead67-896e-4c08-92db-0b446d8a80c8.sock: use of closed network connection
2020-08-31T01:11:09.531742Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest11abb081-e603-4e1e-b0bf-acb8417f6075.sock" 

2020-08-31T01:11:09.531754Z	info	sds	Start SDS grpc server
2020-08-31T01:11:09.722275Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:09.722331Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:09.832747Z	info	sds	resource:default new connection
2020-08-31T01:11:09.832815Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:11:09.832872Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:09.833265Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:09.833293Z	error	sds	Remote side closed connection
2020-08-31T01:11:10.024078Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:10.026925Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:10.028712Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:10.134101Z	info	sds	resource:default new connection
2020-08-31T01:11:10.134170Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:11:10.134261Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:10.134660Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:10.134687Z	error	sds	Remote side closed connection
2020-08-31T01:11:10.135005Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest11abb081-e603-4e1e-b0bf-acb8417f6075.sock: use of closed network connection
2020-08-31T01:11:10.135135Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest213a6658-3584-47f3-bbf7-1a31b49bb6b0.sock" 

2020-08-31T01:11:10.135166Z	info	sds	Start SDS grpc server
2020-08-31T01:11:10.436064Z	info	sds	resource:default new connection
2020-08-31T01:11:10.436125Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:11:10.436181Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:10.436524Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:10.436557Z	error	sds	Remote side closed connection
2020-08-31T01:11:10.436862Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest213a6658-3584-47f3-bbf7-1a31b49bb6b0.sock: use of closed network connection
2020-08-31T01:11:10.531341Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:10.531767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:11.135224Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:11.303001Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:11.437009Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:11:11.606169Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:11.607392Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:11.909276Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:12.027136Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:12.028855Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:11:12.466705Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest04344cb2-4235-42a9-8adf-2d90a3490466.sock" 

2020-08-31T01:11:12.466744Z	info	sds	Start SDS grpc server
2020-08-31T01:11:12.513832Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:12.513876Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:12.531613Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:12.531963Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:12.816767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:13.118446Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:13.135357Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:13.437233Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:13.468146Z	info	sds	resource:default new connection
2020-08-31T01:11:13.468211Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:11:13.476982Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:11:13.552032Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:11:13.552070Z	info	cache	GenerateSecret default
2020-08-31T01:11:13.552132Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:13.552467Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest04344cb2-4235-42a9-8adf-2d90a3490466.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.577s
2020-08-31T01:11:18.811172Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest64df48db-dbef-4a6e-a612-fbd3163e25a3.sock" 

2020-08-31T01:11:18.811295Z	info	sds	Start SDS grpc server
2020-08-31T01:11:18.812537Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:11:18.812594Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:11:18.812991Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:19.812429Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:19.812494Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:11:20.813328Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:11:20.813414Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:11:20.813437Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:11:20.813503Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:20.813781Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest64df48db-dbef-4a6e-a612-fbd3163e25a3.sock: use of closed network connection
2020-08-31T01:11:20.813939Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:20.813957Z	error	sds	Remote side closed connection
2020-08-31T01:11:20.814083Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"443a2cc3-4bbe-4996-9615-d48cc4253bd1\".sock" 

2020-08-31T01:11:20.814124Z	info	sds	Start SDS grpc server
2020-08-31T01:11:21.115136Z	info	sds	resource:default new connection
2020-08-31T01:11:21.115202Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:11:21.115326Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:21.115726Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:21.115755Z	error	sds	Remote side closed connection
2020-08-31T01:11:21.116354Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:11:21.116398Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:11:21.116554Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:11:21.116858Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:21.116879Z	error	sds	Remote side closed connection
2020-08-31T01:11:21.117094Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"443a2cc3-4bbe-4996-9615-d48cc4253bd1".sock: use of closed network connection
2020-08-31T01:11:21.117334Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4cb7f550-8f62-4fce-b412-04b812ec32ab\".sock" 

2020-08-31T01:11:21.117402Z	info	sds	Start SDS grpc server
2020-08-31T01:11:21.118314Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:11:21.118349Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:11:21.118396Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:11:21.118764Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:21.118786Z	error	sds	Remote side closed connection
2020-08-31T01:11:21.118844Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4cb7f550-8f62-4fce-b412-04b812ec32ab".sock: use of closed network connection
2020-08-31T01:11:21.119002Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f320d2c6-5f6b-4e8e-b491-671ba8f5a999\".sock" 

2020-08-31T01:11:21.119039Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:21.420058Z	info	sds	resource:default new connection
2020-08-31T01:11:21.420120Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:11:21.420175Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:21.420513Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:21.420539Z	error	sds	Remote side closed connection
2020-08-31T01:11:21.420762Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f320d2c6-5f6b-4e8e-b491-671ba8f5a999".sock: use of closed network connection
2020-08-31T01:11:21.420939Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"dc33b4a2-3ee2-460b-9669-932b41354815\".sock" 

2020-08-31T01:11:21.420959Z	info	sds	Start SDS grpc server
2020-08-31T01:11:21.421001Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"eb1114ae-b21a-4626-b34e-f994d9245ab8\".sock" 

2020-08-31T01:11:21.421005Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:21.722145Z	info	sds	resource:default new connection
2020-08-31T01:11:21.722206Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:11:21.722270Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:21.722573Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:21.722599Z	error	sds	Remote side closed connection
2020-08-31T01:11:21.723162Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:11:21.723206Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:11:21.723244Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:11:21.723497Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:21.723513Z	error	sds	Remote side closed connection
2020-08-31T01:11:21.813990Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:22.024486Z	info	sds	resource:default new connection
2020-08-31T01:11:22.024541Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:11:22.024595Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:22.024955Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:22.024995Z	error	sds	Remote side closed connection
2020-08-31T01:11:22.025167Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"dc33b4a2-3ee2-460b-9669-932b41354815".sock: use of closed network connection
2020-08-31T01:11:22.025293Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"eb1114ae-b21a-4626-b34e-f994d9245ab8".sock: use of closed network connection
2020-08-31T01:11:22.025548Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2300d4d5-2914-46be-970a-dd54f7a30efc\".sock" 

2020-08-31T01:11:22.025585Z	info	sds	Start SDS grpc server
2020-08-31T01:11:22.117326Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:22.119012Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:11:22.328329Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2300d4d5-2914-46be-970a-dd54f7a30efc".sock: use of closed network connection
2020-08-31T01:11:22.328519Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"445640b0-3793-4e23-88d3-e47822f18c5c\".sock" 

2020-08-31T01:11:22.328564Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:22.420964Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:11:22.630223Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"445640b0-3793-4e23-88d3-e47822f18c5c".sock: use of closed network connection
2020-08-31T01:11:22.630425Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest234b5e66-7bb7-458b-b7c9-7a9b8c4998d4.sock" 

2020-08-31T01:11:22.630478Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ac2a05ae-b9e8-4ab1-816b-c91833301796\".sock" 

2020-08-31T01:11:22.630493Z	info	sds	Start SDS grpc server
2020-08-31T01:11:22.630512Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:11:23.025392Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:23.025447Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:11:23.234950Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest234b5e66-7bb7-458b-b7c9-7a9b8c4998d4.sock: use of closed network connection
2020-08-31T01:11:23.235001Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ac2a05ae-b9e8-4ab1-816b-c91833301796".sock: use of closed network connection
2020-08-31T01:11:23.235212Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestf9efd580-8b76-48ca-810a-a36d385d2e76.sock" 

2020-08-31T01:11:23.235236Z	info	sds	Start SDS grpc server
2020-08-31T01:11:23.328650Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:23.536163Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:11:23.536302Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:23.536526Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestf9efd580-8b76-48ca-810a-a36d385d2e76.sock: use of closed network connection
2020-08-31T01:11:23.536749Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc0e23443-46f5-47c2-84ce-9872cc26c49a.sock" 

2020-08-31T01:11:23.536876Z	info	sds	Start SDS grpc server
2020-08-31T01:11:23.537552Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:11:23.537599Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:11:23.537651Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:23.537798Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:11:23.537837Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:11:23.538359Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:11:23.630471Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:23.814259Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:24.117611Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:24.119209Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:24.235153Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:24.235212Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:24.421221Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:24.536773Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:24.537870Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:24.537893Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:11:25.025644Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:25.025688Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:25.328951Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:25.538763Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:25.539150Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc0e23443-46f5-47c2-84ce-9872cc26c49a.sock: use of closed network connection
2020-08-31T01:11:25.539169Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:25.539193Z	error	sds	Remote side closed connection
2020-08-31T01:11:25.539294Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:25.539320Z	error	sds	Remote side closed connection
2020-08-31T01:11:25.539513Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest528f70d9-b6e7-4ac4-a6a8-b55a32aa5a91.sock" 

2020-08-31T01:11:25.539683Z	info	sds	Start SDS grpc server
2020-08-31T01:11:25.540307Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:11:25.540346Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:11:25.540434Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:25.541039Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:11:25.540433379 +0000 UTC m=+6.804242268 and is waiting for next SDS request
2020-08-31T01:11:25.541061Z	info	sds	Dynamic push for secret default
2020-08-31T01:11:25.541063Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest528f70d9-b6e7-4ac4-a6a8-b55a32aa5a91.sock: use of closed network connection
2020-08-31T01:11:25.541122Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:25.541133Z	error	sds	Remote side closed connection
2020-08-31T01:11:25.541173Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:25.541200Z	error	sds	Remote side closed connection
2020-08-31T01:11:25.541255Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8334e5f7-3a0c-4bb5-97cd-7fa80d897cc0.sock" 

2020-08-31T01:11:25.541273Z	info	sds	Start SDS grpc server
2020-08-31T01:11:25.541996Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:11:25.542034Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:11:25.542067Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:25.542515Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:11:25.630727Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:26.042620Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:26.042679Z	info	sds	Dynamic push for secret default
2020-08-31T01:11:26.043324Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8334e5f7-3a0c-4bb5-97cd-7fa80d897cc0.sock: use of closed network connection
2020-08-31T01:11:26.043403Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:26.043431Z	error	sds	Remote side closed connection
2020-08-31T01:11:26.043453Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:26.043474Z	error	sds	Remote side closed connection
2020-08-31T01:11:26.043598Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9026fb3f-5e12-4bfa-a9da-1ab6ae42bac6.sock" 

2020-08-31T01:11:26.043612Z	info	sds	Start SDS grpc server
2020-08-31T01:11:26.043872Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9026fb3f-5e12-4bfa-a9da-1ab6ae42bac6.sock: use of closed network connection
2020-08-31T01:11:26.043982Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest42debb96-7a90-40f0-933c-3a1b0f3110e0.sock" 

2020-08-31T01:11:26.043987Z	info	sds	Start SDS grpc server
2020-08-31T01:11:26.235434Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:26.235462Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:26.345081Z	info	sds	resource:default new connection
2020-08-31T01:11:26.345149Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:11:26.345204Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:26.345464Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:26.345488Z	error	sds	Remote side closed connection
2020-08-31T01:11:26.537044Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:26.539376Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:26.541134Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:26.646759Z	info	sds	resource:default new connection
2020-08-31T01:11:26.646836Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:11:26.646908Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:26.647206Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:26.647232Z	error	sds	Remote side closed connection
2020-08-31T01:11:26.647503Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest42debb96-7a90-40f0-933c-3a1b0f3110e0.sock: use of closed network connection
2020-08-31T01:11:26.647632Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest292718db-42b2-4d1c-be5a-253958c5b19a.sock" 

2020-08-31T01:11:26.647651Z	info	sds	Start SDS grpc server
2020-08-31T01:11:26.948632Z	info	sds	resource:default new connection
2020-08-31T01:11:26.948724Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:11:26.948781Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:26.949030Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:26.949069Z	error	sds	Remote side closed connection
2020-08-31T01:11:26.949336Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest292718db-42b2-4d1c-be5a-253958c5b19a.sock: use of closed network connection
2020-08-31T01:11:27.043542Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:27.044021Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:27.647760Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:27.814533Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:27.949434Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:11:28.117904Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:28.119417Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:28.421489Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:28.539588Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:28.541307Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:11:28.978723Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0484da35-dc64-4f4c-9948-a372526d6b27.sock" 

2020-08-31T01:11:28.978771Z	info	sds	Start SDS grpc server
2020-08-31T01:11:29.025913Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:29.025954Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:29.043785Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:29.044174Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:29.329195Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:29.630978Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:29.647998Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:29.949622Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:29.979521Z	info	sds	resource:default new connection
2020-08-31T01:11:29.979590Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:11:29.989091Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:11:30.041873Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:11:30.041916Z	info	cache	GenerateSecret default
2020-08-31T01:11:30.041979Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:30.042459Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0484da35-dc64-4f4c-9948-a372526d6b27.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.551s
2020-08-31T01:11:35.264434Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb672c0c9-971a-4405-b072-5ee86e197b15.sock" 

2020-08-31T01:11:35.264512Z	info	sds	Start SDS grpc server
2020-08-31T01:11:35.266609Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:11:35.266704Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:11:35.267729Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:36.265726Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:36.265813Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:11:37.266461Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:11:37.266552Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:11:37.266577Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:11:37.266663Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:37.266923Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb672c0c9-971a-4405-b072-5ee86e197b15.sock: use of closed network connection
2020-08-31T01:11:37.267043Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:37.267054Z	error	sds	Remote side closed connection
2020-08-31T01:11:37.267189Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"38978163-488f-409c-8bbe-52a3055155bf\".sock" 

2020-08-31T01:11:37.267239Z	info	sds	Start SDS grpc server
2020-08-31T01:11:37.568309Z	info	sds	resource:default new connection
2020-08-31T01:11:37.568374Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:11:37.568442Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:37.568730Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:37.568758Z	error	sds	Remote side closed connection
2020-08-31T01:11:37.569316Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:11:37.569366Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:11:37.569565Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:11:37.569750Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:37.569774Z	error	sds	Remote side closed connection
2020-08-31T01:11:37.570045Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"38978163-488f-409c-8bbe-52a3055155bf".sock: use of closed network connection
2020-08-31T01:11:37.570281Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6cc398f0-34e3-4707-b37b-d6968c8d7af7\".sock" 

2020-08-31T01:11:37.570380Z	info	sds	Start SDS grpc server
2020-08-31T01:11:37.570769Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:11:37.570827Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:11:37.570865Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:11:37.571106Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:37.571136Z	error	sds	Remote side closed connection
2020-08-31T01:11:37.571215Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6cc398f0-34e3-4707-b37b-d6968c8d7af7".sock: use of closed network connection
2020-08-31T01:11:37.571392Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ef23d3e4-de51-4613-8a81-b868c581d95d\".sock" 

2020-08-31T01:11:37.571407Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:37.872529Z	info	sds	resource:default new connection
2020-08-31T01:11:37.872599Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:11:37.872691Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:37.873049Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:37.873129Z	error	sds	Remote side closed connection
2020-08-31T01:11:37.873379Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ef23d3e4-de51-4613-8a81-b868c581d95d".sock: use of closed network connection
2020-08-31T01:11:37.873601Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b2d31c87-9cda-4ee8-b506-3d9153880191\".sock" 

2020-08-31T01:11:37.873671Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f734b9f9-2c9c-4f6a-8e41-29d1a535e730\".sock" 

2020-08-31T01:11:37.873705Z	info	sds	Start SDS grpc server
2020-08-31T01:11:37.873727Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:38.175138Z	info	sds	resource:default new connection
2020-08-31T01:11:38.175215Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:11:38.175283Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:38.175650Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:38.175687Z	error	sds	Remote side closed connection
2020-08-31T01:11:38.176554Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:11:38.176615Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:11:38.176706Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:11:38.177043Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:38.177075Z	error	sds	Remote side closed connection
2020-08-31T01:11:38.267306Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:38.478458Z	info	sds	resource:default new connection
2020-08-31T01:11:38.478516Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:11:38.478592Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:38.478885Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:38.478916Z	error	sds	Remote side closed connection
2020-08-31T01:11:38.479163Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b2d31c87-9cda-4ee8-b506-3d9153880191".sock: use of closed network connection
2020-08-31T01:11:38.479212Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f734b9f9-2c9c-4f6a-8e41-29d1a535e730".sock: use of closed network connection
2020-08-31T01:11:38.479372Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"55166fb7-045c-4f39-9243-0260263b43df\".sock" 

2020-08-31T01:11:38.479377Z	info	sds	Start SDS grpc server
2020-08-31T01:11:38.570132Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:38.571467Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:11:38.782264Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"55166fb7-045c-4f39-9243-0260263b43df".sock: use of closed network connection
2020-08-31T01:11:38.782450Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6e4534de-1042-43af-af90-a2db4b940f45\".sock" 

2020-08-31T01:11:38.782479Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:38.873659Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:11:39.084325Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6e4534de-1042-43af-af90-a2db4b940f45".sock: use of closed network connection
2020-08-31T01:11:39.084521Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta0c2fd1e-5dde-4d0f-b419-372062400244.sock" 

2020-08-31T01:11:39.084579Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4c4e0e9b-e7d7-485a-9ed0-bbda44a9352c\".sock" 

2020-08-31T01:11:39.084619Z	info	sds	Start SDS grpc server
2020-08-31T01:11:39.084640Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:11:39.479417Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:39.479475Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:11:39.689208Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta0c2fd1e-5dde-4d0f-b419-372062400244.sock: use of closed network connection
2020-08-31T01:11:39.689259Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4c4e0e9b-e7d7-485a-9ed0-bbda44a9352c".sock: use of closed network connection
2020-08-31T01:11:39.689496Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest3590d86e-2cd6-4c99-90b8-22bcaaefe589.sock" 

2020-08-31T01:11:39.689523Z	info	sds	Start SDS grpc server
2020-08-31T01:11:39.782494Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:39.990655Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:11:39.990747Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:39.990999Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest3590d86e-2cd6-4c99-90b8-22bcaaefe589.sock: use of closed network connection
2020-08-31T01:11:39.991201Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1fd6bf5d-5f1b-4d14-8be3-d1b22a46832c.sock" 

2020-08-31T01:11:39.991231Z	info	sds	Start SDS grpc server
2020-08-31T01:11:39.992418Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:11:39.992499Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:11:39.992561Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:39.992997Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:11:39.993043Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:11:39.993080Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:11:40.084557Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:40.267723Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:40.570428Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:40.571664Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:40.689389Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:40.689366Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:40.873943Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:40.991273Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:40.992881Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:40.992930Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:11:41.479689Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:41.479748Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:41.782846Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:41.993887Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:41.994396Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1fd6bf5d-5f1b-4d14-8be3-d1b22a46832c.sock: use of closed network connection
2020-08-31T01:11:41.994452Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:41.994483Z	error	sds	Remote side closed connection
2020-08-31T01:11:41.994518Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:41.994547Z	error	sds	Remote side closed connection
2020-08-31T01:11:41.994669Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd193948d-3d06-4ee4-8ae5-65f87d9974f7.sock" 

2020-08-31T01:11:41.994695Z	info	sds	Start SDS grpc server
2020-08-31T01:11:41.995740Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:11:41.995792Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:11:41.995837Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:41.996380Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:11:41.995837035 +0000 UTC m=+6.807422642 and is waiting for next SDS request
2020-08-31T01:11:41.996402Z	info	sds	Dynamic push for secret default
2020-08-31T01:11:41.996423Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd193948d-3d06-4ee4-8ae5-65f87d9974f7.sock: use of closed network connection
2020-08-31T01:11:41.996513Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:41.996533Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:41.996559Z	error	sds	Remote side closed connection
2020-08-31T01:11:41.996542Z	error	sds	Remote side closed connection
2020-08-31T01:11:41.996645Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2564b70f-18d0-4fb1-8bc8-a957df24ab7e.sock" 

2020-08-31T01:11:41.996676Z	info	sds	Start SDS grpc server
2020-08-31T01:11:41.997527Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:11:41.997593Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:11:41.997640Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:41.998320Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:11:42.084900Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:42.498469Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:42.498527Z	info	sds	Dynamic push for secret default
2020-08-31T01:11:42.499167Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2564b70f-18d0-4fb1-8bc8-a957df24ab7e.sock: use of closed network connection
2020-08-31T01:11:42.499325Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:42.499355Z	error	sds	Remote side closed connection
2020-08-31T01:11:42.499339Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:42.499438Z	error	sds	Remote side closed connection
2020-08-31T01:11:42.499525Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3899ac2b-bdbe-4c91-8801-6eecfc50af2a.sock" 

2020-08-31T01:11:42.499574Z	info	sds	Start SDS grpc server
2020-08-31T01:11:42.499774Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3899ac2b-bdbe-4c91-8801-6eecfc50af2a.sock: use of closed network connection
2020-08-31T01:11:42.499863Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestca5bc45e-729d-490b-9eef-2e38e56737b9.sock" 

2020-08-31T01:11:42.499881Z	info	sds	Start SDS grpc server
2020-08-31T01:11:42.689679Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:42.689685Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:42.800633Z	info	sds	resource:default new connection
2020-08-31T01:11:42.800732Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:11:42.800788Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:42.801104Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:42.801138Z	error	sds	Remote side closed connection
2020-08-31T01:11:42.991394Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:42.994630Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:42.996721Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:43.102542Z	info	sds	resource:default new connection
2020-08-31T01:11:43.102602Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:11:43.102657Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:43.102869Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:43.102904Z	error	sds	Remote side closed connection
2020-08-31T01:11:43.103267Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestca5bc45e-729d-490b-9eef-2e38e56737b9.sock: use of closed network connection
2020-08-31T01:11:43.103391Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2107c3f5-6558-4783-ad47-3ba81790ecd8.sock" 

2020-08-31T01:11:43.103433Z	info	sds	Start SDS grpc server
2020-08-31T01:11:43.404775Z	info	sds	resource:default new connection
2020-08-31T01:11:43.404860Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:11:43.404922Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:43.405202Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:43.405230Z	error	sds	Remote side closed connection
2020-08-31T01:11:43.405540Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2107c3f5-6558-4783-ad47-3ba81790ecd8.sock: use of closed network connection
2020-08-31T01:11:43.499429Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:43.499955Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:44.103534Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:44.267862Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:44.405743Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:11:44.570775Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:44.571971Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:44.874301Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:44.994786Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:44.996985Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:11:45.438999Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest77dd8297-0f2c-416a-beea-dc93ed74ad27.sock" 

2020-08-31T01:11:45.439052Z	info	sds	Start SDS grpc server
2020-08-31T01:11:45.480014Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:45.480077Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:45.499663Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:45.500238Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:45.783153Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:46.085061Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:46.103946Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:46.406004Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:46.440315Z	info	sds	resource:default new connection
2020-08-31T01:11:46.440379Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:11:46.446276Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:11:46.689808Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:46.689872Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:46.731428Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:11:46.731475Z	info	cache	GenerateSecret default
2020-08-31T01:11:46.731583Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:46.732016Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest77dd8297-0f2c-416a-beea-dc93ed74ad27.sock: use of closed network connection
PASS
2020-08-31T01:11:46.732122Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.788s
2020-08-31T01:11:52.039027Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd388f866-b448-414a-9f91-826bfce75ae8.sock" 

2020-08-31T01:11:52.039137Z	info	sds	Start SDS grpc server
2020-08-31T01:11:52.040339Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:11:52.040407Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:11:52.040856Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:53.040280Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:53.040335Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:11:54.041204Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:11:54.041272Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:11:54.041295Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:11:54.041406Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:54.041639Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd388f866-b448-414a-9f91-826bfce75ae8.sock: use of closed network connection
2020-08-31T01:11:54.041772Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:54.041807Z	error	sds	Remote side closed connection
2020-08-31T01:11:54.041948Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5e89d546-2b5f-4136-922c-5c3bd2584d7f\".sock" 

2020-08-31T01:11:54.042002Z	info	sds	Start SDS grpc server
2020-08-31T01:11:54.343054Z	info	sds	resource:default new connection
2020-08-31T01:11:54.343122Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:11:54.343194Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:54.343551Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:54.343579Z	error	sds	Remote side closed connection
2020-08-31T01:11:54.344398Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:11:54.344439Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:11:54.344634Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:11:54.345036Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:54.345075Z	error	sds	Remote side closed connection
2020-08-31T01:11:54.345183Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5e89d546-2b5f-4136-922c-5c3bd2584d7f".sock: use of closed network connection
2020-08-31T01:11:54.345365Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9acb5f69-ff08-4a4b-a4e0-9ef94e76e70e\".sock" 

2020-08-31T01:11:54.345446Z	info	sds	Start SDS grpc server
2020-08-31T01:11:54.345959Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:11:54.345987Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:11:54.346026Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:11:54.346247Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:54.346274Z	error	sds	Remote side closed connection
2020-08-31T01:11:54.346408Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9acb5f69-ff08-4a4b-a4e0-9ef94e76e70e".sock: use of closed network connection
2020-08-31T01:11:54.346604Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1d1e7667-2877-42c6-8aeb-838383e225f6\".sock" 

2020-08-31T01:11:54.346641Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:54.647649Z	info	sds	resource:default new connection
2020-08-31T01:11:54.647715Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:11:54.647768Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:54.648239Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:54.648256Z	error	sds	Remote side closed connection
2020-08-31T01:11:54.648371Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1d1e7667-2877-42c6-8aeb-838383e225f6".sock: use of closed network connection
2020-08-31T01:11:54.648627Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a88f7e35-a98f-41c3-9bff-3ce61201cb71\".sock" 

2020-08-31T01:11:54.648681Z	info	sds	Start SDS grpc server
2020-08-31T01:11:54.648728Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"48c01a20-4360-4b3f-ab9e-95d6febdc1a6\".sock" 

2020-08-31T01:11:54.648763Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:54.949646Z	info	sds	resource:default new connection
2020-08-31T01:11:54.949721Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:11:54.949773Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:54.950068Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:54.950103Z	error	sds	Remote side closed connection
2020-08-31T01:11:54.951191Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:11:54.951251Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:11:54.951297Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:11:54.951589Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:54.951627Z	error	sds	Remote side closed connection
2020-08-31T01:11:55.041804Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:55.252582Z	info	sds	resource:default new connection
2020-08-31T01:11:55.252645Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:11:55.252752Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:55.253110Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:55.253148Z	error	sds	Remote side closed connection
2020-08-31T01:11:55.253333Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a88f7e35-a98f-41c3-9bff-3ce61201cb71".sock: use of closed network connection
2020-08-31T01:11:55.253457Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"48c01a20-4360-4b3f-ab9e-95d6febdc1a6".sock: use of closed network connection
2020-08-31T01:11:55.253721Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"de235f70-4905-478f-80d5-e59007ebac87\".sock" 

2020-08-31T01:11:55.253735Z	info	sds	Start SDS grpc server
2020-08-31T01:11:55.345291Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:55.346573Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:11:55.556185Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"de235f70-4905-478f-80d5-e59007ebac87".sock: use of closed network connection
2020-08-31T01:11:55.556557Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2c385954-b90e-4a79-bd47-f5312dee8b16\".sock" 

2020-08-31T01:11:55.556604Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:11:55.648571Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:11:55.858116Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2c385954-b90e-4a79-bd47-f5312dee8b16".sock: use of closed network connection
2020-08-31T01:11:55.858386Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest4d843f5e-bcef-4a64-86d8-9a7d5836da23.sock" 

2020-08-31T01:11:55.858449Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c37e858b-c8a7-491f-92a4-59ec37fa7a9c\".sock" 

2020-08-31T01:11:55.858481Z	info	sds	Start SDS grpc server
2020-08-31T01:11:55.858503Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:11:56.253524Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:56.253546Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:11:56.462354Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest4d843f5e-bcef-4a64-86d8-9a7d5836da23.sock: use of closed network connection
2020-08-31T01:11:56.462420Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c37e858b-c8a7-491f-92a4-59ec37fa7a9c".sock: use of closed network connection
2020-08-31T01:11:56.462610Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0fc0e500-afff-4bb7-a2ff-ec39d6368022.sock" 

2020-08-31T01:11:56.462665Z	info	sds	Start SDS grpc server
2020-08-31T01:11:56.556464Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:56.764198Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:11:56.764294Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:56.764520Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0fc0e500-afff-4bb7-a2ff-ec39d6368022.sock: use of closed network connection
2020-08-31T01:11:56.764806Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb0f64985-3eaa-4437-8254-f788b5eb121a.sock" 

2020-08-31T01:11:56.764829Z	info	sds	Start SDS grpc server
2020-08-31T01:11:56.766427Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:11:56.766520Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:11:56.766551Z	info	sds	resource:default new connection
2020-08-31T01:11:56.766590Z	info	sds	resource:default pushed key/cert pair to proxy
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:11:56.766621Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:11:56.766670Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:11:56.858323Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:57.042052Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:57.345554Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:57.346762Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:57.462426Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:57.462478Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:57.648812Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:57.764760Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:57.766664Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:57.766702Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:11:58.253835Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:58.253871Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:58.556742Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:58.767581Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:58.767953Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb0f64985-3eaa-4437-8254-f788b5eb121a.sock: use of closed network connection
2020-08-31T01:11:58.768018Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:58.768064Z	error	sds	Remote side closed connection
2020-08-31T01:11:58.768086Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:58.768120Z	error	sds	Remote side closed connection
2020-08-31T01:11:58.768275Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1191c40e-ce19-4f46-a190-20dbf293ee1a.sock" 

2020-08-31T01:11:58.768357Z	info	sds	Start SDS grpc server
2020-08-31T01:11:58.769171Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:11:58.769210Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:11:58.769256Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:58.769677Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:11:58.769256129 +0000 UTC m=+6.806113436 and is waiting for next SDS request
2020-08-31T01:11:58.769692Z	info	sds	Dynamic push for secret default
2020-08-31T01:11:58.769737Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1191c40e-ce19-4f46-a190-20dbf293ee1a.sock: use of closed network connection
2020-08-31T01:11:58.769777Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:58.769797Z	error	sds	Remote side closed connection
2020-08-31T01:11:58.769831Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:58.769851Z	error	sds	Remote side closed connection
2020-08-31T01:11:58.769930Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf13959b0-5a82-4ef0-a25a-b8b029841dff.sock" 

2020-08-31T01:11:58.770004Z	info	sds	Start SDS grpc server
2020-08-31T01:11:58.770466Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:11:58.770500Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:11:58.770533Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:58.771013Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:11:58.858586Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:59.271225Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:59.271283Z	info	sds	Dynamic push for secret default
2020-08-31T01:11:59.271845Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf13959b0-5a82-4ef0-a25a-b8b029841dff.sock: use of closed network connection
2020-08-31T01:11:59.271967Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:59.271992Z	error	sds	Remote side closed connection
2020-08-31T01:11:59.271999Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:59.272030Z	error	sds	Remote side closed connection
2020-08-31T01:11:59.272081Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0fa82211-5da8-4bf8-b5d0-6ab0f8c4f977.sock" 

2020-08-31T01:11:59.272162Z	info	sds	Start SDS grpc server
2020-08-31T01:11:59.272321Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0fa82211-5da8-4bf8-b5d0-6ab0f8c4f977.sock: use of closed network connection
2020-08-31T01:11:59.272404Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf4491d4e-550d-4c92-afdc-a222eb92913a.sock" 

2020-08-31T01:11:59.272411Z	info	sds	Start SDS grpc server
2020-08-31T01:11:59.462691Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:59.462739Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:11:59.573419Z	info	sds	resource:default new connection
2020-08-31T01:11:59.573483Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:11:59.573537Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:59.573837Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:59.573863Z	error	sds	Remote side closed connection
2020-08-31T01:11:59.765013Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:59.768149Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:59.769900Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:11:59.875059Z	info	sds	resource:default new connection
2020-08-31T01:11:59.875130Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:11:59.875185Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:11:59.875529Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:11:59.875561Z	error	sds	Remote side closed connection
2020-08-31T01:11:59.875835Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf4491d4e-550d-4c92-afdc-a222eb92913a.sock: use of closed network connection
2020-08-31T01:11:59.876111Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd373968c-d6a8-443b-a419-6e5f9cf7b297.sock" 

2020-08-31T01:11:59.876152Z	info	sds	Start SDS grpc server
2020-08-31T01:12:00.177277Z	info	sds	resource:default new connection
2020-08-31T01:12:00.177386Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:12:00.177445Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:00.177859Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:00.177887Z	error	sds	Remote side closed connection
2020-08-31T01:12:00.178007Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd373968c-d6a8-443b-a419-6e5f9cf7b297.sock: use of closed network connection
2020-08-31T01:12:00.272072Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:00.272340Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:00.875984Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:01.042280Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:01.178219Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:12:01.345863Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:01.346937Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:01.648973Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:01.768426Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:01.770118Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:12:02.208087Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste5e6cb3d-843f-477c-b7d3-d082d97756fe.sock" 

2020-08-31T01:12:02.208155Z	info	sds	Start SDS grpc server
2020-08-31T01:12:02.254087Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:02.254122Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:02.272314Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:02.272448Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:02.556972Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:02.858861Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:02.876149Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:03.178486Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:03.209560Z	info	sds	resource:default new connection
2020-08-31T01:12:03.209624Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:12:03.213426Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:12:03.324914Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:12:03.324960Z	info	cache	GenerateSecret default
2020-08-31T01:12:03.325021Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:03.325394Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste5e6cb3d-843f-477c-b7d3-d082d97756fe.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.608s
2020-08-31T01:12:08.557808Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2b7a3127-62e1-409a-bcc0-e2cfcb846f2b.sock" 

2020-08-31T01:12:08.557944Z	info	sds	Start SDS grpc server
2020-08-31T01:12:08.559566Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:12:08.559638Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:12:08.559998Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:09.559401Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:09.559453Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:12:10.560178Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:12:10.560263Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:12:10.560287Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:12:10.560347Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:10.560564Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2b7a3127-62e1-409a-bcc0-e2cfcb846f2b.sock: use of closed network connection
2020-08-31T01:12:10.560736Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:10.560765Z	error	sds	Remote side closed connection
2020-08-31T01:12:10.560946Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a3b7efa3-94b3-4ded-94b4-91bf0fe96a48\".sock" 

2020-08-31T01:12:10.560968Z	info	sds	Start SDS grpc server
2020-08-31T01:12:10.862419Z	info	sds	resource:default new connection
2020-08-31T01:12:10.862525Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:12:10.862583Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:10.862890Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:10.862919Z	error	sds	Remote side closed connection
2020-08-31T01:12:10.863751Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:12:10.863811Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:12:10.863997Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:12:10.864223Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:10.864241Z	error	sds	Remote side closed connection
2020-08-31T01:12:10.864495Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a3b7efa3-94b3-4ded-94b4-91bf0fe96a48".sock: use of closed network connection
2020-08-31T01:12:10.864847Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"69ebf37a-d451-4b93-aa67-f999ede31b30\".sock" 

2020-08-31T01:12:10.864944Z	info	sds	Start SDS grpc server
2020-08-31T01:12:10.865511Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:12:10.865551Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:12:10.865593Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:12:10.865807Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:10.865826Z	error	sds	Remote side closed connection
2020-08-31T01:12:10.866112Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"69ebf37a-d451-4b93-aa67-f999ede31b30".sock: use of closed network connection
2020-08-31T01:12:10.866249Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"85ff1f83-cccf-4673-ae43-c83b4051b5f2\".sock" 

2020-08-31T01:12:10.866282Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:11.167188Z	info	sds	resource:default new connection
2020-08-31T01:12:11.167251Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:12:11.167351Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:11.167705Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:11.167735Z	error	sds	Remote side closed connection
2020-08-31T01:12:11.168028Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"85ff1f83-cccf-4673-ae43-c83b4051b5f2".sock: use of closed network connection
2020-08-31T01:12:11.168277Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d4f3d0cb-f171-4897-bcd2-94a42b5f1850\".sock" 

2020-08-31T01:12:11.168340Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4381a77a-ba64-41db-a058-55465395f1d1\".sock" 

2020-08-31T01:12:11.168359Z	info	sds	Start SDS grpc server
2020-08-31T01:12:11.168373Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:11.469253Z	info	sds	resource:default new connection
2020-08-31T01:12:11.469310Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:12:11.469363Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:11.469659Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:11.469685Z	error	sds	Remote side closed connection
2020-08-31T01:12:11.470245Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:12:11.470280Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:12:11.470345Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:12:11.470648Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:11.470672Z	error	sds	Remote side closed connection
2020-08-31T01:12:11.560793Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:11.771621Z	info	sds	resource:default new connection
2020-08-31T01:12:11.771689Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:12:11.771762Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:11.772210Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:11.772239Z	error	sds	Remote side closed connection
2020-08-31T01:12:11.772391Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d4f3d0cb-f171-4897-bcd2-94a42b5f1850".sock: use of closed network connection
2020-08-31T01:12:11.772439Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4381a77a-ba64-41db-a058-55465395f1d1".sock: use of closed network connection
2020-08-31T01:12:11.772624Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4f018885-152e-44f5-8f2e-f85664ec802a\".sock" 

2020-08-31T01:12:11.772646Z	info	sds	Start SDS grpc server
2020-08-31T01:12:11.864728Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:11.866244Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:12:12.075027Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4f018885-152e-44f5-8f2e-f85664ec802a".sock: use of closed network connection
2020-08-31T01:12:12.075207Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"eb446e34-4150-4520-b154-a5b0ed4c995a\".sock" 

2020-08-31T01:12:12.075230Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:12.168268Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:12:12.377186Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"eb446e34-4150-4520-b154-a5b0ed4c995a".sock: use of closed network connection
2020-08-31T01:12:12.377400Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta68a2b21-444b-4a1e-b974-7cf46f71e987.sock" 

2020-08-31T01:12:12.377464Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c568a7e3-ba60-4137-af39-e26ab40dfcfd\".sock" 

2020-08-31T01:12:12.377468Z	info	sds	Start SDS grpc server
2020-08-31T01:12:12.377500Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:12:12.772587Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:12.772628Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:12:12.981633Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta68a2b21-444b-4a1e-b974-7cf46f71e987.sock: use of closed network connection
2020-08-31T01:12:12.981710Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c568a7e3-ba60-4137-af39-e26ab40dfcfd".sock: use of closed network connection
2020-08-31T01:12:12.981901Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest6fa718e8-bf6a-4c41-bf02-37fcfe5c66f8.sock" 

2020-08-31T01:12:12.981926Z	info	sds	Start SDS grpc server
2020-08-31T01:12:13.075222Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:13.285094Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:12:13.285257Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:13.285562Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest6fa718e8-bf6a-4c41-bf02-37fcfe5c66f8.sock: use of closed network connection
2020-08-31T01:12:13.285840Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf3d3de1a-3f48-4ca8-9389-e9b292693c43.sock" 

2020-08-31T01:12:13.285926Z	info	sds	Start SDS grpc server
2020-08-31T01:12:13.286869Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:12:13.286929Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:12:13.286985Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:13.287012Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:12:13.287046Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:12:13.287077Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:12:13.377364Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:13.560973Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:13.864967Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:13.866432Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:13.981853Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:13.981894Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:14.168470Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:14.285688Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:14.287146Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:14.287174Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:12:14.772881Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:14.772842Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:15.075447Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:15.287958Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:15.288331Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf3d3de1a-3f48-4ca8-9389-e9b292693c43.sock: use of closed network connection
2020-08-31T01:12:15.288382Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:15.288404Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:15.288413Z	error	sds	Remote side closed connection
2020-08-31T01:12:15.288428Z	error	sds	Remote side closed connection
2020-08-31T01:12:15.288606Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0958d945-22e9-4edd-89e0-b8d0819e13ee.sock" 

2020-08-31T01:12:15.288702Z	info	sds	Start SDS grpc server
2020-08-31T01:12:15.289428Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:12:15.289470Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:12:15.289517Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:15.289958Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:12:15.289517209 +0000 UTC m=+6.810750050 and is waiting for next SDS request
2020-08-31T01:12:15.289980Z	info	sds	Dynamic push for secret default
2020-08-31T01:12:15.290001Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0958d945-22e9-4edd-89e0-b8d0819e13ee.sock: use of closed network connection
2020-08-31T01:12:15.290054Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:15.290067Z	error	sds	Remote side closed connection
2020-08-31T01:12:15.290165Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:15.290188Z	error	sds	Remote side closed connection
2020-08-31T01:12:15.290279Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1013b8a0-3cac-422a-b294-88e9f9800be3.sock" 

2020-08-31T01:12:15.290392Z	info	sds	Start SDS grpc server
2020-08-31T01:12:15.290996Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:12:15.291033Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:12:15.291069Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:15.291537Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:12:15.377573Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:15.791599Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:15.791651Z	info	sds	Dynamic push for secret default
2020-08-31T01:12:15.792233Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1013b8a0-3cac-422a-b294-88e9f9800be3.sock: use of closed network connection
2020-08-31T01:12:15.792342Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:15.792354Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:15.792400Z	error	sds	Remote side closed connection
2020-08-31T01:12:15.792386Z	error	sds	Remote side closed connection
2020-08-31T01:12:15.792479Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste9b0a157-310a-4207-8b93-3d3bb59eb5ea.sock" 

2020-08-31T01:12:15.792495Z	info	sds	Start SDS grpc server
2020-08-31T01:12:15.792774Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste9b0a157-310a-4207-8b93-3d3bb59eb5ea.sock: use of closed network connection
2020-08-31T01:12:15.792900Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest70c12cb0-b827-4695-9e22-fda2cda23f5b.sock" 

2020-08-31T01:12:15.792923Z	info	sds	Start SDS grpc server
2020-08-31T01:12:15.982111Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:15.982157Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:16.093927Z	info	sds	resource:default new connection
2020-08-31T01:12:16.093984Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:12:16.094041Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:16.094317Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:16.094349Z	error	sds	Remote side closed connection
2020-08-31T01:12:16.285925Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:16.288532Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:16.290159Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:16.395357Z	info	sds	resource:default new connection
2020-08-31T01:12:16.395415Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:12:16.395467Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:16.395740Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:16.395753Z	error	sds	Remote side closed connection
2020-08-31T01:12:16.396115Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest70c12cb0-b827-4695-9e22-fda2cda23f5b.sock: use of closed network connection
2020-08-31T01:12:16.396281Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdd105a31-82dd-4ea4-941f-d5a987d4268b.sock" 

2020-08-31T01:12:16.396317Z	info	sds	Start SDS grpc server
2020-08-31T01:12:16.697255Z	info	sds	resource:default new connection
2020-08-31T01:12:16.697314Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:12:16.697373Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:16.697736Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:16.697764Z	error	sds	Remote side closed connection
2020-08-31T01:12:16.697942Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdd105a31-82dd-4ea4-941f-d5a987d4268b.sock: use of closed network connection
2020-08-31T01:12:16.792473Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:16.792902Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:17.396372Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:17.561218Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:17.698165Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:12:17.865197Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:17.866579Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:18.168722Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:18.288794Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:18.290349Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:12:18.729638Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf1da9a14-c24d-4dc9-b315-073c2881db72.sock" 

2020-08-31T01:12:18.729691Z	info	sds	Start SDS grpc server
2020-08-31T01:12:18.773152Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:18.773174Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:18.792745Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:18.793074Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:19.075701Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:19.377945Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:19.396651Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:19.698410Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:19.730468Z	info	sds	resource:default new connection
2020-08-31T01:12:19.730537Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:12:19.736166Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:12:19.855596Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:12:19.855642Z	info	cache	GenerateSecret default
2020-08-31T01:12:19.855702Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:19.856059Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf1da9a14-c24d-4dc9-b315-073c2881db72.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.622s
2020-08-31T01:12:25.091609Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4a38f5b5-4349-4e0d-a402-277f5d2a1ed8.sock" 

2020-08-31T01:12:25.091698Z	info	sds	Start SDS grpc server
2020-08-31T01:12:25.093043Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:12:25.093105Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:12:25.093489Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:26.092972Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:26.093036Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:12:27.093777Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:12:27.093885Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:12:27.093947Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:12:27.094030Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:27.094323Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4a38f5b5-4349-4e0d-a402-277f5d2a1ed8.sock: use of closed network connection
2020-08-31T01:12:27.094434Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:27.094463Z	error	sds	Remote side closed connection
2020-08-31T01:12:27.094554Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cd5cbec5-3576-443b-ba0a-55bd14657e6d\".sock" 

2020-08-31T01:12:27.094573Z	info	sds	Start SDS grpc server
2020-08-31T01:12:27.395559Z	info	sds	resource:default new connection
2020-08-31T01:12:27.395629Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:12:27.395686Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:27.396012Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:27.396038Z	error	sds	Remote side closed connection
2020-08-31T01:12:27.396636Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:12:27.396724Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:12:27.396926Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:12:27.397191Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:27.397219Z	error	sds	Remote side closed connection
2020-08-31T01:12:27.397324Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cd5cbec5-3576-443b-ba0a-55bd14657e6d".sock: use of closed network connection
2020-08-31T01:12:27.397502Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a3e30e85-5054-4193-ad2e-c894bf88d96d\".sock" 

2020-08-31T01:12:27.397592Z	info	sds	Start SDS grpc server
2020-08-31T01:12:27.397939Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:12:27.397966Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:12:27.398005Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:12:27.398205Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:27.398221Z	error	sds	Remote side closed connection
2020-08-31T01:12:27.398387Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a3e30e85-5054-4193-ad2e-c894bf88d96d".sock: use of closed network connection
2020-08-31T01:12:27.398543Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2de959bd-ad69-4670-859e-fadea3a174ee\".sock" 

2020-08-31T01:12:27.398586Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:27.699602Z	info	sds	resource:default new connection
2020-08-31T01:12:27.699700Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:12:27.699757Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:27.700043Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:27.700070Z	error	sds	Remote side closed connection
2020-08-31T01:12:27.700541Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2de959bd-ad69-4670-859e-fadea3a174ee".sock: use of closed network connection
2020-08-31T01:12:27.700830Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"bddf0a64-dc95-47ab-b9f0-07b42d6f7057\".sock" 

2020-08-31T01:12:27.700910Z	info	sds	Start SDS grpc server
2020-08-31T01:12:27.700936Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:27.700928Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bd43caf6-9f05-4d1f-bac8-72db148aa165\".sock" 

2020-08-31T01:12:28.001963Z	info	sds	resource:default new connection
2020-08-31T01:12:28.002037Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:12:28.002101Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:28.002502Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:28.002569Z	error	sds	Remote side closed connection
2020-08-31T01:12:28.003167Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:12:28.003213Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:12:28.003272Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:12:28.003571Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:28.003609Z	error	sds	Remote side closed connection
2020-08-31T01:12:28.094599Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:28.304615Z	info	sds	resource:default new connection
2020-08-31T01:12:28.304707Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:12:28.304775Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:28.305235Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:28.305264Z	error	sds	Remote side closed connection
2020-08-31T01:12:28.305485Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"bddf0a64-dc95-47ab-b9f0-07b42d6f7057".sock: use of closed network connection
2020-08-31T01:12:28.305533Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bd43caf6-9f05-4d1f-bac8-72db148aa165".sock: use of closed network connection
2020-08-31T01:12:28.305706Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b7b791d5-92f3-4e69-9a45-d0bd58cc6b77\".sock" 

2020-08-31T01:12:28.305728Z	info	sds	Start SDS grpc server
2020-08-31T01:12:28.397491Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:28.398612Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:12:28.608894Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b7b791d5-92f3-4e69-9a45-d0bd58cc6b77".sock: use of closed network connection
2020-08-31T01:12:28.609066Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"32f178c8-6824-4b9f-af1c-62cdf85b6f9d\".sock" 

2020-08-31T01:12:28.609109Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:28.700774Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:12:28.910659Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"32f178c8-6824-4b9f-af1c-62cdf85b6f9d".sock: use of closed network connection
2020-08-31T01:12:28.910949Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1483fdf5-1bcd-4a53-b4b7-107fd3034848.sock" 

2020-08-31T01:12:28.910968Z	info	sds	Start SDS grpc server
2020-08-31T01:12:28.911018Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5351f2e7-415a-406d-bf30-4255642e449c\".sock" 

2020-08-31T01:12:28.911051Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:12:29.305689Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:29.305749Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:12:29.515288Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1483fdf5-1bcd-4a53-b4b7-107fd3034848.sock: use of closed network connection
2020-08-31T01:12:29.515343Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5351f2e7-415a-406d-bf30-4255642e449c".sock: use of closed network connection
2020-08-31T01:12:29.515552Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestf1824d97-3499-4ff0-9e05-7558b9ffeef9.sock" 

2020-08-31T01:12:29.515588Z	info	sds	Start SDS grpc server
2020-08-31T01:12:29.609124Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:29.816544Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:12:29.816650Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:29.816955Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestf1824d97-3499-4ff0-9e05-7558b9ffeef9.sock: use of closed network connection
2020-08-31T01:12:29.817143Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest103563e6-62e3-4f4c-942d-06b91e20d79f.sock" 

2020-08-31T01:12:29.817259Z	info	sds	Start SDS grpc server
2020-08-31T01:12:29.818095Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:12:29.818150Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:12:29.818204Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:29.818299Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:12:29.818388Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:12:29.818434Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:12:29.910891Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:30.094854Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:30.397714Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:30.398819Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:30.515487Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:30.515492Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:30.701017Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:30.817066Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:30.818324Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:30.833326Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:12:31.305936Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:31.305970Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:31.609364Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:31.819034Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:31.819411Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest103563e6-62e3-4f4c-942d-06b91e20d79f.sock: use of closed network connection
2020-08-31T01:12:31.820087Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfa9e68e0-24d7-47e1-bb2b-a186f06be58d.sock" 

2020-08-31T01:12:31.820245Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:31.820261Z	info	sds	Start SDS grpc server
2020-08-31T01:12:31.820291Z	error	sds	Remote side closed connection
2020-08-31T01:12:31.820525Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:31.821045Z	error	sds	Remote side closed connection
2020-08-31T01:12:31.822600Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:12:31.822647Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:12:31.822694Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:31.823181Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:12:31.822693344 +0000 UTC m=+6.808102810 and is waiting for next SDS request
2020-08-31T01:12:31.823215Z	info	sds	Dynamic push for secret default
2020-08-31T01:12:31.823212Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfa9e68e0-24d7-47e1-bb2b-a186f06be58d.sock: use of closed network connection
2020-08-31T01:12:31.823252Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:31.823265Z	error	sds	Remote side closed connection
2020-08-31T01:12:31.823341Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:31.823433Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc283b090-6441-4670-9271-8bd27e95693a.sock" 

2020-08-31T01:12:31.823422Z	error	sds	Remote side closed connection
2020-08-31T01:12:31.823471Z	info	sds	Start SDS grpc server
2020-08-31T01:12:31.824090Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:12:31.824145Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:12:31.824189Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:31.824709Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:12:31.911125Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:32.324938Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:32.324993Z	info	sds	Dynamic push for secret default
2020-08-31T01:12:32.325678Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc283b090-6441-4670-9271-8bd27e95693a.sock: use of closed network connection
2020-08-31T01:12:32.325800Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:32.325828Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:32.325831Z	error	sds	Remote side closed connection
2020-08-31T01:12:32.325850Z	error	sds	Remote side closed connection
2020-08-31T01:12:32.325914Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8fd586be-1edb-4ca0-9709-207336243b44.sock" 

2020-08-31T01:12:32.325961Z	info	sds	Start SDS grpc server
2020-08-31T01:12:32.326137Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8fd586be-1edb-4ca0-9709-207336243b44.sock: use of closed network connection
2020-08-31T01:12:32.326217Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6a232bb0-1781-4840-8c3d-66049cbecd42.sock" 

2020-08-31T01:12:32.326257Z	info	sds	Start SDS grpc server
2020-08-31T01:12:32.515767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:32.515798Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:32.627180Z	info	sds	resource:default new connection
2020-08-31T01:12:32.627235Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:12:32.627317Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:32.627590Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:32.627602Z	error	sds	Remote side closed connection
2020-08-31T01:12:32.819624Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:32.823412Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:32.833346Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:32.928779Z	info	sds	resource:default new connection
2020-08-31T01:12:32.928885Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:12:32.928945Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:32.929220Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:32.929246Z	error	sds	Remote side closed connection
2020-08-31T01:12:32.929669Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6a232bb0-1781-4840-8c3d-66049cbecd42.sock: use of closed network connection
2020-08-31T01:12:32.929819Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8d6fd414-93c8-4a07-adb2-368828e1cb87.sock" 

2020-08-31T01:12:32.929865Z	info	sds	Start SDS grpc server
2020-08-31T01:12:33.230743Z	info	sds	resource:default new connection
2020-08-31T01:12:33.230825Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:12:33.230889Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:33.231184Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:33.231223Z	error	sds	Remote side closed connection
2020-08-31T01:12:33.231548Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8d6fd414-93c8-4a07-adb2-368828e1cb87.sock: use of closed network connection
2020-08-31T01:12:33.325886Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:33.326163Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:33.929919Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:34.095141Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:34.231690Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:12:34.397947Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:34.398995Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:34.701235Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:34.819925Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:34.823577Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:12:35.261100Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8306f32c-0794-4db0-9040-f7dd1d2c48a1.sock" 

2020-08-31T01:12:35.261149Z	info	sds	Start SDS grpc server
2020-08-31T01:12:35.306216Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:35.306255Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:35.326135Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:35.326228Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:35.609531Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:35.911362Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:35.930136Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:36.231969Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:36.262059Z	info	sds	resource:default new connection
2020-08-31T01:12:36.262133Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:12:36.265841Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:12:36.396880Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:12:36.396926Z	info	cache	GenerateSecret default
2020-08-31T01:12:36.396987Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:36.397415Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8306f32c-0794-4db0-9040-f7dd1d2c48a1.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.629s
2020-08-31T01:12:41.720335Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7b02045b-d1a9-4326-8c55-7c3424ae21d5.sock" 

2020-08-31T01:12:41.720383Z	info	sds	Start SDS grpc server
2020-08-31T01:12:41.722000Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:12:41.722080Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:12:41.722565Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:42.721812Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:42.721881Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:12:43.722585Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:12:43.722669Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:12:43.722694Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:12:43.722772Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:43.722977Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7b02045b-d1a9-4326-8c55-7c3424ae21d5.sock: use of closed network connection
2020-08-31T01:12:43.723141Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:43.723179Z	error	sds	Remote side closed connection
2020-08-31T01:12:43.723263Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ff98c189-682b-4d9f-885a-cd6a40d2a709\".sock" 

2020-08-31T01:12:43.723316Z	info	sds	Start SDS grpc server
2020-08-31T01:12:44.024322Z	info	sds	resource:default new connection
2020-08-31T01:12:44.024408Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:12:44.024472Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:44.024877Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:44.024902Z	error	sds	Remote side closed connection
2020-08-31T01:12:44.025564Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:12:44.025613Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:12:44.025773Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:12:44.026071Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:44.026092Z	error	sds	Remote side closed connection
2020-08-31T01:12:44.026269Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ff98c189-682b-4d9f-885a-cd6a40d2a709".sock: use of closed network connection
2020-08-31T01:12:44.026456Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3dd40de4-998e-43d1-b84e-c4c5bb900e71\".sock" 

2020-08-31T01:12:44.026525Z	info	sds	Start SDS grpc server
2020-08-31T01:12:44.027382Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:12:44.027419Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:12:44.027467Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:12:44.027659Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:44.027681Z	error	sds	Remote side closed connection
2020-08-31T01:12:44.027866Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3dd40de4-998e-43d1-b84e-c4c5bb900e71".sock: use of closed network connection
2020-08-31T01:12:44.028022Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c6d274dc-89d7-463f-9edf-f24c67849735\".sock" 

2020-08-31T01:12:44.028050Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:44.328946Z	info	sds	resource:default new connection
2020-08-31T01:12:44.329016Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:12:44.329095Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:44.329449Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:44.329484Z	error	sds	Remote side closed connection
2020-08-31T01:12:44.329609Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c6d274dc-89d7-463f-9edf-f24c67849735".sock: use of closed network connection
2020-08-31T01:12:44.329796Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5d26f152-d019-4e07-a229-50c0d4c4af17\".sock" 

2020-08-31T01:12:44.329853Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b9a45b7e-36f2-4713-80e4-ce18fe37010a\".sock" 

2020-08-31T01:12:44.329869Z	info	sds	Start SDS grpc server
2020-08-31T01:12:44.329884Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:44.630745Z	info	sds	resource:default new connection
2020-08-31T01:12:44.630807Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:12:44.630904Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:44.631157Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:44.631191Z	error	sds	Remote side closed connection
2020-08-31T01:12:44.631734Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:12:44.631768Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:12:44.631808Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:12:44.632021Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:44.632042Z	error	sds	Remote side closed connection
2020-08-31T01:12:44.723180Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:44.933138Z	info	sds	resource:default new connection
2020-08-31T01:12:44.933196Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:12:44.933282Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:44.933528Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:44.933581Z	error	sds	Remote side closed connection
2020-08-31T01:12:44.933864Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5d26f152-d019-4e07-a229-50c0d4c4af17".sock: use of closed network connection
2020-08-31T01:12:44.933908Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b9a45b7e-36f2-4713-80e4-ce18fe37010a".sock: use of closed network connection
2020-08-31T01:12:44.934158Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f9538cea-2262-4bc5-95ae-2d6ca2cd0088\".sock" 

2020-08-31T01:12:44.934192Z	info	sds	Start SDS grpc server
2020-08-31T01:12:45.026476Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:45.027970Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:12:45.236545Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f9538cea-2262-4bc5-95ae-2d6ca2cd0088".sock: use of closed network connection
2020-08-31T01:12:45.236819Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"595e9059-6413-45c1-989a-1bff12236a03\".sock" 

2020-08-31T01:12:45.236854Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:12:45.329839Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:12:45.539037Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"595e9059-6413-45c1-989a-1bff12236a03".sock: use of closed network connection
2020-08-31T01:12:45.539217Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest76c11fa6-2613-4bc8-854a-444ef941dac0.sock" 

2020-08-31T01:12:45.539272Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"772a16e1-2965-4e4b-8c18-16438ffff70e\".sock" 

2020-08-31T01:12:45.539288Z	info	sds	Start SDS grpc server
2020-08-31T01:12:45.539310Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:12:45.934076Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:45.934089Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:12:46.143091Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest76c11fa6-2613-4bc8-854a-444ef941dac0.sock: use of closed network connection
2020-08-31T01:12:46.143155Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"772a16e1-2965-4e4b-8c18-16438ffff70e".sock: use of closed network connection
2020-08-31T01:12:46.143320Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest53cc4a91-dbe6-4b72-b5b4-e5e99f27b8ad.sock" 

2020-08-31T01:12:46.143349Z	info	sds	Start SDS grpc server
2020-08-31T01:12:46.236777Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:46.444421Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:12:46.444521Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:46.444839Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest53cc4a91-dbe6-4b72-b5b4-e5e99f27b8ad.sock: use of closed network connection
2020-08-31T01:12:46.445063Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest25c9ce9d-b097-48b9-9a4d-b7dc25fa9c95.sock" 

2020-08-31T01:12:46.445145Z	info	sds	Start SDS grpc server
2020-08-31T01:12:46.448046Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:12:46.448110Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:12:46.448163Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:46.448283Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:12:46.448346Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:12:46.448385Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:12:46.539252Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:46.723415Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:47.026726Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:47.028186Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:47.143319Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:47.143345Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:47.330090Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:47.445073Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:47.448282Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:47.448331Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:12:47.934403Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:47.934414Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:48.237062Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:48.449217Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:48.449710Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:48.449729Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest25c9ce9d-b097-48b9-9a4d-b7dc25fa9c95.sock: use of closed network connection
2020-08-31T01:12:48.449741Z	error	sds	Remote side closed connection
2020-08-31T01:12:48.449858Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:48.449880Z	error	sds	Remote side closed connection
2020-08-31T01:12:48.449992Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest37067f2c-8f1e-4b5e-a2fe-d6adde8eeb2b.sock" 

2020-08-31T01:12:48.450016Z	info	sds	Start SDS grpc server
2020-08-31T01:12:48.451124Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:12:48.451168Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:12:48.451224Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:48.451646Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:12:48.451223597 +0000 UTC m=+6.810947604 and is waiting for next SDS request
2020-08-31T01:12:48.451670Z	info	sds	Dynamic push for secret default
2020-08-31T01:12:48.451697Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest37067f2c-8f1e-4b5e-a2fe-d6adde8eeb2b.sock: use of closed network connection
2020-08-31T01:12:48.451807Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:48.451817Z	error	sds	Remote side closed connection
2020-08-31T01:12:48.451965Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:48.451987Z	error	sds	Remote side closed connection
2020-08-31T01:12:48.452087Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest885c95f8-0225-4e5d-b884-3f16bfc74944.sock" 

2020-08-31T01:12:48.452161Z	info	sds	Start SDS grpc server
2020-08-31T01:12:48.452963Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:12:48.452999Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:12:48.453035Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:48.453554Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:12:48.539506Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:48.953781Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:48.953836Z	info	sds	Dynamic push for secret default
2020-08-31T01:12:48.954468Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest885c95f8-0225-4e5d-b884-3f16bfc74944.sock: use of closed network connection
2020-08-31T01:12:48.954569Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:48.954599Z	error	sds	Remote side closed connection
2020-08-31T01:12:48.954618Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:48.954644Z	error	sds	Remote side closed connection
2020-08-31T01:12:48.954723Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest73973e68-6646-45ba-a0bb-d1523f8a272a.sock" 

2020-08-31T01:12:48.954776Z	info	sds	Start SDS grpc server
2020-08-31T01:12:48.954949Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest73973e68-6646-45ba-a0bb-d1523f8a272a.sock: use of closed network connection
2020-08-31T01:12:48.955031Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0ca14a40-35cb-4285-95b1-0ed90d3d94cd.sock" 

2020-08-31T01:12:48.955051Z	info	sds	Start SDS grpc server
2020-08-31T01:12:49.143588Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:49.143622Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:49.255996Z	info	sds	resource:default new connection
2020-08-31T01:12:49.256162Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:12:49.256239Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:49.256580Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:49.256617Z	error	sds	Remote side closed connection
2020-08-31T01:12:49.445328Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:49.449946Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:49.451891Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:49.557851Z	info	sds	resource:default new connection
2020-08-31T01:12:49.557934Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:12:49.557990Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:49.558316Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:49.558339Z	error	sds	Remote side closed connection
2020-08-31T01:12:49.558579Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0ca14a40-35cb-4285-95b1-0ed90d3d94cd.sock: use of closed network connection
2020-08-31T01:12:49.558714Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7273a630-ddd2-4aed-ba30-4924c9354934.sock" 

2020-08-31T01:12:49.558742Z	info	sds	Start SDS grpc server
2020-08-31T01:12:49.859650Z	info	sds	resource:default new connection
2020-08-31T01:12:49.859714Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:12:49.859775Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:49.860038Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:49.860065Z	error	sds	Remote side closed connection
2020-08-31T01:12:49.860369Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7273a630-ddd2-4aed-ba30-4924c9354934.sock: use of closed network connection
2020-08-31T01:12:49.954700Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:49.955102Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:50.558807Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:50.723704Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:50.860505Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:12:51.026897Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:51.028420Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:51.330354Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:51.450195Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:51.452105Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:12:51.889968Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3a8192e5-dac4-49b4-9ca4-9e52fe28f318.sock" 

2020-08-31T01:12:51.890016Z	info	sds	Start SDS grpc server
2020-08-31T01:12:51.934764Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:51.934807Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:51.954957Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:51.955298Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:52.237308Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:52.539795Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:12:52.559011Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:52.860765Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:12:52.890791Z	info	sds	resource:default new connection
2020-08-31T01:12:52.890875Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:12:52.901732Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:12:52.968620Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:12:52.968702Z	info	cache	GenerateSecret default
2020-08-31T01:12:52.968765Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:52.969174Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3a8192e5-dac4-49b4-9ca4-9e52fe28f318.sock: use of closed network connection
2020-08-31T01:12:52.969217Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:52.969237Z	error	sds	Remote side closed connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.575s
2020-08-31T01:12:58.255420Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9b8ada55-0be2-4c65-aed7-61598aeea15a.sock" 

2020-08-31T01:12:58.255532Z	info	sds	Start SDS grpc server
2020-08-31T01:12:58.256762Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:12:58.256850Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:12:58.258162Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:12:59.256710Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:12:59.256803Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:13:00.257551Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:13:00.257635Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:13:00.257669Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:13:00.257737Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:00.257944Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9b8ada55-0be2-4c65-aed7-61598aeea15a.sock: use of closed network connection
2020-08-31T01:13:00.258058Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:00.258082Z	error	sds	Remote side closed connection
2020-08-31T01:13:00.258185Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cdce04ba-424c-4e37-a735-4346bb29392c\".sock" 

2020-08-31T01:13:00.258227Z	info	sds	Start SDS grpc server
2020-08-31T01:13:00.559095Z	info	sds	resource:default new connection
2020-08-31T01:13:00.559163Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:13:00.559224Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:00.559540Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:00.559567Z	error	sds	Remote side closed connection
2020-08-31T01:13:00.560175Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:13:00.560242Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:13:00.560448Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:13:00.560723Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:00.560755Z	error	sds	Remote side closed connection
2020-08-31T01:13:00.560981Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cdce04ba-424c-4e37-a735-4346bb29392c".sock: use of closed network connection
2020-08-31T01:13:00.561150Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4268fa7c-707b-4469-8515-141de5bf67b2\".sock" 

2020-08-31T01:13:00.561259Z	info	sds	Start SDS grpc server
2020-08-31T01:13:00.561537Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:13:00.561564Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:13:00.561595Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:13:00.561864Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:00.561891Z	error	sds	Remote side closed connection
2020-08-31T01:13:00.562003Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4268fa7c-707b-4469-8515-141de5bf67b2".sock: use of closed network connection
2020-08-31T01:13:00.562159Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7aad786f-8d92-4b3a-a06c-9f1f89401e94\".sock" 

2020-08-31T01:13:00.562187Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:00.863319Z	info	sds	resource:default new connection
2020-08-31T01:13:00.863423Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:13:00.863480Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:00.863804Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:00.863840Z	error	sds	Remote side closed connection
2020-08-31T01:13:00.863980Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7aad786f-8d92-4b3a-a06c-9f1f89401e94".sock: use of closed network connection
2020-08-31T01:13:00.864198Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7875313b-55d7-44c6-a8b1-ebdf6d28b161\".sock" 

2020-08-31T01:13:00.864255Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"aa40df80-acd2-4007-9dfb-88d9a8eace56\".sock" 

2020-08-31T01:13:00.864266Z	info	sds	Start SDS grpc server
2020-08-31T01:13:00.864287Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:01.165324Z	info	sds	resource:default new connection
2020-08-31T01:13:01.165384Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:13:01.165441Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:01.165730Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:01.165759Z	error	sds	Remote side closed connection
2020-08-31T01:13:01.166373Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:13:01.166419Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:13:01.166484Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:13:01.166798Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:01.166826Z	error	sds	Remote side closed connection
2020-08-31T01:13:01.258187Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:01.467838Z	info	sds	resource:default new connection
2020-08-31T01:13:01.467890Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:13:01.467952Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:01.468262Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:01.468288Z	error	sds	Remote side closed connection
2020-08-31T01:13:01.468776Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7875313b-55d7-44c6-a8b1-ebdf6d28b161".sock: use of closed network connection
2020-08-31T01:13:01.468847Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"aa40df80-acd2-4007-9dfb-88d9a8eace56".sock: use of closed network connection
2020-08-31T01:13:01.469082Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9461c5c2-0cce-45d2-bcb3-477401090d48\".sock" 

2020-08-31T01:13:01.469116Z	info	sds	Start SDS grpc server
2020-08-31T01:13:01.561182Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:01.562180Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:13:01.771570Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9461c5c2-0cce-45d2-bcb3-477401090d48".sock: use of closed network connection
2020-08-31T01:13:01.771801Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"976c2352-4368-4209-9e81-199c9ce9c9aa\".sock" 

2020-08-31T01:13:01.771833Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:01.864193Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:13:02.073555Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"976c2352-4368-4209-9e81-199c9ce9c9aa".sock: use of closed network connection
2020-08-31T01:13:02.073790Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestdd611efb-cdcc-4d09-a9e9-552cb9e52fe7.sock" 

2020-08-31T01:13:02.073840Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6f44ff4d-be2c-48d7-8ff1-d082a0c9ee8e\".sock" 

2020-08-31T01:13:02.073821Z	info	sds	Start SDS grpc server
2020-08-31T01:13:02.073863Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:13:02.469000Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:02.469040Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:13:02.678108Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestdd611efb-cdcc-4d09-a9e9-552cb9e52fe7.sock: use of closed network connection
2020-08-31T01:13:02.678159Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6f44ff4d-be2c-48d7-8ff1-d082a0c9ee8e".sock: use of closed network connection
2020-08-31T01:13:02.678370Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest43a7a102-049c-46f2-b4c4-2d5cc7b3050e.sock" 

2020-08-31T01:13:02.678404Z	info	sds	Start SDS grpc server
2020-08-31T01:13:02.771785Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:02.979486Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:13:02.979579Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:02.979847Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest43a7a102-049c-46f2-b4c4-2d5cc7b3050e.sock: use of closed network connection
2020-08-31T01:13:02.980110Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbbd7c652-56f1-4fd6-91c0-b585b17f9017.sock" 

2020-08-31T01:13:02.980134Z	info	sds	Start SDS grpc server
2020-08-31T01:13:02.981074Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:13:02.981127Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:13:02.981171Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:02.981385Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:13:02.981438Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:13:02.981470Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:13:03.073763Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:03.258304Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:03.561432Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:03.562352Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:03.678386Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:03.678412Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:03.864455Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:03.980091Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:03.981395Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:03.981418Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:13:04.469307Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:04.469360Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:04.772051Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:04.982253Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:04.982556Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbbd7c652-56f1-4fd6-91c0-b585b17f9017.sock: use of closed network connection
2020-08-31T01:13:04.982566Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:04.982603Z	error	sds	Remote side closed connection
2020-08-31T01:13:04.982817Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:04.982839Z	error	sds	Remote side closed connection
2020-08-31T01:13:04.982938Z	info	sds	Start SDS grpc server
2020-08-31T01:13:04.982923Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1698e516-74c0-4565-89df-2ce82129ff3e.sock" 

2020-08-31T01:13:04.983778Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:13:04.983818Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:13:04.983864Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:04.984336Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:13:04.983863525 +0000 UTC m=+6.804055456 and is waiting for next SDS request
2020-08-31T01:13:04.984355Z	info	sds	Dynamic push for secret default
2020-08-31T01:13:04.984376Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1698e516-74c0-4565-89df-2ce82129ff3e.sock: use of closed network connection
2020-08-31T01:13:04.984458Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:04.984472Z	error	sds	Remote side closed connection
2020-08-31T01:13:04.984484Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:04.984503Z	error	sds	Remote side closed connection
2020-08-31T01:13:04.984537Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2492583b-4dac-44d3-8d5e-b5145008b239.sock" 

2020-08-31T01:13:04.984543Z	info	sds	Start SDS grpc server
2020-08-31T01:13:04.985280Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:13:04.985329Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:13:04.985371Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:04.985979Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:13:05.073990Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:05.486056Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:05.486107Z	info	sds	Dynamic push for secret default
2020-08-31T01:13:05.486703Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2492583b-4dac-44d3-8d5e-b5145008b239.sock: use of closed network connection
2020-08-31T01:13:05.486797Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:05.486818Z	error	sds	Remote side closed connection
2020-08-31T01:13:05.486822Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:05.486845Z	error	sds	Remote side closed connection
2020-08-31T01:13:05.486914Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste29fc761-7fea-4a00-ae5e-69b92513bd70.sock" 

2020-08-31T01:13:05.486982Z	info	sds	Start SDS grpc server
2020-08-31T01:13:05.487120Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste29fc761-7fea-4a00-ae5e-69b92513bd70.sock: use of closed network connection
2020-08-31T01:13:05.487243Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc375da8a-ec3a-4e74-af31-a715b376dd68.sock" 

2020-08-31T01:13:05.487256Z	info	sds	Start SDS grpc server
2020-08-31T01:13:05.678682Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:05.678733Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:05.788904Z	info	sds	resource:default new connection
2020-08-31T01:13:05.788974Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:13:05.789031Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:05.789317Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:05.789346Z	error	sds	Remote side closed connection
2020-08-31T01:13:05.980368Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:05.982794Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:05.984581Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:06.090219Z	info	sds	resource:default new connection
2020-08-31T01:13:06.090308Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:13:06.090377Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:06.090744Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:06.090782Z	error	sds	Remote side closed connection
2020-08-31T01:13:06.091139Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc375da8a-ec3a-4e74-af31-a715b376dd68.sock: use of closed network connection
2020-08-31T01:13:06.091268Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest952d3bd5-75b0-4442-bb83-273904ebf679.sock" 

2020-08-31T01:13:06.091278Z	info	sds	Start SDS grpc server
2020-08-31T01:13:06.392235Z	info	sds	resource:default new connection
2020-08-31T01:13:06.392322Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:13:06.392376Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:06.392735Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:06.392754Z	error	sds	Remote side closed connection
2020-08-31T01:13:06.393044Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest952d3bd5-75b0-4442-bb83-273904ebf679.sock: use of closed network connection
2020-08-31T01:13:06.486930Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:06.487183Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:07.091388Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:07.258556Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:07.393256Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:13:07.561674Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:07.562519Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:07.864587Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:07.982996Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:07.984775Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:13:08.426324Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4dbb5c68-4a78-43fd-9150-c79fb1020161.sock" 

2020-08-31T01:13:08.426384Z	info	sds	Start SDS grpc server
2020-08-31T01:13:08.469536Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:08.469586Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:08.487184Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:08.487348Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:08.772305Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:09.074264Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:09.091618Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:09.393529Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:09.427175Z	info	sds	resource:default new connection
2020-08-31T01:13:09.427234Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:13:09.437814Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:13:09.533465Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:13:09.533512Z	info	cache	GenerateSecret default
2020-08-31T01:13:09.533575Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:09.533912Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4dbb5c68-4a78-43fd-9150-c79fb1020161.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.598s
2020-08-31T01:13:14.814815Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest413a564e-a7c7-49cc-969e-bb6384dbe6f7.sock" 

2020-08-31T01:13:14.814935Z	info	sds	Start SDS grpc server
2020-08-31T01:13:14.816165Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:13:14.816239Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:13:14.817184Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:15.816012Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:15.816073Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:13:16.816747Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:13:16.816817Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:13:16.816842Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:13:16.816904Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:16.817160Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest413a564e-a7c7-49cc-969e-bb6384dbe6f7.sock: use of closed network connection
2020-08-31T01:13:16.817294Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:16.817341Z	error	sds	Remote side closed connection
2020-08-31T01:13:16.817453Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2ab0bc7b-2612-4a4e-bf7c-51f355b5611a\".sock" 

2020-08-31T01:13:16.817508Z	info	sds	Start SDS grpc server
2020-08-31T01:13:17.118473Z	info	sds	resource:default new connection
2020-08-31T01:13:17.118536Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:13:17.118590Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:17.118896Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:17.118980Z	error	sds	Remote side closed connection
2020-08-31T01:13:17.119517Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:13:17.119567Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:13:17.119761Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:13:17.119995Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:17.120014Z	error	sds	Remote side closed connection
2020-08-31T01:13:17.120232Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2ab0bc7b-2612-4a4e-bf7c-51f355b5611a".sock: use of closed network connection
2020-08-31T01:13:17.120398Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9a4a6abc-47b2-4a29-b549-657fe6411e74\".sock" 

2020-08-31T01:13:17.120418Z	info	sds	Start SDS grpc server
2020-08-31T01:13:17.120868Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:13:17.120902Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:13:17.120938Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:13:17.121117Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:17.121134Z	error	sds	Remote side closed connection
2020-08-31T01:13:17.121297Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9a4a6abc-47b2-4a29-b549-657fe6411e74".sock: use of closed network connection
2020-08-31T01:13:17.121450Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4ca4346e-d15c-4d98-92dd-f9df797a31f9\".sock" 

2020-08-31T01:13:17.121477Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:17.422461Z	info	sds	resource:default new connection
2020-08-31T01:13:17.422522Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:13:17.422577Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:17.422787Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:17.422818Z	error	sds	Remote side closed connection
2020-08-31T01:13:17.423068Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4ca4346e-d15c-4d98-92dd-f9df797a31f9".sock: use of closed network connection
2020-08-31T01:13:17.423253Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5f84e89a-1e22-4c1a-ad84-c7ac84609eb3\".sock" 

2020-08-31T01:13:17.423309Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"44c80b0c-2c31-4beb-9235-5d55c7165a24\".sock" 

2020-08-31T01:13:17.423325Z	info	sds	Start SDS grpc server
2020-08-31T01:13:17.423352Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:17.724392Z	info	sds	resource:default new connection
2020-08-31T01:13:17.724505Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:13:17.724562Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:17.724916Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:17.724943Z	error	sds	Remote side closed connection
2020-08-31T01:13:17.725552Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:13:17.725589Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:13:17.725629Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:13:17.725963Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:17.725986Z	error	sds	Remote side closed connection
2020-08-31T01:13:17.817374Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:18.026936Z	info	sds	resource:default new connection
2020-08-31T01:13:18.027053Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:13:18.027112Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:18.027389Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:18.027401Z	error	sds	Remote side closed connection
2020-08-31T01:13:18.027616Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5f84e89a-1e22-4c1a-ad84-c7ac84609eb3".sock: use of closed network connection
2020-08-31T01:13:18.027666Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"44c80b0c-2c31-4beb-9235-5d55c7165a24".sock: use of closed network connection
2020-08-31T01:13:18.027977Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c3bd4b90-13de-44b3-a192-559345ac07fc\".sock" 

2020-08-31T01:13:18.027996Z	info	sds	Start SDS grpc server
2020-08-31T01:13:18.120451Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:18.121480Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:13:18.330998Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c3bd4b90-13de-44b3-a192-559345ac07fc".sock: use of closed network connection
2020-08-31T01:13:18.331186Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0d2cde16-a31d-4d70-9ce0-7957a3c052d8\".sock" 

2020-08-31T01:13:18.331208Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:18.423272Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:13:18.632810Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0d2cde16-a31d-4d70-9ce0-7957a3c052d8".sock: use of closed network connection
2020-08-31T01:13:18.632995Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest2e1f01af-f6f3-4ace-86a1-52cfb16dacec.sock" 

2020-08-31T01:13:18.633015Z	info	sds	Start SDS grpc server
2020-08-31T01:13:18.633053Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:18.633048Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"99b4b845-1e28-466d-b0e2-be4dc9e379f2\".sock" 

Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:13:19.027838Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:19.027907Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:13:19.252623Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest2e1f01af-f6f3-4ace-86a1-52cfb16dacec.sock: use of closed network connection
2020-08-31T01:13:19.252728Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"99b4b845-1e28-466d-b0e2-be4dc9e379f2".sock: use of closed network connection
2020-08-31T01:13:19.252929Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest2b82fb44-eaa3-4f9c-8c70-8f32f6622821.sock" 

2020-08-31T01:13:19.252942Z	info	sds	Start SDS grpc server
2020-08-31T01:13:19.331226Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:19.553785Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:13:19.553894Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:19.554087Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest2b82fb44-eaa3-4f9c-8c70-8f32f6622821.sock: use of closed network connection
2020-08-31T01:13:19.554350Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta2093b53-4902-40e8-977d-2b5ae55de99a.sock" 

2020-08-31T01:13:19.554432Z	info	sds	Start SDS grpc server
2020-08-31T01:13:19.556036Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:13:19.556159Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:13:19.556261Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:19.557124Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:13:19.557173Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:13:19.557210Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:13:19.633037Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:19.817614Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:20.120714Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:20.121671Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:20.252782Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:20.252809Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:20.423525Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:20.554333Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:20.556904Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:20.556959Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:13:21.028114Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:21.028181Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:21.331485Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:21.557848Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:21.558157Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta2093b53-4902-40e8-977d-2b5ae55de99a.sock: use of closed network connection
2020-08-31T01:13:21.558228Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:21.558252Z	error	sds	Remote side closed connection
2020-08-31T01:13:21.558250Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:21.558273Z	error	sds	Remote side closed connection
2020-08-31T01:13:21.558413Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc4de3175-44f6-4c54-bc9e-e79e25afd661.sock" 

2020-08-31T01:13:21.558470Z	info	sds	Start SDS grpc server
2020-08-31T01:13:21.559346Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:13:21.559398Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:13:21.559443Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:21.560002Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:13:21.55944249 +0000 UTC m=+6.821152333 and is waiting for next SDS request
2020-08-31T01:13:21.560025Z	info	sds	Dynamic push for secret default
2020-08-31T01:13:21.560050Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc4de3175-44f6-4c54-bc9e-e79e25afd661.sock: use of closed network connection
2020-08-31T01:13:21.560173Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:21.560184Z	error	sds	Remote side closed connection
2020-08-31T01:13:21.560221Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:21.560226Z	error	sds	Remote side closed connection
2020-08-31T01:13:21.560280Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3f35fc5c-3103-4a8c-913d-94bd92d45fbf.sock" 

2020-08-31T01:13:21.560333Z	info	sds	Start SDS grpc server
2020-08-31T01:13:21.561099Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:13:21.561134Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:13:21.561165Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:21.561644Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:13:21.633354Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:22.061732Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:22.061784Z	info	sds	Dynamic push for secret default
2020-08-31T01:13:22.062365Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3f35fc5c-3103-4a8c-913d-94bd92d45fbf.sock: use of closed network connection
2020-08-31T01:13:22.062543Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:22.062565Z	error	sds	Remote side closed connection
2020-08-31T01:13:22.062545Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:22.062592Z	error	sds	Remote side closed connection
2020-08-31T01:13:22.062616Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest59a0592d-bcc0-4e97-b5b6-9ca5490f21b5.sock" 

2020-08-31T01:13:22.062624Z	info	sds	Start SDS grpc server
2020-08-31T01:13:22.062887Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest59a0592d-bcc0-4e97-b5b6-9ca5490f21b5.sock: use of closed network connection
2020-08-31T01:13:22.062972Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestda5791bb-9caa-4b55-a6fe-065e74ccef77.sock" 

2020-08-31T01:13:22.062991Z	info	sds	Start SDS grpc server
2020-08-31T01:13:22.253032Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:22.253080Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:22.363899Z	info	sds	resource:default new connection
2020-08-31T01:13:22.363996Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:13:22.364047Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:22.364386Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:22.364400Z	error	sds	Remote side closed connection
2020-08-31T01:13:22.554596Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:22.558379Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:22.560193Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:22.665497Z	info	sds	resource:default new connection
2020-08-31T01:13:22.665576Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:13:22.665642Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:22.665979Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:22.666005Z	error	sds	Remote side closed connection
2020-08-31T01:13:22.666217Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestda5791bb-9caa-4b55-a6fe-065e74ccef77.sock: use of closed network connection
2020-08-31T01:13:22.666383Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest00fbaaeb-0cf1-4db3-8751-f63404bd0162.sock" 

2020-08-31T01:13:22.666430Z	info	sds	Start SDS grpc server
2020-08-31T01:13:22.967327Z	info	sds	resource:default new connection
2020-08-31T01:13:22.967382Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:13:22.967431Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:22.967724Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:22.967738Z	error	sds	Remote side closed connection
2020-08-31T01:13:22.967966Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest00fbaaeb-0cf1-4db3-8751-f63404bd0162.sock: use of closed network connection
2020-08-31T01:13:23.062613Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:23.062954Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:23.666478Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:23.817907Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:23.968199Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:13:24.120975Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:24.121842Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:24.423805Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:24.558638Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:24.560369Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:13:24.997384Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb8c027d9-772e-4839-a908-24d7e670820f.sock" 

2020-08-31T01:13:24.997417Z	info	sds	Start SDS grpc server
2020-08-31T01:13:25.028357Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:25.028412Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:25.062896Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:25.063040Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:25.331737Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:25.633601Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:25.666724Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:25.968521Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:25.998254Z	info	sds	resource:default new connection
2020-08-31T01:13:25.998395Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:13:26.006198Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:13:26.128487Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:13:26.128532Z	info	cache	GenerateSecret default
2020-08-31T01:13:26.128588Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:26.129005Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb8c027d9-772e-4839-a908-24d7e670820f.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.637s
2020-08-31T01:13:31.331362Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesteab9093c-8879-4604-ac45-8a955e2e5b7b.sock" 

2020-08-31T01:13:31.331454Z	info	sds	Start SDS grpc server
2020-08-31T01:13:31.332943Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:13:31.333013Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:13:31.333423Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:32.332796Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:32.332886Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:13:33.334105Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:13:33.334219Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:13:33.334244Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:13:33.334302Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:33.334508Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesteab9093c-8879-4604-ac45-8a955e2e5b7b.sock: use of closed network connection
2020-08-31T01:13:33.334638Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:33.334680Z	error	sds	Remote side closed connection
2020-08-31T01:13:33.334759Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f4178769-cce3-4894-8eaf-f28087f0899e\".sock" 

2020-08-31T01:13:33.334797Z	info	sds	Start SDS grpc server
2020-08-31T01:13:33.635768Z	info	sds	resource:default new connection
2020-08-31T01:13:33.635834Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:13:33.635896Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:33.636269Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:33.636293Z	error	sds	Remote side closed connection
2020-08-31T01:13:33.636856Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:13:33.636917Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:13:33.637083Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:13:33.637373Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:33.637393Z	error	sds	Remote side closed connection
2020-08-31T01:13:33.637588Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f4178769-cce3-4894-8eaf-f28087f0899e".sock: use of closed network connection
2020-08-31T01:13:33.637794Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"8dfa4187-4535-46a1-aa35-95ee180a9926\".sock" 

2020-08-31T01:13:33.637870Z	info	sds	Start SDS grpc server
2020-08-31T01:13:33.638320Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:13:33.638348Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:13:33.638385Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:13:33.638592Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:33.638606Z	error	sds	Remote side closed connection
2020-08-31T01:13:33.638885Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"8dfa4187-4535-46a1-aa35-95ee180a9926".sock: use of closed network connection
2020-08-31T01:13:33.639075Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"058c2851-9df8-4ebf-98a6-f6589acc5cd8\".sock" 

2020-08-31T01:13:33.639129Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:33.940113Z	info	sds	resource:default new connection
2020-08-31T01:13:33.940187Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:13:33.940251Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:33.940560Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:33.940581Z	error	sds	Remote side closed connection
2020-08-31T01:13:33.940833Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"058c2851-9df8-4ebf-98a6-f6589acc5cd8".sock: use of closed network connection
2020-08-31T01:13:33.941040Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"8b17b213-5ac1-4d22-9845-2cf1c9da0dc0\".sock" 

2020-08-31T01:13:33.941053Z	info	sds	Start SDS grpc server
2020-08-31T01:13:33.941101Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c9260157-c7cb-4b51-8c27-b74a3d00dc5d\".sock" 

2020-08-31T01:13:33.941139Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:34.242004Z	info	sds	resource:default new connection
2020-08-31T01:13:34.242073Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:13:34.242126Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:34.242370Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:34.242398Z	error	sds	Remote side closed connection
2020-08-31T01:13:34.242920Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:13:34.242961Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:13:34.243002Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:13:34.243323Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:34.243339Z	error	sds	Remote side closed connection
2020-08-31T01:13:34.334735Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:34.544497Z	info	sds	resource:default new connection
2020-08-31T01:13:34.544568Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:13:34.544632Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:34.544905Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:34.544937Z	error	sds	Remote side closed connection
2020-08-31T01:13:34.545175Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"8b17b213-5ac1-4d22-9845-2cf1c9da0dc0".sock: use of closed network connection
2020-08-31T01:13:34.545267Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c9260157-c7cb-4b51-8c27-b74a3d00dc5d".sock: use of closed network connection
2020-08-31T01:13:34.545501Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f7a3adc3-77fa-4d5b-8cbc-d529b175c69f\".sock" 

2020-08-31T01:13:34.545519Z	info	sds	Start SDS grpc server
2020-08-31T01:13:34.637785Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:34.639041Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:13:34.848427Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f7a3adc3-77fa-4d5b-8cbc-d529b175c69f".sock: use of closed network connection
2020-08-31T01:13:34.848623Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0566b115-b0d9-46ad-992a-3d492d07b6ea\".sock" 

2020-08-31T01:13:34.848647Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:34.941072Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:13:35.150301Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0566b115-b0d9-46ad-992a-3d492d07b6ea".sock: use of closed network connection
2020-08-31T01:13:35.150521Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest7d7e8e1f-aed0-4502-b758-04f565bebc03.sock" 

2020-08-31T01:13:35.150580Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c6296368-ef47-47c2-be5f-3e8ec2375d74\".sock" 

2020-08-31T01:13:35.150568Z	info	sds	Start SDS grpc server
2020-08-31T01:13:35.150611Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:13:35.545390Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:35.545379Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:13:35.756108Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest7d7e8e1f-aed0-4502-b758-04f565bebc03.sock: use of closed network connection
2020-08-31T01:13:35.756165Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c6296368-ef47-47c2-be5f-3e8ec2375d74".sock: use of closed network connection
2020-08-31T01:13:35.756380Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest16374a05-3a39-402b-a207-4b26178f4921.sock" 

2020-08-31T01:13:35.756417Z	info	sds	Start SDS grpc server
2020-08-31T01:13:35.848699Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:36.057527Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:13:36.057634Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:36.057846Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest16374a05-3a39-402b-a207-4b26178f4921.sock: use of closed network connection
2020-08-31T01:13:36.058084Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest83262663-926b-4470-8104-e68a8f49f014.sock" 

2020-08-31T01:13:36.058110Z	info	sds	Start SDS grpc server
2020-08-31T01:13:36.058973Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:13:36.059032Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:13:36.059082Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:36.059177Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:13:36.059219Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:13:36.059266Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:13:36.150534Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:36.334947Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:36.638034Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:36.639212Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:36.756248Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:36.756279Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:36.941372Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:37.058049Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:37.059340Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:37.059378Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:13:37.545640Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:37.545640Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:37.848923Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:38.060193Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:38.060520Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest83262663-926b-4470-8104-e68a8f49f014.sock: use of closed network connection
2020-08-31T01:13:38.060607Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:38.060622Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:38.060640Z	error	sds	Remote side closed connection
2020-08-31T01:13:38.060623Z	error	sds	Remote side closed connection
2020-08-31T01:13:38.060804Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfb20bdb6-9162-4f29-97ab-22ebc0fb6064.sock" 

2020-08-31T01:13:38.060959Z	info	sds	Start SDS grpc server
2020-08-31T01:13:38.061606Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:13:38.061661Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:13:38.061716Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:38.062240Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:13:38.061715553 +0000 UTC m=+6.807452761 and is waiting for next SDS request
2020-08-31T01:13:38.062258Z	info	sds	Dynamic push for secret default
2020-08-31T01:13:38.062284Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfb20bdb6-9162-4f29-97ab-22ebc0fb6064.sock: use of closed network connection
2020-08-31T01:13:38.062406Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:38.062421Z	error	sds	Remote side closed connection
2020-08-31T01:13:38.062430Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:38.062453Z	error	sds	Remote side closed connection
2020-08-31T01:13:38.062679Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest99576355-240a-4518-8a88-2e40ee9792a3.sock" 

2020-08-31T01:13:38.062755Z	info	sds	Start SDS grpc server
2020-08-31T01:13:38.063459Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:13:38.063513Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:13:38.063554Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:38.064090Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:13:38.150749Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:38.564200Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:38.564251Z	info	sds	Dynamic push for secret default
2020-08-31T01:13:38.565114Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest99576355-240a-4518-8a88-2e40ee9792a3.sock: use of closed network connection
2020-08-31T01:13:38.565211Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:38.565240Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:38.565303Z	error	sds	Remote side closed connection
2020-08-31T01:13:38.565245Z	error	sds	Remote side closed connection
2020-08-31T01:13:38.565349Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest64acb62c-7389-4383-b4a6-15186051db6b.sock" 

2020-08-31T01:13:38.565383Z	info	sds	Start SDS grpc server
2020-08-31T01:13:38.565601Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest64acb62c-7389-4383-b4a6-15186051db6b.sock: use of closed network connection
2020-08-31T01:13:38.565697Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest993f2b80-3d8e-4d6f-a5cd-f8b08751cf7f.sock" 

2020-08-31T01:13:38.565702Z	info	sds	Start SDS grpc server
2020-08-31T01:13:38.756500Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:38.756550Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:38.866556Z	info	sds	resource:default new connection
2020-08-31T01:13:38.866612Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:13:38.866676Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:38.866929Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:38.866946Z	error	sds	Remote side closed connection
2020-08-31T01:13:39.058226Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:39.060728Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:39.062430Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:39.167942Z	info	sds	resource:default new connection
2020-08-31T01:13:39.167997Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:13:39.168045Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:39.168347Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:39.168374Z	error	sds	Remote side closed connection
2020-08-31T01:13:39.168637Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest993f2b80-3d8e-4d6f-a5cd-f8b08751cf7f.sock: use of closed network connection
2020-08-31T01:13:39.168860Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest85b97c5b-7585-4e51-aeb8-ad47fc1eb587.sock" 

2020-08-31T01:13:39.168874Z	info	sds	Start SDS grpc server
2020-08-31T01:13:39.469908Z	info	sds	resource:default new connection
2020-08-31T01:13:39.469971Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:13:39.470025Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:39.470400Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:39.470426Z	error	sds	Remote side closed connection
2020-08-31T01:13:39.470630Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest85b97c5b-7585-4e51-aeb8-ad47fc1eb587.sock: use of closed network connection
2020-08-31T01:13:39.565341Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:39.565657Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:40.168932Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:40.335197Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:40.470812Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:13:40.638231Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:40.639355Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:40.941665Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:41.060925Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:41.062573Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:13:41.502801Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0075188c-85e5-4214-a4ba-29fbea41ef51.sock" 

2020-08-31T01:13:41.502854Z	info	sds	Start SDS grpc server
2020-08-31T01:13:41.545880Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:41.545928Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:41.565574Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:41.565740Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:41.849196Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:42.150932Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:42.169082Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:42.471019Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:42.503729Z	info	sds	resource:default new connection
2020-08-31T01:13:42.503793Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:13:42.512518Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:13:42.578254Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:13:42.578303Z	info	cache	GenerateSecret default
2020-08-31T01:13:42.578372Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:42.578744Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0075188c-85e5-4214-a4ba-29fbea41ef51.sock: use of closed network connection
PASS
2020-08-31T01:13:42.578876Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:42.578917Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.572s
2020-08-31T01:13:47.861553Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfe83cce9-79d6-40a5-88db-a19eb62ef53d.sock" 

2020-08-31T01:13:47.861668Z	info	sds	Start SDS grpc server
2020-08-31T01:13:47.862913Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:13:47.862974Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:13:47.863335Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:48.862812Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:48.862875Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:13:49.863742Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:13:49.863869Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:13:49.863906Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:13:49.863980Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:49.864269Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfe83cce9-79d6-40a5-88db-a19eb62ef53d.sock: use of closed network connection
2020-08-31T01:13:49.864374Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:49.864392Z	error	sds	Remote side closed connection
2020-08-31T01:13:49.864511Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"bf9d4be2-5c83-41c5-ae05-8931cac32de8\".sock" 

2020-08-31T01:13:49.864557Z	info	sds	Start SDS grpc server
2020-08-31T01:13:50.165593Z	info	sds	resource:default new connection
2020-08-31T01:13:50.165650Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:13:50.165706Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:50.165937Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:50.165967Z	error	sds	Remote side closed connection
2020-08-31T01:13:50.166923Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:13:50.166988Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:13:50.167192Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:13:50.167499Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:50.167521Z	error	sds	Remote side closed connection
2020-08-31T01:13:50.167710Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"bf9d4be2-5c83-41c5-ae05-8931cac32de8".sock: use of closed network connection
2020-08-31T01:13:50.167899Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"527e7af5-a8a2-494e-b42c-cbdbc3ad1a22\".sock" 

2020-08-31T01:13:50.167929Z	info	sds	Start SDS grpc server
2020-08-31T01:13:50.168368Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:13:50.168410Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:13:50.168445Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:13:50.168762Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:50.168784Z	error	sds	Remote side closed connection
2020-08-31T01:13:50.168912Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"527e7af5-a8a2-494e-b42c-cbdbc3ad1a22".sock: use of closed network connection
2020-08-31T01:13:50.169069Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4d115c07-93fe-4c0d-aba6-f29ee044f1c8\".sock" 

2020-08-31T01:13:50.169082Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:50.470097Z	info	sds	resource:default new connection
2020-08-31T01:13:50.470174Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:13:50.470239Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:50.470518Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:50.470536Z	error	sds	Remote side closed connection
2020-08-31T01:13:50.470798Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4d115c07-93fe-4c0d-aba6-f29ee044f1c8".sock: use of closed network connection
2020-08-31T01:13:50.471037Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"be9e248f-d40d-44c1-9de7-f89752c0afb2\".sock" 

2020-08-31T01:13:50.471058Z	info	sds	Start SDS grpc server
2020-08-31T01:13:50.471104Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0f6044bc-83bb-4581-b9fb-f0dd9012d2a7\".sock" 

2020-08-31T01:13:50.471138Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:50.772109Z	info	sds	resource:default new connection
2020-08-31T01:13:50.772161Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:13:50.772211Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:50.772574Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:50.772600Z	error	sds	Remote side closed connection
2020-08-31T01:13:50.773261Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:13:50.773296Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:13:50.773337Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:13:50.773557Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:50.773578Z	error	sds	Remote side closed connection
2020-08-31T01:13:50.864527Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:51.074535Z	info	sds	resource:default new connection
2020-08-31T01:13:51.074588Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:13:51.074645Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:51.075002Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:51.075033Z	error	sds	Remote side closed connection
2020-08-31T01:13:51.075240Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"be9e248f-d40d-44c1-9de7-f89752c0afb2".sock: use of closed network connection
2020-08-31T01:13:51.075310Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0f6044bc-83bb-4581-b9fb-f0dd9012d2a7".sock: use of closed network connection
2020-08-31T01:13:51.075602Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c6b9725c-d606-44c1-997d-7e94222b5492\".sock" 

2020-08-31T01:13:51.075655Z	info	sds	Start SDS grpc server
2020-08-31T01:13:51.167927Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:51.169050Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:13:51.378158Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c6b9725c-d606-44c1-997d-7e94222b5492".sock: use of closed network connection
2020-08-31T01:13:51.378387Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a54d5158-564d-4d03-8e24-f8e45775c678\".sock" 

2020-08-31T01:13:51.378412Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:13:51.471012Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:13:51.680190Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a54d5158-564d-4d03-8e24-f8e45775c678".sock: use of closed network connection
2020-08-31T01:13:51.680421Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestb15be552-3a1c-4268-8d92-dced15dd2cb5.sock" 

2020-08-31T01:13:51.680439Z	info	sds	Start SDS grpc server
2020-08-31T01:13:51.680484Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"500e1667-a657-411c-b889-492de2548038\".sock" 

2020-08-31T01:13:51.680492Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:13:52.075463Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:52.075463Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:13:52.285969Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestb15be552-3a1c-4268-8d92-dced15dd2cb5.sock: use of closed network connection
2020-08-31T01:13:52.286043Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"500e1667-a657-411c-b889-492de2548038".sock: use of closed network connection
2020-08-31T01:13:52.286317Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest9974bce2-afc6-4c33-8a44-b7780ef3a976.sock" 

2020-08-31T01:13:52.286355Z	info	sds	Start SDS grpc server
2020-08-31T01:13:52.378364Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:52.587506Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:13:52.587597Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:52.587862Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest9974bce2-afc6-4c33-8a44-b7780ef3a976.sock: use of closed network connection
2020-08-31T01:13:52.588091Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest91bcb344-f2b1-4006-a1ba-6f9599fbcd4d.sock" 

2020-08-31T01:13:52.588110Z	info	sds	Start SDS grpc server
2020-08-31T01:13:52.588940Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:13:52.588991Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:13:52.589036Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:52.589083Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:13:52.589144Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:13:52.589182Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:13:52.680404Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:52.864713Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:53.168100Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:53.169192Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:53.286200Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:53.286248Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:53.471245Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:53.588042Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:53.589270Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:53.589304Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:13:54.075715Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:54.075750Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:54.378596Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:54.590219Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:54.590628Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest91bcb344-f2b1-4006-a1ba-6f9599fbcd4d.sock: use of closed network connection
2020-08-31T01:13:54.590743Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:54.590782Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:54.590773Z	error	sds	Remote side closed connection
2020-08-31T01:13:54.590815Z	error	sds	Remote side closed connection
2020-08-31T01:13:54.590873Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest243a96ce-333a-453e-ac7b-28240aaac075.sock" 

2020-08-31T01:13:54.590972Z	info	sds	Start SDS grpc server
2020-08-31T01:13:54.591735Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:13:54.591789Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:13:54.591838Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:54.592263Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:13:54.591837199 +0000 UTC m=+6.805438759 and is waiting for next SDS request
2020-08-31T01:13:54.592282Z	info	sds	Dynamic push for secret default
2020-08-31T01:13:54.592295Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest243a96ce-333a-453e-ac7b-28240aaac075.sock: use of closed network connection
2020-08-31T01:13:54.592362Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:54.592388Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:54.592389Z	error	sds	Remote side closed connection
2020-08-31T01:13:54.592411Z	error	sds	Remote side closed connection
2020-08-31T01:13:54.592477Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbfcf18f7-b943-45d8-aac3-7f809f8d8e1d.sock" 

2020-08-31T01:13:54.592500Z	info	sds	Start SDS grpc server
2020-08-31T01:13:54.593495Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:13:54.593539Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:13:54.593581Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:54.594319Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:13:54.680513Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:55.094444Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:55.094502Z	info	sds	Dynamic push for secret default
2020-08-31T01:13:55.095159Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbfcf18f7-b943-45d8-aac3-7f809f8d8e1d.sock: use of closed network connection
2020-08-31T01:13:55.095308Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:55.095313Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:55.095347Z	error	sds	Remote side closed connection
2020-08-31T01:13:55.095333Z	error	sds	Remote side closed connection
2020-08-31T01:13:55.095408Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf586d5d7-18b9-4d30-87c6-cbd469e70613.sock" 

2020-08-31T01:13:55.095456Z	info	sds	Start SDS grpc server
2020-08-31T01:13:55.095633Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf586d5d7-18b9-4d30-87c6-cbd469e70613.sock: use of closed network connection
2020-08-31T01:13:55.095707Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8662d37d-c251-46cf-acd7-16129e55026e.sock" 

2020-08-31T01:13:55.095727Z	info	sds	Start SDS grpc server
2020-08-31T01:13:55.286429Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:55.286462Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:55.396634Z	info	sds	resource:default new connection
2020-08-31T01:13:55.396707Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:13:55.396762Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:55.397053Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:55.397100Z	error	sds	Remote side closed connection
2020-08-31T01:13:55.588321Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:55.590903Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:55.592502Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:55.698142Z	info	sds	resource:default new connection
2020-08-31T01:13:55.698205Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:13:55.698261Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:55.698603Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:55.698631Z	error	sds	Remote side closed connection
2020-08-31T01:13:55.698881Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8662d37d-c251-46cf-acd7-16129e55026e.sock: use of closed network connection
2020-08-31T01:13:55.699004Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest91ce2af6-650e-4e8e-a925-8de7c642d095.sock" 

2020-08-31T01:13:55.699036Z	info	sds	Start SDS grpc server
2020-08-31T01:13:55.999994Z	info	sds	resource:default new connection
2020-08-31T01:13:56.000118Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:13:56.000194Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:56.000573Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:13:56.000601Z	error	sds	Remote side closed connection
2020-08-31T01:13:56.000899Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest91ce2af6-650e-4e8e-a925-8de7c642d095.sock: use of closed network connection
2020-08-31T01:13:56.095383Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:56.095675Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:56.699093Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:56.864991Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:57.001055Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:13:57.168332Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:57.169359Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:57.471385Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:57.591152Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:57.592736Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:13:58.034367Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest716c7a1c-8f07-490d-8a9a-38d72915e3af.sock" 

2020-08-31T01:13:58.034420Z	info	sds	Start SDS grpc server
2020-08-31T01:13:58.075990Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:58.075994Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:58.095662Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:58.095732Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:58.378835Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:58.680783Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:13:58.699341Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:59.001197Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:13:59.035215Z	info	sds	resource:default new connection
2020-08-31T01:13:59.035295Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:13:59.045844Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:13:59.133523Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:13:59.133569Z	info	cache	GenerateSecret default
2020-08-31T01:13:59.133631Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:13:59.133970Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest716c7a1c-8f07-490d-8a9a-38d72915e3af.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.595s
2020-08-31T01:14:04.337585Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd5de14ed-862d-461c-bd1c-a64a904d8f25.sock" 

2020-08-31T01:14:04.337669Z	info	sds	Start SDS grpc server
2020-08-31T01:14:04.339008Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:14:04.339081Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:14:04.339475Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:05.338996Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:05.339052Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:14:06.339864Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:14:06.339946Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:14:06.339981Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:14:06.340052Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:06.340288Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd5de14ed-862d-461c-bd1c-a64a904d8f25.sock: use of closed network connection
2020-08-31T01:14:06.340430Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:06.340457Z	error	sds	Remote side closed connection
2020-08-31T01:14:06.340616Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"706c2ff5-f7e1-4201-8ee2-fb6b01d80b98\".sock" 

2020-08-31T01:14:06.340710Z	info	sds	Start SDS grpc server
2020-08-31T01:14:06.641674Z	info	sds	resource:default new connection
2020-08-31T01:14:06.641731Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:14:06.641787Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:06.642063Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:06.642125Z	error	sds	Remote side closed connection
2020-08-31T01:14:06.642547Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:14:06.642582Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:14:06.642727Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:14:06.642987Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:06.642998Z	error	sds	Remote side closed connection
2020-08-31T01:14:06.643286Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"706c2ff5-f7e1-4201-8ee2-fb6b01d80b98".sock: use of closed network connection
2020-08-31T01:14:06.643494Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"46ee3d55-ff84-4992-a96a-437e99c30c25\".sock" 

2020-08-31T01:14:06.643573Z	info	sds	Start SDS grpc server
2020-08-31T01:14:06.644020Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:14:06.644059Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:14:06.644105Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:14:06.644356Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:06.644376Z	error	sds	Remote side closed connection
2020-08-31T01:14:06.644520Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"46ee3d55-ff84-4992-a96a-437e99c30c25".sock: use of closed network connection
2020-08-31T01:14:06.644729Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"37790eba-997f-4613-8f4d-e10707f40614\".sock" 

2020-08-31T01:14:06.644765Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:06.945822Z	info	sds	resource:default new connection
2020-08-31T01:14:06.945895Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:14:06.945974Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:06.946283Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:06.946320Z	error	sds	Remote side closed connection
2020-08-31T01:14:06.946440Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"37790eba-997f-4613-8f4d-e10707f40614".sock: use of closed network connection
2020-08-31T01:14:06.946633Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cd2d8380-486f-4e9b-a0da-27915cdf42c8\".sock" 

2020-08-31T01:14:06.946688Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d2a91b11-4065-4757-859d-233223900884\".sock" 

2020-08-31T01:14:06.946704Z	info	sds	Start SDS grpc server
2020-08-31T01:14:06.946729Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:07.247675Z	info	sds	resource:default new connection
2020-08-31T01:14:07.247728Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:14:07.247781Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:07.248130Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:07.248162Z	error	sds	Remote side closed connection
2020-08-31T01:14:07.248748Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:14:07.248803Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:14:07.248839Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:14:07.249190Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:07.249224Z	error	sds	Remote side closed connection
2020-08-31T01:14:07.340371Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:07.550134Z	info	sds	resource:default new connection
2020-08-31T01:14:07.550208Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:14:07.550307Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:07.550629Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:07.550655Z	error	sds	Remote side closed connection
2020-08-31T01:14:07.550933Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cd2d8380-486f-4e9b-a0da-27915cdf42c8".sock: use of closed network connection
2020-08-31T01:14:07.550977Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d2a91b11-4065-4757-859d-233223900884".sock: use of closed network connection
2020-08-31T01:14:07.551187Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5f7e5697-caf8-44ac-9155-c63545b07580\".sock" 

2020-08-31T01:14:07.551209Z	info	sds	Start SDS grpc server
2020-08-31T01:14:07.643500Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:07.644707Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:14:07.854154Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5f7e5697-caf8-44ac-9155-c63545b07580".sock: use of closed network connection
2020-08-31T01:14:07.854336Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b8fe4029-c66e-4c71-a2a6-e96798fa72ba\".sock" 

2020-08-31T01:14:07.854367Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:07.946667Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:14:08.155865Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b8fe4029-c66e-4c71-a2a6-e96798fa72ba".sock: use of closed network connection
2020-08-31T01:14:08.156045Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestf1312c50-ccfd-4219-bdb9-a1ba9abfe4aa.sock" 

2020-08-31T01:14:08.156100Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6813c463-cc87-48c7-a9f0-530f3bfea279\".sock" 

2020-08-31T01:14:08.156132Z	info	sds	Start SDS grpc server
2020-08-31T01:14:08.156145Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:14:08.551157Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:08.551193Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:14:08.759958Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestf1312c50-ccfd-4219-bdb9-a1ba9abfe4aa.sock: use of closed network connection
2020-08-31T01:14:08.760032Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6813c463-cc87-48c7-a9f0-530f3bfea279".sock: use of closed network connection
2020-08-31T01:14:08.760209Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest8e7c0294-ade6-447f-bc2a-2e9cc73779d0.sock" 

2020-08-31T01:14:08.760231Z	info	sds	Start SDS grpc server
2020-08-31T01:14:08.854311Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:09.061366Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:14:09.061478Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:09.061729Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest8e7c0294-ade6-447f-bc2a-2e9cc73779d0.sock: use of closed network connection
2020-08-31T01:14:09.062039Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest203c3574-441f-4dc5-a332-665404044c85.sock" 

2020-08-31T01:14:09.062146Z	info	sds	Start SDS grpc server
2020-08-31T01:14:09.062767Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:14:09.062816Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:14:09.063394Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:09.063665Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:14:09.063723Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:14:09.063760Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:14:09.156083Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:09.340641Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:09.643783Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:09.644876Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:09.760170Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:09.760199Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:09.946792Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:10.061942Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:10.063691Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:10.063733Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:14:10.551441Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:10.551491Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:10.854546Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:11.064630Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:11.065086Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest203c3574-441f-4dc5-a332-665404044c85.sock: use of closed network connection
2020-08-31T01:14:11.065140Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:11.065165Z	error	sds	Remote side closed connection
2020-08-31T01:14:11.065201Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:11.065236Z	error	sds	Remote side closed connection
2020-08-31T01:14:11.065410Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest65b0062e-a2b4-42b4-97ed-b98bcc8208fb.sock" 

2020-08-31T01:14:11.065492Z	info	sds	Start SDS grpc server
2020-08-31T01:14:11.067181Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:14:11.067272Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:14:11.067358Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:11.068689Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:14:11.067356923 +0000 UTC m=+6.805611357 and is waiting for next SDS request
2020-08-31T01:14:11.068722Z	info	sds	Dynamic push for secret default
2020-08-31T01:14:11.068737Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest65b0062e-a2b4-42b4-97ed-b98bcc8208fb.sock: use of closed network connection
2020-08-31T01:14:11.068817Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:11.068848Z	error	sds	Remote side closed connection
2020-08-31T01:14:11.068844Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:11.068902Z	error	sds	Remote side closed connection
2020-08-31T01:14:11.069035Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1ac07e90-684a-46fa-8f5b-272ca47edb57.sock" 

2020-08-31T01:14:11.069048Z	info	sds	Start SDS grpc server
2020-08-31T01:14:11.069980Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:14:11.070029Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:14:11.070075Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:11.070647Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:14:11.156330Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:11.570733Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:11.570791Z	info	sds	Dynamic push for secret default
2020-08-31T01:14:11.571396Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1ac07e90-684a-46fa-8f5b-272ca47edb57.sock: use of closed network connection
2020-08-31T01:14:11.571478Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:11.571506Z	error	sds	Remote side closed connection
2020-08-31T01:14:11.571527Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:11.571546Z	error	sds	Remote side closed connection
2020-08-31T01:14:11.571621Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest98d93692-eb54-448d-ab33-57f97656bd52.sock" 

2020-08-31T01:14:11.571694Z	info	sds	Start SDS grpc server
2020-08-31T01:14:11.571833Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest98d93692-eb54-448d-ab33-57f97656bd52.sock: use of closed network connection
2020-08-31T01:14:11.571927Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcac13eb4-4061-41fc-a943-b4e1aaad0ba3.sock" 

2020-08-31T01:14:11.571953Z	info	sds	Start SDS grpc server
2020-08-31T01:14:11.760408Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:11.760459Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:11.872891Z	info	sds	resource:default new connection
2020-08-31T01:14:11.872946Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:14:11.872998Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:11.873267Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:11.873329Z	error	sds	Remote side closed connection
2020-08-31T01:14:12.062198Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:12.065276Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:12.068826Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:12.174281Z	info	sds	resource:default new connection
2020-08-31T01:14:12.174345Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:14:12.174419Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:12.174700Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:12.174716Z	error	sds	Remote side closed connection
2020-08-31T01:14:12.175003Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcac13eb4-4061-41fc-a943-b4e1aaad0ba3.sock: use of closed network connection
2020-08-31T01:14:12.175148Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc0a695ec-b1ab-4542-aee3-f64cad29c5de.sock" 

2020-08-31T01:14:12.175182Z	info	sds	Start SDS grpc server
2020-08-31T01:14:12.476236Z	info	sds	resource:default new connection
2020-08-31T01:14:12.476299Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:14:12.476365Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:12.476737Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:12.476764Z	error	sds	Remote side closed connection
2020-08-31T01:14:12.477082Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc0a695ec-b1ab-4542-aee3-f64cad29c5de.sock: use of closed network connection
2020-08-31T01:14:12.571566Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:12.571958Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:13.175201Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:13.340921Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:13.477202Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:14:13.644035Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:13.645059Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:13.947045Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:14.065485Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:14.068971Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:14:14.506556Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest27c73dbc-db80-489c-97bf-af2ed6e9f469.sock" 

2020-08-31T01:14:14.506615Z	info	sds	Start SDS grpc server
2020-08-31T01:14:14.551688Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:14.551736Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:14.571859Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:14.572047Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:14.854854Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:15.156547Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:15.175426Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:15.477407Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:15.507559Z	info	sds	resource:default new connection
2020-08-31T01:14:15.507621Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:14:15.512211Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:14:15.579904Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:14:15.579947Z	info	cache	GenerateSecret default
2020-08-31T01:14:15.580047Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:15.580465Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest27c73dbc-db80-489c-97bf-af2ed6e9f469.sock: use of closed network connection
PASS
2020-08-31T01:14:15.580571Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:15.580603Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.564s
2020-08-31T01:14:20.835375Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest299c2634-58e8-4508-821d-b6288bc82543.sock" 

2020-08-31T01:14:20.835505Z	info	sds	Start SDS grpc server
2020-08-31T01:14:20.836930Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:14:20.837048Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:14:20.837487Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:21.836986Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:21.837245Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:14:22.837830Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:14:22.837914Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:14:22.837943Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:14:22.838015Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:22.838268Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest299c2634-58e8-4508-821d-b6288bc82543.sock: use of closed network connection
2020-08-31T01:14:22.838350Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:22.838371Z	error	sds	Remote side closed connection
2020-08-31T01:14:22.838508Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"bdc20540-e322-4656-ba6a-a407ca1bae3c\".sock" 

2020-08-31T01:14:22.838544Z	info	sds	Start SDS grpc server
2020-08-31T01:14:23.139862Z	info	sds	resource:default new connection
2020-08-31T01:14:23.139919Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:14:23.139974Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:23.140260Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:23.140286Z	error	sds	Remote side closed connection
2020-08-31T01:14:23.141115Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:14:23.141244Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:14:23.141473Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:14:23.141801Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:23.141819Z	error	sds	Remote side closed connection
2020-08-31T01:14:23.142112Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"bdc20540-e322-4656-ba6a-a407ca1bae3c".sock: use of closed network connection
2020-08-31T01:14:23.142384Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d30af5d2-7587-4ae0-a725-e9861f01ebe4\".sock" 

2020-08-31T01:14:23.142465Z	info	sds	Start SDS grpc server
2020-08-31T01:14:23.143076Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:14:23.143109Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:14:23.143150Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:14:23.143476Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:23.143498Z	error	sds	Remote side closed connection
2020-08-31T01:14:23.143706Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d30af5d2-7587-4ae0-a725-e9861f01ebe4".sock: use of closed network connection
2020-08-31T01:14:23.143868Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2dd27459-0a8a-48d3-baad-eceaab20c787\".sock" 

2020-08-31T01:14:23.143905Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:23.445184Z	info	sds	resource:default new connection
2020-08-31T01:14:23.445259Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:14:23.445314Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:23.445853Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:23.445881Z	error	sds	Remote side closed connection
2020-08-31T01:14:23.446199Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2dd27459-0a8a-48d3-baad-eceaab20c787".sock: use of closed network connection
2020-08-31T01:14:23.446425Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c004cd1c-82f0-4486-a51b-bffbffa873a9\".sock" 

2020-08-31T01:14:23.446486Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"679a48a4-3206-41f3-bc65-192d54f0c1ce\".sock" 

2020-08-31T01:14:23.446479Z	info	sds	Start SDS grpc server
2020-08-31T01:14:23.446513Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:23.747721Z	info	sds	resource:default new connection
2020-08-31T01:14:23.747839Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:14:23.747913Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:23.748395Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:23.748423Z	error	sds	Remote side closed connection
2020-08-31T01:14:23.749002Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:14:23.749064Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:14:23.749117Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:14:23.749422Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:23.749441Z	error	sds	Remote side closed connection
2020-08-31T01:14:23.838563Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:24.051300Z	info	sds	resource:default new connection
2020-08-31T01:14:24.051406Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:14:24.051464Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:24.051866Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:24.051902Z	error	sds	Remote side closed connection
2020-08-31T01:14:24.052002Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c004cd1c-82f0-4486-a51b-bffbffa873a9".sock: use of closed network connection
2020-08-31T01:14:24.052048Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"679a48a4-3206-41f3-bc65-192d54f0c1ce".sock: use of closed network connection
2020-08-31T01:14:24.052212Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4f6b6253-6be6-4287-b7f0-48eb3d591353\".sock" 

2020-08-31T01:14:24.052232Z	info	sds	Start SDS grpc server
2020-08-31T01:14:24.142243Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:24.143981Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:14:24.355227Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4f6b6253-6be6-4287-b7f0-48eb3d591353".sock: use of closed network connection
2020-08-31T01:14:24.355500Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8e3a80b2-ca3a-4f53-a2b6-cde87e0dc328\".sock" 

2020-08-31T01:14:24.355535Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:24.446307Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:14:24.657445Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8e3a80b2-ca3a-4f53-a2b6-cde87e0dc328".sock: use of closed network connection
2020-08-31T01:14:24.657686Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestf089d1b9-fcb5-4eeb-8416-2393641188c0.sock" 

2020-08-31T01:14:24.657749Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"53bc1c27-f8c8-4f33-bec4-fc31dd713f74\".sock" 

2020-08-31T01:14:24.657787Z	info	sds	Start SDS grpc server
2020-08-31T01:14:24.657811Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:14:25.052361Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:25.052415Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:14:25.262669Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestf089d1b9-fcb5-4eeb-8416-2393641188c0.sock: use of closed network connection
2020-08-31T01:14:25.262723Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"53bc1c27-f8c8-4f33-bec4-fc31dd713f74".sock: use of closed network connection
2020-08-31T01:14:25.262886Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta5652ae3-f53d-4f67-b437-e03668187198.sock" 

2020-08-31T01:14:25.262892Z	info	sds	Start SDS grpc server
2020-08-31T01:14:25.355547Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:25.564185Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:14:25.564283Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:25.564536Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta5652ae3-f53d-4f67-b437-e03668187198.sock: use of closed network connection
2020-08-31T01:14:25.564805Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaa5ef2da-11f2-49d0-83fa-3ffe17562a65.sock" 

2020-08-31T01:14:25.564858Z	info	sds	Start SDS grpc server
2020-08-31T01:14:25.565908Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:14:25.565974Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:14:25.566030Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:14:25.566712Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:14:25.566757Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:14:25.566793Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:25.657748Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:25.838931Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:26.142536Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:26.144237Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:26.262765Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:26.262830Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:26.446602Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:26.564824Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:26.566766Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:26.566806Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:14:27.052595Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:27.052645Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:27.355781Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:27.567719Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:27.568090Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaa5ef2da-11f2-49d0-83fa-3ffe17562a65.sock: use of closed network connection
2020-08-31T01:14:27.568114Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:27.568138Z	error	sds	Remote side closed connection
2020-08-31T01:14:27.568172Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:27.568194Z	error	sds	Remote side closed connection
2020-08-31T01:14:27.568364Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfa0c6c3c-ffe6-473b-8fb3-bb3ca9ecc70c.sock" 

2020-08-31T01:14:27.568464Z	info	sds	Start SDS grpc server
2020-08-31T01:14:27.569141Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:14:27.569184Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:14:27.569229Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:27.569668Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:14:27.569228963 +0000 UTC m=+6.815175861 and is waiting for next SDS request
2020-08-31T01:14:27.569691Z	info	sds	Dynamic push for secret default
2020-08-31T01:14:27.569675Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfa0c6c3c-ffe6-473b-8fb3-bb3ca9ecc70c.sock: use of closed network connection
2020-08-31T01:14:27.569721Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:27.569727Z	error	sds	Remote side closed connection
2020-08-31T01:14:27.569746Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:27.569763Z	error	sds	Remote side closed connection
2020-08-31T01:14:27.569876Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestda72c8bc-8b18-4081-81d4-bb7999a099c4.sock" 

2020-08-31T01:14:27.569915Z	info	sds	Start SDS grpc server
2020-08-31T01:14:27.570516Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:14:27.570560Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:14:27.570593Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:27.571068Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:14:27.657961Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:28.071305Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:28.071364Z	info	sds	Dynamic push for secret default
2020-08-31T01:14:28.072142Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestda72c8bc-8b18-4081-81d4-bb7999a099c4.sock: use of closed network connection
2020-08-31T01:14:28.072258Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:28.072266Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:28.072288Z	error	sds	Remote side closed connection
2020-08-31T01:14:28.072301Z	error	sds	Remote side closed connection
2020-08-31T01:14:28.072422Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd30b3895-6992-4773-a892-c8e410410a7c.sock" 

2020-08-31T01:14:28.072531Z	info	sds	Start SDS grpc server
2020-08-31T01:14:28.072628Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd30b3895-6992-4773-a892-c8e410410a7c.sock: use of closed network connection
2020-08-31T01:14:28.072786Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest874c0d4a-ac14-44e1-a66c-4e305a86580c.sock" 

2020-08-31T01:14:28.072816Z	info	sds	Start SDS grpc server
2020-08-31T01:14:28.263078Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:28.263129Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:28.374545Z	info	sds	resource:default new connection
2020-08-31T01:14:28.374623Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:14:28.374706Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:28.375997Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:28.376022Z	error	sds	Remote side closed connection
2020-08-31T01:14:28.565084Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:28.568301Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:28.569858Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:28.677111Z	info	sds	resource:default new connection
2020-08-31T01:14:28.677191Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:14:28.677250Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:28.677549Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:28.677575Z	error	sds	Remote side closed connection
2020-08-31T01:14:28.677846Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest874c0d4a-ac14-44e1-a66c-4e305a86580c.sock: use of closed network connection
2020-08-31T01:14:28.677970Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1ebcac60-4d92-4ca1-be7c-575d01b6230d.sock" 

2020-08-31T01:14:28.677992Z	info	sds	Start SDS grpc server
2020-08-31T01:14:28.979161Z	info	sds	resource:default new connection
2020-08-31T01:14:28.979227Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:14:28.979282Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:28.979616Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:28.979672Z	error	sds	Remote side closed connection
2020-08-31T01:14:28.979946Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1ebcac60-4d92-4ca1-be7c-575d01b6230d.sock: use of closed network connection
2020-08-31T01:14:29.072405Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:29.072690Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:29.678058Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:29.839208Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:29.980174Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:14:30.142794Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:30.144511Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:30.446857Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:30.568572Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:30.570055Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:14:31.011618Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfc5a925d-774b-4f13-a0b1-7c17beba52bb.sock" 

2020-08-31T01:14:31.011667Z	info	sds	Start SDS grpc server
2020-08-31T01:14:31.052923Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:31.052956Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:31.072705Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:31.072778Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:31.356033Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:31.658228Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:31.678393Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:31.980396Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:32.012473Z	info	sds	resource:default new connection
2020-08-31T01:14:32.012599Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:14:32.018384Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:14:32.187534Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:14:32.187583Z	info	cache	GenerateSecret default
2020-08-31T01:14:32.187645Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:32.188017Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfc5a925d-774b-4f13-a0b1-7c17beba52bb.sock: use of closed network connection
PASS
2020-08-31T01:14:32.188114Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.681s
2020-08-31T01:14:37.417823Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd2f8ac94-7aee-4294-96ba-77399f5f5f96.sock" 

2020-08-31T01:14:37.417926Z	info	sds	Start SDS grpc server
2020-08-31T01:14:37.419142Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:14:37.419211Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:14:37.419662Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:38.419076Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:38.419133Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:14:39.419903Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:14:39.419981Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:14:39.420007Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:14:39.420062Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:39.420315Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd2f8ac94-7aee-4294-96ba-77399f5f5f96.sock: use of closed network connection
2020-08-31T01:14:39.420476Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:39.420499Z	error	sds	Remote side closed connection
2020-08-31T01:14:39.420607Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7903759b-a1ca-48ef-bbbd-d385f887a72c\".sock" 

2020-08-31T01:14:39.420646Z	info	sds	Start SDS grpc server
2020-08-31T01:14:39.721626Z	info	sds	resource:default new connection
2020-08-31T01:14:39.721689Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:14:39.721777Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:39.722219Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:39.722243Z	error	sds	Remote side closed connection
2020-08-31T01:14:39.722822Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:14:39.722880Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:14:39.723057Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:14:39.723277Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:39.723301Z	error	sds	Remote side closed connection
2020-08-31T01:14:39.723509Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7903759b-a1ca-48ef-bbbd-d385f887a72c".sock: use of closed network connection
2020-08-31T01:14:39.723744Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ba12a3de-e28b-425e-b833-a16811336f12\".sock" 

2020-08-31T01:14:39.723789Z	info	sds	Start SDS grpc server
2020-08-31T01:14:39.724203Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:14:39.724234Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:14:39.724267Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:14:39.724496Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:39.724530Z	error	sds	Remote side closed connection
2020-08-31T01:14:39.724826Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ba12a3de-e28b-425e-b833-a16811336f12".sock: use of closed network connection
2020-08-31T01:14:39.725095Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"889ae39f-e03f-4716-9a4a-bd8966e9ac29\".sock" 

2020-08-31T01:14:39.725137Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:40.026223Z	info	sds	resource:default new connection
2020-08-31T01:14:40.026322Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:14:40.026395Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:40.026717Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:40.026747Z	error	sds	Remote side closed connection
2020-08-31T01:14:40.027018Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"889ae39f-e03f-4716-9a4a-bd8966e9ac29".sock: use of closed network connection
2020-08-31T01:14:40.027237Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"963394f6-f12a-46b1-bd17-19ad7835f909\".sock" 

2020-08-31T01:14:40.027303Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c66c2343-e14d-4e86-b735-a064af548dce\".sock" 

2020-08-31T01:14:40.027336Z	info	sds	Start SDS grpc server
2020-08-31T01:14:40.027358Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:40.328401Z	info	sds	resource:default new connection
2020-08-31T01:14:40.328477Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:14:40.328543Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:40.328872Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:40.328907Z	error	sds	Remote side closed connection
2020-08-31T01:14:40.329468Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:14:40.329507Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:14:40.329553Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:14:40.329787Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:40.329803Z	error	sds	Remote side closed connection
2020-08-31T01:14:40.420543Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:40.631214Z	info	sds	resource:default new connection
2020-08-31T01:14:40.631277Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:14:40.631330Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:40.631678Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:40.631705Z	error	sds	Remote side closed connection
2020-08-31T01:14:40.631901Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"963394f6-f12a-46b1-bd17-19ad7835f909".sock: use of closed network connection
2020-08-31T01:14:40.631943Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c66c2343-e14d-4e86-b735-a064af548dce".sock: use of closed network connection
2020-08-31T01:14:40.632158Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"18f80062-f751-490c-a0d5-529af3831539\".sock" 

2020-08-31T01:14:40.632166Z	info	sds	Start SDS grpc server
2020-08-31T01:14:40.723697Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:40.724918Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:14:40.934635Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"18f80062-f751-490c-a0d5-529af3831539".sock: use of closed network connection
2020-08-31T01:14:40.934815Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"250e3053-eb89-4187-9bbb-af06756f6fa1\".sock" 

2020-08-31T01:14:40.934837Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:41.027249Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:14:41.236408Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"250e3053-eb89-4187-9bbb-af06756f6fa1".sock: use of closed network connection
2020-08-31T01:14:41.236606Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest7609c9ab-3861-492d-a5d9-5af543af7554.sock" 

2020-08-31T01:14:41.236694Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ff42df31-6348-44f1-816d-bcd399d627bb\".sock" 

2020-08-31T01:14:41.236683Z	info	sds	Start SDS grpc server
2020-08-31T01:14:41.236707Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:14:41.632102Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:41.632097Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:14:41.840923Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest7609c9ab-3861-492d-a5d9-5af543af7554.sock: use of closed network connection
2020-08-31T01:14:41.840977Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ff42df31-6348-44f1-816d-bcd399d627bb".sock: use of closed network connection
2020-08-31T01:14:41.841180Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest6e61dc27-1cce-4900-8eeb-7d6c322cfda0.sock" 

2020-08-31T01:14:41.841188Z	info	sds	Start SDS grpc server
2020-08-31T01:14:41.934783Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:42.142149Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:14:42.142270Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:42.142508Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest6e61dc27-1cce-4900-8eeb-7d6c322cfda0.sock: use of closed network connection
2020-08-31T01:14:42.142739Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4a021816-dcdc-4fe3-9a62-2acbaa511d7c.sock" 

2020-08-31T01:14:42.142781Z	info	sds	Start SDS grpc server
2020-08-31T01:14:42.143448Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:14:42.143497Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:14:42.143583Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:14:42.144174Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:14:42.144241Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:14:42.144297Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:42.236692Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:42.420773Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:42.723967Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:42.725122Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:42.841161Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:42.841218Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:43.027502Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:43.142709Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:43.144275Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:43.144313Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:14:43.646174Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:43.646223Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:43.935028Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:44.145085Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:44.145476Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:44.145493Z	error	sds	Remote side closed connection
2020-08-31T01:14:44.145500Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4a021816-dcdc-4fe3-9a62-2acbaa511d7c.sock: use of closed network connection
2020-08-31T01:14:44.145736Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:44.145766Z	error	sds	Remote side closed connection
2020-08-31T01:14:44.145800Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta8a7b633-5f78-4ac7-9c06-62ce1716ba7d.sock" 

2020-08-31T01:14:44.145869Z	info	sds	Start SDS grpc server
2020-08-31T01:14:44.146617Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:14:44.146661Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:14:44.146706Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:44.147303Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:14:44.146705131 +0000 UTC m=+6.803156195 and is waiting for next SDS request
2020-08-31T01:14:44.147332Z	info	sds	Dynamic push for secret default
2020-08-31T01:14:44.147353Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta8a7b633-5f78-4ac7-9c06-62ce1716ba7d.sock: use of closed network connection
2020-08-31T01:14:44.147469Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:44.147475Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:44.148044Z	error	sds	Remote side closed connection
2020-08-31T01:14:44.147486Z	error	sds	Remote side closed connection
2020-08-31T01:14:44.148251Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste03c8771-3b3b-4c8f-9ac4-fba9b64a2500.sock" 

2020-08-31T01:14:44.148292Z	info	sds	Start SDS grpc server
2020-08-31T01:14:44.150351Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:14:44.150461Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:14:44.150514Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:44.151092Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:14:44.236982Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:44.651228Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:44.651283Z	info	sds	Dynamic push for secret default
2020-08-31T01:14:44.651787Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste03c8771-3b3b-4c8f-9ac4-fba9b64a2500.sock: use of closed network connection
2020-08-31T01:14:44.651853Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:44.651876Z	error	sds	Remote side closed connection
2020-08-31T01:14:44.651943Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:44.651963Z	error	sds	Remote side closed connection
2020-08-31T01:14:44.652074Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4e43faba-839a-485e-a926-fe3ba026bac1.sock" 

2020-08-31T01:14:44.652178Z	info	sds	Start SDS grpc server
2020-08-31T01:14:44.652299Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4e43faba-839a-485e-a926-fe3ba026bac1.sock: use of closed network connection
2020-08-31T01:14:44.652390Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1cfcc49d-bf38-4648-b0f3-04649e05cc75.sock" 

2020-08-31T01:14:44.652409Z	info	sds	Start SDS grpc server
2020-08-31T01:14:44.841349Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:44.841390Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:44.953359Z	info	sds	resource:default new connection
2020-08-31T01:14:44.953412Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:14:44.953463Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:44.953784Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:44.953800Z	error	sds	Remote side closed connection
2020-08-31T01:14:45.142939Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:45.145704Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:45.147543Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:45.254935Z	info	sds	resource:default new connection
2020-08-31T01:14:45.255010Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:14:45.255076Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:45.255336Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:45.255363Z	error	sds	Remote side closed connection
2020-08-31T01:14:45.255714Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1cfcc49d-bf38-4648-b0f3-04649e05cc75.sock: use of closed network connection
2020-08-31T01:14:45.255841Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest26f8276e-9e90-4f47-85ed-5c34646ea6e2.sock" 

2020-08-31T01:14:45.255870Z	info	sds	Start SDS grpc server
2020-08-31T01:14:45.556924Z	info	sds	resource:default new connection
2020-08-31T01:14:45.556995Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:14:45.557062Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:45.557514Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:45.557563Z	error	sds	Remote side closed connection
2020-08-31T01:14:45.557739Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest26f8276e-9e90-4f47-85ed-5c34646ea6e2.sock: use of closed network connection
2020-08-31T01:14:45.652004Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:45.652355Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:46.255956Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:46.421013Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:46.557941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:14:46.724245Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:46.725277Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:47.027685Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:47.145941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:47.147715Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:14:47.586168Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest214e95e4-b8a4-4b31-9e1b-9a925f43c9e1.sock" 

2020-08-31T01:14:47.586217Z	info	sds	Start SDS grpc server
2020-08-31T01:14:47.646441Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:47.646496Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:47.652265Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:47.652500Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:47.935299Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:48.237241Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:48.256088Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:48.558195Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:48.587132Z	info	sds	resource:default new connection
2020-08-31T01:14:48.587210Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:14:48.588562Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:14:48.694538Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:14:48.694586Z	info	cache	GenerateSecret default
2020-08-31T01:14:48.694647Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:48.695007Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest214e95e4-b8a4-4b31-9e1b-9a925f43c9e1.sock: use of closed network connection
PASS
2020-08-31T01:14:48.695057Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:48.695081Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.598s
2020-08-31T01:14:53.935959Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8770433d-a0a4-48ba-af82-9c814e4dffc6.sock" 

2020-08-31T01:14:53.936082Z	info	sds	Start SDS grpc server
2020-08-31T01:14:53.937323Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:14:53.937382Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:14:53.937728Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:54.937211Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:54.937276Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:14:55.937961Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:14:55.938034Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:14:55.938057Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:14:55.938112Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:55.938364Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8770433d-a0a4-48ba-af82-9c814e4dffc6.sock: use of closed network connection
2020-08-31T01:14:55.938510Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:55.938549Z	error	sds	Remote side closed connection
2020-08-31T01:14:55.938606Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4c19c792-c99f-40f2-b68c-de3e34b69785\".sock" 

2020-08-31T01:14:55.938653Z	info	sds	Start SDS grpc server
2020-08-31T01:14:56.239592Z	info	sds	resource:default new connection
2020-08-31T01:14:56.239662Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:14:56.239718Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:56.239995Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:56.240010Z	error	sds	Remote side closed connection
2020-08-31T01:14:56.240578Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:14:56.240618Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:14:56.240808Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:14:56.241043Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:56.241078Z	error	sds	Remote side closed connection
2020-08-31T01:14:56.241420Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4c19c792-c99f-40f2-b68c-de3e34b69785".sock: use of closed network connection
2020-08-31T01:14:56.241689Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c85c2147-19ef-47d8-a0ea-826b77edfcb9\".sock" 

2020-08-31T01:14:56.241774Z	info	sds	Start SDS grpc server
2020-08-31T01:14:56.242142Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:14:56.242170Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:14:56.242201Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:14:56.242445Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:56.242460Z	error	sds	Remote side closed connection
2020-08-31T01:14:56.242743Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c85c2147-19ef-47d8-a0ea-826b77edfcb9".sock: use of closed network connection
2020-08-31T01:14:56.242951Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9ba16fef-e66b-45be-8f1b-aab324371ab4\".sock" 

2020-08-31T01:14:56.242964Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:56.543985Z	info	sds	resource:default new connection
2020-08-31T01:14:56.544045Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:14:56.544101Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:56.544514Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:56.544549Z	error	sds	Remote side closed connection
2020-08-31T01:14:56.544638Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9ba16fef-e66b-45be-8f1b-aab324371ab4".sock: use of closed network connection
2020-08-31T01:14:56.544867Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"007f17d5-5d7e-4f7f-855c-2dd9f4721d19\".sock" 

2020-08-31T01:14:56.544928Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"77eb0fcb-8003-4cfd-b906-3bc9a020683d\".sock" 

2020-08-31T01:14:56.544939Z	info	sds	Start SDS grpc server
2020-08-31T01:14:56.544961Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:56.846019Z	info	sds	resource:default new connection
2020-08-31T01:14:56.846093Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:14:56.846160Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:56.846483Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:56.846526Z	error	sds	Remote side closed connection
2020-08-31T01:14:56.846988Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:14:56.847031Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:14:56.847069Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:14:56.847284Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:56.847307Z	error	sds	Remote side closed connection
2020-08-31T01:14:56.938445Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:57.148809Z	info	sds	resource:default new connection
2020-08-31T01:14:57.148862Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:14:57.148923Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:57.149159Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:57.149187Z	error	sds	Remote side closed connection
2020-08-31T01:14:57.149444Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"007f17d5-5d7e-4f7f-855c-2dd9f4721d19".sock: use of closed network connection
2020-08-31T01:14:57.149488Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"77eb0fcb-8003-4cfd-b906-3bc9a020683d".sock: use of closed network connection
2020-08-31T01:14:57.149668Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"83276be1-68fe-4440-ab1f-fea01e8e1bcb\".sock" 

2020-08-31T01:14:57.149696Z	info	sds	Start SDS grpc server
2020-08-31T01:14:57.241632Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:57.242917Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:14:57.451967Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"83276be1-68fe-4440-ab1f-fea01e8e1bcb".sock: use of closed network connection
2020-08-31T01:14:57.452167Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"78072bd6-784b-44b6-8b87-bbfc783998de\".sock" 

2020-08-31T01:14:57.452189Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:57.544884Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:14:57.753892Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"78072bd6-784b-44b6-8b87-bbfc783998de".sock: use of closed network connection
2020-08-31T01:14:57.754085Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest89820a7a-7140-4c9d-ba62-14ae40b666a3.sock" 

2020-08-31T01:14:57.754146Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"106b6406-79b0-4ed5-84ac-4c119c352cbd\".sock" 

2020-08-31T01:14:57.754178Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:14:57.754187Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:14:58.149661Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:58.149727Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:14:58.363946Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest89820a7a-7140-4c9d-ba62-14ae40b666a3.sock: use of closed network connection
2020-08-31T01:14:58.364001Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"106b6406-79b0-4ed5-84ac-4c119c352cbd".sock: use of closed network connection
2020-08-31T01:14:58.364284Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest85639a0a-e0fd-47ac-aa65-29c2dd2a74f1.sock" 

2020-08-31T01:14:58.364317Z	info	sds	Start SDS grpc server
2020-08-31T01:14:58.452175Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:58.665544Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:14:58.665653Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:14:58.665926Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest85639a0a-e0fd-47ac-aa65-29c2dd2a74f1.sock: use of closed network connection
2020-08-31T01:14:58.666225Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc922fa71-30d2-49c3-a116-53d1b3f9f7c5.sock" 

2020-08-31T01:14:58.666306Z	info	sds	Start SDS grpc server
2020-08-31T01:14:58.667462Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:14:58.667526Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:14:58.667573Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:58.667660Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:14:58.667682Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:14:58.667705Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:14:58.754119Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:58.938696Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:59.241901Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:59.243073Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:59.364167Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:59.364205Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:59.545100Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:14:59.666139Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:14:59.667903Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:14:59.667946Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:15:00.149933Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:00.149993Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:00.452417Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:00.668858Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:00.669160Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc922fa71-30d2-49c3-a116-53d1b3f9f7c5.sock: use of closed network connection
2020-08-31T01:15:00.669223Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:00.669318Z	error	sds	Remote side closed connection
2020-08-31T01:15:00.669283Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:00.669353Z	error	sds	Remote side closed connection
2020-08-31T01:15:00.669402Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest54f34449-83f1-4c7a-9e54-15cb21077788.sock" 

2020-08-31T01:15:00.669516Z	info	sds	Start SDS grpc server
2020-08-31T01:15:00.670105Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:15:00.670145Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:15:00.670197Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:00.670616Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:15:00.670196719 +0000 UTC m=+6.807512621 and is waiting for next SDS request
2020-08-31T01:15:00.670637Z	info	sds	Dynamic push for secret default
2020-08-31T01:15:00.670667Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest54f34449-83f1-4c7a-9e54-15cb21077788.sock: use of closed network connection
2020-08-31T01:15:00.670755Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:00.670782Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:00.670801Z	error	sds	Remote side closed connection
2020-08-31T01:15:00.670823Z	error	sds	Remote side closed connection
2020-08-31T01:15:00.670927Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaf6e26f6-5960-42e8-af58-594fdad42dfa.sock" 

2020-08-31T01:15:00.670986Z	info	sds	Start SDS grpc server
2020-08-31T01:15:00.671651Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:15:00.671700Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:15:00.671736Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:00.672390Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:15:00.754371Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:01.172573Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:01.172638Z	info	sds	Dynamic push for secret default
2020-08-31T01:15:01.173334Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaf6e26f6-5960-42e8-af58-594fdad42dfa.sock: use of closed network connection
2020-08-31T01:15:01.173449Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:01.173477Z	error	sds	Remote side closed connection
2020-08-31T01:15:01.173447Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:01.173527Z	error	sds	Remote side closed connection
2020-08-31T01:15:01.173568Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5b70d949-724f-4a8d-ae2e-b8352f6c51b4.sock" 

2020-08-31T01:15:01.173588Z	info	sds	Start SDS grpc server
2020-08-31T01:15:01.173838Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5b70d949-724f-4a8d-ae2e-b8352f6c51b4.sock: use of closed network connection
2020-08-31T01:15:01.173934Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd54d5aa8-d952-409e-a03d-8f545992bb2f.sock" 

2020-08-31T01:15:01.173938Z	info	sds	Start SDS grpc server
2020-08-31T01:15:01.364459Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:01.364502Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:01.474830Z	info	sds	resource:default new connection
2020-08-31T01:15:01.474884Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:15:01.474933Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:01.475240Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:01.475269Z	error	sds	Remote side closed connection
2020-08-31T01:15:01.666434Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:01.669355Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:01.670873Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:01.777192Z	info	sds	resource:default new connection
2020-08-31T01:15:01.777274Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:15:01.777357Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:01.777989Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:01.778029Z	error	sds	Remote side closed connection
2020-08-31T01:15:01.778597Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd54d5aa8-d952-409e-a03d-8f545992bb2f.sock: use of closed network connection
2020-08-31T01:15:01.778737Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb51f377d-9ec7-426c-953b-edc9a6d8e6ad.sock" 

2020-08-31T01:15:01.778751Z	info	sds	Start SDS grpc server
2020-08-31T01:15:02.079679Z	info	sds	resource:default new connection
2020-08-31T01:15:02.079773Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:15:02.079827Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:02.080140Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:02.080161Z	error	sds	Remote side closed connection
2020-08-31T01:15:02.080443Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb51f377d-9ec7-426c-953b-edc9a6d8e6ad.sock: use of closed network connection
2020-08-31T01:15:02.173542Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:02.173892Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:02.778825Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:02.938966Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:03.080602Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:15:03.242160Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:03.243214Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:03.545343Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:03.669577Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:03.671112Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:15:04.110192Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest27b52b51-cdd0-4cad-a90d-fceedb1cb370.sock" 

2020-08-31T01:15:04.110306Z	info	sds	Start SDS grpc server
2020-08-31T01:15:04.150164Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:04.150206Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:04.173693Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:04.174099Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:04.452648Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:04.754621Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:04.779085Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:05.080802Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:05.129322Z	info	sds	resource:default new connection
2020-08-31T01:15:05.129381Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:15:05.139097Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:15:05.364605Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:05.364708Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:05.385481Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:15:05.385537Z	info	cache	GenerateSecret default
2020-08-31T01:15:05.385633Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:05.386024Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest27b52b51-cdd0-4cad-a90d-fceedb1cb370.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.774s
2020-08-31T01:15:10.595372Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfedba108-6474-4b48-9b53-1bc663252ce3.sock" 

2020-08-31T01:15:10.595480Z	info	sds	Start SDS grpc server
2020-08-31T01:15:10.597055Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:15:10.597139Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:15:10.597531Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:11.596892Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:11.596945Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:15:12.597752Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:15:12.597853Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:15:12.597885Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:15:12.597955Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:12.598324Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfedba108-6474-4b48-9b53-1bc663252ce3.sock: use of closed network connection
2020-08-31T01:15:12.598447Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:12.598476Z	error	sds	Remote side closed connection
2020-08-31T01:15:12.598636Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cfe6010d-522a-4091-88bb-c7af7ee9c604\".sock" 

2020-08-31T01:15:12.598676Z	info	sds	Start SDS grpc server
2020-08-31T01:15:12.899652Z	info	sds	resource:default new connection
2020-08-31T01:15:12.899726Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:15:12.899802Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:12.900050Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:12.900082Z	error	sds	Remote side closed connection
2020-08-31T01:15:12.900709Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:15:12.900812Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:15:12.901012Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:15:12.901403Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:12.901428Z	error	sds	Remote side closed connection
2020-08-31T01:15:12.901573Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cfe6010d-522a-4091-88bb-c7af7ee9c604".sock: use of closed network connection
2020-08-31T01:15:12.901753Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"352380e5-afa5-4832-8376-786186a4bdb6\".sock" 

2020-08-31T01:15:12.901831Z	info	sds	Start SDS grpc server
2020-08-31T01:15:12.902347Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:15:12.902392Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:15:12.902439Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:15:12.902644Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:12.902676Z	error	sds	Remote side closed connection
2020-08-31T01:15:12.902965Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"352380e5-afa5-4832-8376-786186a4bdb6".sock: use of closed network connection
2020-08-31T01:15:12.903136Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7721c49d-bca3-4e2b-8822-b3a1dcf01298\".sock" 

2020-08-31T01:15:12.903171Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:13.204075Z	info	sds	resource:default new connection
2020-08-31T01:15:13.204140Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:15:13.204207Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:13.204472Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:13.204487Z	error	sds	Remote side closed connection
2020-08-31T01:15:13.204763Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7721c49d-bca3-4e2b-8822-b3a1dcf01298".sock: use of closed network connection
2020-08-31T01:15:13.205008Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ee2e6415-46fa-43ce-9d7e-889441a2821e\".sock" 

2020-08-31T01:15:13.205024Z	info	sds	Start SDS grpc server
2020-08-31T01:15:13.205073Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9012bdc8-39f0-4579-b585-6fe029e7afa3\".sock" 

2020-08-31T01:15:13.205105Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:13.506064Z	info	sds	resource:default new connection
2020-08-31T01:15:13.506132Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:15:13.506198Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:13.506510Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:13.506530Z	error	sds	Remote side closed connection
2020-08-31T01:15:13.507096Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:15:13.507133Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:15:13.507168Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:15:13.507417Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:13.507437Z	error	sds	Remote side closed connection
2020-08-31T01:15:13.598534Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:13.808192Z	info	sds	resource:default new connection
2020-08-31T01:15:13.808282Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:15:13.808336Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:13.808597Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:13.808630Z	error	sds	Remote side closed connection
2020-08-31T01:15:13.808824Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ee2e6415-46fa-43ce-9d7e-889441a2821e".sock: use of closed network connection
2020-08-31T01:15:13.808868Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9012bdc8-39f0-4579-b585-6fe029e7afa3".sock: use of closed network connection
2020-08-31T01:15:13.809035Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5cfbc1a4-5780-4bc7-8791-76c30954ab0c\".sock" 

2020-08-31T01:15:13.809055Z	info	sds	Start SDS grpc server
2020-08-31T01:15:13.901776Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:13.903126Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:15:14.112129Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5cfbc1a4-5780-4bc7-8791-76c30954ab0c".sock: use of closed network connection
2020-08-31T01:15:14.112369Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"df7dd67b-c506-4d5f-ab92-8cc28e22d2bf\".sock" 

2020-08-31T01:15:14.112387Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:14.204952Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:15:14.414108Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"df7dd67b-c506-4d5f-ab92-8cc28e22d2bf".sock: use of closed network connection
2020-08-31T01:15:14.414341Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest071edad4-26cb-4bec-91ef-754bc3a2789e.sock" 

2020-08-31T01:15:14.414398Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"09404448-47b6-4bd8-bfe2-c35ca099d49e\".sock" 

2020-08-31T01:15:14.414403Z	info	sds	Start SDS grpc server
2020-08-31T01:15:14.414448Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:15:14.809002Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:14.809043Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:15:15.018668Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest071edad4-26cb-4bec-91ef-754bc3a2789e.sock: use of closed network connection
2020-08-31T01:15:15.018727Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"09404448-47b6-4bd8-bfe2-c35ca099d49e".sock: use of closed network connection
2020-08-31T01:15:15.018911Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest12e4538b-bfaf-4e5d-989a-46c0d14ca506.sock" 

2020-08-31T01:15:15.018949Z	info	sds	Start SDS grpc server
2020-08-31T01:15:15.112332Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:15.320030Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:15:15.320123Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:15.320376Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest12e4538b-bfaf-4e5d-989a-46c0d14ca506.sock: use of closed network connection
2020-08-31T01:15:15.320583Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestffcb4077-8af3-403c-8478-3814d60966f0.sock" 

2020-08-31T01:15:15.320607Z	info	sds	Start SDS grpc server
2020-08-31T01:15:15.321332Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:15:15.321428Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:15:15.321493Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:15.321574Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:15:15.321628Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:15:15.321663Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:15:15.414339Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:15.598771Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:15.902031Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:15.903278Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:16.018876Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:16.018915Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:16.205171Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:16.320581Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:16.321721Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:16.321826Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:15:16.809223Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:16.809270Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:17.112581Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:17.322539Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:17.322910Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestffcb4077-8af3-403c-8478-3814d60966f0.sock: use of closed network connection
2020-08-31T01:15:17.322960Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:17.322982Z	error	sds	Remote side closed connection
2020-08-31T01:15:17.323029Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:17.323053Z	error	sds	Remote side closed connection
2020-08-31T01:15:17.323173Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest87812a1f-8026-48e6-92bb-2039dd3be425.sock" 

2020-08-31T01:15:17.323195Z	info	sds	Start SDS grpc server
2020-08-31T01:15:17.324032Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:15:17.324084Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:15:17.324142Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:17.324620Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:15:17.324140949 +0000 UTC m=+6.810691654 and is waiting for next SDS request
2020-08-31T01:15:17.324639Z	info	sds	Dynamic push for secret default
2020-08-31T01:15:17.324700Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest87812a1f-8026-48e6-92bb-2039dd3be425.sock: use of closed network connection
2020-08-31T01:15:17.324845Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:17.324845Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:17.324864Z	error	sds	Remote side closed connection
2020-08-31T01:15:17.324880Z	error	sds	Remote side closed connection
2020-08-31T01:15:17.324948Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5734001e-489b-42b2-9550-54e4ff6172ae.sock" 

2020-08-31T01:15:17.324999Z	info	sds	Start SDS grpc server
2020-08-31T01:15:17.325790Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:15:17.325837Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:15:17.325873Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:17.326516Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:15:17.414703Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:17.826620Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:17.826673Z	info	sds	Dynamic push for secret default
2020-08-31T01:15:17.827258Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5734001e-489b-42b2-9550-54e4ff6172ae.sock: use of closed network connection
2020-08-31T01:15:17.827376Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:17.827387Z	error	sds	Remote side closed connection
2020-08-31T01:15:17.827537Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:17.827567Z	error	sds	Remote side closed connection
2020-08-31T01:15:17.827726Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb3d8ab3b-a7e2-480a-bff0-c3460a503bab.sock" 

2020-08-31T01:15:17.827820Z	info	sds	Start SDS grpc server
2020-08-31T01:15:17.828030Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb3d8ab3b-a7e2-480a-bff0-c3460a503bab.sock: use of closed network connection
2020-08-31T01:15:17.828118Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2cbbfb1e-4f3a-4769-a782-f819000446db.sock" 

2020-08-31T01:15:17.828139Z	info	sds	Start SDS grpc server
2020-08-31T01:15:18.019112Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:18.019160Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:18.129120Z	info	sds	resource:default new connection
2020-08-31T01:15:18.129178Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:15:18.129236Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:18.129456Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:18.129467Z	error	sds	Remote side closed connection
2020-08-31T01:15:18.320753Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:18.323093Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:18.324878Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:18.430596Z	info	sds	resource:default new connection
2020-08-31T01:15:18.430659Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:15:18.430721Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:18.431170Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:18.431196Z	error	sds	Remote side closed connection
2020-08-31T01:15:18.431442Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2cbbfb1e-4f3a-4769-a782-f819000446db.sock: use of closed network connection
2020-08-31T01:15:18.431569Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest45b4fd6a-afbc-447d-b0fd-57710540272d.sock" 

2020-08-31T01:15:18.431602Z	info	sds	Start SDS grpc server
2020-08-31T01:15:18.732439Z	info	sds	resource:default new connection
2020-08-31T01:15:18.732505Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:15:18.732567Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:18.732925Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:18.732956Z	error	sds	Remote side closed connection
2020-08-31T01:15:18.733239Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest45b4fd6a-afbc-447d-b0fd-57710540272d.sock: use of closed network connection
2020-08-31T01:15:18.827505Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:18.828187Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:19.431590Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:19.599016Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:19.733453Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:15:19.902281Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:19.903455Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:20.205422Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:20.323296Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:20.325053Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:15:20.764687Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesteb931f6e-3dba-49c2-8ebc-3dfebfc8e157.sock" 

2020-08-31T01:15:20.764752Z	info	sds	Start SDS grpc server
2020-08-31T01:15:20.809542Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:20.809558Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:20.827757Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:20.828353Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:21.112811Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:21.414950Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:21.431823Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:21.733626Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:21.765599Z	info	sds	resource:default new connection
2020-08-31T01:15:21.765657Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:15:21.776197Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:15:21.843088Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:15:21.843131Z	info	cache	GenerateSecret default
2020-08-31T01:15:21.843188Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:21.843620Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesteb931f6e-3dba-49c2-8ebc-3dfebfc8e157.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.577s
2020-08-31T01:15:27.129162Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf5f89332-5ee0-481b-a268-5d4f5104cec7.sock" 

2020-08-31T01:15:27.129258Z	info	sds	Start SDS grpc server
2020-08-31T01:15:27.131929Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:15:27.131995Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:15:27.132406Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:28.131540Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:28.131596Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:15:29.132366Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:15:29.132438Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:15:29.132464Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:15:29.132519Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:29.132766Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf5f89332-5ee0-481b-a268-5d4f5104cec7.sock: use of closed network connection
2020-08-31T01:15:29.132963Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:29.132997Z	error	sds	Remote side closed connection
2020-08-31T01:15:29.133031Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ebe9fd9b-e38f-4031-a308-46ccab7006de\".sock" 

2020-08-31T01:15:29.133057Z	info	sds	Start SDS grpc server
2020-08-31T01:15:29.434211Z	info	sds	resource:default new connection
2020-08-31T01:15:29.434277Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:15:29.434330Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:29.434564Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:29.434590Z	error	sds	Remote side closed connection
2020-08-31T01:15:29.435180Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:15:29.435234Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:15:29.435396Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:15:29.435682Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:29.435703Z	error	sds	Remote side closed connection
2020-08-31T01:15:29.435884Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ebe9fd9b-e38f-4031-a308-46ccab7006de".sock: use of closed network connection
2020-08-31T01:15:29.436049Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"039367a9-f4e6-4730-9977-e4f258aefcd7\".sock" 

2020-08-31T01:15:29.436144Z	info	sds	Start SDS grpc server
2020-08-31T01:15:29.436543Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:15:29.436577Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:15:29.436616Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:15:29.436872Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:29.436897Z	error	sds	Remote side closed connection
2020-08-31T01:15:29.437089Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"039367a9-f4e6-4730-9977-e4f258aefcd7".sock: use of closed network connection
2020-08-31T01:15:29.437244Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b504ccfd-a620-4192-9d52-11ecd0549f7f\".sock" 

2020-08-31T01:15:29.437319Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:29.738171Z	info	sds	resource:default new connection
2020-08-31T01:15:29.738239Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:15:29.738297Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:29.738613Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:29.738639Z	error	sds	Remote side closed connection
2020-08-31T01:15:29.738854Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b504ccfd-a620-4192-9d52-11ecd0549f7f".sock: use of closed network connection
2020-08-31T01:15:29.739041Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"efcd571a-e187-43cb-ab56-21417a11d2b1\".sock" 

2020-08-31T01:15:29.739095Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1bea173e-948c-4a7d-b5fd-ae56c7391a69\".sock" 

2020-08-31T01:15:29.739112Z	info	sds	Start SDS grpc server
2020-08-31T01:15:29.739123Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:30.040158Z	info	sds	resource:default new connection
2020-08-31T01:15:30.040219Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:15:30.040274Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:30.040597Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:30.040612Z	error	sds	Remote side closed connection
2020-08-31T01:15:30.041134Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:15:30.041179Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:15:30.041215Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:15:30.041450Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:30.041476Z	error	sds	Remote side closed connection
2020-08-31T01:15:30.132989Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:30.342552Z	info	sds	resource:default new connection
2020-08-31T01:15:30.342608Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:15:30.342662Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:30.342877Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:30.342956Z	error	sds	Remote side closed connection
2020-08-31T01:15:30.343150Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"efcd571a-e187-43cb-ab56-21417a11d2b1".sock: use of closed network connection
2020-08-31T01:15:30.343194Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1bea173e-948c-4a7d-b5fd-ae56c7391a69".sock: use of closed network connection
2020-08-31T01:15:30.343420Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b8db85dd-0ef9-4ff0-b555-44d36e828072\".sock" 

2020-08-31T01:15:30.343454Z	info	sds	Start SDS grpc server
2020-08-31T01:15:30.436017Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:30.437169Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:15:30.645817Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b8db85dd-0ef9-4ff0-b555-44d36e828072".sock: use of closed network connection
2020-08-31T01:15:30.646019Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4463bfc2-7128-4ab4-ba9b-bb60493783ef\".sock" 

2020-08-31T01:15:30.646051Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:30.739080Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:15:30.947616Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4463bfc2-7128-4ab4-ba9b-bb60493783ef".sock: use of closed network connection
2020-08-31T01:15:30.947810Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestd8fa7777-99cf-4554-a8aa-45cdc7031cb5.sock" 

2020-08-31T01:15:30.947867Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5d75cd1e-1c7c-4a96-8767-e39fa3899977\".sock" 

2020-08-31T01:15:30.947898Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:30.947882Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:15:31.343376Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:31.343385Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:15:31.552000Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestd8fa7777-99cf-4554-a8aa-45cdc7031cb5.sock: use of closed network connection
2020-08-31T01:15:31.552052Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5d75cd1e-1c7c-4a96-8767-e39fa3899977".sock: use of closed network connection
2020-08-31T01:15:31.552299Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest8332b8f9-f41d-4916-9e1b-85e61dc29835.sock" 

2020-08-31T01:15:31.552339Z	info	sds	Start SDS grpc server
2020-08-31T01:15:31.646025Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:31.853498Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:15:31.853596Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:31.853837Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest8332b8f9-f41d-4916-9e1b-85e61dc29835.sock: use of closed network connection
2020-08-31T01:15:31.854128Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0055f4a0-a87a-4eda-91e7-14b510e7f4ef.sock" 

2020-08-31T01:15:31.854271Z	info	sds	Start SDS grpc server
2020-08-31T01:15:31.855423Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:15:31.855522Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:15:31.855575Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:31.855615Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:15:31.855658Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:15:31.855693Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:15:31.947858Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:32.133288Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:32.436282Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:32.437351Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:32.552244Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:32.552329Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:32.739387Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:32.854054Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:32.855837Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:32.855870Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:15:33.343666Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:33.343695Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:33.646267Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:33.856806Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:33.857185Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0055f4a0-a87a-4eda-91e7-14b510e7f4ef.sock: use of closed network connection
2020-08-31T01:15:33.857222Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:33.857258Z	error	sds	Remote side closed connection
2020-08-31T01:15:33.857321Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:33.857349Z	error	sds	Remote side closed connection
2020-08-31T01:15:33.857446Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste550f96e-edf5-45cb-834c-a4eca4a5ae84.sock" 

2020-08-31T01:15:33.857507Z	info	sds	Start SDS grpc server
2020-08-31T01:15:33.858279Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:15:33.858321Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:15:33.858366Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:33.858856Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:15:33.858365336 +0000 UTC m=+6.804288099 and is waiting for next SDS request
2020-08-31T01:15:33.858881Z	info	sds	Dynamic push for secret default
2020-08-31T01:15:33.858905Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste550f96e-edf5-45cb-834c-a4eca4a5ae84.sock: use of closed network connection
2020-08-31T01:15:33.859047Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:33.859079Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:33.859077Z	error	sds	Remote side closed connection
2020-08-31T01:15:33.859102Z	error	sds	Remote side closed connection
2020-08-31T01:15:33.859206Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest65fe418f-f6cf-44a1-ab6c-073588ca2497.sock" 

2020-08-31T01:15:33.859314Z	info	sds	Start SDS grpc server
2020-08-31T01:15:33.860193Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:15:33.860241Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:15:33.860287Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:33.860869Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:15:33.948056Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:34.360984Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:34.361035Z	info	sds	Dynamic push for secret default
2020-08-31T01:15:34.361577Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest65fe418f-f6cf-44a1-ab6c-073588ca2497.sock: use of closed network connection
2020-08-31T01:15:34.361669Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:34.361695Z	error	sds	Remote side closed connection
2020-08-31T01:15:34.361736Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:34.361801Z	error	sds	Remote side closed connection
2020-08-31T01:15:34.361812Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd6ddb25f-b256-4698-b3d8-ff7fe98ad055.sock" 

2020-08-31T01:15:34.361973Z	info	sds	Start SDS grpc server
2020-08-31T01:15:34.362088Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd6ddb25f-b256-4698-b3d8-ff7fe98ad055.sock: use of closed network connection
2020-08-31T01:15:34.362186Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestefeec3fd-ecf3-4e37-b386-9086450505e0.sock" 

2020-08-31T01:15:34.362203Z	info	sds	Start SDS grpc server
2020-08-31T01:15:34.552523Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:34.552554Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:34.663106Z	info	sds	resource:default new connection
2020-08-31T01:15:34.663168Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:15:34.663225Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:34.663504Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:34.663535Z	error	sds	Remote side closed connection
2020-08-31T01:15:34.854294Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:34.857376Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:34.859076Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:34.964623Z	info	sds	resource:default new connection
2020-08-31T01:15:34.964729Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:15:34.964782Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:34.965044Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:34.965056Z	error	sds	Remote side closed connection
2020-08-31T01:15:34.965421Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestefeec3fd-ecf3-4e37-b386-9086450505e0.sock: use of closed network connection
2020-08-31T01:15:34.965552Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd0a69af7-3652-4908-982b-6750c7b7fcf4.sock" 

2020-08-31T01:15:34.965571Z	info	sds	Start SDS grpc server
2020-08-31T01:15:35.266652Z	info	sds	resource:default new connection
2020-08-31T01:15:35.266741Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:15:35.266793Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:35.267084Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:35.267111Z	error	sds	Remote side closed connection
2020-08-31T01:15:35.267406Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd0a69af7-3652-4908-982b-6750c7b7fcf4.sock: use of closed network connection
2020-08-31T01:15:35.361776Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:35.362208Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:35.965653Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:36.133535Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:36.267498Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:15:36.436526Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:36.437512Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:36.739623Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:36.857618Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:36.859139Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:15:37.300272Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9225e750-02e7-490f-aac9-fe3f912872c0.sock" 

2020-08-31T01:15:37.300328Z	info	sds	Start SDS grpc server
2020-08-31T01:15:37.343966Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:37.344016Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:37.361891Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:37.362357Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:37.646526Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:37.948298Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:37.967950Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:38.267800Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:38.301380Z	info	sds	resource:default new connection
2020-08-31T01:15:38.301449Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:15:38.309085Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:15:38.395579Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:15:38.395625Z	info	cache	GenerateSecret default
2020-08-31T01:15:38.395685Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:38.396087Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9225e750-02e7-490f-aac9-fe3f912872c0.sock: use of closed network connection
PASS
2020-08-31T01:15:38.396194Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:38.396230Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.586s
2020-08-31T01:15:43.670165Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest873c398f-c27f-41ea-91bb-951765ccf670.sock" 

2020-08-31T01:15:43.670291Z	info	sds	Start SDS grpc server
2020-08-31T01:15:43.671489Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:15:43.671546Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:15:43.671891Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:44.671482Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:44.671551Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:15:45.672272Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:15:45.672339Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:15:45.672370Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:15:45.672446Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:45.672763Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest873c398f-c27f-41ea-91bb-951765ccf670.sock: use of closed network connection
2020-08-31T01:15:45.672895Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:45.672928Z	error	sds	Remote side closed connection
2020-08-31T01:15:45.673051Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a8f629e7-b5f6-4f35-a601-4130a8b3ebf6\".sock" 

2020-08-31T01:15:45.673097Z	info	sds	Start SDS grpc server
2020-08-31T01:15:45.973957Z	info	sds	resource:default new connection
2020-08-31T01:15:45.974018Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:15:45.974078Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:45.974427Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:45.974459Z	error	sds	Remote side closed connection
2020-08-31T01:15:45.975025Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:15:45.975059Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:15:45.975256Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:15:45.975479Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:45.975524Z	error	sds	Remote side closed connection
2020-08-31T01:15:45.975690Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a8f629e7-b5f6-4f35-a601-4130a8b3ebf6".sock: use of closed network connection
2020-08-31T01:15:45.975912Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"fe3a9981-a567-4664-812f-369ac82926e6\".sock" 

2020-08-31T01:15:45.975974Z	info	sds	Start SDS grpc server
2020-08-31T01:15:45.976428Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:15:45.976470Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:15:45.976502Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:15:45.976757Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:45.976768Z	error	sds	Remote side closed connection
2020-08-31T01:15:45.977016Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"fe3a9981-a567-4664-812f-369ac82926e6".sock: use of closed network connection
2020-08-31T01:15:45.977195Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0ae22c90-47be-4aa7-8791-3025949e500f\".sock" 

2020-08-31T01:15:45.977239Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:46.278103Z	info	sds	resource:default new connection
2020-08-31T01:15:46.278161Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:15:46.278222Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:46.278424Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:46.278442Z	error	sds	Remote side closed connection
2020-08-31T01:15:46.278769Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0ae22c90-47be-4aa7-8791-3025949e500f".sock: use of closed network connection
2020-08-31T01:15:46.278957Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"85baca7f-1736-4cf8-bdd4-42cb6cb40b0d\".sock" 

2020-08-31T01:15:46.279021Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bfa6523f-825c-4491-b94a-66f4e6f3330e\".sock" 

2020-08-31T01:15:46.279024Z	info	sds	Start SDS grpc server
2020-08-31T01:15:46.279053Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:46.580118Z	info	sds	resource:default new connection
2020-08-31T01:15:46.580177Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:15:46.580233Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:46.580452Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:46.580465Z	error	sds	Remote side closed connection
2020-08-31T01:15:46.581343Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:15:46.581384Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:15:46.581427Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:15:46.581662Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:46.581697Z	error	sds	Remote side closed connection
2020-08-31T01:15:46.672963Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:46.882691Z	info	sds	resource:default new connection
2020-08-31T01:15:46.882783Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:15:46.882840Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:46.883088Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:46.883157Z	error	sds	Remote side closed connection
2020-08-31T01:15:46.883708Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"85baca7f-1736-4cf8-bdd4-42cb6cb40b0d".sock: use of closed network connection
2020-08-31T01:15:46.883787Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bfa6523f-825c-4491-b94a-66f4e6f3330e".sock: use of closed network connection
2020-08-31T01:15:46.884136Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5ecf88e4-cfb5-461c-a4c2-dc854776ae83\".sock" 

2020-08-31T01:15:46.884168Z	info	sds	Start SDS grpc server
2020-08-31T01:15:46.975868Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:46.977186Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:15:47.186926Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5ecf88e4-cfb5-461c-a4c2-dc854776ae83".sock: use of closed network connection
2020-08-31T01:15:47.187122Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ef19d3df-afdb-4d9e-aefd-e98e65f497a6\".sock" 

2020-08-31T01:15:47.187146Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:15:47.278895Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:15:47.488860Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ef19d3df-afdb-4d9e-aefd-e98e65f497a6".sock: use of closed network connection
2020-08-31T01:15:47.489099Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest4593bca5-d08e-4595-a8d2-a73daf914d59.sock" 

2020-08-31T01:15:47.489180Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f6d015b1-1913-46ed-9d0e-d6f6515ac3b2\".sock" 

2020-08-31T01:15:47.489170Z	info	sds	Start SDS grpc server
2020-08-31T01:15:47.489193Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:15:47.883918Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:47.883950Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:15:48.092948Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest4593bca5-d08e-4595-a8d2-a73daf914d59.sock: use of closed network connection
2020-08-31T01:15:48.093000Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f6d015b1-1913-46ed-9d0e-d6f6515ac3b2".sock: use of closed network connection
2020-08-31T01:15:48.093179Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestaf51083d-ce0b-41a6-9a9c-e3e18e1aefb9.sock" 

2020-08-31T01:15:48.093202Z	info	sds	Start SDS grpc server
2020-08-31T01:15:48.187128Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:48.396841Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:15:48.396977Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:48.397266Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestaf51083d-ce0b-41a6-9a9c-e3e18e1aefb9.sock: use of closed network connection
2020-08-31T01:15:48.397551Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf171ce1b-f87e-41c4-bd91-9d1b3e2b7b54.sock" 

2020-08-31T01:15:48.397645Z	info	sds	Start SDS grpc server
2020-08-31T01:15:48.398419Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:15:48.398466Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:15:48.398507Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:48.398615Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:15:48.398635Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:15:48.398657Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:15:48.489077Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:48.673212Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:48.976083Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:48.977303Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:49.093176Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:49.093246Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:49.279160Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:49.397496Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:49.398728Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:49.398771Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:15:49.884086Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:49.884065Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:50.187370Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:50.399541Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:50.399936Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:50.399954Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf171ce1b-f87e-41c4-bd91-9d1b3e2b7b54.sock: use of closed network connection
2020-08-31T01:15:50.399963Z	error	sds	Remote side closed connection
2020-08-31T01:15:50.400134Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:50.400167Z	error	sds	Remote side closed connection
2020-08-31T01:15:50.400201Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4c2d00a7-dda8-4fc7-9a54-cb82bfcaff1e.sock" 

2020-08-31T01:15:50.400292Z	info	sds	Start SDS grpc server
2020-08-31T01:15:50.401173Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:15:50.401256Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:15:50.401357Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:50.401881Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:15:50.401356442 +0000 UTC m=+6.807911100 and is waiting for next SDS request
2020-08-31T01:15:50.401903Z	info	sds	Dynamic push for secret default
2020-08-31T01:15:50.401956Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4c2d00a7-dda8-4fc7-9a54-cb82bfcaff1e.sock: use of closed network connection
2020-08-31T01:15:50.402001Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:50.402009Z	error	sds	Remote side closed connection
2020-08-31T01:15:50.402033Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:50.402047Z	error	sds	Remote side closed connection
2020-08-31T01:15:50.402179Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta7fabedf-35c9-4457-8e43-b45145a80106.sock" 

2020-08-31T01:15:50.402251Z	info	sds	Start SDS grpc server
2020-08-31T01:15:50.403294Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:15:50.403363Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:15:50.403417Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:50.404006Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:15:50.489222Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:50.904240Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:50.904294Z	info	sds	Dynamic push for secret default
2020-08-31T01:15:50.904909Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta7fabedf-35c9-4457-8e43-b45145a80106.sock: use of closed network connection
2020-08-31T01:15:50.904987Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:50.905013Z	error	sds	Remote side closed connection
2020-08-31T01:15:50.905053Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:50.905085Z	error	sds	Remote side closed connection
2020-08-31T01:15:50.905152Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdc25fe88-0aac-4f7a-b05a-73c8e45e979c.sock" 

2020-08-31T01:15:50.905210Z	info	sds	Start SDS grpc server
2020-08-31T01:15:50.905427Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdc25fe88-0aac-4f7a-b05a-73c8e45e979c.sock: use of closed network connection
2020-08-31T01:15:50.905513Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaabf92d0-b75f-447c-a589-34b1e5f3a97e.sock" 

2020-08-31T01:15:50.905526Z	info	sds	Start SDS grpc server
2020-08-31T01:15:51.093398Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:51.093417Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:51.206393Z	info	sds	resource:default new connection
2020-08-31T01:15:51.206446Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:15:51.206497Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:51.206786Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:51.206839Z	error	sds	Remote side closed connection
2020-08-31T01:15:51.397725Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:51.400103Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:51.402121Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:51.507982Z	info	sds	resource:default new connection
2020-08-31T01:15:51.508060Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:15:51.508125Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:51.508405Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:51.508433Z	error	sds	Remote side closed connection
2020-08-31T01:15:51.508748Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaabf92d0-b75f-447c-a589-34b1e5f3a97e.sock: use of closed network connection
2020-08-31T01:15:51.508883Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd75c29a8-c89e-45c9-ac06-c583020d9903.sock" 

2020-08-31T01:15:51.508920Z	info	sds	Start SDS grpc server
2020-08-31T01:15:51.809961Z	info	sds	resource:default new connection
2020-08-31T01:15:51.810022Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:15:51.810073Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:51.810301Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:15:51.810340Z	error	sds	Remote side closed connection
2020-08-31T01:15:51.810556Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd75c29a8-c89e-45c9-ac06-c583020d9903.sock: use of closed network connection
2020-08-31T01:15:51.905119Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:51.905452Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:52.508959Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:52.673486Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:52.810641Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:15:52.976361Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:52.977529Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:53.279451Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:53.400340Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:53.402312Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:15:53.842119Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste5ec9ed5-9399-4a75-8d46-4d2fa3b98ec1.sock" 

2020-08-31T01:15:53.842172Z	info	sds	Start SDS grpc server
2020-08-31T01:15:53.884376Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:53.884400Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:53.905398Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:53.905641Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:54.187607Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:54.489459Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:54.509194Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:54.810929Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:54.843167Z	info	sds	resource:default new connection
2020-08-31T01:15:54.843231Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:15:54.853847Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:15:55.093649Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:15:55.093686Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:15:55.223495Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:15:55.223539Z	info	cache	GenerateSecret default
2020-08-31T01:15:55.223608Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:15:55.223944Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste5ec9ed5-9399-4a75-8d46-4d2fa3b98ec1.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.886s
2020-08-31T01:16:00.385692Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbb788f48-c982-40a6-98da-830dcce957eb.sock" 

2020-08-31T01:16:00.385788Z	info	sds	Start SDS grpc server
2020-08-31T01:16:00.387105Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:16:00.387185Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:16:00.387539Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:01.387052Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:01.387168Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:16:02.387751Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:16:02.387823Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:16:02.387865Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:16:02.387927Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:02.388151Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbb788f48-c982-40a6-98da-830dcce957eb.sock: use of closed network connection
2020-08-31T01:16:02.388289Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:02.388316Z	error	sds	Remote side closed connection
2020-08-31T01:16:02.388471Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ab84f343-d0dd-4407-87b1-c547c6221e1e\".sock" 

2020-08-31T01:16:02.388510Z	info	sds	Start SDS grpc server
2020-08-31T01:16:02.689500Z	info	sds	resource:default new connection
2020-08-31T01:16:02.689586Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:16:02.689667Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:02.689993Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:02.690019Z	error	sds	Remote side closed connection
2020-08-31T01:16:02.690812Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:16:02.690855Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:16:02.691042Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:16:02.691331Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:02.691357Z	error	sds	Remote side closed connection
2020-08-31T01:16:02.691494Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ab84f343-d0dd-4407-87b1-c547c6221e1e".sock: use of closed network connection
2020-08-31T01:16:02.691745Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"15c4b13a-f466-454a-ba01-ead54e853de5\".sock" 

2020-08-31T01:16:02.691822Z	info	sds	Start SDS grpc server
2020-08-31T01:16:02.692251Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:16:02.692287Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:16:02.692332Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:16:02.692602Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:02.692619Z	error	sds	Remote side closed connection
2020-08-31T01:16:02.692844Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"15c4b13a-f466-454a-ba01-ead54e853de5".sock: use of closed network connection
2020-08-31T01:16:02.692975Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"943f7297-d2be-4de0-9967-3a0b0ae3200d\".sock" 

2020-08-31T01:16:02.693022Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:02.994022Z	info	sds	resource:default new connection
2020-08-31T01:16:02.994094Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:16:02.994165Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:02.994451Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:02.994477Z	error	sds	Remote side closed connection
2020-08-31T01:16:02.994695Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"943f7297-d2be-4de0-9967-3a0b0ae3200d".sock: use of closed network connection
2020-08-31T01:16:02.994909Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2aef934f-2f17-41ad-9049-92b65cb8b591\".sock" 

2020-08-31T01:16:02.994972Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a02a5330-6157-4490-844b-3b25cd6aed89\".sock" 

2020-08-31T01:16:02.994978Z	info	sds	Start SDS grpc server
2020-08-31T01:16:02.994995Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:03.296007Z	info	sds	resource:default new connection
2020-08-31T01:16:03.296077Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:16:03.296145Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:03.296441Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:03.296454Z	error	sds	Remote side closed connection
2020-08-31T01:16:03.297129Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:16:03.297177Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:16:03.297223Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:16:03.297475Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:03.297500Z	error	sds	Remote side closed connection
2020-08-31T01:16:03.388399Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:03.598511Z	info	sds	resource:default new connection
2020-08-31T01:16:03.598569Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:16:03.598631Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:03.598953Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:03.598981Z	error	sds	Remote side closed connection
2020-08-31T01:16:03.599261Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2aef934f-2f17-41ad-9049-92b65cb8b591".sock: use of closed network connection
2020-08-31T01:16:03.599312Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a02a5330-6157-4490-844b-3b25cd6aed89".sock: use of closed network connection
2020-08-31T01:16:03.599543Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"aab46ef1-115b-4ce7-8a42-858dd6c15d28\".sock" 

2020-08-31T01:16:03.599575Z	info	sds	Start SDS grpc server
2020-08-31T01:16:03.691684Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:03.693006Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:16:03.902849Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"aab46ef1-115b-4ce7-8a42-858dd6c15d28".sock: use of closed network connection
2020-08-31T01:16:03.903088Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0be3d5a8-f8fe-43ef-8e5c-47653ea42437\".sock" 

2020-08-31T01:16:03.903112Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:03.994757Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:16:04.204811Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0be3d5a8-f8fe-43ef-8e5c-47653ea42437".sock: use of closed network connection
2020-08-31T01:16:04.205023Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest07bb00bb-02e5-4e00-a020-0a6cf942951f.sock" 

2020-08-31T01:16:04.205039Z	info	sds	Start SDS grpc server
2020-08-31T01:16:04.205088Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"25a086b6-9302-4ea1-a271-cea06fc72685\".sock" 

2020-08-31T01:16:04.205102Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:16:04.599494Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:04.599483Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:16:04.809264Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest07bb00bb-02e5-4e00-a020-0a6cf942951f.sock: use of closed network connection
2020-08-31T01:16:04.809322Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"25a086b6-9302-4ea1-a271-cea06fc72685".sock: use of closed network connection
2020-08-31T01:16:04.809560Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1580e592-7958-4a96-8f14-a623dfacce78.sock" 

2020-08-31T01:16:04.809598Z	info	sds	Start SDS grpc server
2020-08-31T01:16:04.903099Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:05.110930Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:16:05.111051Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:05.111308Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1580e592-7958-4a96-8f14-a623dfacce78.sock: use of closed network connection
2020-08-31T01:16:05.112226Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest35305b35-8ed9-440f-ad86-191e673f30ec.sock" 

2020-08-31T01:16:05.112316Z	info	sds	Start SDS grpc server
2020-08-31T01:16:05.114474Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:16:05.114549Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:16:05.114617Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:05.114696Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:16:05.114789Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:16:05.114835Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:16:05.205032Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:05.388723Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:05.691934Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:05.693211Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:05.809541Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:05.809577Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:05.995028Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:06.111514Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:06.114809Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:06.114858Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:16:06.599747Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:06.599799Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:06.903385Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:07.115824Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:07.116131Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest35305b35-8ed9-440f-ad86-191e673f30ec.sock: use of closed network connection
2020-08-31T01:16:07.116159Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:07.116182Z	error	sds	Remote side closed connection
2020-08-31T01:16:07.116261Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:07.116284Z	error	sds	Remote side closed connection
2020-08-31T01:16:07.116419Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta973ead6-591e-40d7-9df2-ccb3036d041e.sock" 

2020-08-31T01:16:07.116518Z	info	sds	Start SDS grpc server
2020-08-31T01:16:07.117172Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:16:07.117227Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:16:07.117287Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:07.118066Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:16:07.117286138 +0000 UTC m=+6.807633261 and is waiting for next SDS request
2020-08-31T01:16:07.118088Z	info	sds	Dynamic push for secret default
2020-08-31T01:16:07.118120Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta973ead6-591e-40d7-9df2-ccb3036d041e.sock: use of closed network connection
2020-08-31T01:16:07.118190Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:07.118214Z	error	sds	Remote side closed connection
2020-08-31T01:16:07.118284Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:07.118296Z	error	sds	Remote side closed connection
2020-08-31T01:16:07.118358Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfafef50d-ae70-4150-85c7-343bd2d9ac3f.sock" 

2020-08-31T01:16:07.118387Z	info	sds	Start SDS grpc server
2020-08-31T01:16:07.119021Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:16:07.119061Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:16:07.119096Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:07.119651Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:16:07.205332Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:07.619790Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:07.619853Z	info	sds	Dynamic push for secret default
2020-08-31T01:16:07.620426Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfafef50d-ae70-4150-85c7-343bd2d9ac3f.sock: use of closed network connection
2020-08-31T01:16:07.620520Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:07.620540Z	error	sds	Remote side closed connection
2020-08-31T01:16:07.620587Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:07.620613Z	error	sds	Remote side closed connection
2020-08-31T01:16:07.620732Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta58b3fb8-01e1-4633-913f-8fefde47a2c0.sock" 

2020-08-31T01:16:07.620799Z	info	sds	Start SDS grpc server
2020-08-31T01:16:07.621044Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta58b3fb8-01e1-4633-913f-8fefde47a2c0.sock: use of closed network connection
2020-08-31T01:16:07.621146Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0139771a-cb75-46cd-b589-ec7959256e9d.sock" 

2020-08-31T01:16:07.621164Z	info	sds	Start SDS grpc server
2020-08-31T01:16:07.809816Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:07.809838Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:07.922061Z	info	sds	resource:default new connection
2020-08-31T01:16:07.922120Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:16:07.922184Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:07.922467Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:07.922494Z	error	sds	Remote side closed connection
2020-08-31T01:16:08.111743Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:08.116338Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:08.118283Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:08.223679Z	info	sds	resource:default new connection
2020-08-31T01:16:08.223737Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:16:08.223813Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:08.224053Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:08.224080Z	error	sds	Remote side closed connection
2020-08-31T01:16:08.224412Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0139771a-cb75-46cd-b589-ec7959256e9d.sock: use of closed network connection
2020-08-31T01:16:08.224538Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestea623ce1-24c4-4b4a-bdf4-552da6bcdd53.sock" 

2020-08-31T01:16:08.224573Z	info	sds	Start SDS grpc server
2020-08-31T01:16:08.525575Z	info	sds	resource:default new connection
2020-08-31T01:16:08.525632Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:16:08.525684Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:08.525930Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:08.525961Z	error	sds	Remote side closed connection
2020-08-31T01:16:08.526251Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestea623ce1-24c4-4b4a-bdf4-552da6bcdd53.sock: use of closed network connection
2020-08-31T01:16:08.620645Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:08.621239Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:09.224640Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:09.388977Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:09.526468Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:16:09.692153Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:09.693382Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:09.995288Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:10.116555Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:10.118490Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:16:10.559859Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest72000705-6c20-4540-9695-3d8f3c0f5b03.sock" 

2020-08-31T01:16:10.559940Z	info	sds	Start SDS grpc server
2020-08-31T01:16:10.600023Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:10.600027Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:10.620914Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:10.621410Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:10.903538Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:11.205587Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:11.224915Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:11.526722Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:11.560847Z	info	sds	resource:default new connection
2020-08-31T01:16:11.560924Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:16:11.564374Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:16:11.721660Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:16:11.721705Z	info	cache	GenerateSecret default
2020-08-31T01:16:11.721767Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:11.722177Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest72000705-6c20-4540-9695-3d8f3c0f5b03.sock: use of closed network connection
PASS
2020-08-31T01:16:11.722290Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:11.722335Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.661s
2020-08-31T01:16:16.940069Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf94d0d91-dd5c-41d9-ba0a-75fab75b2043.sock" 

2020-08-31T01:16:16.940160Z	info	sds	Start SDS grpc server
2020-08-31T01:16:16.941477Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:16:16.941538Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:16:16.942003Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:17.941400Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:17.941458Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:16:18.942167Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:16:18.942248Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:16:18.942272Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:16:18.942338Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:18.942578Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf94d0d91-dd5c-41d9-ba0a-75fab75b2043.sock: use of closed network connection
2020-08-31T01:16:18.942692Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:18.942719Z	error	sds	Remote side closed connection
2020-08-31T01:16:18.942825Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6b322447-0248-48d2-bbdc-f2e74ae74af8\".sock" 

2020-08-31T01:16:18.942856Z	info	sds	Start SDS grpc server
2020-08-31T01:16:19.243760Z	info	sds	resource:default new connection
2020-08-31T01:16:19.243825Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:16:19.243888Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:19.244163Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:19.244195Z	error	sds	Remote side closed connection
2020-08-31T01:16:19.244799Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:16:19.244846Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:16:19.245017Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:16:19.245276Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:19.245297Z	error	sds	Remote side closed connection
2020-08-31T01:16:19.245476Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6b322447-0248-48d2-bbdc-f2e74ae74af8".sock: use of closed network connection
2020-08-31T01:16:19.245693Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"15784792-3cca-4792-8e33-f290c7581073\".sock" 

2020-08-31T01:16:19.245725Z	info	sds	Start SDS grpc server
2020-08-31T01:16:19.246170Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:16:19.246209Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:16:19.246256Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:16:19.246442Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:19.246471Z	error	sds	Remote side closed connection
2020-08-31T01:16:19.246623Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"15784792-3cca-4792-8e33-f290c7581073".sock: use of closed network connection
2020-08-31T01:16:19.246782Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2959b886-7e65-4c1f-9119-9c6a10d208ec\".sock" 

2020-08-31T01:16:19.246814Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:19.547793Z	info	sds	resource:default new connection
2020-08-31T01:16:19.547936Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:16:19.547993Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:19.548247Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:19.548273Z	error	sds	Remote side closed connection
2020-08-31T01:16:19.548630Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2959b886-7e65-4c1f-9119-9c6a10d208ec".sock: use of closed network connection
2020-08-31T01:16:19.548959Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"509db9a2-aa33-4b7f-b80c-df845ea3012c\".sock" 

2020-08-31T01:16:19.549045Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"53d7185f-a941-4f3d-bb57-06112ed9454c\".sock" 

2020-08-31T01:16:19.549030Z	info	sds	Start SDS grpc server
2020-08-31T01:16:19.549087Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:19.850497Z	info	sds	resource:default new connection
2020-08-31T01:16:19.850551Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:16:19.850609Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:19.850846Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:19.850872Z	error	sds	Remote side closed connection
2020-08-31T01:16:19.851501Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:16:19.851535Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:16:19.851571Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:16:19.851716Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:19.851734Z	error	sds	Remote side closed connection
2020-08-31T01:16:19.942820Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:20.152635Z	info	sds	resource:default new connection
2020-08-31T01:16:20.152733Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:16:20.152822Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:20.153195Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:20.153220Z	error	sds	Remote side closed connection
2020-08-31T01:16:20.153428Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"509db9a2-aa33-4b7f-b80c-df845ea3012c".sock: use of closed network connection
2020-08-31T01:16:20.153479Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"53d7185f-a941-4f3d-bb57-06112ed9454c".sock: use of closed network connection
2020-08-31T01:16:20.153678Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"405c3310-4366-49e8-872e-dab4240ee882\".sock" 

2020-08-31T01:16:20.153699Z	info	sds	Start SDS grpc server
2020-08-31T01:16:20.245720Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:20.246771Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:16:20.456045Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"405c3310-4366-49e8-872e-dab4240ee882".sock: use of closed network connection
2020-08-31T01:16:20.456290Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"805a1eed-82d3-43df-8b33-35839cf67f8f\".sock" 

2020-08-31T01:16:20.456317Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:20.548834Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:16:20.758610Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"805a1eed-82d3-43df-8b33-35839cf67f8f".sock: use of closed network connection
2020-08-31T01:16:20.758894Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestdf4f0342-347a-4df0-8bcc-a17640b5cbe6.sock" 

2020-08-31T01:16:20.758973Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5574d676-3e92-4894-b071-e652d1b70961\".sock" 

2020-08-31T01:16:20.759010Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:20.759015Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:16:21.153517Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:21.153580Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:16:21.363711Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestdf4f0342-347a-4df0-8bcc-a17640b5cbe6.sock: use of closed network connection
2020-08-31T01:16:21.363766Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5574d676-3e92-4894-b071-e652d1b70961".sock: use of closed network connection
2020-08-31T01:16:21.363989Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0cf44342-79ca-47e5-af3b-a143cb0e3521.sock" 

2020-08-31T01:16:21.364026Z	info	sds	Start SDS grpc server
2020-08-31T01:16:21.456315Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:21.665262Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:16:21.665354Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:21.665640Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0cf44342-79ca-47e5-af3b-a143cb0e3521.sock: use of closed network connection
2020-08-31T01:16:21.665884Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest83a2897b-8864-4547-9121-2ec93970cd40.sock" 

2020-08-31T01:16:21.665923Z	info	sds	Start SDS grpc server
2020-08-31T01:16:21.666660Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:16:21.666704Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:16:21.666747Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:21.666853Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:16:21.666919Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:16:21.666955Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:16:21.758833Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:21.943108Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:22.245969Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:22.246943Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:22.363912Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:22.363949Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:22.549054Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:22.665832Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:22.666967Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:22.666999Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:16:23.153795Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:23.153835Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:23.456577Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:23.668038Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:23.668427Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest83a2897b-8864-4547-9121-2ec93970cd40.sock: use of closed network connection
2020-08-31T01:16:23.668506Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:23.668539Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:23.668566Z	error	sds	Remote side closed connection
2020-08-31T01:16:23.668528Z	error	sds	Remote side closed connection
2020-08-31T01:16:23.668683Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest330488fe-21a4-4491-8c6c-8a5323099a24.sock" 

2020-08-31T01:16:23.668718Z	info	sds	Start SDS grpc server
2020-08-31T01:16:23.669664Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:16:23.669702Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:16:23.669757Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:23.670291Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:16:23.669756693 +0000 UTC m=+6.809232779 and is waiting for next SDS request
2020-08-31T01:16:23.670314Z	info	sds	Dynamic push for secret default
2020-08-31T01:16:23.670341Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest330488fe-21a4-4491-8c6c-8a5323099a24.sock: use of closed network connection
2020-08-31T01:16:23.670425Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:23.670468Z	error	sds	Remote side closed connection
2020-08-31T01:16:23.670482Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:23.670498Z	error	sds	Remote side closed connection
2020-08-31T01:16:23.670532Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb91e9468-4d35-4760-872c-a35fba6ac7c2.sock" 

2020-08-31T01:16:23.670601Z	info	sds	Start SDS grpc server
2020-08-31T01:16:23.671203Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:16:23.671237Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:16:23.671284Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:23.671785Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:16:23.759059Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:24.171977Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:24.172040Z	info	sds	Dynamic push for secret default
2020-08-31T01:16:24.172564Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb91e9468-4d35-4760-872c-a35fba6ac7c2.sock: use of closed network connection
2020-08-31T01:16:24.172615Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:24.172641Z	error	sds	Remote side closed connection
2020-08-31T01:16:24.172729Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:24.172738Z	error	sds	Remote side closed connection
2020-08-31T01:16:24.172839Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2632beca-c44d-412b-83ff-a13d3cc70828.sock" 

2020-08-31T01:16:24.172853Z	info	sds	Start SDS grpc server
2020-08-31T01:16:24.173123Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2632beca-c44d-412b-83ff-a13d3cc70828.sock: use of closed network connection
2020-08-31T01:16:24.173228Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestead1e7e0-d134-44e7-b175-5c51bf9c8ec9.sock" 

2020-08-31T01:16:24.173253Z	info	sds	Start SDS grpc server
2020-08-31T01:16:24.364164Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:24.364208Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:24.474165Z	info	sds	resource:default new connection
2020-08-31T01:16:24.474254Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:16:24.474312Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:24.474599Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:24.474615Z	error	sds	Remote side closed connection
2020-08-31T01:16:24.666057Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:24.668622Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:24.670541Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:24.775784Z	info	sds	resource:default new connection
2020-08-31T01:16:24.775851Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:16:24.775904Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:24.776213Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:24.776252Z	error	sds	Remote side closed connection
2020-08-31T01:16:24.776559Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestead1e7e0-d134-44e7-b175-5c51bf9c8ec9.sock: use of closed network connection
2020-08-31T01:16:24.776749Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest77ebda44-03d6-45e6-a9eb-3522bc1140a4.sock" 

2020-08-31T01:16:24.776798Z	info	sds	Start SDS grpc server
2020-08-31T01:16:25.077815Z	info	sds	resource:default new connection
2020-08-31T01:16:25.077910Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:16:25.077982Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:25.078259Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:25.078291Z	error	sds	Remote side closed connection
2020-08-31T01:16:25.078627Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest77ebda44-03d6-45e6-a9eb-3522bc1140a4.sock: use of closed network connection
2020-08-31T01:16:25.172781Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:25.173254Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:25.776815Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:25.943390Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:26.078847Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:16:26.246226Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:26.247100Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:26.549330Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:26.668891Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:26.670699Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:16:27.111548Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest766a4313-b610-410a-b4bf-61cd99677c5d.sock" 

2020-08-31T01:16:27.111599Z	info	sds	Start SDS grpc server
2020-08-31T01:16:27.153929Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:27.153968Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:27.173040Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:27.173424Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:27.456839Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:27.759400Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:27.777075Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:28.079151Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:28.112619Z	info	sds	resource:default new connection
2020-08-31T01:16:28.112739Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:16:28.119719Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:16:28.364473Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:28.364510Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:28.462987Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:16:28.463037Z	info	cache	GenerateSecret default
2020-08-31T01:16:28.463113Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:28.463620Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest766a4313-b610-410a-b4bf-61cd99677c5d.sock: use of closed network connection
PASS
2020-08-31T01:16:28.463758Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.853s
2020-08-31T01:16:33.718171Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6fc348c6-f077-4243-8cfd-a239fbc6b88b.sock" 

2020-08-31T01:16:33.718258Z	info	sds	Start SDS grpc server
2020-08-31T01:16:33.719689Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:16:33.719741Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:16:33.720116Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:34.719397Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:34.719458Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:16:35.720628Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:16:35.720746Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:16:35.720774Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:16:35.720840Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:35.721078Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6fc348c6-f077-4243-8cfd-a239fbc6b88b.sock: use of closed network connection
2020-08-31T01:16:35.721192Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:35.721226Z	error	sds	Remote side closed connection
2020-08-31T01:16:35.721394Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"762cec7d-231c-4fe7-b679-f31e008cf7e2\".sock" 

2020-08-31T01:16:35.721453Z	info	sds	Start SDS grpc server
2020-08-31T01:16:36.022476Z	info	sds	resource:default new connection
2020-08-31T01:16:36.022565Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:16:36.022633Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:36.023060Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:36.023085Z	error	sds	Remote side closed connection
2020-08-31T01:16:36.023663Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:16:36.023702Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:16:36.023864Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:16:36.024138Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:36.024164Z	error	sds	Remote side closed connection
2020-08-31T01:16:36.024347Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"762cec7d-231c-4fe7-b679-f31e008cf7e2".sock: use of closed network connection
2020-08-31T01:16:36.024527Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"415a622a-ee81-4e23-83a9-9dd20d193b19\".sock" 

2020-08-31T01:16:36.024599Z	info	sds	Start SDS grpc server
2020-08-31T01:16:36.025037Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:16:36.025077Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:16:36.025138Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:16:36.025410Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:36.025442Z	error	sds	Remote side closed connection
2020-08-31T01:16:36.025573Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"415a622a-ee81-4e23-83a9-9dd20d193b19".sock: use of closed network connection
2020-08-31T01:16:36.025749Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"61847190-e5cd-4d9c-846c-7531e312d418\".sock" 

2020-08-31T01:16:36.025778Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:36.326680Z	info	sds	resource:default new connection
2020-08-31T01:16:36.326754Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:16:36.326816Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:36.327105Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:36.327127Z	error	sds	Remote side closed connection
2020-08-31T01:16:36.327312Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"61847190-e5cd-4d9c-846c-7531e312d418".sock: use of closed network connection
2020-08-31T01:16:36.327555Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5b07fc9b-b061-4fe9-9bdb-79e0172c73db\".sock" 

2020-08-31T01:16:36.327593Z	info	sds	Start SDS grpc server
2020-08-31T01:16:36.327631Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"fd69a152-5fbb-4f3c-8d49-13eee3725c4b\".sock" 

2020-08-31T01:16:36.327642Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:36.628610Z	info	sds	resource:default new connection
2020-08-31T01:16:36.628730Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:16:36.628793Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:36.629149Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:36.629178Z	error	sds	Remote side closed connection
2020-08-31T01:16:36.629788Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:16:36.629819Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:16:36.629864Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:16:36.630101Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:36.630118Z	error	sds	Remote side closed connection
2020-08-31T01:16:36.721266Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:36.931199Z	info	sds	resource:default new connection
2020-08-31T01:16:36.931280Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:16:36.931358Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:36.931630Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:36.931667Z	error	sds	Remote side closed connection
2020-08-31T01:16:36.931955Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5b07fc9b-b061-4fe9-9bdb-79e0172c73db".sock: use of closed network connection
2020-08-31T01:16:36.932028Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"fd69a152-5fbb-4f3c-8d49-13eee3725c4b".sock: use of closed network connection
2020-08-31T01:16:36.932202Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5f617e25-198d-4b0e-9d42-5ae2aa6dbb8d\".sock" 

2020-08-31T01:16:36.932223Z	info	sds	Start SDS grpc server
2020-08-31T01:16:37.024560Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:37.025736Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:16:37.235165Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5f617e25-198d-4b0e-9d42-5ae2aa6dbb8d".sock: use of closed network connection
2020-08-31T01:16:37.235353Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d1083b04-747a-466b-82fa-97f10fae86f6\".sock" 

2020-08-31T01:16:37.235377Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:37.327549Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:16:37.536967Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d1083b04-747a-466b-82fa-97f10fae86f6".sock: use of closed network connection
2020-08-31T01:16:37.537188Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestce05f059-3e92-4d0c-893f-73a99e4cd806.sock" 

2020-08-31T01:16:37.537273Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8423a5f0-02eb-4702-958b-d1ce52305494\".sock" 

2020-08-31T01:16:37.537268Z	info	sds	Start SDS grpc server
2020-08-31T01:16:37.537307Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:16:37.932193Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:37.932257Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:16:38.141429Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestce05f059-3e92-4d0c-893f-73a99e4cd806.sock: use of closed network connection
2020-08-31T01:16:38.141494Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8423a5f0-02eb-4702-958b-d1ce52305494".sock: use of closed network connection
2020-08-31T01:16:38.141667Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest6dbbf360-9a36-4d49-87aa-4f6b5a646d8f.sock" 

2020-08-31T01:16:38.141693Z	info	sds	Start SDS grpc server
2020-08-31T01:16:38.235442Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:38.443575Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:16:38.443712Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:38.444048Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest6dbbf360-9a36-4d49-87aa-4f6b5a646d8f.sock: use of closed network connection
2020-08-31T01:16:38.444919Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2f869b6b-f99e-4a35-b777-0be7bd1a50b4.sock" 

2020-08-31T01:16:38.445060Z	info	sds	Start SDS grpc server
2020-08-31T01:16:38.445837Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:16:38.445895Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:16:38.445937Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:38.446148Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:16:38.446210Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:16:38.446249Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:16:38.537196Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:38.721522Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:39.024779Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:39.025927Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:39.141671Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:39.141697Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:39.327793Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:39.444310Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:39.446066Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:39.446107Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:16:39.932507Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:39.932513Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:40.235723Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:40.446901Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:40.447262Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2f869b6b-f99e-4a35-b777-0be7bd1a50b4.sock: use of closed network connection
2020-08-31T01:16:40.447325Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:40.447379Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:40.447333Z	error	sds	Remote side closed connection
2020-08-31T01:16:40.447395Z	error	sds	Remote side closed connection
2020-08-31T01:16:40.447548Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4f86576b-570c-4aec-8404-fd796eb726bb.sock" 

2020-08-31T01:16:40.447578Z	info	sds	Start SDS grpc server
2020-08-31T01:16:40.448234Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:16:40.448282Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:16:40.448355Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:40.448849Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:16:40.448353984 +0000 UTC m=+6.807376205 and is waiting for next SDS request
2020-08-31T01:16:40.448872Z	info	sds	Dynamic push for secret default
2020-08-31T01:16:40.448884Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4f86576b-570c-4aec-8404-fd796eb726bb.sock: use of closed network connection
2020-08-31T01:16:40.448936Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:40.448959Z	error	sds	Remote side closed connection
2020-08-31T01:16:40.449035Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:40.449046Z	error	sds	Remote side closed connection
2020-08-31T01:16:40.449175Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta410d88b-a085-4057-aae3-815fe118e3e9.sock" 

2020-08-31T01:16:40.449245Z	info	sds	Start SDS grpc server
2020-08-31T01:16:40.450112Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:16:40.450166Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:16:40.450220Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:40.450742Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:16:40.537552Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:40.951037Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:40.951108Z	info	sds	Dynamic push for secret default
2020-08-31T01:16:40.951654Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta410d88b-a085-4057-aae3-815fe118e3e9.sock: use of closed network connection
2020-08-31T01:16:40.951777Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:40.951826Z	error	sds	Remote side closed connection
2020-08-31T01:16:40.951777Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:40.951864Z	error	sds	Remote side closed connection
2020-08-31T01:16:40.951921Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3c32bfe7-13da-4df1-b0bb-26afc70ea4e7.sock" 

2020-08-31T01:16:40.952003Z	info	sds	Start SDS grpc server
2020-08-31T01:16:40.952168Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3c32bfe7-13da-4df1-b0bb-26afc70ea4e7.sock: use of closed network connection
2020-08-31T01:16:40.952271Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestee224b72-afb8-4024-a56a-0fe199e1d3c5.sock" 

2020-08-31T01:16:40.952289Z	info	sds	Start SDS grpc server
2020-08-31T01:16:41.141918Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:41.141943Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:41.253179Z	info	sds	resource:default new connection
2020-08-31T01:16:41.253248Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:16:41.253300Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:41.253549Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:41.253575Z	error	sds	Remote side closed connection
2020-08-31T01:16:41.444561Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:41.447438Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:41.449035Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:41.554642Z	info	sds	resource:default new connection
2020-08-31T01:16:41.554704Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:16:41.554786Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:41.555051Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:41.555064Z	error	sds	Remote side closed connection
2020-08-31T01:16:41.555373Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestee224b72-afb8-4024-a56a-0fe199e1d3c5.sock: use of closed network connection
2020-08-31T01:16:41.555506Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest70d6f461-6e08-40f1-ad69-e4d3bd35399a.sock" 

2020-08-31T01:16:41.555563Z	info	sds	Start SDS grpc server
2020-08-31T01:16:41.856620Z	info	sds	resource:default new connection
2020-08-31T01:16:41.856708Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:16:41.856761Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:41.857050Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:41.857081Z	error	sds	Remote side closed connection
2020-08-31T01:16:41.857393Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest70d6f461-6e08-40f1-ad69-e4d3bd35399a.sock: use of closed network connection
2020-08-31T01:16:41.951877Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:41.952239Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:42.555602Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:42.721803Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:42.857603Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:16:43.024885Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:43.026030Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:43.327963Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:43.447684Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:43.449221Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:16:43.889269Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb229d901-e535-450d-9a2e-260be887597b.sock" 

2020-08-31T01:16:43.889323Z	info	sds	Start SDS grpc server
2020-08-31T01:16:43.932767Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:43.932794Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:43.952109Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:43.952363Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:44.235995Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:44.537716Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:44.555853Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:44.857793Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:44.890162Z	info	sds	resource:default new connection
2020-08-31T01:16:44.890265Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:16:44.898947Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:16:44.974315Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:16:44.974361Z	info	cache	GenerateSecret default
2020-08-31T01:16:44.974423Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:44.974844Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb229d901-e535-450d-9a2e-260be887597b.sock: use of closed network connection
PASS
2020-08-31T01:16:44.974958Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:44.974998Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.582s
2020-08-31T01:16:50.250537Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest62842a11-513d-4f71-855c-a920c519024e.sock" 

2020-08-31T01:16:50.250621Z	info	sds	Start SDS grpc server
2020-08-31T01:16:50.251907Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:16:50.251962Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:16:50.252430Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:51.251985Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:51.252043Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:16:52.252993Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:16:52.253081Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:16:52.253110Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:16:52.253172Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:52.253408Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest62842a11-513d-4f71-855c-a920c519024e.sock: use of closed network connection
2020-08-31T01:16:52.253561Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:52.253587Z	error	sds	Remote side closed connection
2020-08-31T01:16:52.253817Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e4105383-2e17-4a40-a450-ae820ad82624\".sock" 

2020-08-31T01:16:52.253880Z	info	sds	Start SDS grpc server
2020-08-31T01:16:52.555047Z	info	sds	resource:default new connection
2020-08-31T01:16:52.555110Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:16:52.555206Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:52.555522Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:52.555606Z	error	sds	Remote side closed connection
2020-08-31T01:16:52.556475Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:16:52.556550Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:16:52.556784Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:16:52.557176Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:52.557201Z	error	sds	Remote side closed connection
2020-08-31T01:16:52.557390Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e4105383-2e17-4a40-a450-ae820ad82624".sock: use of closed network connection
2020-08-31T01:16:52.557612Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cc132dfc-97af-4f07-9a7c-965a63cc3293\".sock" 

2020-08-31T01:16:52.557637Z	info	sds	Start SDS grpc server
2020-08-31T01:16:52.558292Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:16:52.558351Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:16:52.558391Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:16:52.558710Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:52.558724Z	error	sds	Remote side closed connection
2020-08-31T01:16:52.558932Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cc132dfc-97af-4f07-9a7c-965a63cc3293".sock: use of closed network connection
2020-08-31T01:16:52.559220Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4dcc3b40-12bc-4d7d-b288-f079377816ea\".sock" 

2020-08-31T01:16:52.559256Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:52.860367Z	info	sds	resource:default new connection
2020-08-31T01:16:52.860437Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:16:52.860499Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:52.860872Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:52.860888Z	error	sds	Remote side closed connection
2020-08-31T01:16:52.861199Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4dcc3b40-12bc-4d7d-b288-f079377816ea".sock: use of closed network connection
2020-08-31T01:16:52.861387Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3082296e-21ef-4548-a386-dda5e37a7903\".sock" 

2020-08-31T01:16:52.861438Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"25824eb0-c6cb-4484-a2aa-b12b050575d4\".sock" 

2020-08-31T01:16:52.861448Z	info	sds	Start SDS grpc server
2020-08-31T01:16:52.861472Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:53.162497Z	info	sds	resource:default new connection
2020-08-31T01:16:53.162562Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:16:53.162615Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:53.163008Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:53.163035Z	error	sds	Remote side closed connection
2020-08-31T01:16:53.163587Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:16:53.163643Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:16:53.163684Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:16:53.163887Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:53.163896Z	error	sds	Remote side closed connection
2020-08-31T01:16:53.253737Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:53.465241Z	info	sds	resource:default new connection
2020-08-31T01:16:53.465400Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:16:53.465455Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:53.465690Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:53.465715Z	error	sds	Remote side closed connection
2020-08-31T01:16:53.465934Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3082296e-21ef-4548-a386-dda5e37a7903".sock: use of closed network connection
2020-08-31T01:16:53.465982Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"25824eb0-c6cb-4484-a2aa-b12b050575d4".sock: use of closed network connection
2020-08-31T01:16:53.466166Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a5cfeaee-6fb2-4527-ae9c-5b105ebb287b\".sock" 

2020-08-31T01:16:53.466218Z	info	sds	Start SDS grpc server
2020-08-31T01:16:53.557618Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:53.559112Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:16:53.769411Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a5cfeaee-6fb2-4527-ae9c-5b105ebb287b".sock: use of closed network connection
2020-08-31T01:16:53.769619Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"490ad430-8d40-4bae-bc66-8a60e5a441ec\".sock" 

2020-08-31T01:16:53.769646Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:53.861510Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:16:54.071528Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"490ad430-8d40-4bae-bc66-8a60e5a441ec".sock: use of closed network connection
2020-08-31T01:16:54.071722Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestab2b039e-b7dc-49a6-9dfb-a7ab988fd2ac.sock" 

2020-08-31T01:16:54.071777Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8c81202c-b5c0-460a-ad8d-5b688d76d010\".sock" 

2020-08-31T01:16:54.071811Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:16:54.071801Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:16:54.466259Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:54.466234Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:16:54.676632Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestab2b039e-b7dc-49a6-9dfb-a7ab988fd2ac.sock: use of closed network connection
2020-08-31T01:16:54.676825Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8c81202c-b5c0-460a-ad8d-5b688d76d010".sock: use of closed network connection
2020-08-31T01:16:54.677062Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1b5d1d1b-4504-45ef-a6e2-09a0d3b936b7.sock" 

2020-08-31T01:16:54.677105Z	info	sds	Start SDS grpc server
2020-08-31T01:16:54.769668Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:54.978307Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:16:54.978405Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:54.978664Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1b5d1d1b-4504-45ef-a6e2-09a0d3b936b7.sock: use of closed network connection
2020-08-31T01:16:54.978898Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbb3c0eb7-9032-42b1-b7de-63e43d7e6b6f.sock" 

2020-08-31T01:16:54.979037Z	info	sds	Start SDS grpc server
2020-08-31T01:16:54.979861Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:16:54.979922Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:16:54.979980Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:54.980144Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:16:54.980185Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:16:54.980224Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:16:55.071778Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:55.254082Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:55.557958Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:55.559387Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:55.676897Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:55.676945Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:55.861823Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:55.978953Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:55.980314Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:55.980358Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:16:56.466592Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:56.466610Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:56.769967Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:56.981358Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:56.981810Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbb3c0eb7-9032-42b1-b7de-63e43d7e6b6f.sock: use of closed network connection
2020-08-31T01:16:56.981855Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:56.981891Z	error	sds	Remote side closed connection
2020-08-31T01:16:56.981935Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:56.981943Z	error	sds	Remote side closed connection
2020-08-31T01:16:56.982074Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdf07d667-28fc-4a39-bb22-ee9ee75772d3.sock" 

2020-08-31T01:16:56.982203Z	info	sds	Start SDS grpc server
2020-08-31T01:16:56.983960Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:16:56.984008Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:16:56.984053Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:56.984632Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:16:56.984052463 +0000 UTC m=+6.818508067 and is waiting for next SDS request
2020-08-31T01:16:56.984692Z	info	sds	Dynamic push for secret default
2020-08-31T01:16:56.984723Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdf07d667-28fc-4a39-bb22-ee9ee75772d3.sock: use of closed network connection
2020-08-31T01:16:56.984818Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:56.984822Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:56.984833Z	error	sds	Remote side closed connection
2020-08-31T01:16:56.984851Z	error	sds	Remote side closed connection
2020-08-31T01:16:56.985023Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd7dee3db-c364-493f-815e-5c8246c81f86.sock" 

2020-08-31T01:16:56.985122Z	info	sds	Start SDS grpc server
2020-08-31T01:16:56.985913Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:16:56.985963Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:16:56.986001Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:56.986574Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:16:57.071949Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:57.486755Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:57.486808Z	info	sds	Dynamic push for secret default
2020-08-31T01:16:57.487539Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd7dee3db-c364-493f-815e-5c8246c81f86.sock: use of closed network connection
2020-08-31T01:16:57.487654Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:57.487677Z	error	sds	Remote side closed connection
2020-08-31T01:16:57.487745Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestea40439a-d8a1-48b9-948f-a62a31e773cc.sock" 

2020-08-31T01:16:57.487787Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:57.487817Z	error	sds	Remote side closed connection
2020-08-31T01:16:57.487776Z	info	sds	Start SDS grpc server
2020-08-31T01:16:57.488061Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestea40439a-d8a1-48b9-948f-a62a31e773cc.sock: use of closed network connection
2020-08-31T01:16:57.488195Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd4de5d09-d899-4e4e-b34c-08cb3299ff47.sock" 

2020-08-31T01:16:57.488230Z	info	sds	Start SDS grpc server
2020-08-31T01:16:57.677179Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:57.677262Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:57.789426Z	info	sds	resource:default new connection
2020-08-31T01:16:57.789525Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:16:57.789606Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:57.789899Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:57.789922Z	error	sds	Remote side closed connection
2020-08-31T01:16:57.979290Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:57.982209Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:57.985031Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:58.092714Z	info	sds	resource:default new connection
2020-08-31T01:16:58.092962Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:16:58.093086Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:58.093870Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:58.093897Z	error	sds	Remote side closed connection
2020-08-31T01:16:58.094106Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd4de5d09-d899-4e4e-b34c-08cb3299ff47.sock: use of closed network connection
2020-08-31T01:16:58.094240Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3fe54ee9-f236-4e14-b9d8-e20bcaaab7b4.sock" 

2020-08-31T01:16:58.094256Z	info	sds	Start SDS grpc server
2020-08-31T01:16:58.395364Z	info	sds	resource:default new connection
2020-08-31T01:16:58.395435Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:16:58.395489Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:16:58.395955Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:16:58.395984Z	error	sds	Remote side closed connection
2020-08-31T01:16:58.396180Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3fe54ee9-f236-4e14-b9d8-e20bcaaab7b4.sock: use of closed network connection
2020-08-31T01:16:58.487845Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:58.488236Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:59.094407Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:59.254367Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:59.396476Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:16:59.558100Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:59.559616Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:59.862031Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:16:59.982322Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:16:59.985243Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:17:00.427255Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest23198f83-5e5b-4d1a-bedb-375220f65ec3.sock" 

2020-08-31T01:17:00.427305Z	info	sds	Start SDS grpc server
2020-08-31T01:17:00.466844Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:00.466867Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:00.488119Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:00.488413Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:00.770247Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:01.072236Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:01.094677Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:01.396766Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:01.428292Z	info	sds	resource:default new connection
2020-08-31T01:17:01.428351Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:17:01.439097Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:17:01.504683Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:17:01.504730Z	info	cache	GenerateSecret default
2020-08-31T01:17:01.504807Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:01.505143Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest23198f83-5e5b-4d1a-bedb-375220f65ec3.sock: use of closed network connection
PASS
2020-08-31T01:17:01.505263Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:01.505299Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.590s
2020-08-31T01:17:06.773737Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3a725937-1150-4619-bb4a-3ae72cadd15e.sock" 

2020-08-31T01:17:06.773836Z	info	sds	Start SDS grpc server
2020-08-31T01:17:06.775124Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:17:06.775190Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:17:06.775635Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:07.775102Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:07.775161Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:17:08.775913Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:17:08.776000Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:17:08.776022Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:17:08.776092Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:08.776317Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3a725937-1150-4619-bb4a-3ae72cadd15e.sock: use of closed network connection
2020-08-31T01:17:08.776404Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:08.776418Z	error	sds	Remote side closed connection
2020-08-31T01:17:08.776550Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ad95c696-5124-4c0f-8fc8-24726c974c86\".sock" 

2020-08-31T01:17:08.776565Z	info	sds	Start SDS grpc server
2020-08-31T01:17:09.078058Z	info	sds	resource:default new connection
2020-08-31T01:17:09.078120Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:17:09.078201Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:09.078494Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:09.078526Z	error	sds	Remote side closed connection
2020-08-31T01:17:09.079125Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:17:09.079172Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:17:09.079348Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:17:09.079550Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:09.079577Z	error	sds	Remote side closed connection
2020-08-31T01:17:09.079804Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ad95c696-5124-4c0f-8fc8-24726c974c86".sock: use of closed network connection
2020-08-31T01:17:09.079982Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ad3a3dda-a00a-48dd-917c-23207fc6e33c\".sock" 

2020-08-31T01:17:09.080106Z	info	sds	Start SDS grpc server
2020-08-31T01:17:09.080530Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:17:09.080572Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:17:09.080619Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:17:09.080851Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:09.080873Z	error	sds	Remote side closed connection
2020-08-31T01:17:09.081014Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ad3a3dda-a00a-48dd-917c-23207fc6e33c".sock: use of closed network connection
2020-08-31T01:17:09.081171Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"49e84fc7-70d3-4b5e-9627-bf79c4819c85\".sock" 

2020-08-31T01:17:09.081201Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:09.382108Z	info	sds	resource:default new connection
2020-08-31T01:17:09.382170Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:17:09.382227Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:09.382551Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:09.382576Z	error	sds	Remote side closed connection
2020-08-31T01:17:09.382822Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"49e84fc7-70d3-4b5e-9627-bf79c4819c85".sock: use of closed network connection
2020-08-31T01:17:09.383042Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"22a05336-79f1-451e-8a10-18d3c56b7cdc\".sock" 

2020-08-31T01:17:09.383063Z	info	sds	Start SDS grpc server
2020-08-31T01:17:09.383125Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9a8c8a62-03e4-44e3-8c3a-a82823ee1fd7\".sock" 

2020-08-31T01:17:09.383164Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:09.684058Z	info	sds	resource:default new connection
2020-08-31T01:17:09.684122Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:17:09.684177Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:09.684549Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:09.684584Z	error	sds	Remote side closed connection
2020-08-31T01:17:09.685068Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:17:09.685099Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:17:09.685136Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:17:09.685406Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:09.685420Z	error	sds	Remote side closed connection
2020-08-31T01:17:09.776527Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:09.986258Z	info	sds	resource:default new connection
2020-08-31T01:17:09.986310Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:17:09.986393Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:09.986739Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:09.986771Z	error	sds	Remote side closed connection
2020-08-31T01:17:09.986905Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"22a05336-79f1-451e-8a10-18d3c56b7cdc".sock: use of closed network connection
2020-08-31T01:17:09.986955Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9a8c8a62-03e4-44e3-8c3a-a82823ee1fd7".sock: use of closed network connection
2020-08-31T01:17:09.987177Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"43e05ccb-44e3-42e5-94d6-357ecfcaf009\".sock" 

2020-08-31T01:17:09.987206Z	info	sds	Start SDS grpc server
2020-08-31T01:17:10.080023Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:10.081170Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:17:10.289841Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"43e05ccb-44e3-42e5-94d6-357ecfcaf009".sock: use of closed network connection
2020-08-31T01:17:10.290023Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8b35375a-38fc-4592-bf51-0c8896d0be0a\".sock" 

2020-08-31T01:17:10.290045Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:10.383022Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:17:10.592178Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8b35375a-38fc-4592-bf51-0c8896d0be0a".sock: use of closed network connection
2020-08-31T01:17:10.592392Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0445b635-fc89-417e-8ab0-f0cccc0dece5.sock" 

2020-08-31T01:17:10.592445Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b53f7fb7-37e0-48ce-b4e5-21d24c2ff336\".sock" 

2020-08-31T01:17:10.592481Z	info	sds	Start SDS grpc server
2020-08-31T01:17:10.592504Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:17:10.987097Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:10.987116Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:17:11.196787Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0445b635-fc89-417e-8ab0-f0cccc0dece5.sock: use of closed network connection
2020-08-31T01:17:11.196840Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b53f7fb7-37e0-48ce-b4e5-21d24c2ff336".sock: use of closed network connection
2020-08-31T01:17:11.197035Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest8cacb357-9561-46f1-8c17-f407cf1f878b.sock" 

2020-08-31T01:17:11.197057Z	info	sds	Start SDS grpc server
2020-08-31T01:17:11.290056Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:11.499007Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:17:11.499163Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:11.499384Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest8cacb357-9561-46f1-8c17-f407cf1f878b.sock: use of closed network connection
2020-08-31T01:17:11.499933Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest73dcc214-4675-451f-8fc8-ff937c5fd059.sock" 

2020-08-31T01:17:11.500056Z	info	sds	Start SDS grpc server
2020-08-31T01:17:11.500707Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:17:11.500760Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:17:11.500803Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:11.501018Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:17:11.501064Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:17:11.501098Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:17:11.592413Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:11.776781Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:12.080317Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:12.081330Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:12.196947Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:12.196947Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:12.383343Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:12.499594Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:12.501106Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:12.501146Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:17:12.987405Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:12.987427Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:13.290288Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:13.502051Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:13.502406Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:13.502466Z	error	sds	Remote side closed connection
2020-08-31T01:17:13.502440Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest73dcc214-4675-451f-8fc8-ff937c5fd059.sock: use of closed network connection
2020-08-31T01:17:13.502531Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:13.502538Z	error	sds	Remote side closed connection
2020-08-31T01:17:13.502741Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2ab1de75-844e-42fe-ae1b-15221814853b.sock" 

2020-08-31T01:17:13.502811Z	info	sds	Start SDS grpc server
2020-08-31T01:17:13.503539Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:17:13.503575Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:17:13.503627Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:13.504060Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:17:13.503626877 +0000 UTC m=+6.805889512 and is waiting for next SDS request
2020-08-31T01:17:13.504081Z	info	sds	Dynamic push for secret default
2020-08-31T01:17:13.504117Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2ab1de75-844e-42fe-ae1b-15221814853b.sock: use of closed network connection
2020-08-31T01:17:13.504162Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:13.504184Z	error	sds	Remote side closed connection
2020-08-31T01:17:13.504237Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:13.504258Z	error	sds	Remote side closed connection
2020-08-31T01:17:13.504286Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestef1ae6d3-e90c-4280-ac89-7f900d7bb084.sock" 

2020-08-31T01:17:13.504372Z	info	sds	Start SDS grpc server
2020-08-31T01:17:13.504944Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:17:13.504981Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:17:13.505014Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:13.505558Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:17:13.592680Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:14.005705Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:14.005761Z	info	sds	Dynamic push for secret default
2020-08-31T01:17:14.006561Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestef1ae6d3-e90c-4280-ac89-7f900d7bb084.sock: use of closed network connection
2020-08-31T01:17:14.006668Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:14.006692Z	error	sds	Remote side closed connection
2020-08-31T01:17:14.006758Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:14.006767Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc7de4b1b-00f9-49b8-b16f-0747f0e5fb82.sock" 

2020-08-31T01:17:14.006847Z	error	sds	Remote side closed connection
2020-08-31T01:17:14.006782Z	info	sds	Start SDS grpc server
2020-08-31T01:17:14.007206Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc7de4b1b-00f9-49b8-b16f-0747f0e5fb82.sock: use of closed network connection
2020-08-31T01:17:14.007384Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest43a37cc9-9f37-4b76-a5fd-ba26e2661cb4.sock" 

2020-08-31T01:17:14.007413Z	info	sds	Start SDS grpc server
2020-08-31T01:17:14.197195Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:14.197244Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:14.308414Z	info	sds	resource:default new connection
2020-08-31T01:17:14.308483Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:17:14.308545Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:14.309014Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:14.309102Z	error	sds	Remote side closed connection
2020-08-31T01:17:14.499905Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:14.502641Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:14.504347Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:14.610030Z	info	sds	resource:default new connection
2020-08-31T01:17:14.610098Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:17:14.610183Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:14.610555Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:14.610613Z	error	sds	Remote side closed connection
2020-08-31T01:17:14.610902Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest43a37cc9-9f37-4b76-a5fd-ba26e2661cb4.sock: use of closed network connection
2020-08-31T01:17:14.611052Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest49ec0980-80ae-4ac7-888d-24c993d7b562.sock" 

2020-08-31T01:17:14.611082Z	info	sds	Start SDS grpc server
2020-08-31T01:17:14.911961Z	info	sds	resource:default new connection
2020-08-31T01:17:14.912016Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:17:14.912078Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:14.912571Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:14.912616Z	error	sds	Remote side closed connection
2020-08-31T01:17:14.912896Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest49ec0980-80ae-4ac7-888d-24c993d7b562.sock: use of closed network connection
2020-08-31T01:17:15.006720Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:15.007277Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:15.611110Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:15.777018Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:15.913128Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:17:16.080540Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:16.081544Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:16.383600Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:16.502941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:16.504535Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:17:16.945606Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdc348593-b158-49a9-a57a-77df2f9d1638.sock" 

2020-08-31T01:17:16.945656Z	info	sds	Start SDS grpc server
2020-08-31T01:17:16.987707Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:16.987742Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:17.006945Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:17.007463Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:17.290532Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:17.592868Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:17.611335Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:17.913394Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:17.946699Z	info	sds	resource:default new connection
2020-08-31T01:17:17.946772Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:17:17.954467Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:17:17.996931Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:17:17.996980Z	info	cache	GenerateSecret default
2020-08-31T01:17:17.997047Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:17.997477Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdc348593-b158-49a9-a57a-77df2f9d1638.sock: use of closed network connection
PASS
2020-08-31T01:17:17.997639Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:17.997656Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.547s
2020-08-31T01:17:23.211076Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8d8a7558-2eb2-4be2-8476-95d3ce6145e4.sock" 

2020-08-31T01:17:23.211183Z	info	sds	Start SDS grpc server
2020-08-31T01:17:23.212691Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:17:23.212776Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:17:23.213643Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:24.212566Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:24.212649Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:17:25.213422Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:17:25.213525Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:17:25.213548Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:17:25.213604Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:25.213918Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8d8a7558-2eb2-4be2-8476-95d3ce6145e4.sock: use of closed network connection
2020-08-31T01:17:25.214066Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:25.214097Z	error	sds	Remote side closed connection
2020-08-31T01:17:25.214143Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b698cba0-3c16-49b0-9d19-85e6456f75eb\".sock" 

2020-08-31T01:17:25.214170Z	info	sds	Start SDS grpc server
2020-08-31T01:17:25.515138Z	info	sds	resource:default new connection
2020-08-31T01:17:25.515205Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:17:25.515260Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:25.515567Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:25.515593Z	error	sds	Remote side closed connection
2020-08-31T01:17:25.516170Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:17:25.516223Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:17:25.516428Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:17:25.516736Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:25.516787Z	error	sds	Remote side closed connection
2020-08-31T01:17:25.516975Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b698cba0-3c16-49b0-9d19-85e6456f75eb".sock: use of closed network connection
2020-08-31T01:17:25.517152Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7604cce2-093f-4cb7-8a69-cbc94e3c5cd6\".sock" 

2020-08-31T01:17:25.517238Z	info	sds	Start SDS grpc server
2020-08-31T01:17:25.517620Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:17:25.517653Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:17:25.517691Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:17:25.517935Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:25.517960Z	error	sds	Remote side closed connection
2020-08-31T01:17:25.518111Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7604cce2-093f-4cb7-8a69-cbc94e3c5cd6".sock: use of closed network connection
2020-08-31T01:17:25.518290Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f65b2266-7e9d-4c5a-89cb-cd1c253793f4\".sock" 

2020-08-31T01:17:25.518319Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:25.819238Z	info	sds	resource:default new connection
2020-08-31T01:17:25.819296Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:17:25.819358Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:25.819577Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:25.819611Z	error	sds	Remote side closed connection
2020-08-31T01:17:25.819807Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f65b2266-7e9d-4c5a-89cb-cd1c253793f4".sock: use of closed network connection
2020-08-31T01:17:25.820019Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"91fecf5f-a058-4a3a-821a-783aab81913f\".sock" 

2020-08-31T01:17:25.820082Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5c47b941-2e90-4ed0-8ad9-f1c823fa98a4\".sock" 

2020-08-31T01:17:25.820091Z	info	sds	Start SDS grpc server
2020-08-31T01:17:25.820116Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:26.121326Z	info	sds	resource:default new connection
2020-08-31T01:17:26.121428Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:17:26.121529Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:26.121848Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:26.121866Z	error	sds	Remote side closed connection
2020-08-31T01:17:26.122482Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:17:26.122530Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:17:26.122573Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:17:26.122754Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:26.122763Z	error	sds	Remote side closed connection
2020-08-31T01:17:26.214150Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:26.423860Z	info	sds	resource:default new connection
2020-08-31T01:17:26.423924Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:17:26.424009Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:26.424285Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:26.424328Z	error	sds	Remote side closed connection
2020-08-31T01:17:26.424531Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"91fecf5f-a058-4a3a-821a-783aab81913f".sock: use of closed network connection
2020-08-31T01:17:26.424576Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5c47b941-2e90-4ed0-8ad9-f1c823fa98a4".sock: use of closed network connection
2020-08-31T01:17:26.424792Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f3ca696e-f5e6-42cf-967c-8c6ed4521f47\".sock" 

2020-08-31T01:17:26.424819Z	info	sds	Start SDS grpc server
2020-08-31T01:17:26.517165Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:26.518255Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:17:26.727980Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f3ca696e-f5e6-42cf-967c-8c6ed4521f47".sock: use of closed network connection
2020-08-31T01:17:26.728152Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3815c6bf-849a-4010-b991-79052f239cbb\".sock" 

2020-08-31T01:17:26.728172Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:26.819964Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:17:27.029737Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3815c6bf-849a-4010-b991-79052f239cbb".sock: use of closed network connection
2020-08-31T01:17:27.029975Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest8a71d297-737b-4736-ab3f-722bc54f0d87.sock" 

2020-08-31T01:17:27.030049Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"479cecee-f182-4f08-bff1-2a859549a29b\".sock" 

2020-08-31T01:17:27.030074Z	info	sds	Start SDS grpc server
2020-08-31T01:17:27.030097Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:17:27.424717Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:27.424717Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:17:27.634110Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest8a71d297-737b-4736-ab3f-722bc54f0d87.sock: use of closed network connection
2020-08-31T01:17:27.634163Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"479cecee-f182-4f08-bff1-2a859549a29b".sock: use of closed network connection
2020-08-31T01:17:27.634352Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestd5d8e4b5-62bf-4887-9f7d-11ffc36ec43c.sock" 

2020-08-31T01:17:27.634378Z	info	sds	Start SDS grpc server
2020-08-31T01:17:27.728167Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:27.935679Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:17:27.935770Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:27.935989Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestd5d8e4b5-62bf-4887-9f7d-11ffc36ec43c.sock: use of closed network connection
2020-08-31T01:17:27.936239Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestad1cf160-0d7b-4cbf-943e-03f5719924b1.sock" 

2020-08-31T01:17:27.936298Z	info	sds	Start SDS grpc server
2020-08-31T01:17:27.938774Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:17:27.939025Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:17:27.939574Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:27.939579Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:17:27.939626Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:17:27.939664Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:17:28.029977Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:28.214426Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:28.517425Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:28.518451Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:28.634349Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:28.634402Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:28.820291Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:28.936208Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:28.939139Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:28.939183Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:17:29.424956Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:29.425000Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:29.728406Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:29.939982Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:29.940404Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestad1cf160-0d7b-4cbf-943e-03f5719924b1.sock: use of closed network connection
2020-08-31T01:17:29.940507Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:29.940533Z	error	sds	Remote side closed connection
2020-08-31T01:17:29.940593Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:29.940602Z	error	sds	Remote side closed connection
2020-08-31T01:17:29.940774Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb07f43fc-f0de-4dfe-a023-589d59d9d461.sock" 

2020-08-31T01:17:29.940867Z	info	sds	Start SDS grpc server
2020-08-31T01:17:29.941662Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:17:29.941725Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:17:29.941963Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:29.942538Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:17:29.941960015 +0000 UTC m=+6.808364987 and is waiting for next SDS request
2020-08-31T01:17:29.942561Z	info	sds	Dynamic push for secret default
2020-08-31T01:17:29.942596Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb07f43fc-f0de-4dfe-a023-589d59d9d461.sock: use of closed network connection
2020-08-31T01:17:29.942692Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:29.942706Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:29.942722Z	error	sds	Remote side closed connection
2020-08-31T01:17:29.942712Z	error	sds	Remote side closed connection
2020-08-31T01:17:29.942908Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb87b3019-ed5d-440e-82b0-c6be4a362038.sock" 

2020-08-31T01:17:29.942927Z	info	sds	Start SDS grpc server
2020-08-31T01:17:29.943661Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:17:29.943702Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:17:29.943742Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:29.944263Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:17:30.030243Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:30.444360Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:30.444419Z	info	sds	Dynamic push for secret default
2020-08-31T01:17:30.445025Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb87b3019-ed5d-440e-82b0-c6be4a362038.sock: use of closed network connection
2020-08-31T01:17:30.445118Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:30.445146Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:30.445148Z	error	sds	Remote side closed connection
2020-08-31T01:17:30.445175Z	error	sds	Remote side closed connection
2020-08-31T01:17:30.445290Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcd9ba52f-9b0f-4f4d-aef4-7f5c33208d6f.sock" 

2020-08-31T01:17:30.445332Z	info	sds	Start SDS grpc server
2020-08-31T01:17:30.445515Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcd9ba52f-9b0f-4f4d-aef4-7f5c33208d6f.sock: use of closed network connection
2020-08-31T01:17:30.445600Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf7eee7a8-9f13-4e0e-ad35-11ffbbc10214.sock" 

2020-08-31T01:17:30.445618Z	info	sds	Start SDS grpc server
2020-08-31T01:17:30.634541Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:30.634599Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:30.746706Z	info	sds	resource:default new connection
2020-08-31T01:17:30.746803Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:17:30.746866Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:30.747147Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:30.747175Z	error	sds	Remote side closed connection
2020-08-31T01:17:30.936430Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:30.940560Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:30.942800Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:31.048363Z	info	sds	resource:default new connection
2020-08-31T01:17:31.048442Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:17:31.048529Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:31.048826Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:31.048854Z	error	sds	Remote side closed connection
2020-08-31T01:17:31.049325Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf7eee7a8-9f13-4e0e-ad35-11ffbbc10214.sock: use of closed network connection
2020-08-31T01:17:31.049453Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2396fa6e-b8b2-41a6-ac01-6c838419f842.sock" 

2020-08-31T01:17:31.049496Z	info	sds	Start SDS grpc server
2020-08-31T01:17:31.350479Z	info	sds	resource:default new connection
2020-08-31T01:17:31.350541Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:17:31.350596Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:31.350945Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:31.350985Z	error	sds	Remote side closed connection
2020-08-31T01:17:31.351114Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2396fa6e-b8b2-41a6-ac01-6c838419f842.sock: use of closed network connection
2020-08-31T01:17:31.445227Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:31.445597Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:32.049552Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:32.214703Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:32.351330Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:17:32.517651Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:32.518636Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:32.820534Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:32.940818Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:32.942990Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:17:33.385194Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5d601ff7-0e82-4d4f-bb21-c89fffa6260f.sock" 

2020-08-31T01:17:33.385246Z	info	sds	Start SDS grpc server
2020-08-31T01:17:33.425242Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:33.425302Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:33.445483Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:33.445709Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:33.728547Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:34.030466Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:34.049890Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:34.351575Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:34.386082Z	info	sds	resource:default new connection
2020-08-31T01:17:34.386172Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:17:34.390666Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:17:34.555068Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:17:34.555113Z	info	cache	GenerateSecret default
2020-08-31T01:17:34.555181Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:34.555562Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5d601ff7-0e82-4d4f-bb21-c89fffa6260f.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.668s
2020-08-31T01:17:39.778367Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest82d4c369-5e95-4c4e-8d3c-c534149eb3ae.sock" 

2020-08-31T01:17:39.778468Z	info	sds	Start SDS grpc server
2020-08-31T01:17:39.779855Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:17:39.779912Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:17:39.780364Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:40.779766Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:40.779823Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:17:41.780522Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:17:41.780593Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:17:41.780617Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:17:41.780695Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:41.780891Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest82d4c369-5e95-4c4e-8d3c-c534149eb3ae.sock: use of closed network connection
2020-08-31T01:17:41.781056Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:41.781075Z	error	sds	Remote side closed connection
2020-08-31T01:17:41.781173Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e2a49d5d-e8ed-405d-96fe-cec0e3b4ba31\".sock" 

2020-08-31T01:17:41.781229Z	info	sds	Start SDS grpc server
2020-08-31T01:17:42.082318Z	info	sds	resource:default new connection
2020-08-31T01:17:42.082384Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:17:42.082437Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:42.082736Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:42.082763Z	error	sds	Remote side closed connection
2020-08-31T01:17:42.083478Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:17:42.083557Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:17:42.083729Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:17:42.084107Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:42.084123Z	error	sds	Remote side closed connection
2020-08-31T01:17:42.084275Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e2a49d5d-e8ed-405d-96fe-cec0e3b4ba31".sock: use of closed network connection
2020-08-31T01:17:42.084495Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4a5f95d2-2884-47b4-9b4a-e4f01f85f309\".sock" 

2020-08-31T01:17:42.084606Z	info	sds	Start SDS grpc server
2020-08-31T01:17:42.085083Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:17:42.085132Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:17:42.085177Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:17:42.085512Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:42.085534Z	error	sds	Remote side closed connection
2020-08-31T01:17:42.085747Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4a5f95d2-2884-47b4-9b4a-e4f01f85f309".sock: use of closed network connection
2020-08-31T01:17:42.085898Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e8872dd9-ab8e-457e-82b7-2289cefa8910\".sock" 

2020-08-31T01:17:42.085923Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:42.386836Z	info	sds	resource:default new connection
2020-08-31T01:17:42.386902Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:17:42.386980Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:42.387274Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:42.387308Z	error	sds	Remote side closed connection
2020-08-31T01:17:42.387568Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e8872dd9-ab8e-457e-82b7-2289cefa8910".sock: use of closed network connection
2020-08-31T01:17:42.387813Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5da5c254-8e9b-40f6-86b6-98daf4668349\".sock" 

2020-08-31T01:17:42.387869Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7b4b4ca4-834b-47a2-840f-6c47276d72db\".sock" 

2020-08-31T01:17:42.387900Z	info	sds	Start SDS grpc server
2020-08-31T01:17:42.387912Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:42.688932Z	info	sds	resource:default new connection
2020-08-31T01:17:42.689002Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:17:42.689057Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:42.689317Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:42.689339Z	error	sds	Remote side closed connection
2020-08-31T01:17:42.689801Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:17:42.689836Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:17:42.689882Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:17:42.690110Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:42.690127Z	error	sds	Remote side closed connection
2020-08-31T01:17:42.781077Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:42.991193Z	info	sds	resource:default new connection
2020-08-31T01:17:42.991291Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:17:42.991366Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:42.991760Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:42.991805Z	error	sds	Remote side closed connection
2020-08-31T01:17:42.992244Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5da5c254-8e9b-40f6-86b6-98daf4668349".sock: use of closed network connection
2020-08-31T01:17:42.992389Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7b4b4ca4-834b-47a2-840f-6c47276d72db".sock: use of closed network connection
2020-08-31T01:17:42.992624Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a79071b1-93d9-4946-a094-eddeb144b04b\".sock" 

2020-08-31T01:17:42.992703Z	info	sds	Start SDS grpc server
2020-08-31T01:17:43.084497Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:43.085897Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:17:43.295386Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a79071b1-93d9-4946-a094-eddeb144b04b".sock: use of closed network connection
2020-08-31T01:17:43.295594Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a125ab8d-a9cd-4ddc-98c7-24a6c4526394\".sock" 

2020-08-31T01:17:43.295616Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:43.387765Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:17:43.597768Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a125ab8d-a9cd-4ddc-98c7-24a6c4526394".sock: use of closed network connection
2020-08-31T01:17:43.598019Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestdd532637-ce3c-469b-b9a5-c96eefaf3c88.sock" 

2020-08-31T01:17:43.598056Z	info	sds	Start SDS grpc server
2020-08-31T01:17:43.598105Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"cf1f91b7-c451-4999-bea5-c04136af9f25\".sock" 

2020-08-31T01:17:43.598121Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:17:43.992511Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:43.992545Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:17:44.202084Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestdd532637-ce3c-469b-b9a5-c96eefaf3c88.sock: use of closed network connection
2020-08-31T01:17:44.202139Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"cf1f91b7-c451-4999-bea5-c04136af9f25".sock: use of closed network connection
2020-08-31T01:17:44.202322Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest440ba82f-8170-49e8-ae6e-8b980b17fded.sock" 

2020-08-31T01:17:44.202348Z	info	sds	Start SDS grpc server
2020-08-31T01:17:44.295634Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:44.503441Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:17:44.503544Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:44.503779Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest440ba82f-8170-49e8-ae6e-8b980b17fded.sock: use of closed network connection
2020-08-31T01:17:44.504045Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest178661fb-e9e9-4098-b909-4be4631a62a9.sock" 

2020-08-31T01:17:44.504055Z	info	sds	Start SDS grpc server
2020-08-31T01:17:44.504849Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:17:44.504892Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:17:44.504934Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:44.505008Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:17:44.505074Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:17:44.505109Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:17:44.597990Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:44.781351Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:45.084835Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:45.086095Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:45.202304Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:45.202332Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:45.388011Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:45.503988Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:45.505152Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:45.505210Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:17:45.992783Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:45.992773Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:46.295915Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:46.506140Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:46.506492Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest178661fb-e9e9-4098-b909-4be4631a62a9.sock: use of closed network connection
2020-08-31T01:17:46.506502Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:46.506529Z	error	sds	Remote side closed connection
2020-08-31T01:17:46.506600Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:46.506648Z	error	sds	Remote side closed connection
2020-08-31T01:17:46.506824Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste186374e-871b-436c-948d-25cbb71574bf.sock" 

2020-08-31T01:17:46.506907Z	info	sds	Start SDS grpc server
2020-08-31T01:17:46.508037Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:17:46.508082Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:17:46.508128Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:46.508559Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:17:46.508128253 +0000 UTC m=+6.805474895 and is waiting for next SDS request
2020-08-31T01:17:46.508575Z	info	sds	Dynamic push for secret default
2020-08-31T01:17:46.508605Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste186374e-871b-436c-948d-25cbb71574bf.sock: use of closed network connection
2020-08-31T01:17:46.508724Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:46.508733Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:46.508756Z	error	sds	Remote side closed connection
2020-08-31T01:17:46.508740Z	error	sds	Remote side closed connection
2020-08-31T01:17:46.508824Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdb9050ae-70bc-49d6-b9a0-08b5a46790bd.sock" 

2020-08-31T01:17:46.508835Z	info	sds	Start SDS grpc server
2020-08-31T01:17:46.511816Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:17:46.511887Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:17:46.511935Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:46.512690Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:17:46.598207Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:47.012773Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:47.012828Z	info	sds	Dynamic push for secret default
2020-08-31T01:17:47.013368Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdb9050ae-70bc-49d6-b9a0-08b5a46790bd.sock: use of closed network connection
2020-08-31T01:17:47.013548Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:47.013549Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:47.013579Z	error	sds	Remote side closed connection
2020-08-31T01:17:47.013589Z	error	sds	Remote side closed connection
2020-08-31T01:17:47.013627Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd9a59ad8-b6a5-411b-8bb3-11ff2d384f02.sock" 

2020-08-31T01:17:47.013634Z	info	sds	Start SDS grpc server
2020-08-31T01:17:47.013905Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd9a59ad8-b6a5-411b-8bb3-11ff2d384f02.sock: use of closed network connection
2020-08-31T01:17:47.014001Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1c025d18-0687-448c-8e9d-eaf2a964cdae.sock" 

2020-08-31T01:17:47.014015Z	info	sds	Start SDS grpc server
2020-08-31T01:17:47.202577Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:47.202622Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:47.315179Z	info	sds	resource:default new connection
2020-08-31T01:17:47.315256Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:17:47.315325Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:47.315629Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:47.315656Z	error	sds	Remote side closed connection
2020-08-31T01:17:47.504245Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:47.506668Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:47.508803Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:47.616630Z	info	sds	resource:default new connection
2020-08-31T01:17:47.616742Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:17:47.616797Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:47.617089Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:47.617114Z	error	sds	Remote side closed connection
2020-08-31T01:17:47.617381Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1c025d18-0687-448c-8e9d-eaf2a964cdae.sock: use of closed network connection
2020-08-31T01:17:47.617503Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcacd73e4-8397-4476-9a5a-9cdbb3fdbc2d.sock" 

2020-08-31T01:17:47.617552Z	info	sds	Start SDS grpc server
2020-08-31T01:17:47.918541Z	info	sds	resource:default new connection
2020-08-31T01:17:47.918592Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:17:47.918664Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:47.918998Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:47.919026Z	error	sds	Remote side closed connection
2020-08-31T01:17:47.919240Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcacd73e4-8397-4476-9a5a-9cdbb3fdbc2d.sock: use of closed network connection
2020-08-31T01:17:48.013606Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:48.014015Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:48.617601Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:48.781600Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:48.919473Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:17:49.085101Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:49.086299Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:49.388271Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:49.507916Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:49.508972Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:17:49.950223Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest234202b7-989a-4c23-a594-9789e308a831.sock" 

2020-08-31T01:17:49.950275Z	info	sds	Start SDS grpc server
2020-08-31T01:17:49.993051Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:49.993099Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:50.013859Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:50.014161Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:50.296171Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:50.598462Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:17:50.617866Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:50.919769Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:50.951174Z	info	sds	resource:default new connection
2020-08-31T01:17:50.951237Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:17:50.955966Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:17:51.083137Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:17:51.083185Z	info	cache	GenerateSecret default
2020-08-31T01:17:51.083287Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:51.083652Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest234202b7-989a-4c23-a594-9789e308a831.sock: use of closed network connection
PASS
2020-08-31T01:17:51.083695Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.629s
2020-08-31T01:17:56.285520Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest43e6821f-e87d-41e6-8940-effbd7e5e97d.sock" 

2020-08-31T01:17:56.285622Z	info	sds	Start SDS grpc server
2020-08-31T01:17:56.286937Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:17:56.287012Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:17:56.287350Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:57.286793Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:57.286850Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:17:58.287534Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:17:58.287631Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:17:58.287774Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:17:58.287898Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:58.288185Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest43e6821f-e87d-41e6-8940-effbd7e5e97d.sock: use of closed network connection
2020-08-31T01:17:58.288295Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:58.288318Z	error	sds	Remote side closed connection
2020-08-31T01:17:58.288532Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a9ec6c48-89f4-451d-b518-3caf6f7cd54a\".sock" 

2020-08-31T01:17:58.288570Z	info	sds	Start SDS grpc server
2020-08-31T01:17:58.589530Z	info	sds	resource:default new connection
2020-08-31T01:17:58.589593Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:17:58.589652Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:58.590177Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:58.590195Z	error	sds	Remote side closed connection
2020-08-31T01:17:58.590628Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:17:58.590683Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:17:58.590864Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:17:58.591156Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:58.591193Z	error	sds	Remote side closed connection
2020-08-31T01:17:58.592370Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a9ec6c48-89f4-451d-b518-3caf6f7cd54a".sock: use of closed network connection
2020-08-31T01:17:58.592564Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7b219829-b6e1-47b2-b82f-2787cb94b6de\".sock" 

2020-08-31T01:17:58.592590Z	info	sds	Start SDS grpc server
2020-08-31T01:17:58.593132Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:17:58.593167Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:17:58.593210Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:17:58.593495Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:58.593505Z	error	sds	Remote side closed connection
2020-08-31T01:17:58.593723Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7b219829-b6e1-47b2-b82f-2787cb94b6de".sock: use of closed network connection
2020-08-31T01:17:58.593902Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"fd81006c-955f-4b09-8a76-526fab508564\".sock" 

2020-08-31T01:17:58.593938Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:58.895312Z	info	sds	resource:default new connection
2020-08-31T01:17:58.895369Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:17:58.895426Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:58.895686Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:58.895741Z	error	sds	Remote side closed connection
2020-08-31T01:17:58.895956Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"fd81006c-955f-4b09-8a76-526fab508564".sock: use of closed network connection
2020-08-31T01:17:58.896140Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cfeb5dad-7de7-4afd-847a-2f8df98c3e93\".sock" 

2020-08-31T01:17:58.896154Z	info	sds	Start SDS grpc server
2020-08-31T01:17:58.896212Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f410a3c9-ffa6-4ee2-9e88-0db44715fc74\".sock" 

2020-08-31T01:17:58.896220Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:59.197176Z	info	sds	resource:default new connection
2020-08-31T01:17:59.197256Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:17:59.197310Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:59.197627Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:59.197653Z	error	sds	Remote side closed connection
2020-08-31T01:17:59.198159Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:17:59.198198Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:17:59.198237Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:17:59.198442Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:59.198464Z	error	sds	Remote side closed connection
2020-08-31T01:17:59.288477Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:59.499439Z	info	sds	resource:default new connection
2020-08-31T01:17:59.499492Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:17:59.499545Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:17:59.499832Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:17:59.499864Z	error	sds	Remote side closed connection
2020-08-31T01:17:59.500074Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cfeb5dad-7de7-4afd-847a-2f8df98c3e93".sock: use of closed network connection
2020-08-31T01:17:59.500119Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f410a3c9-ffa6-4ee2-9e88-0db44715fc74".sock: use of closed network connection
2020-08-31T01:17:59.500289Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a5923007-ab85-4474-8420-dc780b7fd5c8\".sock" 

2020-08-31T01:17:59.500310Z	info	sds	Start SDS grpc server
2020-08-31T01:17:59.592583Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:17:59.593898Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:17:59.802747Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a5923007-ab85-4474-8420-dc780b7fd5c8".sock: use of closed network connection
2020-08-31T01:17:59.802921Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"98328915-9ca7-4cda-8b02-14e9db5be6f9\".sock" 

2020-08-31T01:17:59.802947Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:17:59.896180Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:18:00.104553Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"98328915-9ca7-4cda-8b02-14e9db5be6f9".sock: use of closed network connection
2020-08-31T01:18:00.104792Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest96524d02-e0df-49da-a24b-4f65a9adbe82.sock" 

2020-08-31T01:18:00.104817Z	info	sds	Start SDS grpc server
2020-08-31T01:18:00.104852Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8f349a70-1cfb-4b23-8e89-445fd8909a5d\".sock" 

2020-08-31T01:18:00.104873Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:18:00.500271Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:00.500322Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:18:00.709298Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest96524d02-e0df-49da-a24b-4f65a9adbe82.sock: use of closed network connection
2020-08-31T01:18:00.709351Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8f349a70-1cfb-4b23-8e89-445fd8909a5d".sock: use of closed network connection
2020-08-31T01:18:00.709547Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestc39c65d4-0e0d-49e9-ae27-7f84ec6cf702.sock" 

2020-08-31T01:18:00.709570Z	info	sds	Start SDS grpc server
2020-08-31T01:18:00.802962Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:01.010709Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:18:01.010833Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:01.011061Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestc39c65d4-0e0d-49e9-ae27-7f84ec6cf702.sock: use of closed network connection
2020-08-31T01:18:01.011344Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcae475c6-e441-40df-8229-3cfdccba27de.sock" 

2020-08-31T01:18:01.011360Z	info	sds	Start SDS grpc server
2020-08-31T01:18:01.012183Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:18:01.012289Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:18:01.012346Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:01.012461Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:18:01.012526Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:18:01.012571Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:18:01.104820Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:01.288740Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:01.592710Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:01.594051Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:01.709590Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:01.709596Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:01.896420Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:02.011275Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:02.012549Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:02.012603Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:18:02.500537Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:02.500581Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:02.803177Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:03.013439Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:03.013836Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcae475c6-e441-40df-8229-3cfdccba27de.sock: use of closed network connection
2020-08-31T01:18:03.013943Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:03.013955Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:03.013985Z	error	sds	Remote side closed connection
2020-08-31T01:18:03.013970Z	error	sds	Remote side closed connection
2020-08-31T01:18:03.014090Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest377503dd-2c34-407d-a856-dfde1cf3108f.sock" 

2020-08-31T01:18:03.014176Z	info	sds	Start SDS grpc server
2020-08-31T01:18:03.014953Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:18:03.015002Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:18:03.015046Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:03.015554Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest377503dd-2c34-407d-a856-dfde1cf3108f.sock: use of closed network connection
2020-08-31T01:18:03.015580Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:18:03.015045923 +0000 UTC m=+6.805450551 and is waiting for next SDS request
2020-08-31T01:18:03.015602Z	info	sds	Dynamic push for secret default
2020-08-31T01:18:03.015629Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:03.015636Z	error	sds	Remote side closed connection
2020-08-31T01:18:03.015687Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:03.015708Z	error	sds	Remote side closed connection
2020-08-31T01:18:03.015821Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1fa932bb-a348-4207-becc-ccf6b6b9d77e.sock" 

2020-08-31T01:18:03.015849Z	info	sds	Start SDS grpc server
2020-08-31T01:18:03.016593Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:18:03.016630Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:18:03.016693Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:03.017178Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:18:03.105039Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:03.517421Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:03.517473Z	info	sds	Dynamic push for secret default
2020-08-31T01:18:03.518060Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1fa932bb-a348-4207-becc-ccf6b6b9d77e.sock: use of closed network connection
2020-08-31T01:18:03.518174Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:03.518220Z	error	sds	Remote side closed connection
2020-08-31T01:18:03.518169Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:03.518245Z	error	sds	Remote side closed connection
2020-08-31T01:18:03.518304Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1d77e559-f7b9-441a-b4c8-f0336f86f40d.sock" 

2020-08-31T01:18:03.518388Z	info	sds	Start SDS grpc server
2020-08-31T01:18:03.518566Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1d77e559-f7b9-441a-b4c8-f0336f86f40d.sock: use of closed network connection
2020-08-31T01:18:03.518644Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest81995d55-35a8-454c-84ec-3d098e4b9dd1.sock" 

2020-08-31T01:18:03.518648Z	info	sds	Start SDS grpc server
2020-08-31T01:18:03.709899Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:03.709912Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:03.819603Z	info	sds	resource:default new connection
2020-08-31T01:18:03.819658Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:18:03.819712Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:03.819928Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:03.819953Z	error	sds	Remote side closed connection
2020-08-31T01:18:04.011546Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:04.014061Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:04.015675Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:04.121065Z	info	sds	resource:default new connection
2020-08-31T01:18:04.121125Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:18:04.121179Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:04.121535Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:04.121566Z	error	sds	Remote side closed connection
2020-08-31T01:18:04.121772Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest81995d55-35a8-454c-84ec-3d098e4b9dd1.sock: use of closed network connection
2020-08-31T01:18:04.121901Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6558fb8a-92f5-4fab-8377-3817e5b171b4.sock" 

2020-08-31T01:18:04.121924Z	info	sds	Start SDS grpc server
2020-08-31T01:18:04.422668Z	info	sds	resource:default new connection
2020-08-31T01:18:04.422726Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:18:04.422781Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:04.423020Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:04.423039Z	error	sds	Remote side closed connection
2020-08-31T01:18:04.423294Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6558fb8a-92f5-4fab-8377-3817e5b171b4.sock: use of closed network connection
2020-08-31T01:18:04.518206Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:04.518614Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:05.122009Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:05.288993Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:05.423538Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:18:05.592950Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:05.594253Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:05.896686Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:06.014182Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:06.015882Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:18:06.452424Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc0c9388a-5867-4eca-8397-3775eaa9f326.sock" 

2020-08-31T01:18:06.452488Z	info	sds	Start SDS grpc server
2020-08-31T01:18:06.500786Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:06.500839Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:06.518449Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:06.518796Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:06.803421Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:07.105305Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:07.122273Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:07.423841Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:07.453360Z	info	sds	resource:default new connection
2020-08-31T01:18:07.453424Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:18:07.462806Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:18:07.520219Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:18:07.520258Z	info	cache	GenerateSecret default
2020-08-31T01:18:07.520354Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:07.520768Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc0c9388a-5867-4eca-8397-3775eaa9f326.sock: use of closed network connection
PASS
2020-08-31T01:18:07.520901Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:07.520927Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.557s
2020-08-31T01:18:12.704115Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste4059a2f-092a-40c6-a73d-7474cd2b77fb.sock" 

2020-08-31T01:18:12.704185Z	info	sds	Start SDS grpc server
2020-08-31T01:18:12.705398Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:18:12.705462Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:18:12.705786Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:13.705257Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:13.705299Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:18:14.705934Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:18:14.706027Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:18:14.706058Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:18:14.706113Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:14.706295Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste4059a2f-092a-40c6-a73d-7474cd2b77fb.sock: use of closed network connection
2020-08-31T01:18:14.706402Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:14.706418Z	error	sds	Remote side closed connection
2020-08-31T01:18:14.706552Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ec1c79e3-a43f-495b-8a55-fd6a9f01584e\".sock" 

2020-08-31T01:18:14.706587Z	info	sds	Start SDS grpc server
2020-08-31T01:18:15.007553Z	info	sds	resource:default new connection
2020-08-31T01:18:15.007618Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:18:15.007677Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:15.008078Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:15.008110Z	error	sds	Remote side closed connection
2020-08-31T01:18:15.008540Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:18:15.008588Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:18:15.008761Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:18:15.009017Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:15.009058Z	error	sds	Remote side closed connection
2020-08-31T01:18:15.009151Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ec1c79e3-a43f-495b-8a55-fd6a9f01584e".sock: use of closed network connection
2020-08-31T01:18:15.009385Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"bdd9810c-1d03-4bdc-853d-b3515bd0c523\".sock" 

2020-08-31T01:18:15.009468Z	info	sds	Start SDS grpc server
2020-08-31T01:18:15.009945Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:18:15.009986Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:18:15.010023Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:18:15.010203Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:15.010220Z	error	sds	Remote side closed connection
2020-08-31T01:18:15.010421Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"bdd9810c-1d03-4bdc-853d-b3515bd0c523".sock: use of closed network connection
2020-08-31T01:18:15.010591Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"44332ff6-aed4-4537-a4bf-687c7156263d\".sock" 

2020-08-31T01:18:15.010609Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:15.311991Z	info	sds	resource:default new connection
2020-08-31T01:18:15.312052Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:18:15.312118Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:15.312371Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:15.312400Z	error	sds	Remote side closed connection
2020-08-31T01:18:15.312704Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"44332ff6-aed4-4537-a4bf-687c7156263d".sock: use of closed network connection
2020-08-31T01:18:15.312916Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"bd5465b5-faa2-4e05-8f9f-239c8ac80f01\".sock" 

2020-08-31T01:18:15.312969Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"36f59541-59f4-4456-be6e-b84dba27c7da\".sock" 

2020-08-31T01:18:15.312980Z	info	sds	Start SDS grpc server
2020-08-31T01:18:15.312995Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:15.614022Z	info	sds	resource:default new connection
2020-08-31T01:18:15.614094Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:18:15.614150Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:15.614471Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:15.614508Z	error	sds	Remote side closed connection
2020-08-31T01:18:15.615180Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:18:15.615223Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:18:15.615263Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:18:15.615526Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:15.615543Z	error	sds	Remote side closed connection
2020-08-31T01:18:15.706489Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:15.916978Z	info	sds	resource:default new connection
2020-08-31T01:18:15.917035Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:18:15.917099Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:15.917431Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:15.917462Z	error	sds	Remote side closed connection
2020-08-31T01:18:15.917675Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"bd5465b5-faa2-4e05-8f9f-239c8ac80f01".sock: use of closed network connection
2020-08-31T01:18:15.917718Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"36f59541-59f4-4456-be6e-b84dba27c7da".sock: use of closed network connection
2020-08-31T01:18:15.917875Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0c03cbb5-dfd5-487d-97ad-c640ed732f35\".sock" 

2020-08-31T01:18:15.917881Z	info	sds	Start SDS grpc server
2020-08-31T01:18:16.009408Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:16.010573Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:18:16.220528Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0c03cbb5-dfd5-487d-97ad-c640ed732f35".sock: use of closed network connection
2020-08-31T01:18:16.220787Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"089f0734-ce9c-4fa7-bb38-8e51ff5c7440\".sock" 

2020-08-31T01:18:16.220818Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:16.312913Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:18:16.522402Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"089f0734-ce9c-4fa7-bb38-8e51ff5c7440".sock: use of closed network connection
2020-08-31T01:18:16.522602Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste9b3032d-082b-44f8-8f1c-81c2936a2441.sock" 

2020-08-31T01:18:16.522658Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9687564f-0f27-4e57-a1f9-efdd1eddee75\".sock" 

2020-08-31T01:18:16.522690Z	info	sds	Start SDS grpc server
2020-08-31T01:18:16.522704Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:18:16.917878Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:16.917925Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:18:17.127070Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste9b3032d-082b-44f8-8f1c-81c2936a2441.sock: use of closed network connection
2020-08-31T01:18:17.127124Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9687564f-0f27-4e57-a1f9-efdd1eddee75".sock: use of closed network connection
2020-08-31T01:18:17.127336Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestcd42438b-ac94-477d-94a8-9cbd6d3c5056.sock" 

2020-08-31T01:18:17.127361Z	info	sds	Start SDS grpc server
2020-08-31T01:18:17.220777Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:17.429777Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:18:17.430209Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:17.430720Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestcd42438b-ac94-477d-94a8-9cbd6d3c5056.sock: use of closed network connection
2020-08-31T01:18:17.431009Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1f051050-32ac-45cb-965e-57a0f4eb131f.sock" 

2020-08-31T01:18:17.431090Z	info	sds	Start SDS grpc server
2020-08-31T01:18:17.431781Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:18:17.431829Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:18:17.431911Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:17.431962Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:18:17.432004Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:18:17.432035Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:18:17.522627Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:17.706735Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:18.009616Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:18.010699Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:18.127302Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:18.127326Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:18.313148Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:18.430904Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:18.432094Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:18.432128Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:18:18.918128Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:18.918197Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:19.221003Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:19.432870Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:19.433216Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1f051050-32ac-45cb-965e-57a0f4eb131f.sock: use of closed network connection
2020-08-31T01:18:19.433230Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:19.433258Z	error	sds	Remote side closed connection
2020-08-31T01:18:19.433310Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:19.433322Z	error	sds	Remote side closed connection
2020-08-31T01:18:19.433460Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestadd72772-4614-453c-b240-29010d378e53.sock" 

2020-08-31T01:18:19.433529Z	info	sds	Start SDS grpc server
2020-08-31T01:18:19.434386Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:18:19.434444Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:18:19.434611Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:19.435103Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:18:19.434609975 +0000 UTC m=+6.806001373 and is waiting for next SDS request
2020-08-31T01:18:19.435117Z	info	sds	Dynamic push for secret default
2020-08-31T01:18:19.435144Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestadd72772-4614-453c-b240-29010d378e53.sock: use of closed network connection
2020-08-31T01:18:19.435235Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:19.435264Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:19.435260Z	error	sds	Remote side closed connection
2020-08-31T01:18:19.435295Z	error	sds	Remote side closed connection
2020-08-31T01:18:19.435426Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6f40b2f7-b2af-4a15-afe3-3ccb95ddc661.sock" 

2020-08-31T01:18:19.435447Z	info	sds	Start SDS grpc server
2020-08-31T01:18:19.436180Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:18:19.436238Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:18:19.436272Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:19.436776Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:18:19.522871Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:19.936965Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:19.937025Z	info	sds	Dynamic push for secret default
2020-08-31T01:18:19.937659Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6f40b2f7-b2af-4a15-afe3-3ccb95ddc661.sock: use of closed network connection
2020-08-31T01:18:19.937806Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:19.937834Z	error	sds	Remote side closed connection
2020-08-31T01:18:19.937805Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:19.937896Z	error	sds	Remote side closed connection
2020-08-31T01:18:19.937911Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest93c183be-9ac7-4a56-9361-39b368bc4369.sock" 

2020-08-31T01:18:19.938053Z	info	sds	Start SDS grpc server
2020-08-31T01:18:19.938196Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest93c183be-9ac7-4a56-9361-39b368bc4369.sock: use of closed network connection
2020-08-31T01:18:19.938332Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest61a7d6a5-a05c-4a37-b72f-6a10874e92ba.sock" 

2020-08-31T01:18:19.938355Z	info	sds	Start SDS grpc server
2020-08-31T01:18:20.127553Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:20.127605Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:20.239411Z	info	sds	resource:default new connection
2020-08-31T01:18:20.239487Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:18:20.239560Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:20.239925Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:20.239944Z	error	sds	Remote side closed connection
2020-08-31T01:18:20.431131Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:20.433277Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:20.435324Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:20.541045Z	info	sds	resource:default new connection
2020-08-31T01:18:20.541105Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:18:20.541158Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:20.541450Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:20.541479Z	error	sds	Remote side closed connection
2020-08-31T01:18:20.541719Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest61a7d6a5-a05c-4a37-b72f-6a10874e92ba.sock: use of closed network connection
2020-08-31T01:18:20.541852Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest38f85f39-4054-40fa-ba28-745a1c5fdbe8.sock" 

2020-08-31T01:18:20.541900Z	info	sds	Start SDS grpc server
2020-08-31T01:18:20.842819Z	info	sds	resource:default new connection
2020-08-31T01:18:20.842875Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:18:20.842926Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:20.843171Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:20.843192Z	error	sds	Remote side closed connection
2020-08-31T01:18:20.843586Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest38f85f39-4054-40fa-ba28-745a1c5fdbe8.sock: use of closed network connection
2020-08-31T01:18:20.937860Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:20.938272Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:21.541953Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:21.706965Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:21.843782Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:18:22.009893Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:22.010930Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:22.313264Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:22.433505Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:22.435543Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:18:22.875462Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdf1e98af-7691-4d94-ab04-4677730f9c13.sock" 

2020-08-31T01:18:22.875515Z	info	sds	Start SDS grpc server
2020-08-31T01:18:22.918430Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:22.918430Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:22.938060Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:22.938419Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:23.221218Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:23.523139Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:23.542178Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:23.844021Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:23.876549Z	info	sds	resource:default new connection
2020-08-31T01:18:23.876628Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:18:23.879255Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:18:23.964689Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:18:23.964739Z	info	cache	GenerateSecret default
2020-08-31T01:18:23.964820Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:23.965298Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdf1e98af-7691-4d94-ab04-4677730f9c13.sock: use of closed network connection
2020-08-31T01:18:23.965303Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:23.965342Z	error	sds	Remote side closed connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.584s
2020-08-31T01:18:29.190661Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfa13be92-2b65-4d6f-9003-38cb2edbb295.sock" 

2020-08-31T01:18:29.190748Z	info	sds	Start SDS grpc server
2020-08-31T01:18:29.192136Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:18:29.192212Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:18:29.192598Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:30.191947Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:30.192000Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:18:31.192696Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:18:31.192785Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:18:31.192810Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:18:31.192921Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:31.193153Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfa13be92-2b65-4d6f-9003-38cb2edbb295.sock: use of closed network connection
2020-08-31T01:18:31.193281Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:31.193311Z	error	sds	Remote side closed connection
2020-08-31T01:18:31.193399Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b48ef756-f2dd-406f-a740-f1af5c87cb3d\".sock" 

2020-08-31T01:18:31.193445Z	info	sds	Start SDS grpc server
2020-08-31T01:18:31.494432Z	info	sds	resource:default new connection
2020-08-31T01:18:31.494517Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:18:31.494572Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:31.494864Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:31.494880Z	error	sds	Remote side closed connection
2020-08-31T01:18:31.495415Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:18:31.495454Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:18:31.495717Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:18:31.496055Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:31.496084Z	error	sds	Remote side closed connection
2020-08-31T01:18:31.496245Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b48ef756-f2dd-406f-a740-f1af5c87cb3d".sock: use of closed network connection
2020-08-31T01:18:31.496440Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"410af736-4e04-4e6a-b1fb-6e636baf9876\".sock" 

2020-08-31T01:18:31.496513Z	info	sds	Start SDS grpc server
2020-08-31T01:18:31.497480Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:18:31.497541Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:18:31.497592Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:18:31.497810Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:31.497829Z	error	sds	Remote side closed connection
2020-08-31T01:18:31.498073Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"410af736-4e04-4e6a-b1fb-6e636baf9876".sock: use of closed network connection
2020-08-31T01:18:31.498256Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a7332513-f44e-4963-9374-c6b89035a58e\".sock" 

2020-08-31T01:18:31.498297Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:31.799188Z	info	sds	resource:default new connection
2020-08-31T01:18:31.799241Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:18:31.799294Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:31.799589Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:31.799620Z	error	sds	Remote side closed connection
2020-08-31T01:18:31.799841Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a7332513-f44e-4963-9374-c6b89035a58e".sock: use of closed network connection
2020-08-31T01:18:31.800011Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7a4c6063-62fc-4ded-bf16-1bf249f72104\".sock" 

2020-08-31T01:18:31.800048Z	info	sds	Start SDS grpc server
2020-08-31T01:18:31.800079Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:31.800074Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9c220d6d-eb6d-4fa5-8db5-4970cc0ca2f7\".sock" 

2020-08-31T01:18:32.101160Z	info	sds	resource:default new connection
2020-08-31T01:18:32.101224Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:18:32.101283Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:32.101589Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:32.101618Z	error	sds	Remote side closed connection
2020-08-31T01:18:32.102274Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:18:32.102323Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:18:32.102379Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:18:32.102598Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:32.102623Z	error	sds	Remote side closed connection
2020-08-31T01:18:32.193340Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:32.403695Z	info	sds	resource:default new connection
2020-08-31T01:18:32.403769Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:18:32.403824Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:32.404141Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:32.404168Z	error	sds	Remote side closed connection
2020-08-31T01:18:32.404322Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7a4c6063-62fc-4ded-bf16-1bf249f72104".sock: use of closed network connection
2020-08-31T01:18:32.404364Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9c220d6d-eb6d-4fa5-8db5-4970cc0ca2f7".sock: use of closed network connection
2020-08-31T01:18:32.404530Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7862ff0f-b017-4419-8c5d-649ceb0cc523\".sock" 

2020-08-31T01:18:32.404553Z	info	sds	Start SDS grpc server
2020-08-31T01:18:32.496352Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:32.498248Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:18:32.707488Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7862ff0f-b017-4419-8c5d-649ceb0cc523".sock: use of closed network connection
2020-08-31T01:18:32.707662Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"54ace6e1-17d5-4ee9-884d-a4f28edb9d95\".sock" 

2020-08-31T01:18:32.707685Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:32.800053Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:18:33.009587Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"54ace6e1-17d5-4ee9-884d-a4f28edb9d95".sock: use of closed network connection
2020-08-31T01:18:33.009847Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest8b974e21-bb89-4b6a-b1c5-e5f2dfe401b5.sock" 

2020-08-31T01:18:33.009882Z	info	sds	Start SDS grpc server
2020-08-31T01:18:33.010003Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a01db644-58f1-464f-87f7-2becc59269cd\".sock" 

2020-08-31T01:18:33.010050Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:18:33.404460Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:33.404446Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:18:33.613855Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest8b974e21-bb89-4b6a-b1c5-e5f2dfe401b5.sock: use of closed network connection
2020-08-31T01:18:33.613908Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a01db644-58f1-464f-87f7-2becc59269cd".sock: use of closed network connection
2020-08-31T01:18:33.614103Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta92301a3-f96a-4a6a-8634-a3f7add9e125.sock" 

2020-08-31T01:18:33.614119Z	info	sds	Start SDS grpc server
2020-08-31T01:18:33.707700Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:33.915229Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:18:33.915317Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:33.915526Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta92301a3-f96a-4a6a-8634-a3f7add9e125.sock: use of closed network connection
2020-08-31T01:18:33.915716Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf4080f80-892f-44a0-ab99-2eb9fc311e8c.sock" 

2020-08-31T01:18:33.915741Z	info	sds	Start SDS grpc server
2020-08-31T01:18:33.918029Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:18:33.918145Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:18:33.918212Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:33.918416Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:18:33.918877Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:18:33.918932Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:18:34.009833Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:34.193610Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:34.496628Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:34.498480Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:34.614065Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:34.614095Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:34.800360Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:34.915735Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:34.918394Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:34.918438Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:18:35.404720Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:35.404767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:35.707954Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:35.919245Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:35.919585Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf4080f80-892f-44a0-ab99-2eb9fc311e8c.sock: use of closed network connection
2020-08-31T01:18:35.919635Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:35.919659Z	error	sds	Remote side closed connection
2020-08-31T01:18:35.919680Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:35.919701Z	error	sds	Remote side closed connection
2020-08-31T01:18:35.919799Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3add22d8-f415-48bf-a223-d4055f483416.sock" 

2020-08-31T01:18:35.919876Z	info	sds	Start SDS grpc server
2020-08-31T01:18:35.920787Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:18:35.920855Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:18:35.920901Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:35.921337Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:18:35.920900116 +0000 UTC m=+6.803899723 and is waiting for next SDS request
2020-08-31T01:18:35.921357Z	info	sds	Dynamic push for secret default
2020-08-31T01:18:35.921361Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3add22d8-f415-48bf-a223-d4055f483416.sock: use of closed network connection
2020-08-31T01:18:35.921411Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:35.921431Z	error	sds	Remote side closed connection
2020-08-31T01:18:35.921456Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:35.921483Z	error	sds	Remote side closed connection
2020-08-31T01:18:35.921562Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2b57030d-c5f5-4bab-894d-d928d651890b.sock" 

2020-08-31T01:18:35.921634Z	info	sds	Start SDS grpc server
2020-08-31T01:18:35.922090Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:18:35.922123Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:18:35.922155Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:35.922627Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:18:36.010066Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:36.422706Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:36.422751Z	info	sds	Dynamic push for secret default
2020-08-31T01:18:36.423367Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2b57030d-c5f5-4bab-894d-d928d651890b.sock: use of closed network connection
2020-08-31T01:18:36.423442Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:36.423464Z	error	sds	Remote side closed connection
2020-08-31T01:18:36.423516Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:36.423533Z	error	sds	Remote side closed connection
2020-08-31T01:18:36.423688Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd1db9d8e-a821-4b2e-8cd9-1913fe31b977.sock" 

2020-08-31T01:18:36.423777Z	info	sds	Start SDS grpc server
2020-08-31T01:18:36.424002Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd1db9d8e-a821-4b2e-8cd9-1913fe31b977.sock: use of closed network connection
2020-08-31T01:18:36.424112Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7488daf6-f43f-44f4-974e-6d468fe51d02.sock" 

2020-08-31T01:18:36.424135Z	info	sds	Start SDS grpc server
2020-08-31T01:18:36.614304Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:36.614343Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:36.725207Z	info	sds	resource:default new connection
2020-08-31T01:18:36.725275Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:18:36.725371Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:36.725799Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:36.725823Z	error	sds	Remote side closed connection
2020-08-31T01:18:36.916010Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:36.919776Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:36.921518Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:37.026835Z	info	sds	resource:default new connection
2020-08-31T01:18:37.026917Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:18:37.027010Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:37.027293Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:37.027326Z	error	sds	Remote side closed connection
2020-08-31T01:18:37.027594Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7488daf6-f43f-44f4-974e-6d468fe51d02.sock: use of closed network connection
2020-08-31T01:18:37.027763Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest86e8af28-cb4f-4c61-ae2f-0520331d91a9.sock" 

2020-08-31T01:18:37.027788Z	info	sds	Start SDS grpc server
2020-08-31T01:18:37.328634Z	info	sds	resource:default new connection
2020-08-31T01:18:37.328730Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:18:37.328785Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:37.329044Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:37.329069Z	error	sds	Remote side closed connection
2020-08-31T01:18:37.329405Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest86e8af28-cb4f-4c61-ae2f-0520331d91a9.sock: use of closed network connection
2020-08-31T01:18:37.423595Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:37.424135Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:38.027798Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:38.193844Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:38.329573Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:18:38.496903Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:38.498677Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:38.800605Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:38.920050Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:38.921651Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:18:39.358743Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcdc18033-545a-42e1-97f9-13e62c5cfab5.sock" 

2020-08-31T01:18:39.358790Z	info	sds	Start SDS grpc server
2020-08-31T01:18:39.405035Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:39.405064Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:39.423804Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:39.424317Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:39.708198Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:40.010244Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:40.028034Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:40.329855Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:40.359664Z	info	sds	resource:default new connection
2020-08-31T01:18:40.359730Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:18:40.370347Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:18:40.614523Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:40.614564Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:40.621812Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:18:40.621881Z	info	cache	GenerateSecret default
2020-08-31T01:18:40.621967Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:40.622348Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcdc18033-545a-42e1-97f9-13e62c5cfab5.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.752s
2020-08-31T01:18:45.863241Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcb5d9c1c-4392-4bec-aadc-921326d09978.sock" 

2020-08-31T01:18:45.863361Z	info	sds	Start SDS grpc server
2020-08-31T01:18:45.864792Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:18:45.864857Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:18:45.865243Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:46.864648Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:46.864755Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:18:47.865451Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:18:47.865516Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:18:47.865540Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:18:47.865596Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:47.865936Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcb5d9c1c-4392-4bec-aadc-921326d09978.sock: use of closed network connection
2020-08-31T01:18:47.866174Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:47.866204Z	error	sds	Remote side closed connection
2020-08-31T01:18:47.866272Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b3d74f44-f376-46cc-8824-1d4647f30029\".sock" 

2020-08-31T01:18:47.866315Z	info	sds	Start SDS grpc server
2020-08-31T01:18:48.167386Z	info	sds	resource:default new connection
2020-08-31T01:18:48.167453Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:18:48.167527Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:48.167807Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:48.167829Z	error	sds	Remote side closed connection
2020-08-31T01:18:48.168602Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:18:48.168650Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:18:48.168858Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:18:48.169096Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:48.169115Z	error	sds	Remote side closed connection
2020-08-31T01:18:48.169303Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b3d74f44-f376-46cc-8824-1d4647f30029".sock: use of closed network connection
2020-08-31T01:18:48.169494Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9df472e0-3a56-4a50-bbfe-78d2423bb2b6\".sock" 

2020-08-31T01:18:48.169538Z	info	sds	Start SDS grpc server
2020-08-31T01:18:48.169933Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:18:48.169960Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:18:48.169993Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:18:48.170175Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:48.170183Z	error	sds	Remote side closed connection
2020-08-31T01:18:48.170397Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9df472e0-3a56-4a50-bbfe-78d2423bb2b6".sock: use of closed network connection
2020-08-31T01:18:48.170640Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"43f4b0ef-98e1-4364-8ae3-4efcf7d00bc2\".sock" 

2020-08-31T01:18:48.170656Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:48.471551Z	info	sds	resource:default new connection
2020-08-31T01:18:48.471605Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:18:48.471656Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:48.471902Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:48.471927Z	error	sds	Remote side closed connection
2020-08-31T01:18:48.472110Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"43f4b0ef-98e1-4364-8ae3-4efcf7d00bc2".sock: use of closed network connection
2020-08-31T01:18:48.472301Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e2892511-b043-4f84-9909-f8bcaeba6133\".sock" 

2020-08-31T01:18:48.472370Z	info	sds	Start SDS grpc server
2020-08-31T01:18:48.472403Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:48.472397Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"03cbe547-77c2-4734-8a59-455746204b98\".sock" 

2020-08-31T01:18:48.773525Z	info	sds	resource:default new connection
2020-08-31T01:18:48.773591Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:18:48.773647Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:48.773966Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:48.774015Z	error	sds	Remote side closed connection
2020-08-31T01:18:48.774881Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:18:48.774929Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:18:48.774966Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:18:48.775156Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:48.775176Z	error	sds	Remote side closed connection
2020-08-31T01:18:48.866160Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:49.076297Z	info	sds	resource:default new connection
2020-08-31T01:18:49.076349Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:18:49.076401Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:49.076564Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:49.076597Z	error	sds	Remote side closed connection
2020-08-31T01:18:49.076936Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e2892511-b043-4f84-9909-f8bcaeba6133".sock: use of closed network connection
2020-08-31T01:18:49.076978Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"03cbe547-77c2-4734-8a59-455746204b98".sock: use of closed network connection
2020-08-31T01:18:49.077151Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e8dc7d24-a741-4118-8546-f17a7db06519\".sock" 

2020-08-31T01:18:49.077180Z	info	sds	Start SDS grpc server
2020-08-31T01:18:49.169503Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:49.170614Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:18:49.379235Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e8dc7d24-a741-4118-8546-f17a7db06519".sock: use of closed network connection
2020-08-31T01:18:49.379409Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3ca8ed2d-7661-47a3-a27e-d845a17a7104\".sock" 

2020-08-31T01:18:49.379431Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:18:49.472248Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:18:49.681027Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3ca8ed2d-7661-47a3-a27e-d845a17a7104".sock: use of closed network connection
2020-08-31T01:18:49.681257Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest0b000904-bd08-4a08-892f-f7a82f2687ae.sock" 

2020-08-31T01:18:49.681276Z	info	sds	Start SDS grpc server
2020-08-31T01:18:49.681323Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f5401ba1-a1d2-4fdd-88ec-2c11ca990013\".sock" 

2020-08-31T01:18:49.681358Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:18:50.077094Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:50.077115Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:18:50.285587Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest0b000904-bd08-4a08-892f-f7a82f2687ae.sock: use of closed network connection
2020-08-31T01:18:50.285639Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f5401ba1-a1d2-4fdd-88ec-2c11ca990013".sock: use of closed network connection
2020-08-31T01:18:50.285881Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest02f59739-a39c-44f2-b47c-b0f547b77b74.sock" 

2020-08-31T01:18:50.285921Z	info	sds	Start SDS grpc server
2020-08-31T01:18:50.379474Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:50.586890Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:18:50.586981Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:50.587225Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest02f59739-a39c-44f2-b47c-b0f547b77b74.sock: use of closed network connection
2020-08-31T01:18:50.587421Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaf1564bf-949f-4271-b67a-55e2b8696e61.sock" 

2020-08-31T01:18:50.587515Z	info	sds	Start SDS grpc server
2020-08-31T01:18:50.589040Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:18:50.589121Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:18:50.589178Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:18:50.590443Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:18:50.590891Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:18:50.590936Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:50.681229Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:50.866438Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:51.169713Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:51.170775Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:51.285822Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:51.285820Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:51.472478Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:51.587378Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:51.590250Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:51.590287Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:18:52.077342Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:52.077379Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:52.379727Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:52.591171Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:52.591586Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaf1564bf-949f-4271-b67a-55e2b8696e61.sock: use of closed network connection
2020-08-31T01:18:52.591610Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:52.591634Z	error	sds	Remote side closed connection
2020-08-31T01:18:52.591743Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:52.591787Z	error	sds	Remote side closed connection
2020-08-31T01:18:52.591918Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest28e8437e-1bbb-4e95-a14c-34cbdfe0ec1b.sock" 

2020-08-31T01:18:52.591997Z	info	sds	Start SDS grpc server
2020-08-31T01:18:52.592787Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:18:52.592839Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:18:52.592886Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:52.593309Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:18:52.592885665 +0000 UTC m=+6.804980304 and is waiting for next SDS request
2020-08-31T01:18:52.593329Z	info	sds	Dynamic push for secret default
2020-08-31T01:18:52.593416Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:52.593437Z	error	sds	Remote side closed connection
2020-08-31T01:18:52.593418Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest28e8437e-1bbb-4e95-a14c-34cbdfe0ec1b.sock: use of closed network connection
2020-08-31T01:18:52.593474Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:52.593481Z	error	sds	Remote side closed connection
2020-08-31T01:18:52.593667Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdd36438c-7f3f-429d-8700-bd73295add47.sock" 

2020-08-31T01:18:52.593742Z	info	sds	Start SDS grpc server
2020-08-31T01:18:52.594514Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:18:52.594549Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:18:52.594588Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:52.595107Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:18:52.681479Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:53.095288Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:53.095340Z	info	sds	Dynamic push for secret default
2020-08-31T01:18:53.096019Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdd36438c-7f3f-429d-8700-bd73295add47.sock: use of closed network connection
2020-08-31T01:18:53.096154Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:53.096179Z	error	sds	Remote side closed connection
2020-08-31T01:18:53.096216Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:53.096240Z	error	sds	Remote side closed connection
2020-08-31T01:18:53.096388Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5fe07b3d-67d1-42ef-a886-be0fc7e399bf.sock" 

2020-08-31T01:18:53.096466Z	info	sds	Start SDS grpc server
2020-08-31T01:18:53.096623Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5fe07b3d-67d1-42ef-a886-be0fc7e399bf.sock: use of closed network connection
2020-08-31T01:18:53.096780Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcdd65ded-db88-4292-8d99-a6770c1e9e8d.sock" 

2020-08-31T01:18:53.096802Z	info	sds	Start SDS grpc server
2020-08-31T01:18:53.286105Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:53.286092Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:53.397672Z	info	sds	resource:default new connection
2020-08-31T01:18:53.397733Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:18:53.397787Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:53.398119Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:53.398133Z	error	sds	Remote side closed connection
2020-08-31T01:18:53.587552Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:53.591696Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:53.593643Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:53.699194Z	info	sds	resource:default new connection
2020-08-31T01:18:53.699269Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:18:53.699416Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:53.699746Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:53.699774Z	error	sds	Remote side closed connection
2020-08-31T01:18:53.700216Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcdd65ded-db88-4292-8d99-a6770c1e9e8d.sock: use of closed network connection
2020-08-31T01:18:53.700339Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest18eea0b8-6506-4fc3-b2ad-ad63a0e6fcc4.sock" 

2020-08-31T01:18:53.700374Z	info	sds	Start SDS grpc server
2020-08-31T01:18:54.001333Z	info	sds	resource:default new connection
2020-08-31T01:18:54.001399Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:18:54.001468Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:54.001857Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:18:54.001903Z	error	sds	Remote side closed connection
2020-08-31T01:18:54.002044Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest18eea0b8-6506-4fc3-b2ad-ad63a0e6fcc4.sock: use of closed network connection
2020-08-31T01:18:54.096304Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:54.096677Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:54.700477Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:54.866727Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:55.002156Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:18:55.169962Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:55.170963Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:55.472687Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:55.591905Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:55.593872Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:18:56.031565Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste3410aa1-b5bc-43c9-9e58-b7b5930b2625.sock" 

2020-08-31T01:18:56.031613Z	info	sds	Start SDS grpc server
2020-08-31T01:18:56.077574Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:56.077610Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:56.096535Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:56.096893Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:56.379986Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:56.681775Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:18:56.700734Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:57.002476Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:18:57.032526Z	info	sds	resource:default new connection
2020-08-31T01:18:57.032598Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:18:57.034002Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:18:57.157878Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:18:57.157921Z	info	cache	GenerateSecret default
2020-08-31T01:18:57.157985Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:18:57.159315Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste3410aa1-b5bc-43c9-9e58-b7b5930b2625.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.618s
2020-08-31T01:19:02.345573Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7014d995-a8e0-4fc8-9b48-41a7546f2291.sock" 

2020-08-31T01:19:02.345665Z	info	sds	Start SDS grpc server
2020-08-31T01:19:02.347039Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:19:02.347116Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:19:02.347640Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:03.346953Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:03.347020Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:19:04.347533Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:19:04.347950Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:19:04.347987Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:19:04.348108Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:04.350040Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7014d995-a8e0-4fc8-9b48-41a7546f2291.sock: use of closed network connection
2020-08-31T01:19:04.350270Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:04.350301Z	error	sds	Remote side closed connection
2020-08-31T01:19:04.350374Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3b4c148b-e9b0-48d3-8377-1cf47c07b15b\".sock" 

2020-08-31T01:19:04.350414Z	info	sds	Start SDS grpc server
2020-08-31T01:19:04.651348Z	info	sds	resource:default new connection
2020-08-31T01:19:04.651429Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:19:04.651499Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:04.651709Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:04.651735Z	error	sds	Remote side closed connection
2020-08-31T01:19:04.652447Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:19:04.652482Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:19:04.652638Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:19:04.653017Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:04.653038Z	error	sds	Remote side closed connection
2020-08-31T01:19:04.653159Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3b4c148b-e9b0-48d3-8377-1cf47c07b15b".sock: use of closed network connection
2020-08-31T01:19:04.653382Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b65d00a6-be0e-46e6-b75e-b28dcda577cc\".sock" 

2020-08-31T01:19:04.653450Z	info	sds	Start SDS grpc server
2020-08-31T01:19:04.653898Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:19:04.653926Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:19:04.653974Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:19:04.654180Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:04.654220Z	error	sds	Remote side closed connection
2020-08-31T01:19:04.654331Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b65d00a6-be0e-46e6-b75e-b28dcda577cc".sock: use of closed network connection
2020-08-31T01:19:04.654514Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"db792e25-fe52-475e-8488-2bf7f172832e\".sock" 

2020-08-31T01:19:04.654561Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:04.955450Z	info	sds	resource:default new connection
2020-08-31T01:19:04.955514Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:19:04.955577Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:04.955940Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:04.955967Z	error	sds	Remote side closed connection
2020-08-31T01:19:04.956148Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"db792e25-fe52-475e-8488-2bf7f172832e".sock: use of closed network connection
2020-08-31T01:19:04.956346Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b2b6f154-fac8-4cc5-9cbc-8fa9919bb30a\".sock" 

2020-08-31T01:19:04.956404Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"018e529a-3cbe-47c8-9fee-0a1d0ec42cf4\".sock" 

2020-08-31T01:19:04.956418Z	info	sds	Start SDS grpc server
2020-08-31T01:19:04.956438Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:05.257310Z	info	sds	resource:default new connection
2020-08-31T01:19:05.257367Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:19:05.257418Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:05.257741Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:05.257782Z	error	sds	Remote side closed connection
2020-08-31T01:19:05.258252Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:19:05.258307Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:19:05.258348Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:19:05.258571Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:05.258601Z	error	sds	Remote side closed connection
2020-08-31T01:19:05.350280Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:05.559901Z	info	sds	resource:default new connection
2020-08-31T01:19:05.559958Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:19:05.560053Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:05.560379Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:05.560407Z	error	sds	Remote side closed connection
2020-08-31T01:19:05.560712Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b2b6f154-fac8-4cc5-9cbc-8fa9919bb30a".sock: use of closed network connection
2020-08-31T01:19:05.560763Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"018e529a-3cbe-47c8-9fee-0a1d0ec42cf4".sock: use of closed network connection
2020-08-31T01:19:05.560957Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b7c60e4e-b2cf-4a80-b7a4-99d220615f64\".sock" 

2020-08-31T01:19:05.560978Z	info	sds	Start SDS grpc server
2020-08-31T01:19:05.653384Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:05.654477Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:19:05.863182Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b7c60e4e-b2cf-4a80-b7a4-99d220615f64".sock: use of closed network connection
2020-08-31T01:19:05.863353Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"82b42b72-41c5-4798-9fe1-ace881b927c5\".sock" 

2020-08-31T01:19:05.863374Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:05.956349Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:19:06.164970Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"82b42b72-41c5-4798-9fe1-ace881b927c5".sock: use of closed network connection
2020-08-31T01:19:06.165174Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestc86dcbad-cfeb-4f01-bf9a-bb52653b3ac4.sock" 

2020-08-31T01:19:06.165240Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7dd9d6b1-84fc-4c22-acb6-40d1e081e101\".sock" 

2020-08-31T01:19:06.165277Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:06.165253Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:19:06.560896Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:06.560908Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:19:06.769298Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestc86dcbad-cfeb-4f01-bf9a-bb52653b3ac4.sock: use of closed network connection
2020-08-31T01:19:06.769378Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7dd9d6b1-84fc-4c22-acb6-40d1e081e101".sock: use of closed network connection
2020-08-31T01:19:06.769622Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest00a1baf6-884c-4df5-8b73-1a175a42b414.sock" 

2020-08-31T01:19:06.769647Z	info	sds	Start SDS grpc server
2020-08-31T01:19:06.863377Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:07.070775Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:19:07.070872Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:07.071064Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest00a1baf6-884c-4df5-8b73-1a175a42b414.sock: use of closed network connection
2020-08-31T01:19:07.071309Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb0563386-5d4f-4acc-bc64-ca04454c6af1.sock" 

2020-08-31T01:19:07.071393Z	info	sds	Start SDS grpc server
2020-08-31T01:19:07.072215Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:19:07.072265Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:19:07.072347Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:07.072730Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:19:07.072778Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:19:07.072818Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:19:07.165136Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:07.350529Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:07.653614Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:07.654608Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:07.769464Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:07.769499Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:07.956628Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:08.071318Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:08.072810Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:08.072843Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:19:08.561063Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:08.561103Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:08.863537Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:09.073570Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:09.073950Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb0563386-5d4f-4acc-bc64-ca04454c6af1.sock: use of closed network connection
2020-08-31T01:19:09.073987Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:09.074019Z	error	sds	Remote side closed connection
2020-08-31T01:19:09.074056Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:09.074062Z	error	sds	Remote side closed connection
2020-08-31T01:19:09.074198Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5a025e03-ea00-4556-88b9-40bd56a20aea.sock" 

2020-08-31T01:19:09.074280Z	info	sds	Start SDS grpc server
2020-08-31T01:19:09.076341Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:19:09.076500Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:19:09.077049Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:09.077669Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:19:09.077046572 +0000 UTC m=+6.809612425 and is waiting for next SDS request
2020-08-31T01:19:09.077696Z	info	sds	Dynamic push for secret default
2020-08-31T01:19:09.077731Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5a025e03-ea00-4556-88b9-40bd56a20aea.sock: use of closed network connection
2020-08-31T01:19:09.077809Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:09.077831Z	error	sds	Remote side closed connection
2020-08-31T01:19:09.077866Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:09.077880Z	error	sds	Remote side closed connection
2020-08-31T01:19:09.078020Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest43912c57-47ad-41bd-86df-f714e9b176ba.sock" 

2020-08-31T01:19:09.078068Z	info	sds	Start SDS grpc server
2020-08-31T01:19:09.078807Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:19:09.078849Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:19:09.078887Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:09.079451Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:19:09.165371Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:09.579615Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:09.579677Z	info	sds	Dynamic push for secret default
2020-08-31T01:19:09.580370Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest43912c57-47ad-41bd-86df-f714e9b176ba.sock: use of closed network connection
2020-08-31T01:19:09.580464Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:09.580496Z	error	sds	Remote side closed connection
2020-08-31T01:19:09.580524Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:09.580557Z	error	sds	Remote side closed connection
2020-08-31T01:19:09.580610Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta5ef7c90-c1a7-47ac-aff1-ab564c55beaa.sock" 

2020-08-31T01:19:09.580621Z	info	sds	Start SDS grpc server
2020-08-31T01:19:09.580862Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta5ef7c90-c1a7-47ac-aff1-ab564c55beaa.sock: use of closed network connection
2020-08-31T01:19:09.580942Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste2fb3c8c-8af2-451a-89b7-55c1610bdccd.sock" 

2020-08-31T01:19:09.580954Z	info	sds	Start SDS grpc server
2020-08-31T01:19:09.769718Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:09.769747Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:09.881919Z	info	sds	resource:default new connection
2020-08-31T01:19:09.881996Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:19:09.882061Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:09.882392Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:09.882420Z	error	sds	Remote side closed connection
2020-08-31T01:19:10.071564Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:10.074161Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:10.077894Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:10.183484Z	info	sds	resource:default new connection
2020-08-31T01:19:10.183555Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:19:10.183617Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:10.183924Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:10.183951Z	error	sds	Remote side closed connection
2020-08-31T01:19:10.184189Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste2fb3c8c-8af2-451a-89b7-55c1610bdccd.sock: use of closed network connection
2020-08-31T01:19:10.184371Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcb8a198a-9a7d-4c0c-bd71-fcdcb4be2e75.sock" 

2020-08-31T01:19:10.184419Z	info	sds	Start SDS grpc server
2020-08-31T01:19:10.485430Z	info	sds	resource:default new connection
2020-08-31T01:19:10.485503Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:19:10.485576Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:10.485899Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:10.485941Z	error	sds	Remote side closed connection
2020-08-31T01:19:10.486194Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcb8a198a-9a7d-4c0c-bd71-fcdcb4be2e75.sock: use of closed network connection
2020-08-31T01:19:10.580588Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:10.580913Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:11.184397Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:11.350756Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:11.486385Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:19:11.653810Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:11.654823Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:11.956944Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:12.074420Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:12.078084Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:19:12.515578Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4fefcc19-d4de-47ef-a618-8f21e53773be.sock" 

2020-08-31T01:19:12.515629Z	info	sds	Start SDS grpc server
2020-08-31T01:19:12.561316Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:12.561354Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:12.580854Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:12.581114Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:12.863794Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:13.165636Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:13.184534Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:13.486628Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:13.516343Z	info	sds	resource:default new connection
2020-08-31T01:19:13.516406Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:19:13.523907Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:19:13.737060Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:19:13.737109Z	info	cache	GenerateSecret default
2020-08-31T01:19:13.737169Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:13.737585Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4fefcc19-d4de-47ef-a618-8f21e53773be.sock: use of closed network connection
PASS
2020-08-31T01:19:13.737703Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:13.737741Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.719s
2020-08-31T01:19:18.934528Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbff0020d-75dc-4971-8ac9-137c80050447.sock" 

2020-08-31T01:19:18.934627Z	info	sds	Start SDS grpc server
2020-08-31T01:19:18.935816Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:19:18.935888Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:19:18.936397Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:19.935787Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:19.935846Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:19:20.936528Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:19:20.936607Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:19:20.936630Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:19:20.936792Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:20.937022Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbff0020d-75dc-4971-8ac9-137c80050447.sock: use of closed network connection
2020-08-31T01:19:20.937155Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:20.937173Z	error	sds	Remote side closed connection
2020-08-31T01:19:20.937233Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2aabb7b4-bbf5-4025-b6c7-a9b1e21a62ca\".sock" 

2020-08-31T01:19:20.937267Z	info	sds	Start SDS grpc server
2020-08-31T01:19:21.238127Z	info	sds	resource:default new connection
2020-08-31T01:19:21.238187Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:19:21.238242Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:21.238507Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:21.238533Z	error	sds	Remote side closed connection
2020-08-31T01:19:21.239088Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:19:21.239144Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:19:21.239331Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:19:21.239591Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:21.239624Z	error	sds	Remote side closed connection
2020-08-31T01:19:21.239809Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2aabb7b4-bbf5-4025-b6c7-a9b1e21a62ca".sock: use of closed network connection
2020-08-31T01:19:21.240034Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"31993ee2-398b-4189-8c32-dede0314cffc\".sock" 

2020-08-31T01:19:21.240103Z	info	sds	Start SDS grpc server
2020-08-31T01:19:21.240542Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:19:21.240575Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:19:21.240611Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:19:21.240930Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:21.240959Z	error	sds	Remote side closed connection
2020-08-31T01:19:21.241081Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"31993ee2-398b-4189-8c32-dede0314cffc".sock: use of closed network connection
2020-08-31T01:19:21.241246Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1b2ec054-5413-4d4f-b506-b680e0548a66\".sock" 

2020-08-31T01:19:21.241278Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:21.542134Z	info	sds	resource:default new connection
2020-08-31T01:19:21.542195Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:19:21.542252Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:21.542571Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:21.542598Z	error	sds	Remote side closed connection
2020-08-31T01:19:21.542827Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1b2ec054-5413-4d4f-b506-b680e0548a66".sock: use of closed network connection
2020-08-31T01:19:21.543034Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f36c57a4-957f-413c-991b-772a969a43a7\".sock" 

2020-08-31T01:19:21.543056Z	info	sds	Start SDS grpc server
2020-08-31T01:19:21.543096Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"eb40b739-6167-43fa-9289-d7e9a699e522\".sock" 

2020-08-31T01:19:21.543128Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:21.844512Z	info	sds	resource:default new connection
2020-08-31T01:19:21.844568Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:19:21.844619Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:21.844905Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:21.844924Z	error	sds	Remote side closed connection
2020-08-31T01:19:21.845650Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:19:21.845687Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:19:21.845731Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:19:21.845948Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:21.845970Z	error	sds	Remote side closed connection
2020-08-31T01:19:21.937132Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:22.146910Z	info	sds	resource:default new connection
2020-08-31T01:19:22.146969Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:19:22.147032Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:22.147299Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:22.147311Z	error	sds	Remote side closed connection
2020-08-31T01:19:22.147555Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f36c57a4-957f-413c-991b-772a969a43a7".sock: use of closed network connection
2020-08-31T01:19:22.147609Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"eb40b739-6167-43fa-9289-d7e9a699e522".sock: use of closed network connection
2020-08-31T01:19:22.147791Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3228c9ff-d2f7-4531-a2f5-e12303cab5b7\".sock" 

2020-08-31T01:19:22.147826Z	info	sds	Start SDS grpc server
2020-08-31T01:19:22.240032Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:22.241303Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:19:22.450634Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3228c9ff-d2f7-4531-a2f5-e12303cab5b7".sock: use of closed network connection
2020-08-31T01:19:22.450857Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"469a3fdf-222d-454a-a351-27cd7c4e5551\".sock" 

2020-08-31T01:19:22.450882Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:22.543027Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:19:22.752371Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"469a3fdf-222d-454a-a351-27cd7c4e5551".sock: use of closed network connection
2020-08-31T01:19:22.752551Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest8e9aa610-c6d9-479a-a781-7d2f5ad475c7.sock" 

2020-08-31T01:19:22.752605Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"10467f54-b243-4825-aa2a-b6cc7351451f\".sock" 

2020-08-31T01:19:22.752635Z	info	sds	Start SDS grpc server
2020-08-31T01:19:22.752647Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:19:23.147798Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:23.147845Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:19:23.357010Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest8e9aa610-c6d9-479a-a781-7d2f5ad475c7.sock: use of closed network connection
2020-08-31T01:19:23.357063Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"10467f54-b243-4825-aa2a-b6cc7351451f".sock: use of closed network connection
2020-08-31T01:19:23.357261Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest97245b4f-1aab-428f-87d8-e0073ebb6cfe.sock" 

2020-08-31T01:19:23.357302Z	info	sds	Start SDS grpc server
2020-08-31T01:19:23.450883Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:23.658853Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:19:23.658952Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:23.659149Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest97245b4f-1aab-428f-87d8-e0073ebb6cfe.sock: use of closed network connection
2020-08-31T01:19:23.659403Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest42868437-30a9-49a6-a55a-a1574edadfaa.sock" 

2020-08-31T01:19:23.659442Z	info	sds	Start SDS grpc server
2020-08-31T01:19:23.662114Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:19:23.662210Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:19:23.662295Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:23.662313Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:19:23.662357Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:19:23.662391Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:19:23.752602Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:23.937405Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:24.240171Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:24.241482Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:24.357270Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:24.357270Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:24.543305Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:24.659384Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:24.662402Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:24.662437Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:19:25.148065Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:25.148123Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:25.451161Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:25.663192Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:25.663545Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest42868437-30a9-49a6-a55a-a1574edadfaa.sock: use of closed network connection
2020-08-31T01:19:25.663580Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:25.663604Z	error	sds	Remote side closed connection
2020-08-31T01:19:25.663652Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:25.663687Z	error	sds	Remote side closed connection
2020-08-31T01:19:25.663837Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest908c25ad-85b3-4fda-9232-8bfcd46c1c06.sock" 

2020-08-31T01:19:25.663993Z	info	sds	Start SDS grpc server
2020-08-31T01:19:25.664938Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:19:25.664992Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:19:25.665037Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:25.665548Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:19:25.665036886 +0000 UTC m=+6.804567889 and is waiting for next SDS request
2020-08-31T01:19:25.665560Z	info	sds	Dynamic push for secret default
2020-08-31T01:19:25.665615Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest908c25ad-85b3-4fda-9232-8bfcd46c1c06.sock: use of closed network connection
2020-08-31T01:19:25.665704Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:25.665722Z	error	sds	Remote side closed connection
2020-08-31T01:19:25.665732Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:25.665745Z	error	sds	Remote side closed connection
2020-08-31T01:19:25.665886Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1e6d26cf-939b-4851-a03b-d106150fd9cf.sock" 

2020-08-31T01:19:25.665903Z	info	sds	Start SDS grpc server
2020-08-31T01:19:25.666637Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:19:25.666682Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:19:25.666726Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:25.667270Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:19:25.752932Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:26.167383Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:26.167443Z	info	sds	Dynamic push for secret default
2020-08-31T01:19:26.168064Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1e6d26cf-939b-4851-a03b-d106150fd9cf.sock: use of closed network connection
2020-08-31T01:19:26.168201Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:26.168231Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:26.168267Z	error	sds	Remote side closed connection
2020-08-31T01:19:26.168228Z	error	sds	Remote side closed connection
2020-08-31T01:19:26.168354Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbfc5a956-0459-41a7-8c0e-c5cefd3116a9.sock" 

2020-08-31T01:19:26.168424Z	info	sds	Start SDS grpc server
2020-08-31T01:19:26.168622Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbfc5a956-0459-41a7-8c0e-c5cefd3116a9.sock: use of closed network connection
2020-08-31T01:19:26.168852Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf2be4888-6569-49d0-982a-220274f7ff2f.sock" 

2020-08-31T01:19:26.168874Z	info	sds	Start SDS grpc server
2020-08-31T01:19:26.357516Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:26.357550Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:26.469803Z	info	sds	resource:default new connection
2020-08-31T01:19:26.469870Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:19:26.469930Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:26.470206Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:26.470233Z	error	sds	Remote side closed connection
2020-08-31T01:19:26.659556Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:26.663775Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:26.665805Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:26.771206Z	info	sds	resource:default new connection
2020-08-31T01:19:26.771266Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:19:26.771342Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:26.771642Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:26.771656Z	error	sds	Remote side closed connection
2020-08-31T01:19:26.771917Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf2be4888-6569-49d0-982a-220274f7ff2f.sock: use of closed network connection
2020-08-31T01:19:26.772048Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3c6cc98d-a6f9-4c4b-88f5-b9696f222768.sock" 

2020-08-31T01:19:26.772058Z	info	sds	Start SDS grpc server
2020-08-31T01:19:27.073262Z	info	sds	resource:default new connection
2020-08-31T01:19:27.073373Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:19:27.073434Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:27.073775Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:27.073818Z	error	sds	Remote side closed connection
2020-08-31T01:19:27.074136Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3c6cc98d-a6f9-4c4b-88f5-b9696f222768.sock: use of closed network connection
2020-08-31T01:19:27.168304Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:27.168722Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:27.772110Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:27.937702Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:28.074446Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:19:28.240563Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:28.241694Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:28.543602Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:28.664071Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:28.666095Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:19:29.110062Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd1ccf1ae-a457-4df3-87c5-7f2beffabbe1.sock" 

2020-08-31T01:19:29.110150Z	info	sds	Start SDS grpc server
2020-08-31T01:19:29.148417Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:29.148415Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:29.168625Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:29.168866Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:29.451523Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:29.753233Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:29.772364Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:30.074797Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:30.111183Z	info	sds	resource:default new connection
2020-08-31T01:19:30.111249Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:19:30.121220Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:19:30.167136Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:19:30.167182Z	info	cache	GenerateSecret default
2020-08-31T01:19:30.167287Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:30.167738Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd1ccf1ae-a457-4df3-87c5-7f2beffabbe1.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.555s
2020-08-31T01:19:35.618030Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste2013b1b-acb7-45ac-a9a4-959a0e8df36b.sock" 

2020-08-31T01:19:35.618152Z	info	sds	Start SDS grpc server
2020-08-31T01:19:35.619373Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:19:35.619436Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:19:35.619892Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:36.619250Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:36.619316Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:19:37.620033Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:19:37.620104Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:19:37.620126Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:19:37.620205Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:37.620508Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste2013b1b-acb7-45ac-a9a4-959a0e8df36b.sock: use of closed network connection
2020-08-31T01:19:37.620734Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:37.620756Z	error	sds	Remote side closed connection
2020-08-31T01:19:37.621019Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"046dfd0e-61d1-413c-a017-23b673fa9cbd\".sock" 

2020-08-31T01:19:37.621055Z	info	sds	Start SDS grpc server
2020-08-31T01:19:37.922489Z	info	sds	resource:default new connection
2020-08-31T01:19:37.922548Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:19:37.922601Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:37.922924Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:37.922955Z	error	sds	Remote side closed connection
2020-08-31T01:19:37.923392Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:19:37.923451Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:19:37.923625Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:19:37.923867Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:37.923876Z	error	sds	Remote side closed connection
2020-08-31T01:19:37.924166Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"046dfd0e-61d1-413c-a017-23b673fa9cbd".sock: use of closed network connection
2020-08-31T01:19:37.924366Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"763cf0ce-b754-4628-9414-775788bf3436\".sock" 

2020-08-31T01:19:37.924410Z	info	sds	Start SDS grpc server
2020-08-31T01:19:37.924896Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:19:37.924923Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:19:37.924957Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:19:37.925132Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:37.925152Z	error	sds	Remote side closed connection
2020-08-31T01:19:37.925295Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"763cf0ce-b754-4628-9414-775788bf3436".sock: use of closed network connection
2020-08-31T01:19:37.925446Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"01261a5e-0b6d-4d3f-9223-a3d173522e33\".sock" 

2020-08-31T01:19:37.925473Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:38.226345Z	info	sds	resource:default new connection
2020-08-31T01:19:38.226417Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:19:38.226482Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:38.226760Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:38.226779Z	error	sds	Remote side closed connection
2020-08-31T01:19:38.226961Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"01261a5e-0b6d-4d3f-9223-a3d173522e33".sock: use of closed network connection
2020-08-31T01:19:38.227148Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d174c8d4-833e-4eb6-ae52-2f446de960bd\".sock" 

2020-08-31T01:19:38.227201Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"eb12c470-d3e9-4047-8ec3-7842a4372b32\".sock" 

2020-08-31T01:19:38.227232Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:38.227235Z	info	sds	Start SDS grpc server
2020-08-31T01:19:38.528133Z	info	sds	resource:default new connection
2020-08-31T01:19:38.528197Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:19:38.528251Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:38.528565Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:38.528592Z	error	sds	Remote side closed connection
2020-08-31T01:19:38.529169Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:19:38.529213Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:19:38.529251Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:19:38.529521Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:38.529543Z	error	sds	Remote side closed connection
2020-08-31T01:19:38.620734Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:38.830812Z	info	sds	resource:default new connection
2020-08-31T01:19:38.830921Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:19:38.830981Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:38.831270Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:38.831297Z	error	sds	Remote side closed connection
2020-08-31T01:19:38.831520Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d174c8d4-833e-4eb6-ae52-2f446de960bd".sock: use of closed network connection
2020-08-31T01:19:38.831565Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"eb12c470-d3e9-4047-8ec3-7842a4372b32".sock: use of closed network connection
2020-08-31T01:19:38.831796Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ee08aeb1-0e38-4e84-9498-26771452a500\".sock" 

2020-08-31T01:19:38.831820Z	info	sds	Start SDS grpc server
2020-08-31T01:19:38.924397Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:38.925494Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:19:39.134413Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ee08aeb1-0e38-4e84-9498-26771452a500".sock: use of closed network connection
2020-08-31T01:19:39.134629Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7fe750a9-19bd-4db5-b097-ebf491cedae2\".sock" 

2020-08-31T01:19:39.134655Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:39.227159Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:19:39.436475Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7fe750a9-19bd-4db5-b097-ebf491cedae2".sock: use of closed network connection
2020-08-31T01:19:39.436774Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest9acbe89f-c21c-46f3-8c81-23837e2cc298.sock" 

2020-08-31T01:19:39.436798Z	info	sds	Start SDS grpc server
2020-08-31T01:19:39.436859Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d7bf464d-a4fc-4027-bf50-c002f6a52c08\".sock" 

2020-08-31T01:19:39.436902Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:19:39.831708Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:39.831785Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:19:40.040923Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest9acbe89f-c21c-46f3-8c81-23837e2cc298.sock: use of closed network connection
2020-08-31T01:19:40.040977Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d7bf464d-a4fc-4027-bf50-c002f6a52c08".sock: use of closed network connection
2020-08-31T01:19:40.041148Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest38da5cb2-d55d-41d5-9374-95ae40d72d69.sock" 

2020-08-31T01:19:40.041172Z	info	sds	Start SDS grpc server
2020-08-31T01:19:40.134620Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:40.342304Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:19:40.342423Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:40.342646Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest38da5cb2-d55d-41d5-9374-95ae40d72d69.sock: use of closed network connection
2020-08-31T01:19:40.342891Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest69238bce-daa2-4ae3-85ec-696e8509daca.sock" 

2020-08-31T01:19:40.342910Z	info	sds	Start SDS grpc server
2020-08-31T01:19:40.345534Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:19:40.345960Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:19:40.346020Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:40.346031Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:19:40.346078Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:19:40.346113Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:19:40.436645Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:40.620982Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:40.924643Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:40.925690Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:41.041116Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:41.041112Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:41.227403Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:41.342886Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:41.345878Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:41.345935Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:19:41.832013Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:41.832062Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:42.134849Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:42.346711Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:42.347112Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest69238bce-daa2-4ae3-85ec-696e8509daca.sock: use of closed network connection
2020-08-31T01:19:42.347194Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:42.347199Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:42.347206Z	error	sds	Remote side closed connection
2020-08-31T01:19:42.347240Z	error	sds	Remote side closed connection
2020-08-31T01:19:42.347552Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbf704868-df11-41dc-83dc-88f743223509.sock" 

2020-08-31T01:19:42.347665Z	info	sds	Start SDS grpc server
2020-08-31T01:19:42.348576Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:19:42.348643Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:19:42.348742Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:42.349312Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:19:42.348741771 +0000 UTC m=+6.803671498 and is waiting for next SDS request
2020-08-31T01:19:42.349335Z	info	sds	Dynamic push for secret default
2020-08-31T01:19:42.349408Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbf704868-df11-41dc-83dc-88f743223509.sock: use of closed network connection
2020-08-31T01:19:42.349500Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:42.349522Z	error	sds	Remote side closed connection
2020-08-31T01:19:42.349564Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:42.349586Z	error	sds	Remote side closed connection
2020-08-31T01:19:42.349641Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd05e9a79-e70b-4584-8751-bcfdbf7e885c.sock" 

2020-08-31T01:19:42.349666Z	info	sds	Start SDS grpc server
2020-08-31T01:19:42.350208Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:19:42.350244Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:19:42.350278Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:42.350940Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:19:42.436930Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:42.851106Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:42.851164Z	info	sds	Dynamic push for secret default
2020-08-31T01:19:42.851790Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd05e9a79-e70b-4584-8751-bcfdbf7e885c.sock: use of closed network connection
2020-08-31T01:19:42.851941Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:42.851966Z	error	sds	Remote side closed connection
2020-08-31T01:19:42.851975Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:42.852007Z	error	sds	Remote side closed connection
2020-08-31T01:19:42.852058Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste59f4de6-f91c-4304-a92f-eb6d0e3a52e5.sock" 

2020-08-31T01:19:42.852099Z	info	sds	Start SDS grpc server
2020-08-31T01:19:42.852343Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste59f4de6-f91c-4304-a92f-eb6d0e3a52e5.sock: use of closed network connection
2020-08-31T01:19:42.852436Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb826c647-7a58-4984-8e49-e74bd350e1ae.sock" 

2020-08-31T01:19:42.852456Z	info	sds	Start SDS grpc server
2020-08-31T01:19:43.041335Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:43.041371Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:43.153387Z	info	sds	resource:default new connection
2020-08-31T01:19:43.153468Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:19:43.153528Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:43.153815Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:43.153841Z	error	sds	Remote side closed connection
2020-08-31T01:19:43.343121Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:43.347232Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:43.349576Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:43.454830Z	info	sds	resource:default new connection
2020-08-31T01:19:43.454884Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:19:43.454937Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:43.455181Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:43.455210Z	error	sds	Remote side closed connection
2020-08-31T01:19:43.455461Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb826c647-7a58-4984-8e49-e74bd350e1ae.sock: use of closed network connection
2020-08-31T01:19:43.455593Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest41fb7f52-c91c-4b7c-919a-530f3b41da00.sock" 

2020-08-31T01:19:43.455623Z	info	sds	Start SDS grpc server
2020-08-31T01:19:43.756512Z	info	sds	resource:default new connection
2020-08-31T01:19:43.756589Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:19:43.756640Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:43.756941Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:43.756961Z	error	sds	Remote side closed connection
2020-08-31T01:19:43.757239Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest41fb7f52-c91c-4b7c-919a-530f3b41da00.sock: use of closed network connection
2020-08-31T01:19:43.851996Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:43.852478Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:44.455662Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:44.621199Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:44.757434Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:19:44.924919Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:44.925853Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:45.228823Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:45.347487Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:45.349812Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:19:45.786344Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd782210d-108f-41e4-b6dd-0dac071a8ff8.sock" 

2020-08-31T01:19:45.786393Z	info	sds	Start SDS grpc server
2020-08-31T01:19:45.832248Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:45.832287Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:45.852233Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:45.852630Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:46.135125Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:46.437137Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:46.455907Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:46.757687Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:46.787626Z	info	sds	resource:default new connection
2020-08-31T01:19:46.787682Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:19:46.795153Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:19:46.884249Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:19:46.884292Z	info	cache	GenerateSecret default
2020-08-31T01:19:46.884345Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:46.884719Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd782210d-108f-41e4-b6dd-0dac071a8ff8.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.583s
2020-08-31T01:19:52.052549Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3a8727d3-049f-44b2-a151-e5b7efe39745.sock" 

2020-08-31T01:19:52.052684Z	info	sds	Start SDS grpc server
2020-08-31T01:19:52.053938Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:19:52.054048Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:19:52.054426Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:53.053869Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:53.053940Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:19:54.054856Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:19:54.054958Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:19:54.054987Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:19:54.055042Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:54.055411Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:54.055447Z	error	sds	Remote side closed connection
2020-08-31T01:19:54.055582Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"ce97e29b-e573-4217-ac88-76a584750a9a\".sock" 

2020-08-31T01:19:54.055598Z	info	sds	Start SDS grpc server
2020-08-31T01:19:54.356773Z	info	sds	resource:default new connection
2020-08-31T01:19:54.356837Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:19:54.356911Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:54.357192Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:54.357219Z	error	sds	Remote side closed connection
2020-08-31T01:19:54.357781Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:19:54.357835Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:19:54.358053Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:19:54.358405Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:54.358431Z	error	sds	Remote side closed connection
2020-08-31T01:19:54.358677Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"ce97e29b-e573-4217-ac88-76a584750a9a".sock: use of closed network connection
2020-08-31T01:19:54.358910Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"91a264c5-28e3-4cf2-bb94-eb74b608c9e8\".sock" 

2020-08-31T01:19:54.358992Z	info	sds	Start SDS grpc server
2020-08-31T01:19:54.359432Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:19:54.359473Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:19:54.359511Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:19:54.359671Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:54.359683Z	error	sds	Remote side closed connection
2020-08-31T01:19:54.359912Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"91a264c5-28e3-4cf2-bb94-eb74b608c9e8".sock: use of closed network connection
2020-08-31T01:19:54.360069Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6e38b1e2-b738-4d9e-88dc-402cb218b1cf\".sock" 

2020-08-31T01:19:54.360108Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:54.661161Z	info	sds	resource:default new connection
2020-08-31T01:19:54.661220Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:19:54.661280Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:54.661571Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:54.661601Z	error	sds	Remote side closed connection
2020-08-31T01:19:54.661791Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6e38b1e2-b738-4d9e-88dc-402cb218b1cf".sock: use of closed network connection
2020-08-31T01:19:54.662048Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d91b8c7d-4878-4f5f-b9ea-569f14235f5a\".sock" 

2020-08-31T01:19:54.662120Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"6429f1a3-8ad3-4f5c-943a-54786f2d9f2e\".sock" 

2020-08-31T01:19:54.662122Z	info	sds	Start SDS grpc server
2020-08-31T01:19:54.662158Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:54.963051Z	info	sds	resource:default new connection
2020-08-31T01:19:54.963109Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:19:54.963164Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:54.963594Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:54.963622Z	error	sds	Remote side closed connection
2020-08-31T01:19:54.964026Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:19:54.964060Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:19:54.964095Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:19:54.964322Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:54.964332Z	error	sds	Remote side closed connection
2020-08-31T01:19:55.265342Z	info	sds	resource:default new connection
2020-08-31T01:19:55.265407Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:19:55.265461Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:55.265727Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:55.265763Z	error	sds	Remote side closed connection
2020-08-31T01:19:55.265973Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d91b8c7d-4878-4f5f-b9ea-569f14235f5a".sock: use of closed network connection
2020-08-31T01:19:55.266019Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"6429f1a3-8ad3-4f5c-943a-54786f2d9f2e".sock: use of closed network connection
2020-08-31T01:19:55.266191Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5536e8cc-e596-4080-b238-3a22d84cd04f\".sock" 

2020-08-31T01:19:55.266214Z	info	sds	Start SDS grpc server
2020-08-31T01:19:55.358920Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:55.360064Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:19:55.569558Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5536e8cc-e596-4080-b238-3a22d84cd04f".sock: use of closed network connection
2020-08-31T01:19:55.569784Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e9c8ad11-fc3b-4031-93ba-68e5a9a534c8\".sock" 

2020-08-31T01:19:55.569833Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:19:55.661956Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:19:55.871529Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e9c8ad11-fc3b-4031-93ba-68e5a9a534c8".sock: use of closed network connection
2020-08-31T01:19:55.871733Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest799af55d-b2bd-4b76-8725-46d8dedeea40.sock" 

2020-08-31T01:19:55.871790Z	info	sds	Start SDS grpc server
2020-08-31T01:19:55.871853Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3e0261c6-28fc-4e9d-8bce-003fd86bafd6\".sock" 

2020-08-31T01:19:55.871894Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:19:56.266227Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:56.266202Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:19:56.476207Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest799af55d-b2bd-4b76-8725-46d8dedeea40.sock: use of closed network connection
2020-08-31T01:19:56.476270Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3e0261c6-28fc-4e9d-8bce-003fd86bafd6".sock: use of closed network connection
2020-08-31T01:19:56.476470Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest89350ace-5cdb-42e1-93de-e593dd92de40.sock" 

2020-08-31T01:19:56.476498Z	info	sds	Start SDS grpc server
2020-08-31T01:19:56.569801Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:56.777543Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:19:56.777646Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:56.777916Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest89350ace-5cdb-42e1-93de-e593dd92de40.sock: use of closed network connection
2020-08-31T01:19:56.778123Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste167a058-d7e1-44b7-ab53-4ba2924090d6.sock" 

2020-08-31T01:19:56.778225Z	info	sds	Start SDS grpc server
2020-08-31T01:19:56.778858Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:19:56.778904Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:19:56.778947Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:56.779569Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:19:56.779610Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:19:56.779653Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:19:56.871766Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:57.359185Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:57.360210Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:57.476447Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:57.476472Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:57.662234Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:57.778129Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:57.779628Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:57.779660Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:19:58.266489Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:58.266515Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:58.570032Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:58.780530Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:58.780932Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste167a058-d7e1-44b7-ab53-4ba2924090d6.sock: use of closed network connection
2020-08-31T01:19:58.780976Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:58.781000Z	error	sds	Remote side closed connection
2020-08-31T01:19:58.781030Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:58.781047Z	error	sds	Remote side closed connection
2020-08-31T01:19:58.781160Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest69ccac1c-2aa9-4bf0-8bb0-8dbf7153b9c0.sock" 

2020-08-31T01:19:58.781247Z	info	sds	Start SDS grpc server
2020-08-31T01:19:58.783338Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:19:58.783843Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:19:58.783905Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:58.784335Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:19:58.783904065 +0000 UTC m=+6.808351789 and is waiting for next SDS request
2020-08-31T01:19:58.784357Z	info	sds	Dynamic push for secret default
2020-08-31T01:19:58.784402Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest69ccac1c-2aa9-4bf0-8bb0-8dbf7153b9c0.sock: use of closed network connection
2020-08-31T01:19:58.784456Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:58.784464Z	error	sds	Remote side closed connection
2020-08-31T01:19:58.784499Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:58.784504Z	error	sds	Remote side closed connection
2020-08-31T01:19:58.784645Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7785d832-6467-447b-a4b9-7522cd53c929.sock" 

2020-08-31T01:19:58.784731Z	info	sds	Start SDS grpc server
2020-08-31T01:19:58.785350Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:19:58.785389Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:19:58.785423Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:58.785869Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:19:58.872032Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:59.286033Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:59.286101Z	info	sds	Dynamic push for secret default
2020-08-31T01:19:59.286642Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7785d832-6467-447b-a4b9-7522cd53c929.sock: use of closed network connection
2020-08-31T01:19:59.286720Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:59.286751Z	error	sds	Remote side closed connection
2020-08-31T01:19:59.286793Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:59.286817Z	error	sds	Remote side closed connection
2020-08-31T01:19:59.286912Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest29dc5a34-df16-47ad-9e92-c9b143113081.sock" 

2020-08-31T01:19:59.286986Z	info	sds	Start SDS grpc server
2020-08-31T01:19:59.287156Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest29dc5a34-df16-47ad-9e92-c9b143113081.sock: use of closed network connection
2020-08-31T01:19:59.287262Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestae6c091d-ba83-4a34-81bb-a6baf2028de1.sock" 

2020-08-31T01:19:59.287280Z	info	sds	Start SDS grpc server
2020-08-31T01:19:59.476733Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:59.476757Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:19:59.588198Z	info	sds	resource:default new connection
2020-08-31T01:19:59.588267Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:19:59.588353Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:59.588698Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:59.588735Z	error	sds	Remote side closed connection
2020-08-31T01:19:59.778371Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:59.781105Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:59.784562Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:19:59.889687Z	info	sds	resource:default new connection
2020-08-31T01:19:59.889753Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:19:59.889808Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:19:59.890233Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:19:59.890281Z	error	sds	Remote side closed connection
2020-08-31T01:19:59.890415Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestae6c091d-ba83-4a34-81bb-a6baf2028de1.sock: use of closed network connection
2020-08-31T01:19:59.890533Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf2653e1d-a10c-49bd-a4d0-2ad9a135138c.sock" 

2020-08-31T01:19:59.890548Z	info	sds	Start SDS grpc server
2020-08-31T01:20:00.191538Z	info	sds	resource:default new connection
2020-08-31T01:20:00.191606Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:20:00.191681Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:00.192081Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:00.192122Z	error	sds	Remote side closed connection
2020-08-31T01:20:00.192309Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf2653e1d-a10c-49bd-a4d0-2ad9a135138c.sock: use of closed network connection
2020-08-31T01:20:00.286843Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:00.287213Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:00.890612Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:01.192560Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:20:01.359424Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:01.360413Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:01.662506Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:01.781331Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:01.784762Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:20:02.222617Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest418edfdd-9bf3-4a89-8b68-b7c1a6cb8bdd.sock" 

2020-08-31T01:20:02.222676Z	info	sds	Start SDS grpc server
2020-08-31T01:20:02.266789Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:02.266848Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:02.287077Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:02.287382Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:02.570312Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:02.872321Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:02.890835Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:03.192803Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:03.223984Z	info	sds	resource:default new connection
2020-08-31T01:20:03.224039Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:20:03.227554Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:20:03.300306Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:20:03.300352Z	info	cache	GenerateSecret default
2020-08-31T01:20:03.300415Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:03.300780Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest418edfdd-9bf3-4a89-8b68-b7c1a6cb8bdd.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.570s
2020-08-31T01:20:08.542867Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest298ca558-087f-4d1a-944f-d313e777bbe9.sock" 

2020-08-31T01:20:08.542973Z	info	sds	Start SDS grpc server
2020-08-31T01:20:08.544291Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:20:08.544346Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:20:08.544768Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:09.544124Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:09.544184Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:20:10.544808Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:20:10.544891Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:20:10.544917Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:20:10.544973Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:10.545189Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest298ca558-087f-4d1a-944f-d313e777bbe9.sock: use of closed network connection
2020-08-31T01:20:10.545424Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:10.545460Z	error	sds	Remote side closed connection
2020-08-31T01:20:10.545538Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6b84afaa-2278-4d83-b8ff-cb8083109d32\".sock" 

2020-08-31T01:20:10.545576Z	info	sds	Start SDS grpc server
2020-08-31T01:20:10.846513Z	info	sds	resource:default new connection
2020-08-31T01:20:10.846580Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:20:10.846650Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:10.846968Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:10.846996Z	error	sds	Remote side closed connection
2020-08-31T01:20:10.847556Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:20:10.847603Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:20:10.847829Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:20:10.848191Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:10.848216Z	error	sds	Remote side closed connection
2020-08-31T01:20:10.848383Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6b84afaa-2278-4d83-b8ff-cb8083109d32".sock: use of closed network connection
2020-08-31T01:20:10.848616Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"963183de-783d-40d5-ad3d-e34a0cef0f9f\".sock" 

2020-08-31T01:20:10.848703Z	info	sds	Start SDS grpc server
2020-08-31T01:20:10.849220Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:20:10.849296Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:20:10.849349Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:20:10.849691Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:10.849705Z	error	sds	Remote side closed connection
2020-08-31T01:20:10.849947Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"963183de-783d-40d5-ad3d-e34a0cef0f9f".sock: use of closed network connection
2020-08-31T01:20:10.850114Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8e942b16-47b6-4feb-afee-cda47c5248d8\".sock" 

2020-08-31T01:20:10.850150Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:11.151029Z	info	sds	resource:default new connection
2020-08-31T01:20:11.151091Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:20:11.151143Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:11.151426Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:11.151455Z	error	sds	Remote side closed connection
2020-08-31T01:20:11.151688Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8e942b16-47b6-4feb-afee-cda47c5248d8".sock: use of closed network connection
2020-08-31T01:20:11.151966Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a21dee90-d499-40b4-954e-fc06e52affde\".sock" 

2020-08-31T01:20:11.152034Z	info	sds	Start SDS grpc server
2020-08-31T01:20:11.152054Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:11.152048Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ac1fd1f5-164b-4795-b692-799f92740645\".sock" 

2020-08-31T01:20:11.453110Z	info	sds	resource:default new connection
2020-08-31T01:20:11.453178Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:20:11.453235Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:11.453632Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:11.453656Z	error	sds	Remote side closed connection
2020-08-31T01:20:11.454153Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:20:11.454198Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:20:11.454239Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:20:11.454503Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:11.454540Z	error	sds	Remote side closed connection
2020-08-31T01:20:11.545422Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:11.755417Z	info	sds	resource:default new connection
2020-08-31T01:20:11.755478Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:20:11.755534Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:11.755900Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:11.755928Z	error	sds	Remote side closed connection
2020-08-31T01:20:11.756081Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a21dee90-d499-40b4-954e-fc06e52affde".sock: use of closed network connection
2020-08-31T01:20:11.756124Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ac1fd1f5-164b-4795-b692-799f92740645".sock: use of closed network connection
2020-08-31T01:20:11.756381Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c51f5019-e5ca-4299-9e58-86c871a39f9f\".sock" 

2020-08-31T01:20:11.756408Z	info	sds	Start SDS grpc server
2020-08-31T01:20:11.848604Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:11.850136Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:20:12.058882Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c51f5019-e5ca-4299-9e58-86c871a39f9f".sock: use of closed network connection
2020-08-31T01:20:12.059063Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ed2a3939-3ee7-4ec4-98e0-6d00ecafaa6a\".sock" 

2020-08-31T01:20:12.059086Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:12.151834Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:20:12.360709Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ed2a3939-3ee7-4ec4-98e0-6d00ecafaa6a".sock: use of closed network connection
2020-08-31T01:20:12.360977Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest73a6684b-0cf9-4897-b9ac-43fec6c815fb.sock" 

2020-08-31T01:20:12.361050Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"389dcce3-68aa-417d-a411-38d365e8e33c\".sock" 

2020-08-31T01:20:12.361064Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:12.361041Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:20:12.756234Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:12.756259Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:20:12.965864Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest73a6684b-0cf9-4897-b9ac-43fec6c815fb.sock: use of closed network connection
2020-08-31T01:20:12.965991Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"389dcce3-68aa-417d-a411-38d365e8e33c".sock: use of closed network connection
2020-08-31T01:20:12.966192Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestabf75c6c-ca59-4177-bcde-2e31a8214d83.sock" 

2020-08-31T01:20:12.966217Z	info	sds	Start SDS grpc server
2020-08-31T01:20:13.059118Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:13.267209Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:20:13.267303Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:13.267552Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestabf75c6c-ca59-4177-bcde-2e31a8214d83.sock: use of closed network connection
2020-08-31T01:20:13.267756Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdef74eba-00d0-416c-a186-3640577d5d8e.sock" 

2020-08-31T01:20:13.267783Z	info	sds	Start SDS grpc server
2020-08-31T01:20:13.268503Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:20:13.268563Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:20:13.268620Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:13.268732Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:20:13.268780Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:20:13.268814Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:20:13.360931Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:13.545575Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:13.848869Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:13.850317Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:13.966046Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:13.966085Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:14.152028Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:14.267765Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:14.268790Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:14.268830Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:20:14.756471Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:14.756527Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:15.059341Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:15.269629Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:15.269980Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdef74eba-00d0-416c-a186-3640577d5d8e.sock: use of closed network connection
2020-08-31T01:20:15.270060Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:15.270068Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:15.270100Z	error	sds	Remote side closed connection
2020-08-31T01:20:15.270070Z	error	sds	Remote side closed connection
2020-08-31T01:20:15.270255Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0c820357-428b-4c8d-9936-f5e5d5ac17a8.sock" 

2020-08-31T01:20:15.270385Z	info	sds	Start SDS grpc server
2020-08-31T01:20:15.271596Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:20:15.271638Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:20:15.271681Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:15.272157Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:20:15.271681076 +0000 UTC m=+6.802326970 and is waiting for next SDS request
2020-08-31T01:20:15.272182Z	info	sds	Dynamic push for secret default
2020-08-31T01:20:15.272201Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0c820357-428b-4c8d-9936-f5e5d5ac17a8.sock: use of closed network connection
2020-08-31T01:20:15.272326Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:15.272339Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:15.272354Z	error	sds	Remote side closed connection
2020-08-31T01:20:15.272348Z	error	sds	Remote side closed connection
2020-08-31T01:20:15.272422Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaca3fe00-1398-422e-9e30-701aa0124cc2.sock" 

2020-08-31T01:20:15.272494Z	info	sds	Start SDS grpc server
2020-08-31T01:20:15.274046Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:20:15.274188Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:20:15.274295Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:15.275386Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:20:15.361171Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:15.775519Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:15.775577Z	info	sds	Dynamic push for secret default
2020-08-31T01:20:15.776150Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaca3fe00-1398-422e-9e30-701aa0124cc2.sock: use of closed network connection
2020-08-31T01:20:15.776287Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:15.776312Z	error	sds	Remote side closed connection
2020-08-31T01:20:15.776362Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:15.776389Z	error	sds	Remote side closed connection
2020-08-31T01:20:15.776396Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0f928fcf-fdd7-4319-abb9-d3ba43c94f0a.sock" 

2020-08-31T01:20:15.776493Z	info	sds	Start SDS grpc server
2020-08-31T01:20:15.776642Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0f928fcf-fdd7-4319-abb9-d3ba43c94f0a.sock: use of closed network connection
2020-08-31T01:20:15.776805Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest375b08e7-178e-4035-9aeb-5ec990cea516.sock" 

2020-08-31T01:20:15.776832Z	info	sds	Start SDS grpc server
2020-08-31T01:20:15.966295Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:15.966326Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:16.077717Z	info	sds	resource:default new connection
2020-08-31T01:20:16.077799Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:20:16.077891Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:16.078193Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:16.078241Z	error	sds	Remote side closed connection
2020-08-31T01:20:16.268000Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:16.270143Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:16.272412Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:16.379281Z	info	sds	resource:default new connection
2020-08-31T01:20:16.379358Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:20:16.379423Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:16.379727Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:16.379744Z	error	sds	Remote side closed connection
2020-08-31T01:20:16.380058Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest375b08e7-178e-4035-9aeb-5ec990cea516.sock: use of closed network connection
2020-08-31T01:20:16.380218Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfe05ae3a-e756-4f7c-af84-7b294205f9e4.sock" 

2020-08-31T01:20:16.380241Z	info	sds	Start SDS grpc server
2020-08-31T01:20:16.681250Z	info	sds	resource:default new connection
2020-08-31T01:20:16.681310Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:20:16.681364Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:16.681678Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:16.681695Z	error	sds	Remote side closed connection
2020-08-31T01:20:16.682117Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfe05ae3a-e756-4f7c-af84-7b294205f9e4.sock: use of closed network connection
2020-08-31T01:20:16.776363Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:16.776808Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:17.380346Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:17.545829Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:17.682314Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:20:17.849140Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:17.850502Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:18.152298Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:18.270409Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:18.272597Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:20:18.711073Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest29cb08c9-c3ab-4b48-b027-e5d52db37877.sock" 

2020-08-31T01:20:18.711128Z	info	sds	Start SDS grpc server
2020-08-31T01:20:18.756734Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:18.756769Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:18.776634Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:18.776945Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:19.059584Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:19.361437Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:19.380597Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:19.682596Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:19.711903Z	info	sds	resource:default new connection
2020-08-31T01:20:19.711968Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:20:19.721584Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:20:19.873452Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:20:19.873501Z	info	cache	GenerateSecret default
2020-08-31T01:20:19.873586Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:19.873976Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest29cb08c9-c3ab-4b48-b027-e5d52db37877.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.650s
2020-08-31T01:20:25.291813Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc91013e7-4b5d-496b-8431-9f0000f5d997.sock" 

2020-08-31T01:20:25.291928Z	info	sds	Start SDS grpc server
2020-08-31T01:20:25.294580Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:20:25.294644Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:20:25.295037Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:26.294425Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:26.294486Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:20:27.295243Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:20:27.295341Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:20:27.295368Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:20:27.295445Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:27.295732Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc91013e7-4b5d-496b-8431-9f0000f5d997.sock: use of closed network connection
2020-08-31T01:20:27.295878Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:27.295909Z	error	sds	Remote side closed connection
2020-08-31T01:20:27.296017Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"549f5c45-e991-471c-829e-b9c18a479cef\".sock" 

2020-08-31T01:20:27.296063Z	info	sds	Start SDS grpc server
2020-08-31T01:20:27.597079Z	info	sds	resource:default new connection
2020-08-31T01:20:27.597140Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:20:27.597199Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:27.597492Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:27.597528Z	error	sds	Remote side closed connection
2020-08-31T01:20:27.598062Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:20:27.598119Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:20:27.598279Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:20:27.598565Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:27.598586Z	error	sds	Remote side closed connection
2020-08-31T01:20:27.598821Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"549f5c45-e991-471c-829e-b9c18a479cef".sock: use of closed network connection
2020-08-31T01:20:27.599036Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cea8b0a2-7a6e-408b-bcb7-59522275c957\".sock" 

2020-08-31T01:20:27.599109Z	info	sds	Start SDS grpc server
2020-08-31T01:20:27.599615Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:20:27.599647Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:20:27.599687Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:20:27.599978Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:27.600000Z	error	sds	Remote side closed connection
2020-08-31T01:20:27.600187Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cea8b0a2-7a6e-408b-bcb7-59522275c957".sock: use of closed network connection
2020-08-31T01:20:27.600379Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0f15b058-23e5-4710-90ee-2512131b44c8\".sock" 

2020-08-31T01:20:27.600409Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:27.901443Z	info	sds	resource:default new connection
2020-08-31T01:20:27.901543Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:20:27.901603Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:27.901940Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:27.901960Z	error	sds	Remote side closed connection
2020-08-31T01:20:27.902165Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0f15b058-23e5-4710-90ee-2512131b44c8".sock: use of closed network connection
2020-08-31T01:20:27.902409Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0fba10ed-ea34-41ff-becd-5bd04254798a\".sock" 

2020-08-31T01:20:27.902471Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a0f4b296-f985-4816-aab4-3b22278422b8\".sock" 

2020-08-31T01:20:27.902474Z	info	sds	Start SDS grpc server
2020-08-31T01:20:27.902503Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:28.203550Z	info	sds	resource:default new connection
2020-08-31T01:20:28.203619Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:20:28.203688Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:28.204008Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:28.204039Z	error	sds	Remote side closed connection
2020-08-31T01:20:28.204613Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:20:28.204651Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:20:28.204736Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:20:28.204983Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:28.204998Z	error	sds	Remote side closed connection
2020-08-31T01:20:28.295998Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:28.505986Z	info	sds	resource:default new connection
2020-08-31T01:20:28.506063Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:20:28.506124Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:28.506420Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:28.506432Z	error	sds	Remote side closed connection
2020-08-31T01:20:28.506686Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0fba10ed-ea34-41ff-becd-5bd04254798a".sock: use of closed network connection
2020-08-31T01:20:28.506736Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a0f4b296-f985-4816-aab4-3b22278422b8".sock: use of closed network connection
2020-08-31T01:20:28.506961Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"df22e386-9a9e-4cd4-a0ae-3423c581f34b\".sock" 

2020-08-31T01:20:28.506979Z	info	sds	Start SDS grpc server
2020-08-31T01:20:28.599035Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:28.600348Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:20:28.809646Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"df22e386-9a9e-4cd4-a0ae-3423c581f34b".sock: use of closed network connection
2020-08-31T01:20:28.809847Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ede8ea57-9c2a-4b0f-997a-fa6258094992\".sock" 

2020-08-31T01:20:28.809868Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:28.902401Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:20:29.111525Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ede8ea57-9c2a-4b0f-997a-fa6258094992".sock: use of closed network connection
2020-08-31T01:20:29.111788Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest7e7b2776-8d21-48a9-80e3-21ff21344722.sock" 

2020-08-31T01:20:29.111845Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a2820871-a6a5-4138-8689-6adc614c93ee\".sock" 

2020-08-31T01:20:29.111875Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:29.111884Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:20:29.506865Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:29.506948Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:20:29.715749Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest7e7b2776-8d21-48a9-80e3-21ff21344722.sock: use of closed network connection
2020-08-31T01:20:29.715806Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a2820871-a6a5-4138-8689-6adc614c93ee".sock: use of closed network connection
2020-08-31T01:20:29.716032Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest7c96f66e-8c8b-4479-a6b4-8a6335e1f573.sock" 

2020-08-31T01:20:29.716070Z	info	sds	Start SDS grpc server
2020-08-31T01:20:29.809841Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:30.017482Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:20:30.017569Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:30.017754Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest7c96f66e-8c8b-4479-a6b4-8a6335e1f573.sock: use of closed network connection
2020-08-31T01:20:30.017948Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest05c3fa77-60e9-4dd6-a073-cca8f5b49506.sock" 

2020-08-31T01:20:30.017992Z	info	sds	Start SDS grpc server
2020-08-31T01:20:30.018584Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:20:30.018652Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:20:30.018712Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:30.018761Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:20:30.018800Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:20:30.018845Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:20:30.111757Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:30.296103Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:30.599281Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:30.600530Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:30.715883Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:30.715895Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:30.902640Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:31.017964Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:31.018883Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:31.018917Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:20:31.507139Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:31.507179Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:31.810088Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:32.019718Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:32.020094Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest05c3fa77-60e9-4dd6-a073-cca8f5b49506.sock: use of closed network connection
2020-08-31T01:20:32.020124Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:32.020159Z	error	sds	Remote side closed connection
2020-08-31T01:20:32.020203Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:32.020226Z	error	sds	Remote side closed connection
2020-08-31T01:20:32.020332Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest53c6f769-1cbb-4462-abf1-6c56727ee655.sock" 

2020-08-31T01:20:32.020401Z	info	sds	Start SDS grpc server
2020-08-31T01:20:32.021127Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:20:32.021173Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:20:32.021219Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:32.021648Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:20:32.021219126 +0000 UTC m=+6.803837145 and is waiting for next SDS request
2020-08-31T01:20:32.021674Z	info	sds	Dynamic push for secret default
2020-08-31T01:20:32.021686Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest53c6f769-1cbb-4462-abf1-6c56727ee655.sock: use of closed network connection
2020-08-31T01:20:32.021755Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:32.021776Z	error	sds	Remote side closed connection
2020-08-31T01:20:32.021814Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:32.021820Z	error	sds	Remote side closed connection
2020-08-31T01:20:32.021911Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest937c5f3b-ab12-4975-b0ef-caf8355a79b2.sock" 

2020-08-31T01:20:32.021928Z	info	sds	Start SDS grpc server
2020-08-31T01:20:32.022492Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:20:32.022535Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:20:32.022574Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:32.023057Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:20:32.111999Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:32.523258Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:32.523317Z	info	sds	Dynamic push for secret default
2020-08-31T01:20:32.523943Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest937c5f3b-ab12-4975-b0ef-caf8355a79b2.sock: use of closed network connection
2020-08-31T01:20:32.524019Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:32.524044Z	error	sds	Remote side closed connection
2020-08-31T01:20:32.524085Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:32.524117Z	error	sds	Remote side closed connection
2020-08-31T01:20:32.524157Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest98354a7e-4551-4877-a8ae-829591c91fa9.sock" 

2020-08-31T01:20:32.524199Z	info	sds	Start SDS grpc server
2020-08-31T01:20:32.524407Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest98354a7e-4551-4877-a8ae-829591c91fa9.sock: use of closed network connection
2020-08-31T01:20:32.524492Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestba552e6e-4741-4cc8-92fe-16f3d662906c.sock" 

2020-08-31T01:20:32.524515Z	info	sds	Start SDS grpc server
2020-08-31T01:20:32.716165Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:32.716246Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:32.825474Z	info	sds	resource:default new connection
2020-08-31T01:20:32.825536Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:20:32.825597Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:32.825887Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:32.825920Z	error	sds	Remote side closed connection
2020-08-31T01:20:33.018168Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:33.020294Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:33.021852Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:33.127488Z	info	sds	resource:default new connection
2020-08-31T01:20:33.127574Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:20:33.127649Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:33.127857Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:33.127888Z	error	sds	Remote side closed connection
2020-08-31T01:20:33.128204Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestba552e6e-4741-4cc8-92fe-16f3d662906c.sock: use of closed network connection
2020-08-31T01:20:33.128447Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc631b001-6c07-4acc-8e84-26c9332f1eda.sock" 

2020-08-31T01:20:33.128498Z	info	sds	Start SDS grpc server
2020-08-31T01:20:33.429284Z	info	sds	resource:default new connection
2020-08-31T01:20:33.429378Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:20:33.429436Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:33.429746Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:33.429773Z	error	sds	Remote side closed connection
2020-08-31T01:20:33.430016Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc631b001-6c07-4acc-8e84-26c9332f1eda.sock: use of closed network connection
2020-08-31T01:20:33.524146Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:33.524562Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:34.128477Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:34.296364Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:34.430234Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:20:34.599573Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:34.600749Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:34.902908Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:35.020501Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:35.022020Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:20:35.461956Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0e290a55-83e6-4132-9710-0d8e39575227.sock" 

2020-08-31T01:20:35.462011Z	info	sds	Start SDS grpc server
2020-08-31T01:20:35.507468Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:35.507541Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:35.524382Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:35.524737Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:35.810348Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:36.112237Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:36.128724Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:36.430472Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:36.462828Z	info	sds	resource:default new connection
2020-08-31T01:20:36.462903Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:20:36.473588Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:20:36.521134Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:20:36.522018Z	info	cache	GenerateSecret default
2020-08-31T01:20:36.522119Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:36.522568Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0e290a55-83e6-4132-9710-0d8e39575227.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.554s
2020-08-31T01:20:41.735788Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest35a69e51-bd29-4661-8786-c9b72cde9ece.sock" 

2020-08-31T01:20:41.735826Z	info	sds	Start SDS grpc server
2020-08-31T01:20:41.737602Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:20:41.737696Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:20:41.738094Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:42.736975Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:42.737024Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:20:43.737761Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:20:43.737856Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:20:43.737890Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:20:43.737949Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:43.738203Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest35a69e51-bd29-4661-8786-c9b72cde9ece.sock: use of closed network connection
2020-08-31T01:20:43.738362Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:43.738393Z	error	sds	Remote side closed connection
2020-08-31T01:20:43.738481Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"add13fe5-7b55-472b-a6c3-8a551f1d3610\".sock" 

2020-08-31T01:20:43.738526Z	info	sds	Start SDS grpc server
2020-08-31T01:20:44.039576Z	info	sds	resource:default new connection
2020-08-31T01:20:44.039657Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:20:44.039729Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:44.040094Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:44.040114Z	error	sds	Remote side closed connection
2020-08-31T01:20:44.040889Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:20:44.040943Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:20:44.041110Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:20:44.041389Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:44.041409Z	error	sds	Remote side closed connection
2020-08-31T01:20:44.041594Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"add13fe5-7b55-472b-a6c3-8a551f1d3610".sock: use of closed network connection
2020-08-31T01:20:44.041763Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"242926eb-2c81-47a0-a39d-41d6c96d9a12\".sock" 

2020-08-31T01:20:44.041835Z	info	sds	Start SDS grpc server
2020-08-31T01:20:44.042354Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:20:44.042414Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:20:44.042466Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:20:44.042693Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:44.042732Z	error	sds	Remote side closed connection
2020-08-31T01:20:44.042891Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"242926eb-2c81-47a0-a39d-41d6c96d9a12".sock: use of closed network connection
2020-08-31T01:20:44.043056Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"de4af8da-b262-4873-ad21-db67731921a4\".sock" 

2020-08-31T01:20:44.043085Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:44.344117Z	info	sds	resource:default new connection
2020-08-31T01:20:44.344174Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:20:44.344232Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:44.344551Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:44.344585Z	error	sds	Remote side closed connection
2020-08-31T01:20:44.344833Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"de4af8da-b262-4873-ad21-db67731921a4".sock: use of closed network connection
2020-08-31T01:20:44.345044Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f3b76411-0f2e-4a8f-b9f7-4fc51e1ba32c\".sock" 

2020-08-31T01:20:44.345100Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"63cf7733-d9c0-4b83-91ba-1a91582207cf\".sock" 

2020-08-31T01:20:44.345131Z	info	sds	Start SDS grpc server
2020-08-31T01:20:44.345146Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:44.646057Z	info	sds	resource:default new connection
2020-08-31T01:20:44.646111Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:20:44.646162Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:44.646541Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:44.646582Z	error	sds	Remote side closed connection
2020-08-31T01:20:44.647106Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:20:44.647141Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:20:44.647177Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:20:44.647575Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:44.647594Z	error	sds	Remote side closed connection
2020-08-31T01:20:44.738416Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:44.948755Z	info	sds	resource:default new connection
2020-08-31T01:20:44.948818Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:20:44.948887Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:44.949341Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:44.949376Z	error	sds	Remote side closed connection
2020-08-31T01:20:44.949462Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f3b76411-0f2e-4a8f-b9f7-4fc51e1ba32c".sock: use of closed network connection
2020-08-31T01:20:44.949530Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"63cf7733-d9c0-4b83-91ba-1a91582207cf".sock: use of closed network connection
2020-08-31T01:20:44.949716Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"09af075b-fd61-489c-a62d-af42df7325f6\".sock" 

2020-08-31T01:20:44.949737Z	info	sds	Start SDS grpc server
2020-08-31T01:20:45.041827Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:45.043075Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:20:45.252829Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"09af075b-fd61-489c-a62d-af42df7325f6".sock: use of closed network connection
2020-08-31T01:20:45.253030Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e1d7ba93-d1db-4ad8-9c0b-3ed5f3198263\".sock" 

2020-08-31T01:20:45.253056Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:45.345051Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:20:45.554601Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e1d7ba93-d1db-4ad8-9c0b-3ed5f3198263".sock: use of closed network connection
2020-08-31T01:20:45.554803Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste92c4dad-2222-4f9f-9fed-7352fad4c061.sock" 

2020-08-31T01:20:45.554867Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"35f65831-9efa-43bd-a46f-2a3928b1cf6f\".sock" 

2020-08-31T01:20:45.554900Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:20:45.554893Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:20:45.949681Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:45.949731Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:20:46.158984Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste92c4dad-2222-4f9f-9fed-7352fad4c061.sock: use of closed network connection
2020-08-31T01:20:46.159056Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"35f65831-9efa-43bd-a46f-2a3928b1cf6f".sock: use of closed network connection
2020-08-31T01:20:46.159262Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest13e0e3ca-29f4-4c36-8cd7-c6df24a1cf5d.sock" 

2020-08-31T01:20:46.159287Z	info	sds	Start SDS grpc server
2020-08-31T01:20:46.253022Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:46.460264Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:20:46.460388Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:46.460760Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest13e0e3ca-29f4-4c36-8cd7-c6df24a1cf5d.sock: use of closed network connection
2020-08-31T01:20:46.461048Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest927b837d-4bee-4cae-ad3e-e317d77ab445.sock" 

2020-08-31T01:20:46.461121Z	info	sds	Start SDS grpc server
2020-08-31T01:20:46.462274Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:20:46.462320Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:20:46.462365Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:46.462467Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:20:46.462527Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:20:46.462564Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:20:46.554832Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:46.738557Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:47.041946Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:47.043241Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:47.159194Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:47.159240Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:47.345296Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:47.460997Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:47.462152Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:47.462188Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:20:47.949984Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:47.950021Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:48.253247Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:48.462961Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:48.463355Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest927b837d-4bee-4cae-ad3e-e317d77ab445.sock: use of closed network connection
2020-08-31T01:20:48.463392Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:48.463413Z	error	sds	Remote side closed connection
2020-08-31T01:20:48.463441Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:48.463466Z	error	sds	Remote side closed connection
2020-08-31T01:20:48.463594Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest54389149-0dfd-4945-a911-3242d227d977.sock" 

2020-08-31T01:20:48.463680Z	info	sds	Start SDS grpc server
2020-08-31T01:20:48.465639Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:20:48.465711Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:20:48.465797Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:48.466691Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:20:48.465796484 +0000 UTC m=+6.803345853 and is waiting for next SDS request
2020-08-31T01:20:48.466726Z	info	sds	Dynamic push for secret default
2020-08-31T01:20:48.466730Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest54389149-0dfd-4945-a911-3242d227d977.sock: use of closed network connection
2020-08-31T01:20:48.466863Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:48.466892Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:48.466885Z	error	sds	Remote side closed connection
2020-08-31T01:20:48.466917Z	error	sds	Remote side closed connection
2020-08-31T01:20:48.467027Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb58fda30-d539-4219-8ef7-662a62dd41a8.sock" 

2020-08-31T01:20:48.467169Z	info	sds	Start SDS grpc server
2020-08-31T01:20:48.467914Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:20:48.467956Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:20:48.467993Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:48.468509Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:20:48.555125Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:48.968712Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:48.968761Z	info	sds	Dynamic push for secret default
2020-08-31T01:20:48.969444Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb58fda30-d539-4219-8ef7-662a62dd41a8.sock: use of closed network connection
2020-08-31T01:20:48.969526Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:48.969553Z	error	sds	Remote side closed connection
2020-08-31T01:20:48.969587Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:48.969607Z	error	sds	Remote side closed connection
2020-08-31T01:20:48.969717Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5b6e5a86-f397-4063-8ccf-ffab98d5563c.sock" 

2020-08-31T01:20:48.969745Z	info	sds	Start SDS grpc server
2020-08-31T01:20:48.969992Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5b6e5a86-f397-4063-8ccf-ffab98d5563c.sock: use of closed network connection
2020-08-31T01:20:48.970109Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest669e6069-4b0e-46b4-be9c-5cc1e67bda9d.sock" 

2020-08-31T01:20:48.970133Z	info	sds	Start SDS grpc server
2020-08-31T01:20:49.159428Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:49.159494Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:49.271083Z	info	sds	resource:default new connection
2020-08-31T01:20:49.271138Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:20:49.271191Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:49.271535Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:49.271569Z	error	sds	Remote side closed connection
2020-08-31T01:20:49.461253Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:49.463530Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:49.466883Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:49.572680Z	info	sds	resource:default new connection
2020-08-31T01:20:49.572769Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:20:49.572826Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:49.573131Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:49.573154Z	error	sds	Remote side closed connection
2020-08-31T01:20:49.573457Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest669e6069-4b0e-46b4-be9c-5cc1e67bda9d.sock: use of closed network connection
2020-08-31T01:20:49.573601Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta7766431-a12e-4949-8c36-dfc0bab8adc7.sock" 

2020-08-31T01:20:49.573637Z	info	sds	Start SDS grpc server
2020-08-31T01:20:49.874522Z	info	sds	resource:default new connection
2020-08-31T01:20:49.874588Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:20:49.874658Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:49.875082Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:49.875116Z	error	sds	Remote side closed connection
2020-08-31T01:20:49.875416Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta7766431-a12e-4949-8c36-dfc0bab8adc7.sock: use of closed network connection
2020-08-31T01:20:49.969684Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:49.970131Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:50.573688Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:50.738814Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:50.875621Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:20:51.042190Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:51.043343Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:51.345613Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:51.463760Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:51.467091Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:20:51.905707Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest96b80f89-e049-4edc-af08-5c3c36e1102c.sock" 

2020-08-31T01:20:51.905734Z	info	sds	Start SDS grpc server
2020-08-31T01:20:51.950102Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:51.950153Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:51.969942Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:51.970312Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:52.253498Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:52.555369Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:20:52.573964Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:52.875902Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:20:52.915051Z	info	sds	resource:default new connection
2020-08-31T01:20:52.915149Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:20:52.917932Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:20:53.013371Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:20:53.013425Z	info	cache	GenerateSecret default
2020-08-31T01:20:53.013484Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:53.013859Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest96b80f89-e049-4edc-af08-5c3c36e1102c.sock: use of closed network connection
PASS
2020-08-31T01:20:53.013986Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:53.014012Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.597s
2020-08-31T01:20:58.223454Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0eb93431-55cc-4189-950a-12ee4ab91d3f.sock" 

2020-08-31T01:20:58.223585Z	info	sds	Start SDS grpc server
2020-08-31T01:20:58.224976Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:20:58.225038Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:20:58.225454Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:20:59.224807Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:20:59.224888Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:21:00.225563Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:21:00.225640Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:21:00.225668Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:21:00.225736Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:00.226014Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0eb93431-55cc-4189-950a-12ee4ab91d3f.sock: use of closed network connection
2020-08-31T01:21:00.226149Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:00.226185Z	error	sds	Remote side closed connection
2020-08-31T01:21:00.226387Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"701a42aa-5f3a-456d-a3b5-7a106da42267\".sock" 

2020-08-31T01:21:00.226434Z	info	sds	Start SDS grpc server
2020-08-31T01:21:00.527367Z	info	sds	resource:default new connection
2020-08-31T01:21:00.527436Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:21:00.527493Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:00.527744Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:00.527797Z	error	sds	Remote side closed connection
2020-08-31T01:21:00.528343Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:21:00.528398Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:21:00.528601Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:21:00.528916Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:00.528941Z	error	sds	Remote side closed connection
2020-08-31T01:21:00.529192Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"701a42aa-5f3a-456d-a3b5-7a106da42267".sock: use of closed network connection
2020-08-31T01:21:00.529384Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"831ce707-8663-40a5-b95c-41e8c74f0990\".sock" 

2020-08-31T01:21:00.529489Z	info	sds	Start SDS grpc server
2020-08-31T01:21:00.529979Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:21:00.530037Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:21:00.530091Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:21:00.530338Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:00.530353Z	error	sds	Remote side closed connection
2020-08-31T01:21:00.530550Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"831ce707-8663-40a5-b95c-41e8c74f0990".sock: use of closed network connection
2020-08-31T01:21:00.530694Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"69c18566-add0-4788-9d89-8a493a099e9e\".sock" 

2020-08-31T01:21:00.530714Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:00.838991Z	info	sds	resource:default new connection
2020-08-31T01:21:00.839096Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:21:00.839152Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:00.839543Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:00.839575Z	error	sds	Remote side closed connection
2020-08-31T01:21:00.839720Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"69c18566-add0-4788-9d89-8a493a099e9e".sock: use of closed network connection
2020-08-31T01:21:00.839958Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"0b3f2dbb-8764-4bbb-8b5b-f5ea08c45610\".sock" 

2020-08-31T01:21:00.840015Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"361c3c05-3b21-41e0-9e1e-42bd6534bc36\".sock" 

2020-08-31T01:21:00.840028Z	info	sds	Start SDS grpc server
2020-08-31T01:21:00.840045Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:01.140888Z	info	sds	resource:default new connection
2020-08-31T01:21:01.140954Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:21:01.141009Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:01.141231Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:01.141255Z	error	sds	Remote side closed connection
2020-08-31T01:21:01.141952Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:21:01.142010Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:21:01.142052Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:21:01.142333Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:01.142350Z	error	sds	Remote side closed connection
2020-08-31T01:21:01.226255Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:01.443387Z	info	sds	resource:default new connection
2020-08-31T01:21:01.443455Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:21:01.443512Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:01.443813Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:01.443847Z	error	sds	Remote side closed connection
2020-08-31T01:21:01.444052Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"0b3f2dbb-8764-4bbb-8b5b-f5ea08c45610".sock: use of closed network connection
2020-08-31T01:21:01.444091Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"361c3c05-3b21-41e0-9e1e-42bd6534bc36".sock: use of closed network connection
2020-08-31T01:21:01.444355Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"37a141c3-bb94-46b9-b54c-9d1c217a431a\".sock" 

2020-08-31T01:21:01.444382Z	info	sds	Start SDS grpc server
2020-08-31T01:21:01.529396Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:01.530701Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:21:01.746977Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"37a141c3-bb94-46b9-b54c-9d1c217a431a".sock: use of closed network connection
2020-08-31T01:21:01.747257Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"dacf3c4c-1a60-420c-af4a-04cc026f54f9\".sock" 

2020-08-31T01:21:01.747299Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:01.839901Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:21:02.049571Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"dacf3c4c-1a60-420c-af4a-04cc026f54f9".sock: use of closed network connection
2020-08-31T01:21:02.049838Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste3dbd911-28c0-43cd-9130-eb2b1c5b3676.sock" 

2020-08-31T01:21:02.049860Z	info	sds	Start SDS grpc server
2020-08-31T01:21:02.049929Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1c5798a7-0e9e-4ff8-bead-ee5192bb1b3d\".sock" 

2020-08-31T01:21:02.049973Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:21:02.444252Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:02.444301Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:21:02.654420Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste3dbd911-28c0-43cd-9130-eb2b1c5b3676.sock: use of closed network connection
2020-08-31T01:21:02.654489Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1c5798a7-0e9e-4ff8-bead-ee5192bb1b3d".sock: use of closed network connection
2020-08-31T01:21:02.654669Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest381573bb-29c9-49fa-8216-3ccae664c385.sock" 

2020-08-31T01:21:02.654692Z	info	sds	Start SDS grpc server
2020-08-31T01:21:02.747170Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:02.955721Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:21:02.955812Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:02.956068Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest381573bb-29c9-49fa-8216-3ccae664c385.sock: use of closed network connection
2020-08-31T01:21:02.956277Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest528b8675-d070-4aa7-ad63-8b0a05a0c6c1.sock" 

2020-08-31T01:21:02.956403Z	info	sds	Start SDS grpc server
2020-08-31T01:21:02.957068Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:21:02.957130Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:21:02.957187Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:02.957260Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:21:02.957318Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:21:02.957351Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:21:03.049760Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:03.226577Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:03.529668Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:03.530837Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:03.654652Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:03.654692Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:03.840161Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:03.956257Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:03.957401Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:03.957442Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:21:04.444486Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:04.444534Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:04.747399Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:04.958247Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:04.958571Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest528b8675-d070-4aa7-ad63-8b0a05a0c6c1.sock: use of closed network connection
2020-08-31T01:21:04.958604Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:04.958629Z	error	sds	Remote side closed connection
2020-08-31T01:21:04.958678Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:04.958700Z	error	sds	Remote side closed connection
2020-08-31T01:21:04.958780Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb28cf58c-d821-4e80-b7e9-c99df6e070fb.sock" 

2020-08-31T01:21:04.958850Z	info	sds	Start SDS grpc server
2020-08-31T01:21:04.960517Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:21:04.960584Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:21:04.960688Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:04.961793Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb28cf58c-d821-4e80-b7e9-c99df6e070fb.sock: use of closed network connection
2020-08-31T01:21:04.961855Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:21:04.96068601 +0000 UTC m=+6.814346526 and is waiting for next SDS request
2020-08-31T01:21:04.961897Z	info	sds	Dynamic push for secret default
2020-08-31T01:21:04.961926Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:04.961948Z	error	sds	Remote side closed connection
2020-08-31T01:21:04.961960Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:04.961984Z	error	sds	Remote side closed connection
2020-08-31T01:21:04.962012Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd7abd5d6-b274-4339-82bf-c860a49e3c2b.sock" 

2020-08-31T01:21:04.962074Z	info	sds	Start SDS grpc server
2020-08-31T01:21:04.962672Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:21:04.962713Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:21:04.962748Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:04.963188Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:21:05.050083Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:05.463227Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:05.463283Z	info	sds	Dynamic push for secret default
2020-08-31T01:21:05.463871Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd7abd5d6-b274-4339-82bf-c860a49e3c2b.sock: use of closed network connection
2020-08-31T01:21:05.463972Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:05.464008Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:05.463997Z	error	sds	Remote side closed connection
2020-08-31T01:21:05.464023Z	error	sds	Remote side closed connection
2020-08-31T01:21:05.464130Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4888cc51-103d-4534-82f4-d91751a6448f.sock" 

2020-08-31T01:21:05.464211Z	info	sds	Start SDS grpc server
2020-08-31T01:21:05.464360Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4888cc51-103d-4534-82f4-d91751a6448f.sock: use of closed network connection
2020-08-31T01:21:05.464450Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc4c50abb-0c11-4f32-afcb-e90c42298bad.sock" 

2020-08-31T01:21:05.464467Z	info	sds	Start SDS grpc server
2020-08-31T01:21:05.654935Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:05.654983Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:05.765373Z	info	sds	resource:default new connection
2020-08-31T01:21:05.765429Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:21:05.765489Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:05.765762Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:05.765789Z	error	sds	Remote side closed connection
2020-08-31T01:21:05.956499Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:05.958765Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:05.961965Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:06.066915Z	info	sds	resource:default new connection
2020-08-31T01:21:06.066992Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:21:06.067058Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:06.067391Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:06.067419Z	error	sds	Remote side closed connection
2020-08-31T01:21:06.067782Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc4c50abb-0c11-4f32-afcb-e90c42298bad.sock: use of closed network connection
2020-08-31T01:21:06.067971Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcede5307-14ae-4842-8216-217fd4418c78.sock" 

2020-08-31T01:21:06.067988Z	info	sds	Start SDS grpc server
2020-08-31T01:21:06.368920Z	info	sds	resource:default new connection
2020-08-31T01:21:06.368984Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:21:06.369037Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:06.369312Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:06.369370Z	error	sds	Remote side closed connection
2020-08-31T01:21:06.369601Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcede5307-14ae-4842-8216-217fd4418c78.sock: use of closed network connection
2020-08-31T01:21:06.464079Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:06.464501Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:07.068037Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:07.226894Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:07.369883Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:21:07.529893Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:07.531031Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:07.840423Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:07.959033Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:07.962194Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:21:08.398568Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest17329668-dca1-4107-ab9a-48230f1ee2bc.sock" 

2020-08-31T01:21:08.398617Z	info	sds	Start SDS grpc server
2020-08-31T01:21:08.444636Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:08.444730Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:08.464352Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:08.464697Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:08.747645Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:09.050333Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:09.068258Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:09.370108Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:09.399763Z	info	sds	resource:default new connection
2020-08-31T01:21:09.399828Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:21:09.408392Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:21:09.465456Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:21:09.465503Z	info	cache	GenerateSecret default
2020-08-31T01:21:09.465563Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:09.465930Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest17329668-dca1-4107-ab9a-48230f1ee2bc.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.564s
2020-08-31T01:21:14.765172Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3e6d6d45-1ca7-485d-b3c7-bc7447802177.sock" 

2020-08-31T01:21:14.765289Z	info	sds	Start SDS grpc server
2020-08-31T01:21:14.766775Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:21:14.766861Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:21:14.767349Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:15.766546Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:15.766607Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:21:16.767318Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:21:16.767388Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:21:16.767413Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:21:16.767465Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:16.767710Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3e6d6d45-1ca7-485d-b3c7-bc7447802177.sock: use of closed network connection
2020-08-31T01:21:16.767889Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:16.767927Z	error	sds	Remote side closed connection
2020-08-31T01:21:16.768026Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cd3b9e6b-1fde-4e3d-aa70-c56278672584\".sock" 

2020-08-31T01:21:16.768064Z	info	sds	Start SDS grpc server
2020-08-31T01:21:17.069092Z	info	sds	resource:default new connection
2020-08-31T01:21:17.069168Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:21:17.069332Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:17.069707Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:17.069732Z	error	sds	Remote side closed connection
2020-08-31T01:21:17.070356Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:21:17.070393Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:21:17.070552Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:21:17.070837Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:17.070861Z	error	sds	Remote side closed connection
2020-08-31T01:21:17.071037Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cd3b9e6b-1fde-4e3d-aa70-c56278672584".sock: use of closed network connection
2020-08-31T01:21:17.071216Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a91a294a-2bb8-435e-ab71-ad4ae39242e4\".sock" 

2020-08-31T01:21:17.071244Z	info	sds	Start SDS grpc server
2020-08-31T01:21:17.071742Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:21:17.071814Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:21:17.071859Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:21:17.072209Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:17.072263Z	error	sds	Remote side closed connection
2020-08-31T01:21:17.072470Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a91a294a-2bb8-435e-ab71-ad4ae39242e4".sock: use of closed network connection
2020-08-31T01:21:17.072754Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"216f77bc-df45-4de9-a846-002273bd34f7\".sock" 

2020-08-31T01:21:17.072803Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:17.373660Z	info	sds	resource:default new connection
2020-08-31T01:21:17.373729Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:21:17.373785Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:17.374120Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:17.374146Z	error	sds	Remote side closed connection
2020-08-31T01:21:17.374350Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"216f77bc-df45-4de9-a846-002273bd34f7".sock: use of closed network connection
2020-08-31T01:21:17.374549Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"da41ba79-4c27-446a-a125-949f13d5f349\".sock" 

2020-08-31T01:21:17.374556Z	info	sds	Start SDS grpc server
2020-08-31T01:21:17.374641Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"43ceef85-3f1d-43b7-96d8-47c621511083\".sock" 

2020-08-31T01:21:17.374671Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:17.675672Z	info	sds	resource:default new connection
2020-08-31T01:21:17.675733Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:21:17.675786Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:17.676075Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:17.676103Z	error	sds	Remote side closed connection
2020-08-31T01:21:17.677184Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:21:17.677234Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:21:17.677314Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:21:17.677534Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:17.677548Z	error	sds	Remote side closed connection
2020-08-31T01:21:17.767934Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:17.978596Z	info	sds	resource:default new connection
2020-08-31T01:21:17.978658Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:21:17.978713Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:17.979091Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:17.979124Z	error	sds	Remote side closed connection
2020-08-31T01:21:17.979308Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"da41ba79-4c27-446a-a125-949f13d5f349".sock: use of closed network connection
2020-08-31T01:21:17.979354Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"43ceef85-3f1d-43b7-96d8-47c621511083".sock: use of closed network connection
2020-08-31T01:21:17.979523Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d1f5f366-4515-440e-9d27-314d2741cf1a\".sock" 

2020-08-31T01:21:17.979543Z	info	sds	Start SDS grpc server
2020-08-31T01:21:18.071272Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:18.072648Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:21:18.283872Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d1f5f366-4515-440e-9d27-314d2741cf1a".sock: use of closed network connection
2020-08-31T01:21:18.284078Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"80804027-93ef-48ac-8c71-89c8220685ca\".sock" 

2020-08-31T01:21:18.284113Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:18.374652Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:21:18.585803Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"80804027-93ef-48ac-8c71-89c8220685ca".sock: use of closed network connection
2020-08-31T01:21:18.586108Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest922a0a57-1685-4a12-9fb5-d1d09b8f7897.sock" 

2020-08-31T01:21:18.586201Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e7d6bddb-900b-4bae-9260-213e5023087c\".sock" 

2020-08-31T01:21:18.586204Z	info	sds	Start SDS grpc server
2020-08-31T01:21:18.586242Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:21:18.979518Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:18.979548Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:21:19.190236Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest922a0a57-1685-4a12-9fb5-d1d09b8f7897.sock: use of closed network connection
2020-08-31T01:21:19.190306Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e7d6bddb-900b-4bae-9260-213e5023087c".sock: use of closed network connection
2020-08-31T01:21:19.190546Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest69de253e-99d9-41cb-9ca3-1356ff61e229.sock" 

2020-08-31T01:21:19.190566Z	info	sds	Start SDS grpc server
2020-08-31T01:21:19.284127Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:19.491611Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:21:19.491705Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:19.491903Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest69de253e-99d9-41cb-9ca3-1356ff61e229.sock: use of closed network connection
2020-08-31T01:21:19.492108Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta0f864be-d12c-43ee-8efc-d969194bc1ea.sock" 

2020-08-31T01:21:19.492190Z	info	sds	Start SDS grpc server
2020-08-31T01:21:19.492871Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:21:19.492919Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:21:19.492966Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:19.493166Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:21:19.493231Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:21:19.493275Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:21:19.586032Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:19.768183Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:20.071590Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:20.072898Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:20.190467Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:20.190498Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:20.374917Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:20.492119Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:20.493233Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:20.493267Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:21:20.979778Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:20.979836Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:21.284385Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:21.494199Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:21.494593Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta0f864be-d12c-43ee-8efc-d969194bc1ea.sock: use of closed network connection
2020-08-31T01:21:21.494604Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:21.494631Z	error	sds	Remote side closed connection
2020-08-31T01:21:21.494681Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:21.494688Z	error	sds	Remote side closed connection
2020-08-31T01:21:21.494840Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest950f8173-70ed-46b7-9f0e-05f8127c68fc.sock" 

2020-08-31T01:21:21.494868Z	info	sds	Start SDS grpc server
2020-08-31T01:21:21.495603Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:21:21.495651Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:21:21.495697Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:21.496147Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:21:21.49569669 +0000 UTC m=+6.811701237 and is waiting for next SDS request
2020-08-31T01:21:21.496165Z	info	sds	Dynamic push for secret default
2020-08-31T01:21:21.496188Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest950f8173-70ed-46b7-9f0e-05f8127c68fc.sock: use of closed network connection
2020-08-31T01:21:21.496287Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:21.496310Z	error	sds	Remote side closed connection
2020-08-31T01:21:21.496313Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:21.496322Z	error	sds	Remote side closed connection
2020-08-31T01:21:21.496378Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8a08d5b5-e2c9-4812-909e-63ba0aa37561.sock" 

2020-08-31T01:21:21.496402Z	info	sds	Start SDS grpc server
2020-08-31T01:21:21.497167Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:21:21.497223Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:21:21.497264Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:21.497914Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:21:21.586163Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:21.998049Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:21.998108Z	info	sds	Dynamic push for secret default
2020-08-31T01:21:21.998647Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8a08d5b5-e2c9-4812-909e-63ba0aa37561.sock: use of closed network connection
2020-08-31T01:21:21.998793Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:21.998809Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:21.998835Z	error	sds	Remote side closed connection
2020-08-31T01:21:21.998824Z	error	sds	Remote side closed connection
2020-08-31T01:21:21.998894Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf5381fa6-42b0-43bc-99bb-21cd1e416ee4.sock" 

2020-08-31T01:21:21.998902Z	info	sds	Start SDS grpc server
2020-08-31T01:21:21.999116Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf5381fa6-42b0-43bc-99bb-21cd1e416ee4.sock: use of closed network connection
2020-08-31T01:21:21.999190Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0b90239f-4421-4395-8d5c-e59cfdaed9d0.sock" 

2020-08-31T01:21:21.999209Z	info	sds	Start SDS grpc server
2020-08-31T01:21:22.190787Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:22.190796Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:22.300136Z	info	sds	resource:default new connection
2020-08-31T01:21:22.300201Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:21:22.300254Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:22.300629Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:22.300688Z	error	sds	Remote side closed connection
2020-08-31T01:21:22.492365Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:22.494794Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:22.496246Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:22.601778Z	info	sds	resource:default new connection
2020-08-31T01:21:22.601836Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:21:22.601889Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:22.602201Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:22.602217Z	error	sds	Remote side closed connection
2020-08-31T01:21:22.602460Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0b90239f-4421-4395-8d5c-e59cfdaed9d0.sock: use of closed network connection
2020-08-31T01:21:22.602593Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbe9ac4ad-6c6c-43ec-99d7-775bea62566b.sock" 

2020-08-31T01:21:22.602626Z	info	sds	Start SDS grpc server
2020-08-31T01:21:22.903596Z	info	sds	resource:default new connection
2020-08-31T01:21:22.903659Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:21:22.903714Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:22.903991Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:22.904004Z	error	sds	Remote side closed connection
2020-08-31T01:21:22.904288Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbe9ac4ad-6c6c-43ec-99d7-775bea62566b.sock: use of closed network connection
2020-08-31T01:21:22.998918Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:22.999135Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:23.602712Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:23.768452Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:23.904532Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:21:24.071835Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:24.073082Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:24.375180Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:24.495035Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:24.496481Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:21:24.937207Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdbfa146e-c5bd-4457-90f6-b9e5979f97fb.sock" 

2020-08-31T01:21:24.937243Z	info	sds	Start SDS grpc server
2020-08-31T01:21:24.980040Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:24.980093Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:24.999181Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:24.999250Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:25.284497Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:25.586450Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:25.603005Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:25.904791Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:25.938094Z	info	sds	resource:default new connection
2020-08-31T01:21:25.938175Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:21:25.949058Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:21:26.105869Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:21:26.105946Z	info	cache	GenerateSecret default
2020-08-31T01:21:26.106023Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:26.106387Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdbfa146e-c5bd-4457-90f6-b9e5979f97fb.sock: use of closed network connection
PASS
2020-08-31T01:21:26.106482Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.673s
2020-08-31T01:21:31.349532Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0f48799f-724d-410a-a183-b48751dc771c.sock" 

2020-08-31T01:21:31.349639Z	info	sds	Start SDS grpc server
2020-08-31T01:21:31.350917Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:21:31.350974Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:21:31.351347Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:32.350846Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:32.350909Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:21:33.351728Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:21:33.351810Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:21:33.351835Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:21:33.351892Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:33.352209Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0f48799f-724d-410a-a183-b48751dc771c.sock: use of closed network connection
2020-08-31T01:21:33.352362Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:33.352418Z	error	sds	Remote side closed connection
2020-08-31T01:21:33.352572Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d4bf54f4-b977-4caf-ae8e-f9ec7e319a67\".sock" 

2020-08-31T01:21:33.352610Z	info	sds	Start SDS grpc server
2020-08-31T01:21:33.653563Z	info	sds	resource:default new connection
2020-08-31T01:21:33.653641Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:21:33.653827Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:33.654176Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:33.654201Z	error	sds	Remote side closed connection
2020-08-31T01:21:33.654873Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:21:33.654911Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:21:33.655128Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:21:33.655461Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:33.655495Z	error	sds	Remote side closed connection
2020-08-31T01:21:33.655778Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d4bf54f4-b977-4caf-ae8e-f9ec7e319a67".sock: use of closed network connection
2020-08-31T01:21:33.655943Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"36a5e5fc-f29c-42d3-add1-cb013b98b9d0\".sock" 

2020-08-31T01:21:33.656021Z	info	sds	Start SDS grpc server
2020-08-31T01:21:33.656520Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:21:33.656563Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:21:33.656621Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:21:33.657004Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:33.657038Z	error	sds	Remote side closed connection
2020-08-31T01:21:33.657135Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"36a5e5fc-f29c-42d3-add1-cb013b98b9d0".sock: use of closed network connection
2020-08-31T01:21:33.657308Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a30faed9-abea-4b3f-b453-2ccaa124b330\".sock" 

2020-08-31T01:21:33.657338Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:33.958335Z	info	sds	resource:default new connection
2020-08-31T01:21:33.958386Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:21:33.958439Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:33.958826Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:33.958877Z	error	sds	Remote side closed connection
2020-08-31T01:21:33.959019Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a30faed9-abea-4b3f-b453-2ccaa124b330".sock: use of closed network connection
2020-08-31T01:21:33.959235Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d7e37720-b2b6-49d0-a701-c09751feac30\".sock" 

2020-08-31T01:21:33.959305Z	info	sds	Start SDS grpc server
2020-08-31T01:21:33.959376Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"141e16d6-cfe5-4266-95e0-b7fe41dc0b37\".sock" 

2020-08-31T01:21:33.959414Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:34.260338Z	info	sds	resource:default new connection
2020-08-31T01:21:34.260411Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:21:34.260484Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:34.260796Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:34.260824Z	error	sds	Remote side closed connection
2020-08-31T01:21:34.261298Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:21:34.261345Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:21:34.261380Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:21:34.261607Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:34.261626Z	error	sds	Remote side closed connection
2020-08-31T01:21:34.352429Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:34.562496Z	info	sds	resource:default new connection
2020-08-31T01:21:34.562585Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:21:34.562655Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:34.562919Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:34.562946Z	error	sds	Remote side closed connection
2020-08-31T01:21:34.563175Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d7e37720-b2b6-49d0-a701-c09751feac30".sock: use of closed network connection
2020-08-31T01:21:34.563217Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"141e16d6-cfe5-4266-95e0-b7fe41dc0b37".sock: use of closed network connection
2020-08-31T01:21:34.563426Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"106d3ce9-9336-4de9-9a00-efa4908a9306\".sock" 

2020-08-31T01:21:34.563451Z	info	sds	Start SDS grpc server
2020-08-31T01:21:34.656003Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:34.657265Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:21:34.866271Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"106d3ce9-9336-4de9-9a00-efa4908a9306".sock: use of closed network connection
2020-08-31T01:21:34.866522Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"46b93bbd-88bf-4e7d-a03b-0c7e62c13deb\".sock" 

2020-08-31T01:21:34.866559Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:34.959227Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:21:35.168015Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"46b93bbd-88bf-4e7d-a03b-0c7e62c13deb".sock: use of closed network connection
2020-08-31T01:21:35.168230Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestf6b8ce68-13ef-4551-9265-cc50f4a8144e.sock" 

2020-08-31T01:21:35.168284Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"94d98d84-821e-45ef-8526-0b19cc0fa00d\".sock" 

2020-08-31T01:21:35.168326Z	info	sds	Start SDS grpc server
2020-08-31T01:21:35.168346Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:21:35.563433Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:35.563472Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:21:35.772185Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestf6b8ce68-13ef-4551-9265-cc50f4a8144e.sock: use of closed network connection
2020-08-31T01:21:35.772236Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"94d98d84-821e-45ef-8526-0b19cc0fa00d".sock: use of closed network connection
2020-08-31T01:21:35.772408Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest49b32d68-d033-4991-ae54-cbbbcdfbf7dc.sock" 

2020-08-31T01:21:35.772429Z	info	sds	Start SDS grpc server
2020-08-31T01:21:35.866523Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:36.073525Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:21:36.073622Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:36.073870Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest49b32d68-d033-4991-ae54-cbbbcdfbf7dc.sock: use of closed network connection
2020-08-31T01:21:36.074145Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestadc11ab4-03c7-4273-80d3-e3263f79bda3.sock" 

2020-08-31T01:21:36.074220Z	info	sds	Start SDS grpc server
2020-08-31T01:21:36.075173Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:21:36.075215Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:21:36.075257Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:36.075396Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:21:36.075439Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:21:36.075480Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:21:36.168229Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:36.352696Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:36.656252Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:36.657375Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:36.772402Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:36.772452Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:36.959449Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:37.074091Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:37.075436Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:37.075466Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:21:37.563667Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:37.563680Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:37.866842Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:38.076331Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:38.076741Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestadc11ab4-03c7-4273-80d3-e3263f79bda3.sock: use of closed network connection
2020-08-31T01:21:38.076808Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:38.076817Z	error	sds	Remote side closed connection
2020-08-31T01:21:38.076905Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:38.076936Z	error	sds	Remote side closed connection
2020-08-31T01:21:38.077081Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest94ea0e32-a6d1-4778-a052-61a5dc5ebcbe.sock" 

2020-08-31T01:21:38.077157Z	info	sds	Start SDS grpc server
2020-08-31T01:21:38.077939Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:21:38.077985Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:21:38.078030Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:38.078454Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:21:38.078030134 +0000 UTC m=+6.802544019 and is waiting for next SDS request
2020-08-31T01:21:38.078477Z	info	sds	Dynamic push for secret default
2020-08-31T01:21:38.078508Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest94ea0e32-a6d1-4778-a052-61a5dc5ebcbe.sock: use of closed network connection
2020-08-31T01:21:38.078625Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:38.078662Z	error	sds	Remote side closed connection
2020-08-31T01:21:38.078678Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:38.078705Z	error	sds	Remote side closed connection
2020-08-31T01:21:38.078829Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest864e2b95-6d56-4d8d-9953-8f5d7aacab15.sock" 

2020-08-31T01:21:38.078866Z	info	sds	Start SDS grpc server
2020-08-31T01:21:38.079516Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:21:38.079549Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:21:38.079580Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:38.080015Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:21:38.168493Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:38.580114Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:38.580167Z	info	sds	Dynamic push for secret default
2020-08-31T01:21:38.580827Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest864e2b95-6d56-4d8d-9953-8f5d7aacab15.sock: use of closed network connection
2020-08-31T01:21:38.580908Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:38.580937Z	error	sds	Remote side closed connection
2020-08-31T01:21:38.580963Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:38.580991Z	error	sds	Remote side closed connection
2020-08-31T01:21:38.581076Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste08292ef-3d03-48ab-bb8a-6e0acf7e7a69.sock" 

2020-08-31T01:21:38.581085Z	info	sds	Start SDS grpc server
2020-08-31T01:21:38.581347Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste08292ef-3d03-48ab-bb8a-6e0acf7e7a69.sock: use of closed network connection
2020-08-31T01:21:38.581471Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest265856c9-03bf-4d7b-b9ef-71497d017f47.sock" 

2020-08-31T01:21:38.581495Z	info	sds	Start SDS grpc server
2020-08-31T01:21:38.772615Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:38.772696Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:38.882362Z	info	sds	resource:default new connection
2020-08-31T01:21:38.882417Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:21:38.882475Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:38.882812Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:38.882844Z	error	sds	Remote side closed connection
2020-08-31T01:21:39.074353Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:39.076970Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:39.078727Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:39.183773Z	info	sds	resource:default new connection
2020-08-31T01:21:39.183829Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:21:39.183879Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:39.184239Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:39.184282Z	error	sds	Remote side closed connection
2020-08-31T01:21:39.184603Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest265856c9-03bf-4d7b-b9ef-71497d017f47.sock: use of closed network connection
2020-08-31T01:21:39.184785Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestedf6a7e4-cd7e-4c60-8fe0-8c9ce189b22c.sock" 

2020-08-31T01:21:39.184824Z	info	sds	Start SDS grpc server
2020-08-31T01:21:39.485934Z	info	sds	resource:default new connection
2020-08-31T01:21:39.486011Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:21:39.486084Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:39.486409Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:39.486470Z	error	sds	Remote side closed connection
2020-08-31T01:21:39.486657Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestedf6a7e4-cd7e-4c60-8fe0-8c9ce189b22c.sock: use of closed network connection
2020-08-31T01:21:39.581023Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:39.581477Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:40.184850Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:40.352948Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:40.486885Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:21:40.656495Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:40.657457Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:40.959704Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:41.077225Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:41.078927Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:21:41.515921Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfb76d79b-afaa-4638-99b7-342ca76a9d5f.sock" 

2020-08-31T01:21:41.515973Z	info	sds	Start SDS grpc server
2020-08-31T01:21:41.563955Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:41.564007Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:41.581321Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:41.581606Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:41.867109Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:42.168763Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:42.185115Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:42.487050Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:42.516841Z	info	sds	resource:default new connection
2020-08-31T01:21:42.516903Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:21:42.519362Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:21:42.670086Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:21:42.670130Z	info	cache	GenerateSecret default
2020-08-31T01:21:42.670196Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:42.670644Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfb76d79b-afaa-4638-99b7-342ca76a9d5f.sock: use of closed network connection
PASS
2020-08-31T01:21:42.670722Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:42.670745Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.648s
2020-08-31T01:21:47.966256Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc8245521-9a03-4565-b130-15276ce30b90.sock" 

2020-08-31T01:21:47.966348Z	info	sds	Start SDS grpc server
2020-08-31T01:21:47.967584Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:21:47.967639Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:21:47.968056Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:48.967595Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:48.967677Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:21:49.968279Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:21:49.968348Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:21:49.968373Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:21:49.968431Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:49.968689Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc8245521-9a03-4565-b130-15276ce30b90.sock: use of closed network connection
2020-08-31T01:21:49.968804Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:49.968822Z	error	sds	Remote side closed connection
2020-08-31T01:21:49.968981Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"486a232d-0662-442c-888c-d424542779d1\".sock" 

2020-08-31T01:21:49.969003Z	info	sds	Start SDS grpc server
2020-08-31T01:21:50.269910Z	info	sds	resource:default new connection
2020-08-31T01:21:50.269963Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:21:50.270012Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:50.270315Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:50.270370Z	error	sds	Remote side closed connection
2020-08-31T01:21:50.270972Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:21:50.271020Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:21:50.271289Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:21:50.271645Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:50.271671Z	error	sds	Remote side closed connection
2020-08-31T01:21:50.271859Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"486a232d-0662-442c-888c-d424542779d1".sock: use of closed network connection
2020-08-31T01:21:50.272042Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2b4f00d4-5b05-4b2a-a1df-e6e108a906e6\".sock" 

2020-08-31T01:21:50.272065Z	info	sds	Start SDS grpc server
2020-08-31T01:21:50.272516Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:21:50.272543Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:21:50.272575Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:21:50.272798Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:50.272818Z	error	sds	Remote side closed connection
2020-08-31T01:21:50.272951Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2b4f00d4-5b05-4b2a-a1df-e6e108a906e6".sock: use of closed network connection
2020-08-31T01:21:50.273103Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"caa81c17-eeae-4e07-8739-8f90d3474ce1\".sock" 

2020-08-31T01:21:50.273134Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:50.574029Z	info	sds	resource:default new connection
2020-08-31T01:21:50.574123Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:21:50.574175Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:50.574401Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:50.574437Z	error	sds	Remote side closed connection
2020-08-31T01:21:50.574627Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"caa81c17-eeae-4e07-8739-8f90d3474ce1".sock: use of closed network connection
2020-08-31T01:21:50.574809Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4ecc2486-9659-4934-a1cd-483a84f6f89c\".sock" 

2020-08-31T01:21:50.574859Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"cc5a0d08-98a2-4fbf-9fcb-380c871849d5\".sock" 

2020-08-31T01:21:50.574867Z	info	sds	Start SDS grpc server
2020-08-31T01:21:50.574897Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:50.875885Z	info	sds	resource:default new connection
2020-08-31T01:21:50.875938Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:21:50.876000Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:50.876333Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:50.876389Z	error	sds	Remote side closed connection
2020-08-31T01:21:50.877646Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:21:50.877686Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:21:50.877727Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:21:50.877955Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:50.877978Z	error	sds	Remote side closed connection
2020-08-31T01:21:50.968928Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:51.178842Z	info	sds	resource:default new connection
2020-08-31T01:21:51.178920Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:21:51.178972Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:51.179281Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:51.179299Z	error	sds	Remote side closed connection
2020-08-31T01:21:51.179569Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4ecc2486-9659-4934-a1cd-483a84f6f89c".sock: use of closed network connection
2020-08-31T01:21:51.179616Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"cc5a0d08-98a2-4fbf-9fcb-380c871849d5".sock: use of closed network connection
2020-08-31T01:21:51.179814Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"078b4a1b-c589-4585-8207-ec1c55adcd35\".sock" 

2020-08-31T01:21:51.179841Z	info	sds	Start SDS grpc server
2020-08-31T01:21:51.272087Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:51.273165Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:21:51.482486Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"078b4a1b-c589-4585-8207-ec1c55adcd35".sock: use of closed network connection
2020-08-31T01:21:51.482723Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"64974356-c9ce-4bf4-986d-5ff61aa36c84\".sock" 

2020-08-31T01:21:51.482764Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:51.574742Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:21:51.784204Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"64974356-c9ce-4bf4-986d-5ff61aa36c84".sock: use of closed network connection
2020-08-31T01:21:51.784417Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesteb1d9263-0222-4727-87d7-6b438d412370.sock" 

2020-08-31T01:21:51.784468Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b924bcc5-1ac1-4c3e-bacd-7513efbe09f6\".sock" 

2020-08-31T01:21:51.784487Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:21:51.784483Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:21:52.179810Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:52.179803Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:21:52.388646Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesteb1d9263-0222-4727-87d7-6b438d412370.sock: use of closed network connection
2020-08-31T01:21:52.388788Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b924bcc5-1ac1-4c3e-bacd-7513efbe09f6".sock: use of closed network connection
2020-08-31T01:21:52.388978Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest5bc39180-9e4a-4cdb-acec-8aaa63e2ad98.sock" 

2020-08-31T01:21:52.389009Z	info	sds	Start SDS grpc server
2020-08-31T01:21:52.482596Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:52.690298Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:21:52.690398Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:52.690634Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest5bc39180-9e4a-4cdb-acec-8aaa63e2ad98.sock: use of closed network connection
2020-08-31T01:21:52.690909Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta4741500-741a-40b8-b822-2030086d23fc.sock" 

2020-08-31T01:21:52.691006Z	info	sds	Start SDS grpc server
2020-08-31T01:21:52.693221Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:21:52.693356Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:21:52.693429Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:52.693528Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:21:52.693604Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:21:52.693654Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:21:52.784449Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:52.969149Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:53.272395Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:53.273385Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:53.388835Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:53.388898Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:53.575014Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:53.690889Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:53.693483Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:53.693525Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:21:54.180064Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:54.180109Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:54.482918Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:54.694341Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:54.694682Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta4741500-741a-40b8-b822-2030086d23fc.sock: use of closed network connection
2020-08-31T01:21:54.694709Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:54.694763Z	error	sds	Remote side closed connection
2020-08-31T01:21:54.694904Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:54.694934Z	error	sds	Remote side closed connection
2020-08-31T01:21:54.695019Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest207f8447-7524-4431-9bd7-a1687bd9e7bc.sock" 

2020-08-31T01:21:54.695127Z	info	sds	Start SDS grpc server
2020-08-31T01:21:54.695937Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:21:54.695986Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:21:54.696033Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:54.696630Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:21:54.696032037 +0000 UTC m=+6.802872603 and is waiting for next SDS request
2020-08-31T01:21:54.696676Z	info	sds	Dynamic push for secret default
2020-08-31T01:21:54.696650Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest207f8447-7524-4431-9bd7-a1687bd9e7bc.sock: use of closed network connection
2020-08-31T01:21:54.696743Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:54.696777Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:54.696767Z	error	sds	Remote side closed connection
2020-08-31T01:21:54.696790Z	error	sds	Remote side closed connection
2020-08-31T01:21:54.696895Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest961c05c7-3339-4f1f-95b3-8a3896dff23c.sock" 

2020-08-31T01:21:54.696978Z	info	sds	Start SDS grpc server
2020-08-31T01:21:54.697791Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:21:54.697833Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:21:54.697866Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:54.698404Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:21:54.784614Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:55.198598Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:55.198660Z	info	sds	Dynamic push for secret default
2020-08-31T01:21:55.199293Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest961c05c7-3339-4f1f-95b3-8a3896dff23c.sock: use of closed network connection
2020-08-31T01:21:55.199411Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:55.199423Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:55.199445Z	error	sds	Remote side closed connection
2020-08-31T01:21:55.199473Z	error	sds	Remote side closed connection
2020-08-31T01:21:55.199536Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5f10067c-329e-41f3-882a-624d60b8508a.sock" 

2020-08-31T01:21:55.199572Z	info	sds	Start SDS grpc server
2020-08-31T01:21:55.199763Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5f10067c-329e-41f3-882a-624d60b8508a.sock: use of closed network connection
2020-08-31T01:21:55.199834Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0ebfc404-8c3e-4082-887c-a991fac564f5.sock" 

2020-08-31T01:21:55.199850Z	info	sds	Start SDS grpc server
2020-08-31T01:21:55.389107Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:55.389161Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:55.500796Z	info	sds	resource:default new connection
2020-08-31T01:21:55.500883Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:21:55.500942Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:55.501221Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:55.501238Z	error	sds	Remote side closed connection
2020-08-31T01:21:55.691177Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:55.694915Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:55.696866Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:55.802302Z	info	sds	resource:default new connection
2020-08-31T01:21:55.802364Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:21:55.802418Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:55.802873Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:55.802902Z	error	sds	Remote side closed connection
2020-08-31T01:21:55.803154Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0ebfc404-8c3e-4082-887c-a991fac564f5.sock: use of closed network connection
2020-08-31T01:21:55.803277Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1de9038f-f650-4e92-98e8-eb6c210f02d7.sock" 

2020-08-31T01:21:55.803322Z	info	sds	Start SDS grpc server
2020-08-31T01:21:56.104162Z	info	sds	resource:default new connection
2020-08-31T01:21:56.104228Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:21:56.104281Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:56.104565Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:21:56.104591Z	error	sds	Remote side closed connection
2020-08-31T01:21:56.104888Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1de9038f-f650-4e92-98e8-eb6c210f02d7.sock: use of closed network connection
2020-08-31T01:21:56.199504Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:56.199839Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:56.803377Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:56.969383Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:57.105070Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:21:57.272616Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:57.273557Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:57.575178Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:57.695150Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:57.697051Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:21:58.134296Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfbf51e94-70cc-4ec8-82d3-6514209d1742.sock" 

2020-08-31T01:21:58.134353Z	info	sds	Start SDS grpc server
2020-08-31T01:21:58.180384Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:58.180437Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:58.199731Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:58.200058Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:58.483199Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:58.784856Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:58.803640Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:59.105284Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:59.135639Z	info	sds	resource:default new connection
2020-08-31T01:21:59.135703Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:21:59.144300Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:21:59.389261Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:21:59.389279Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:21:59.389787Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:21:59.389819Z	info	cache	GenerateSecret default
2020-08-31T01:21:59.389883Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:21:59.390308Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfbf51e94-70cc-4ec8-82d3-6514209d1742.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.748s
2020-08-31T01:22:04.709872Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7dfdbe29-9bbd-4450-8135-2ae3279e61aa.sock" 

2020-08-31T01:22:04.709904Z	info	sds	Start SDS grpc server
2020-08-31T01:22:04.711230Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:22:04.711292Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:22:04.711667Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:05.711272Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:05.711323Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:22:06.712459Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:22:06.712553Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:22:06.712581Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:22:06.712637Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:06.712960Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7dfdbe29-9bbd-4450-8135-2ae3279e61aa.sock: use of closed network connection
2020-08-31T01:22:06.713078Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:06.713104Z	error	sds	Remote side closed connection
2020-08-31T01:22:06.713220Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"65053b2f-eea5-4f3b-9295-377538a1cafd\".sock" 

2020-08-31T01:22:06.713265Z	info	sds	Start SDS grpc server
2020-08-31T01:22:07.014720Z	info	sds	resource:default new connection
2020-08-31T01:22:07.014789Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:22:07.014874Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:07.015173Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:07.015190Z	error	sds	Remote side closed connection
2020-08-31T01:22:07.016040Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:22:07.016087Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:22:07.016329Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:22:07.016762Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:07.016792Z	error	sds	Remote side closed connection
2020-08-31T01:22:07.017053Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"65053b2f-eea5-4f3b-9295-377538a1cafd".sock: use of closed network connection
2020-08-31T01:22:07.017230Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5fa3e697-f0f5-46f2-ab7b-6a3cd16db895\".sock" 

2020-08-31T01:22:07.017354Z	info	sds	Start SDS grpc server
2020-08-31T01:22:07.017980Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:22:07.018015Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:22:07.018053Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:22:07.018218Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:07.018240Z	error	sds	Remote side closed connection
2020-08-31T01:22:07.018412Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5fa3e697-f0f5-46f2-ab7b-6a3cd16db895".sock: use of closed network connection
2020-08-31T01:22:07.018566Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"267d3275-9960-4d0d-982a-9c557c42f142\".sock" 

2020-08-31T01:22:07.018599Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:07.320245Z	info	sds	resource:default new connection
2020-08-31T01:22:07.320301Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:22:07.320359Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:07.320603Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:07.320631Z	error	sds	Remote side closed connection
2020-08-31T01:22:07.320841Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"267d3275-9960-4d0d-982a-9c557c42f142".sock: use of closed network connection
2020-08-31T01:22:07.321086Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a014fe6c-355c-4032-947e-5f65951655f5\".sock" 

2020-08-31T01:22:07.321160Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1363356c-e736-4a6f-ac65-7f82e98af298\".sock" 

2020-08-31T01:22:07.321201Z	info	sds	Start SDS grpc server
2020-08-31T01:22:07.321258Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:07.622604Z	info	sds	resource:default new connection
2020-08-31T01:22:07.622665Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:22:07.622730Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:07.623231Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:07.623258Z	error	sds	Remote side closed connection
2020-08-31T01:22:07.624390Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:22:07.624436Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:22:07.624482Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:22:07.624875Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:07.624902Z	error	sds	Remote side closed connection
2020-08-31T01:22:07.713243Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:07.926082Z	info	sds	resource:default new connection
2020-08-31T01:22:07.926155Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:22:07.926215Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:07.926575Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:07.926602Z	error	sds	Remote side closed connection
2020-08-31T01:22:07.926653Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a014fe6c-355c-4032-947e-5f65951655f5".sock: use of closed network connection
2020-08-31T01:22:07.926698Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1363356c-e736-4a6f-ac65-7f82e98af298".sock: use of closed network connection
2020-08-31T01:22:07.926891Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"8e55161f-2e47-44fa-9eab-ec8227b1c01c\".sock" 

2020-08-31T01:22:07.926914Z	info	sds	Start SDS grpc server
2020-08-31T01:22:08.017377Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:08.018678Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:22:08.229539Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"8e55161f-2e47-44fa-9eab-ec8227b1c01c".sock: use of closed network connection
2020-08-31T01:22:08.229726Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"136e8a81-c3ee-40c1-9764-a25c77242a7d\".sock" 

2020-08-31T01:22:08.229749Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:08.321166Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:22:08.531661Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"136e8a81-c3ee-40c1-9764-a25c77242a7d".sock: use of closed network connection
2020-08-31T01:22:08.532012Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest134ee4b5-9827-47e0-b330-2544bd37b1ef.sock" 

2020-08-31T01:22:08.532048Z	info	sds	Start SDS grpc server
2020-08-31T01:22:08.532077Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:08.532071Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"897efd10-f1a8-4ebe-b4c7-4c6b7ba24294\".sock" 

Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:22:08.926917Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:08.926964Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:22:09.137265Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest134ee4b5-9827-47e0-b330-2544bd37b1ef.sock: use of closed network connection
2020-08-31T01:22:09.137314Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"897efd10-f1a8-4ebe-b4c7-4c6b7ba24294".sock: use of closed network connection
2020-08-31T01:22:09.137521Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest09b2321f-3208-4ded-a004-561c138a407e.sock" 

2020-08-31T01:22:09.137606Z	info	sds	Start SDS grpc server
2020-08-31T01:22:09.229792Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:09.438638Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:22:09.438748Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:09.438990Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest09b2321f-3208-4ded-a004-561c138a407e.sock: use of closed network connection
2020-08-31T01:22:09.439172Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8e9b55d7-4123-40a1-8552-6dcc0bd4291d.sock" 

2020-08-31T01:22:09.439236Z	info	sds	Start SDS grpc server
2020-08-31T01:22:09.439753Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:22:09.439849Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:22:09.439914Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:09.439982Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:22:09.440023Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:22:09.440057Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:22:09.532023Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:09.713399Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:10.017690Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:10.019015Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:10.137542Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:10.137537Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:10.321530Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:10.439255Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:10.440165Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:10.440209Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:22:10.927249Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:10.927310Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:11.230076Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:11.441088Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:11.441434Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8e9b55d7-4123-40a1-8552-6dcc0bd4291d.sock: use of closed network connection
2020-08-31T01:22:11.441518Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:11.441547Z	error	sds	Remote side closed connection
2020-08-31T01:22:11.441525Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:11.441572Z	error	sds	Remote side closed connection
2020-08-31T01:22:11.441658Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest01ad9571-3f19-45c2-90ed-a37b13bdd613.sock" 

2020-08-31T01:22:11.441737Z	info	sds	Start SDS grpc server
2020-08-31T01:22:11.443157Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:22:11.443227Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:22:11.443304Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:11.443941Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:22:11.443302848 +0000 UTC m=+6.818535526 and is waiting for next SDS request
2020-08-31T01:22:11.443975Z	info	sds	Dynamic push for secret default
2020-08-31T01:22:11.444069Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest01ad9571-3f19-45c2-90ed-a37b13bdd613.sock: use of closed network connection
2020-08-31T01:22:11.444091Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:11.444173Z	error	sds	Remote side closed connection
2020-08-31T01:22:11.444273Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:11.444309Z	error	sds	Remote side closed connection
2020-08-31T01:22:11.444506Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest15523d8e-3863-4b2b-9756-fb8b1063c6cc.sock" 

2020-08-31T01:22:11.444534Z	info	sds	Start SDS grpc server
2020-08-31T01:22:11.445674Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:22:11.445730Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:22:11.445768Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:11.446488Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:22:11.532274Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:11.946567Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:11.946628Z	info	sds	Dynamic push for secret default
2020-08-31T01:22:11.947325Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest15523d8e-3863-4b2b-9756-fb8b1063c6cc.sock: use of closed network connection
2020-08-31T01:22:11.947399Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:11.947467Z	error	sds	Remote side closed connection
2020-08-31T01:22:11.947502Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:11.947522Z	error	sds	Remote side closed connection
2020-08-31T01:22:11.947594Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc849949b-d9bd-442e-a092-8405125b6899.sock" 

2020-08-31T01:22:11.947677Z	info	sds	Start SDS grpc server
2020-08-31T01:22:11.947828Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc849949b-d9bd-442e-a092-8405125b6899.sock: use of closed network connection
2020-08-31T01:22:11.947916Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest072d8a2c-dfcb-4e2f-ae9f-1c8fe1919bb4.sock" 

2020-08-31T01:22:11.947934Z	info	sds	Start SDS grpc server
2020-08-31T01:22:12.137791Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:12.137823Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:12.248683Z	info	sds	resource:default new connection
2020-08-31T01:22:12.248749Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:22:12.248812Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:12.249097Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:12.249126Z	error	sds	Remote side closed connection
2020-08-31T01:22:12.439547Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:12.441593Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:12.444254Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:12.550330Z	info	sds	resource:default new connection
2020-08-31T01:22:12.550410Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:22:12.550466Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:12.550751Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:12.550781Z	error	sds	Remote side closed connection
2020-08-31T01:22:12.551078Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest072d8a2c-dfcb-4e2f-ae9f-1c8fe1919bb4.sock: use of closed network connection
2020-08-31T01:22:12.551245Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest72dc0207-e96f-4c75-b9e8-78af9d93efc6.sock" 

2020-08-31T01:22:12.551282Z	info	sds	Start SDS grpc server
2020-08-31T01:22:12.852222Z	info	sds	resource:default new connection
2020-08-31T01:22:12.852312Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:22:12.852394Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:12.852717Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:12.852745Z	error	sds	Remote side closed connection
2020-08-31T01:22:12.853023Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest72dc0207-e96f-4c75-b9e8-78af9d93efc6.sock: use of closed network connection
2020-08-31T01:22:12.947579Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:12.947932Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:13.551305Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:13.713693Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:13.853257Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:22:14.017935Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:14.019196Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:14.321855Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:14.441806Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:14.444504Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:22:14.882670Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc22af65e-d340-497a-94ea-033345c856d9.sock" 

2020-08-31T01:22:14.882724Z	info	sds	Start SDS grpc server
2020-08-31T01:22:14.927538Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:14.927598Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:14.947846Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:14.948054Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:15.230204Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:15.532564Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:15.551675Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:15.853480Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:15.883491Z	info	sds	resource:default new connection
2020-08-31T01:22:15.883548Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:22:15.888159Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:22:15.953885Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:22:15.953932Z	info	cache	GenerateSecret default
2020-08-31T01:22:15.953993Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:15.954361Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc22af65e-d340-497a-94ea-033345c856d9.sock: use of closed network connection
PASS
2020-08-31T01:22:15.954485Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.580s
2020-08-31T01:22:21.167023Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdbbd2fa4-04e1-4917-a463-72a82dc6239e.sock" 

2020-08-31T01:22:21.167141Z	info	sds	Start SDS grpc server
2020-08-31T01:22:21.168250Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:22:21.168312Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:22:21.168718Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:22.168284Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:22.168350Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:22:23.168930Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:22:23.169017Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:22:23.169041Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:22:23.169118Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:23.169355Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdbbd2fa4-04e1-4917-a463-72a82dc6239e.sock: use of closed network connection
2020-08-31T01:22:23.169505Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:23.169528Z	error	sds	Remote side closed connection
2020-08-31T01:22:23.169606Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c9403d81-cdda-43b5-98d5-a883b31181d9\".sock" 

2020-08-31T01:22:23.169627Z	info	sds	Start SDS grpc server
2020-08-31T01:22:23.470658Z	info	sds	resource:default new connection
2020-08-31T01:22:23.470746Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:22:23.470812Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:23.471096Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:23.471117Z	error	sds	Remote side closed connection
2020-08-31T01:22:23.471891Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:22:23.471925Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:22:23.472081Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:22:23.472302Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:23.472328Z	error	sds	Remote side closed connection
2020-08-31T01:22:23.472515Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c9403d81-cdda-43b5-98d5-a883b31181d9".sock: use of closed network connection
2020-08-31T01:22:23.472716Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"d6be64f3-c749-4f34-afcc-baee9e1450a4\".sock" 

2020-08-31T01:22:23.472800Z	info	sds	Start SDS grpc server
2020-08-31T01:22:23.473320Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:22:23.473347Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:22:23.473396Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:22:23.473552Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:23.473576Z	error	sds	Remote side closed connection
2020-08-31T01:22:23.473743Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"d6be64f3-c749-4f34-afcc-baee9e1450a4".sock: use of closed network connection
2020-08-31T01:22:23.473983Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4ef607e5-75eb-45d0-9613-3a34b50369ea\".sock" 

2020-08-31T01:22:23.474025Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:23.775020Z	info	sds	resource:default new connection
2020-08-31T01:22:23.775094Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:22:23.775168Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:23.775469Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:23.775508Z	error	sds	Remote side closed connection
2020-08-31T01:22:23.775932Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4ef607e5-75eb-45d0-9613-3a34b50369ea".sock: use of closed network connection
2020-08-31T01:22:23.776153Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f02dead5-ecd1-46a5-aafe-85d056b16972\".sock" 

2020-08-31T01:22:23.776226Z	info	sds	Start SDS grpc server
2020-08-31T01:22:23.776254Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:23.776225Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f50b2d19-ced0-4ccb-8ce6-bac2b1d98f69\".sock" 

2020-08-31T01:22:24.077394Z	info	sds	resource:default new connection
2020-08-31T01:22:24.077476Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:22:24.077531Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:24.077796Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:24.077834Z	error	sds	Remote side closed connection
2020-08-31T01:22:24.078576Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:22:24.078640Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:22:24.078691Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:22:24.079035Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:24.079061Z	error	sds	Remote side closed connection
2020-08-31T01:22:24.169574Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:24.380712Z	info	sds	resource:default new connection
2020-08-31T01:22:24.380776Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:22:24.380835Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:24.381190Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:24.381228Z	error	sds	Remote side closed connection
2020-08-31T01:22:24.381362Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f02dead5-ecd1-46a5-aafe-85d056b16972".sock: use of closed network connection
2020-08-31T01:22:24.381399Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f50b2d19-ced0-4ccb-8ce6-bac2b1d98f69".sock: use of closed network connection
2020-08-31T01:22:24.381578Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c474fdc3-ceb8-4ce4-bd1e-ccf61cffd5cd\".sock" 

2020-08-31T01:22:24.381598Z	info	sds	Start SDS grpc server
2020-08-31T01:22:24.472716Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:24.473907Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:22:24.684131Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c474fdc3-ceb8-4ce4-bd1e-ccf61cffd5cd".sock: use of closed network connection
2020-08-31T01:22:24.684357Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"de9a64e7-fd79-4612-b4e3-551d7c0474cb\".sock" 

2020-08-31T01:22:24.684381Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:24.776104Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:22:24.985764Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"de9a64e7-fd79-4612-b4e3-551d7c0474cb".sock: use of closed network connection
2020-08-31T01:22:24.985954Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest7c1d1d47-2f2e-4435-a9da-de970f743ee3.sock" 

2020-08-31T01:22:24.986017Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e4151943-171d-478b-b30c-245f37d4ff45\".sock" 

2020-08-31T01:22:24.986051Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:24.986045Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:22:25.381562Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:25.381572Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:22:25.589918Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest7c1d1d47-2f2e-4435-a9da-de970f743ee3.sock: use of closed network connection
2020-08-31T01:22:25.589970Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e4151943-171d-478b-b30c-245f37d4ff45".sock: use of closed network connection
2020-08-31T01:22:25.590156Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestdc936fb4-6d67-43df-8d4d-39837342fcb7.sock" 

2020-08-31T01:22:25.590172Z	info	sds	Start SDS grpc server
2020-08-31T01:22:25.684396Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:25.892613Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:22:25.893163Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:25.893300Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestdc936fb4-6d67-43df-8d4d-39837342fcb7.sock: use of closed network connection
2020-08-31T01:22:25.893539Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest111a827d-e1d3-49de-8ede-02a92b7490fc.sock" 

2020-08-31T01:22:25.893632Z	info	sds	Start SDS grpc server
2020-08-31T01:22:25.894370Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:22:25.894420Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:22:25.894462Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:25.894601Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:22:25.894652Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:22:25.894691Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:22:25.985966Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:26.169770Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:26.472967Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:26.474121Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:26.590162Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:26.590149Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:26.776355Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:26.893550Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:26.894755Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:26.894796Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:22:27.381818Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:27.381853Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:27.684687Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:27.895665Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:27.896039Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest111a827d-e1d3-49de-8ede-02a92b7490fc.sock: use of closed network connection
2020-08-31T01:22:27.896104Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:27.896130Z	error	sds	Remote side closed connection
2020-08-31T01:22:27.896178Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:27.896187Z	error	sds	Remote side closed connection
2020-08-31T01:22:27.896280Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8daaf445-7804-41a1-9b04-7b2b9cc8c061.sock" 

2020-08-31T01:22:27.896339Z	info	sds	Start SDS grpc server
2020-08-31T01:22:27.897119Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:22:27.897173Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:22:27.897217Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:27.897669Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:22:27.897216722 +0000 UTC m=+6.807970577 and is waiting for next SDS request
2020-08-31T01:22:27.897686Z	info	sds	Dynamic push for secret default
2020-08-31T01:22:27.897732Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8daaf445-7804-41a1-9b04-7b2b9cc8c061.sock: use of closed network connection
2020-08-31T01:22:27.897799Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:27.897822Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:27.897813Z	error	sds	Remote side closed connection
2020-08-31T01:22:27.897840Z	error	sds	Remote side closed connection
2020-08-31T01:22:27.897939Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaff44cd6-3859-4810-8e17-8de244f3a26a.sock" 

2020-08-31T01:22:27.897957Z	info	sds	Start SDS grpc server
2020-08-31T01:22:27.898656Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:22:27.898699Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:22:27.898742Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:27.899300Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:22:27.986185Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:28.399465Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:28.399519Z	info	sds	Dynamic push for secret default
2020-08-31T01:22:28.400114Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaff44cd6-3859-4810-8e17-8de244f3a26a.sock: use of closed network connection
2020-08-31T01:22:28.400207Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:28.400240Z	error	sds	Remote side closed connection
2020-08-31T01:22:28.400262Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:28.400290Z	error	sds	Remote side closed connection
2020-08-31T01:22:28.400385Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest97481f20-1256-450b-bf0a-56ee4e399bfd.sock" 

2020-08-31T01:22:28.400506Z	info	sds	Start SDS grpc server
2020-08-31T01:22:28.400589Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest97481f20-1256-450b-bf0a-56ee4e399bfd.sock: use of closed network connection
2020-08-31T01:22:28.400716Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste07b65b5-d3f1-4dbf-96fc-57792bcabe01.sock" 

2020-08-31T01:22:28.400736Z	info	sds	Start SDS grpc server
2020-08-31T01:22:28.590435Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:28.590496Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:28.701648Z	info	sds	resource:default new connection
2020-08-31T01:22:28.701751Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:22:28.701808Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:28.702163Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:28.702183Z	error	sds	Remote side closed connection
2020-08-31T01:22:28.893798Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:28.896247Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:28.897794Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:29.003267Z	info	sds	resource:default new connection
2020-08-31T01:22:29.003396Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:22:29.003518Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:29.003845Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:29.003878Z	error	sds	Remote side closed connection
2020-08-31T01:22:29.004144Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste07b65b5-d3f1-4dbf-96fc-57792bcabe01.sock: use of closed network connection
2020-08-31T01:22:29.004282Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest361dea94-2cb1-4fab-8f97-9fc2034fe2e3.sock" 

2020-08-31T01:22:29.004333Z	info	sds	Start SDS grpc server
2020-08-31T01:22:29.305512Z	info	sds	resource:default new connection
2020-08-31T01:22:29.305575Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:22:29.305631Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:29.305918Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:29.305945Z	error	sds	Remote side closed connection
2020-08-31T01:22:29.306270Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest361dea94-2cb1-4fab-8f97-9fc2034fe2e3.sock: use of closed network connection
2020-08-31T01:22:29.400391Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:29.400750Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:30.004388Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:30.170029Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:30.306485Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:22:30.473193Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:30.474296Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:30.776635Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:30.908173Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:30.908209Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:22:31.336292Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest15003c78-f2e4-4be5-839e-f1de1c545703.sock" 

2020-08-31T01:22:31.336337Z	info	sds	Start SDS grpc server
2020-08-31T01:22:31.382108Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:31.382111Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:31.400650Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:31.400855Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:31.684951Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:31.986311Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:32.004490Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:32.306720Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:32.337185Z	info	sds	resource:default new connection
2020-08-31T01:22:32.337256Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:22:32.343080Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:22:32.415894Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:22:32.415950Z	info	cache	GenerateSecret default
2020-08-31T01:22:32.416005Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:32.416427Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest15003c78-f2e4-4be5-839e-f1de1c545703.sock: use of closed network connection
PASS
2020-08-31T01:22:32.416548Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:32.416571Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.572s
2020-08-31T01:22:37.657328Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest73822fb2-1c99-406b-9e75-c248c2709aaa.sock" 

2020-08-31T01:22:37.657455Z	info	sds	Start SDS grpc server
2020-08-31T01:22:37.658673Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:22:37.658730Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:22:37.659117Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:38.658646Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:38.658706Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:22:39.659349Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:22:39.659447Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:22:39.659480Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:22:39.659588Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:39.659794Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest73822fb2-1c99-406b-9e75-c248c2709aaa.sock: use of closed network connection
2020-08-31T01:22:39.659890Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:39.659900Z	error	sds	Remote side closed connection
2020-08-31T01:22:39.660109Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"072d315b-aa1a-48aa-b1a2-fa0448376ce5\".sock" 

2020-08-31T01:22:39.660157Z	info	sds	Start SDS grpc server
2020-08-31T01:22:39.961345Z	info	sds	resource:default new connection
2020-08-31T01:22:39.961405Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:22:39.961471Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:39.961769Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:39.961796Z	error	sds	Remote side closed connection
2020-08-31T01:22:39.962529Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:22:39.962564Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:22:39.962714Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:22:39.962995Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:39.963016Z	error	sds	Remote side closed connection
2020-08-31T01:22:39.963230Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"072d315b-aa1a-48aa-b1a2-fa0448376ce5".sock: use of closed network connection
2020-08-31T01:22:39.963427Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"db2e623a-e018-47cf-a3d7-97a54602e112\".sock" 

2020-08-31T01:22:39.963559Z	info	sds	Start SDS grpc server
2020-08-31T01:22:39.963978Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:22:39.964033Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:22:39.964077Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:22:39.964285Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:39.964348Z	error	sds	Remote side closed connection
2020-08-31T01:22:39.964501Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"db2e623a-e018-47cf-a3d7-97a54602e112".sock: use of closed network connection
2020-08-31T01:22:39.964650Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1f461fce-87bc-44a4-aba9-c981a18258e3\".sock" 

2020-08-31T01:22:39.964708Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:40.265581Z	info	sds	resource:default new connection
2020-08-31T01:22:40.265653Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:22:40.265716Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:40.265998Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:40.266033Z	error	sds	Remote side closed connection
2020-08-31T01:22:40.266275Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1f461fce-87bc-44a4-aba9-c981a18258e3".sock: use of closed network connection
2020-08-31T01:22:40.266487Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"540acf1f-5d1e-4569-8eed-35575ee4e354\".sock" 

2020-08-31T01:22:40.266504Z	info	sds	Start SDS grpc server
2020-08-31T01:22:40.266573Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"05bee312-6c6d-47dc-a314-05207def7fa1\".sock" 

2020-08-31T01:22:40.266607Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:40.567559Z	info	sds	resource:default new connection
2020-08-31T01:22:40.567636Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:22:40.567706Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:40.567975Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:40.567993Z	error	sds	Remote side closed connection
2020-08-31T01:22:40.568644Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:22:40.568709Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:22:40.568748Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:22:40.568980Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:40.569003Z	error	sds	Remote side closed connection
2020-08-31T01:22:40.660009Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:40.869989Z	info	sds	resource:default new connection
2020-08-31T01:22:40.870054Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:22:40.870122Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:40.870441Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:40.870471Z	error	sds	Remote side closed connection
2020-08-31T01:22:40.870728Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"540acf1f-5d1e-4569-8eed-35575ee4e354".sock: use of closed network connection
2020-08-31T01:22:40.870772Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"05bee312-6c6d-47dc-a314-05207def7fa1".sock: use of closed network connection
2020-08-31T01:22:40.870982Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a749dc08-272d-4654-810e-4716ea90abbe\".sock" 

2020-08-31T01:22:40.871001Z	info	sds	Start SDS grpc server
2020-08-31T01:22:40.963446Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:40.964701Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:22:41.174144Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a749dc08-272d-4654-810e-4716ea90abbe".sock: use of closed network connection
2020-08-31T01:22:41.174388Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"83749e00-9c2f-4602-a8e3-1a388cce7daf\".sock" 

2020-08-31T01:22:41.174414Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:41.266506Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:22:41.475826Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"83749e00-9c2f-4602-a8e3-1a388cce7daf".sock: use of closed network connection
2020-08-31T01:22:41.476023Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestff6f043e-be1e-4817-b89b-f74d8d2dc2c7.sock" 

2020-08-31T01:22:41.476087Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9005d8a4-6e22-41cc-813a-28d58f4ccaa8\".sock" 

2020-08-31T01:22:41.476120Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:41.476123Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:22:41.870914Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:41.870949Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:22:42.079972Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestff6f043e-be1e-4817-b89b-f74d8d2dc2c7.sock: use of closed network connection
2020-08-31T01:22:42.080053Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9005d8a4-6e22-41cc-813a-28d58f4ccaa8".sock: use of closed network connection
2020-08-31T01:22:42.080255Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest2add911b-8397-4b5a-b84c-0bd10ef517a9.sock" 

2020-08-31T01:22:42.080281Z	info	sds	Start SDS grpc server
2020-08-31T01:22:42.174392Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:42.381364Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:22:42.381471Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:42.381717Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest2add911b-8397-4b5a-b84c-0bd10ef517a9.sock: use of closed network connection
2020-08-31T01:22:42.381965Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest02373d9d-0b94-4006-a3e1-900b14d7e64a.sock" 

2020-08-31T01:22:42.382055Z	info	sds	Start SDS grpc server
2020-08-31T01:22:42.382673Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:22:42.382719Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:22:42.382763Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:42.382898Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:22:42.382939Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:22:42.382970Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:22:42.476027Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:42.660356Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:42.963607Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:42.964876Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:43.080204Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:43.080269Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:43.266784Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:43.381952Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:43.382972Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:43.383002Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:22:43.871139Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:43.871189Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:44.174629Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:44.383842Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:44.384215Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest02373d9d-0b94-4006-a3e1-900b14d7e64a.sock: use of closed network connection
2020-08-31T01:22:44.384238Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:44.384264Z	error	sds	Remote side closed connection
2020-08-31T01:22:44.384324Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:44.384349Z	error	sds	Remote side closed connection
2020-08-31T01:22:44.384458Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest211cad8e-abdc-4faf-8c25-ff0c8c7db35b.sock" 

2020-08-31T01:22:44.384526Z	info	sds	Start SDS grpc server
2020-08-31T01:22:44.386060Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:22:44.386150Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:22:44.386207Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:44.387175Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:22:44.386206312 +0000 UTC m=+6.806154197 and is waiting for next SDS request
2020-08-31T01:22:44.387194Z	info	sds	Dynamic push for secret default
2020-08-31T01:22:44.387249Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest211cad8e-abdc-4faf-8c25-ff0c8c7db35b.sock: use of closed network connection
2020-08-31T01:22:44.387303Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:44.387325Z	error	sds	Remote side closed connection
2020-08-31T01:22:44.387368Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:44.387397Z	error	sds	Remote side closed connection
2020-08-31T01:22:44.387442Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4dfebf69-7f43-4deb-a003-5f8a7afb685e.sock" 

2020-08-31T01:22:44.387499Z	info	sds	Start SDS grpc server
2020-08-31T01:22:44.388076Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:22:44.388130Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:22:44.388172Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:44.388807Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:22:44.476257Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:44.889012Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:44.889067Z	info	sds	Dynamic push for secret default
2020-08-31T01:22:44.889686Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4dfebf69-7f43-4deb-a003-5f8a7afb685e.sock: use of closed network connection
2020-08-31T01:22:44.889791Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:44.889821Z	error	sds	Remote side closed connection
2020-08-31T01:22:44.889796Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:44.889853Z	error	sds	Remote side closed connection
2020-08-31T01:22:44.889924Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestadef6eff-30e1-45cf-b72d-24a250faee45.sock" 

2020-08-31T01:22:44.889945Z	info	sds	Start SDS grpc server
2020-08-31T01:22:44.890138Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestadef6eff-30e1-45cf-b72d-24a250faee45.sock: use of closed network connection
2020-08-31T01:22:44.890225Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste3525402-0f18-4de8-b932-65aa36fa6565.sock" 

2020-08-31T01:22:44.890242Z	info	sds	Start SDS grpc server
2020-08-31T01:22:45.080488Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:45.080528Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:45.191201Z	info	sds	resource:default new connection
2020-08-31T01:22:45.191256Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:22:45.191318Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:45.191634Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:45.191660Z	error	sds	Remote side closed connection
2020-08-31T01:22:45.382183Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:45.384404Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:45.387417Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:45.492555Z	info	sds	resource:default new connection
2020-08-31T01:22:45.492640Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:22:45.492741Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:45.493006Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:45.493033Z	error	sds	Remote side closed connection
2020-08-31T01:22:45.493298Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste3525402-0f18-4de8-b932-65aa36fa6565.sock: use of closed network connection
2020-08-31T01:22:45.493418Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta83397fb-ea94-41ab-8645-d8b57bcf10ca.sock" 

2020-08-31T01:22:45.493442Z	info	sds	Start SDS grpc server
2020-08-31T01:22:45.794631Z	info	sds	resource:default new connection
2020-08-31T01:22:45.794686Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:22:45.794741Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:45.795017Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:45.795045Z	error	sds	Remote side closed connection
2020-08-31T01:22:45.795368Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta83397fb-ea94-41ab-8645-d8b57bcf10ca.sock: use of closed network connection
2020-08-31T01:22:45.889859Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:45.890329Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:46.493451Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:46.660589Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:46.795594Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:22:46.963841Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:46.965044Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:47.267044Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:47.384526Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:47.387595Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:22:47.824791Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest919f1153-fecf-4bd9-bc62-9bda4d2a22c1.sock" 

2020-08-31T01:22:47.824843Z	info	sds	Start SDS grpc server
2020-08-31T01:22:47.871425Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:47.871470Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:47.890113Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:47.890488Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:48.174849Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:48.476536Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:48.493618Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:48.795849Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:48.825637Z	info	sds	resource:default new connection
2020-08-31T01:22:48.825700Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:22:48.836278Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:22:48.944810Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:22:48.944851Z	info	cache	GenerateSecret default
2020-08-31T01:22:48.944910Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:48.945281Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest919f1153-fecf-4bd9-bc62-9bda4d2a22c1.sock: use of closed network connection
PASS
2020-08-31T01:22:48.945381Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:48.945404Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.618s
2020-08-31T01:22:54.148227Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9de10a4d-46dc-440b-a7fd-feb1bb64fe94.sock" 

2020-08-31T01:22:54.148320Z	info	sds	Start SDS grpc server
2020-08-31T01:22:54.149597Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:22:54.149658Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:22:54.150021Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:55.149465Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:55.149532Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:22:56.150189Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:22:56.150294Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:22:56.150320Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:22:56.150380Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:56.150707Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9de10a4d-46dc-440b-a7fd-feb1bb64fe94.sock: use of closed network connection
2020-08-31T01:22:56.150832Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:56.150853Z	error	sds	Remote side closed connection
2020-08-31T01:22:56.151027Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1e02502b-e07b-4400-b49c-3f31c0766de3\".sock" 

2020-08-31T01:22:56.151066Z	info	sds	Start SDS grpc server
2020-08-31T01:22:56.452071Z	info	sds	resource:default new connection
2020-08-31T01:22:56.452132Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:22:56.452186Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:56.452538Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:56.452556Z	error	sds	Remote side closed connection
2020-08-31T01:22:56.453132Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:22:56.453173Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:22:56.453413Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:22:56.453668Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:56.453705Z	error	sds	Remote side closed connection
2020-08-31T01:22:56.453943Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1e02502b-e07b-4400-b49c-3f31c0766de3".sock: use of closed network connection
2020-08-31T01:22:56.454122Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"611963db-d392-4894-8dbe-1668f3ba5f20\".sock" 

2020-08-31T01:22:56.454178Z	info	sds	Start SDS grpc server
2020-08-31T01:22:56.455083Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:22:56.455118Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:22:56.455164Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:22:56.455382Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:56.455413Z	error	sds	Remote side closed connection
2020-08-31T01:22:56.455674Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"611963db-d392-4894-8dbe-1668f3ba5f20".sock: use of closed network connection
2020-08-31T01:22:56.455879Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b92befd1-890a-4682-9119-232b0cd549a7\".sock" 

2020-08-31T01:22:56.455910Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:56.757047Z	info	sds	resource:default new connection
2020-08-31T01:22:56.757119Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:22:56.757172Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:56.757488Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:56.757511Z	error	sds	Remote side closed connection
2020-08-31T01:22:56.757713Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b92befd1-890a-4682-9119-232b0cd549a7".sock: use of closed network connection
2020-08-31T01:22:56.757912Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"39e75fd3-f4da-4d0b-827a-d6548a3b41cc\".sock" 

2020-08-31T01:22:56.757980Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"dc46842c-3f04-455f-81af-9fd251ca11cb\".sock" 

2020-08-31T01:22:56.757982Z	info	sds	Start SDS grpc server
2020-08-31T01:22:56.758002Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:57.058926Z	info	sds	resource:default new connection
2020-08-31T01:22:57.059000Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:22:57.059069Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:57.059351Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:57.059387Z	error	sds	Remote side closed connection
2020-08-31T01:22:57.059905Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:22:57.059956Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:22:57.059995Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:22:57.060225Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:57.060264Z	error	sds	Remote side closed connection
2020-08-31T01:22:57.150921Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:57.361268Z	info	sds	resource:default new connection
2020-08-31T01:22:57.361329Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:22:57.361381Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:57.361632Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:57.361654Z	error	sds	Remote side closed connection
2020-08-31T01:22:57.361942Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"39e75fd3-f4da-4d0b-827a-d6548a3b41cc".sock: use of closed network connection
2020-08-31T01:22:57.361994Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"dc46842c-3f04-455f-81af-9fd251ca11cb".sock: use of closed network connection
2020-08-31T01:22:57.362148Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4e4fbc3a-c8d0-43b0-b3c2-aba1cbda229c\".sock" 

2020-08-31T01:22:57.362154Z	info	sds	Start SDS grpc server
2020-08-31T01:22:57.454168Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:57.455856Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:22:57.664624Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4e4fbc3a-c8d0-43b0-b3c2-aba1cbda229c".sock: use of closed network connection
2020-08-31T01:22:57.664928Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8b478d8d-78e2-4976-86ce-b7b35e251387\".sock" 

2020-08-31T01:22:57.664972Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:22:57.757899Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:22:57.966732Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8b478d8d-78e2-4976-86ce-b7b35e251387".sock: use of closed network connection
2020-08-31T01:22:57.967196Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestc867c40e-ea2d-4497-adcf-20226e7b4e0f.sock" 

2020-08-31T01:22:57.967284Z	info	sds	Start SDS grpc server
2020-08-31T01:22:57.967335Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9cca7651-54bb-42a6-99a5-de16f1785804\".sock" 

2020-08-31T01:22:57.967343Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:22:58.362171Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:58.362197Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:22:58.571963Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestc867c40e-ea2d-4497-adcf-20226e7b4e0f.sock: use of closed network connection
2020-08-31T01:22:58.572017Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9cca7651-54bb-42a6-99a5-de16f1785804".sock: use of closed network connection
2020-08-31T01:22:58.572279Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesta1e5b93e-a209-4d98-be30-3dc1ca740838.sock" 

2020-08-31T01:22:58.572299Z	info	sds	Start SDS grpc server
2020-08-31T01:22:58.664868Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:58.873512Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:22:58.873609Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:22:58.873800Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesta1e5b93e-a209-4d98-be30-3dc1ca740838.sock: use of closed network connection
2020-08-31T01:22:58.874044Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta9828941-99bd-48d6-b20b-6cfa7774b4da.sock" 

2020-08-31T01:22:58.874062Z	info	sds	Start SDS grpc server
2020-08-31T01:22:58.876222Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:22:58.876296Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:22:58.876352Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:58.876861Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:22:58.876909Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:22:58.876945Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:22:58.966962Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:59.151153Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:59.454308Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:59.456050Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:59.572156Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:59.572169Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:59.758082Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:22:59.874022Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:22:59.876944Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:22:59.876979Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:23:00.362476Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:00.362494Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:00.665107Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:00.877818Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:00.878167Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta9828941-99bd-48d6-b20b-6cfa7774b4da.sock: use of closed network connection
2020-08-31T01:23:00.878223Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:00.878237Z	error	sds	Remote side closed connection
2020-08-31T01:23:00.878290Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:00.878318Z	error	sds	Remote side closed connection
2020-08-31T01:23:00.878608Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6739d730-3959-4f4e-a27b-014f190499df.sock" 

2020-08-31T01:23:00.878710Z	info	sds	Start SDS grpc server
2020-08-31T01:23:00.879393Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:23:00.879465Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:23:00.879512Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:00.880035Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:23:00.879511669 +0000 UTC m=+6.805931525 and is waiting for next SDS request
2020-08-31T01:23:00.880053Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6739d730-3959-4f4e-a27b-014f190499df.sock: use of closed network connection
2020-08-31T01:23:00.880062Z	info	sds	Dynamic push for secret default
2020-08-31T01:23:00.880124Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:00.880143Z	error	sds	Remote side closed connection
2020-08-31T01:23:00.880194Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:00.880219Z	error	sds	Remote side closed connection
2020-08-31T01:23:00.880306Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest90993401-dd68-4cee-ba23-de8dd72160d1.sock" 

2020-08-31T01:23:00.880417Z	info	sds	Start SDS grpc server
2020-08-31T01:23:00.881207Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:23:00.881273Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:23:00.881314Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:00.881841Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:23:00.967230Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:01.381952Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:01.382005Z	info	sds	Dynamic push for secret default
2020-08-31T01:23:01.382569Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest90993401-dd68-4cee-ba23-de8dd72160d1.sock: use of closed network connection
2020-08-31T01:23:01.382668Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:01.382715Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:01.382738Z	error	sds	Remote side closed connection
2020-08-31T01:23:01.382704Z	error	sds	Remote side closed connection
2020-08-31T01:23:01.382875Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd1f9c93e-be51-46eb-a5fd-578da6b55cfd.sock" 

2020-08-31T01:23:01.382923Z	info	sds	Start SDS grpc server
2020-08-31T01:23:01.383129Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd1f9c93e-be51-46eb-a5fd-578da6b55cfd.sock: use of closed network connection
2020-08-31T01:23:01.383210Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb5a56c07-0f68-4c69-bab4-a19079c65dd3.sock" 

2020-08-31T01:23:01.383229Z	info	sds	Start SDS grpc server
2020-08-31T01:23:01.572349Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:01.572399Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:01.684316Z	info	sds	resource:default new connection
2020-08-31T01:23:01.684429Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:23:01.684491Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:01.684736Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:01.684748Z	error	sds	Remote side closed connection
2020-08-31T01:23:01.874265Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:01.878264Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:01.880244Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:01.985917Z	info	sds	resource:default new connection
2020-08-31T01:23:01.985974Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:23:01.986034Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:01.986364Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:01.986393Z	error	sds	Remote side closed connection
2020-08-31T01:23:01.986697Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb5a56c07-0f68-4c69-bab4-a19079c65dd3.sock: use of closed network connection
2020-08-31T01:23:01.986817Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1360e0ed-2670-4190-b577-f4c2d6c34966.sock" 

2020-08-31T01:23:01.986850Z	info	sds	Start SDS grpc server
2020-08-31T01:23:02.287735Z	info	sds	resource:default new connection
2020-08-31T01:23:02.287814Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:23:02.287879Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:02.288131Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:02.288154Z	error	sds	Remote side closed connection
2020-08-31T01:23:02.288422Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1360e0ed-2670-4190-b577-f4c2d6c34966.sock: use of closed network connection
2020-08-31T01:23:02.382844Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:02.383340Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:02.986909Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:03.151274Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:03.288632Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:23:03.454548Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:03.456266Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:03.758297Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:03.878508Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:03.880461Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:23:04.319003Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest37f820c1-9d27-452e-81b5-0b746aa8801f.sock" 

2020-08-31T01:23:04.319052Z	info	sds	Start SDS grpc server
2020-08-31T01:23:04.362808Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:04.362849Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:04.383164Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:04.383543Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:04.665382Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:04.967457Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:04.987174Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:05.288891Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:05.319861Z	info	sds	resource:default new connection
2020-08-31T01:23:05.319934Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:23:05.328490Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:23:05.422530Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:23:05.422577Z	info	cache	GenerateSecret default
2020-08-31T01:23:05.422640Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:05.423938Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest37f820c1-9d27-452e-81b5-0b746aa8801f.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.593s
2020-08-31T01:23:10.639509Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest13fa67f6-2f55-4038-90fa-6428343040ae.sock" 

2020-08-31T01:23:10.639619Z	info	sds	Start SDS grpc server
2020-08-31T01:23:10.641199Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:23:10.641305Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:23:10.641770Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:11.640985Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:11.641046Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:23:12.641627Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:23:12.641697Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:23:12.641723Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:23:12.641792Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:12.641999Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest13fa67f6-2f55-4038-90fa-6428343040ae.sock: use of closed network connection
2020-08-31T01:23:12.642109Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:12.642142Z	error	sds	Remote side closed connection
2020-08-31T01:23:12.642215Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"7a359df5-051e-4c93-acf0-60193d0b998a\".sock" 

2020-08-31T01:23:12.642255Z	info	sds	Start SDS grpc server
2020-08-31T01:23:12.943244Z	info	sds	resource:default new connection
2020-08-31T01:23:12.943321Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:23:12.943387Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:12.943694Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:12.943721Z	error	sds	Remote side closed connection
2020-08-31T01:23:12.944377Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:23:12.944413Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:23:12.944565Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:23:12.944838Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:12.944855Z	error	sds	Remote side closed connection
2020-08-31T01:23:12.945068Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"7a359df5-051e-4c93-acf0-60193d0b998a".sock: use of closed network connection
2020-08-31T01:23:12.945277Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"60982f58-e519-4c6a-a4e7-347c75672eb1\".sock" 

2020-08-31T01:23:12.945347Z	info	sds	Start SDS grpc server
2020-08-31T01:23:12.945828Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:23:12.945862Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:23:12.945908Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:23:12.946149Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:12.946182Z	error	sds	Remote side closed connection
2020-08-31T01:23:12.946376Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"60982f58-e519-4c6a-a4e7-347c75672eb1".sock: use of closed network connection
2020-08-31T01:23:12.946532Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"84b62b71-cbaa-43ab-bf20-cac492f5ac14\".sock" 

2020-08-31T01:23:12.946566Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:13.247531Z	info	sds	resource:default new connection
2020-08-31T01:23:13.247586Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:23:13.247637Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:13.247999Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:13.248026Z	error	sds	Remote side closed connection
2020-08-31T01:23:13.248211Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"84b62b71-cbaa-43ab-bf20-cac492f5ac14".sock: use of closed network connection
2020-08-31T01:23:13.248411Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5e524327-f3e7-44f4-a27f-11a157daaffe\".sock" 

2020-08-31T01:23:13.248424Z	info	sds	Start SDS grpc server
2020-08-31T01:23:13.248521Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"0e448c55-e23c-45a2-aea5-464c81006af6\".sock" 

2020-08-31T01:23:13.248558Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:13.550040Z	info	sds	resource:default new connection
2020-08-31T01:23:13.550109Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:23:13.550163Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:13.550527Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:13.550565Z	error	sds	Remote side closed connection
2020-08-31T01:23:13.550995Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:23:13.551027Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:23:13.551064Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:23:13.551295Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:13.551322Z	error	sds	Remote side closed connection
2020-08-31T01:23:13.642302Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:13.852256Z	info	sds	resource:default new connection
2020-08-31T01:23:13.852317Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:23:13.852369Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:13.852802Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:13.852833Z	error	sds	Remote side closed connection
2020-08-31T01:23:13.852916Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5e524327-f3e7-44f4-a27f-11a157daaffe".sock: use of closed network connection
2020-08-31T01:23:13.852960Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"0e448c55-e23c-45a2-aea5-464c81006af6".sock: use of closed network connection
2020-08-31T01:23:13.853145Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a92e0a1f-e67e-4334-86d3-e910369ea6f6\".sock" 

2020-08-31T01:23:13.853165Z	info	sds	Start SDS grpc server
2020-08-31T01:23:13.945251Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:13.946518Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:23:14.155693Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a92e0a1f-e67e-4334-86d3-e910369ea6f6".sock: use of closed network connection
2020-08-31T01:23:14.155906Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9d5d8681-c498-4053-bef8-9d93f791b4f6\".sock" 

2020-08-31T01:23:14.155935Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:14.248442Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:23:14.457478Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9d5d8681-c498-4053-bef8-9d93f791b4f6".sock: use of closed network connection
2020-08-31T01:23:14.457725Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest5facd0f5-5d88-44db-b03e-7aeacbdc8a73.sock" 

2020-08-31T01:23:14.457784Z	info	sds	Start SDS grpc server
2020-08-31T01:23:14.457809Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"d1dadd34-2ad0-4662-aa8c-5a904cda6e34\".sock" 

2020-08-31T01:23:14.457856Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:23:14.853110Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:14.853150Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:23:15.061758Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest5facd0f5-5d88-44db-b03e-7aeacbdc8a73.sock: use of closed network connection
2020-08-31T01:23:15.061822Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"d1dadd34-2ad0-4662-aa8c-5a904cda6e34".sock: use of closed network connection
2020-08-31T01:23:15.061985Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1e1dc14a-d4fe-4c66-953f-f0dea540b7a5.sock" 

2020-08-31T01:23:15.062006Z	info	sds	Start SDS grpc server
2020-08-31T01:23:15.155924Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:15.363087Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:23:15.363181Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:15.363464Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1e1dc14a-d4fe-4c66-953f-f0dea540b7a5.sock: use of closed network connection
2020-08-31T01:23:15.363654Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest36d63f97-380b-4d92-a26b-35b253f0d471.sock" 

2020-08-31T01:23:15.363688Z	info	sds	Start SDS grpc server
2020-08-31T01:23:15.365101Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:23:15.365142Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:23:15.365191Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:15.365410Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:23:15.365441Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:23:15.365472Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:23:15.457703Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:15.642437Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:15.945504Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:15.946703Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:16.061978Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:16.062038Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:16.248639Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:16.363680Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:16.365433Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:16.365470Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:23:16.853375Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:16.853426Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:17.156181Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:17.366317Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:17.366749Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:17.366784Z	error	sds	Remote side closed connection
2020-08-31T01:23:17.366779Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest36d63f97-380b-4d92-a26b-35b253f0d471.sock: use of closed network connection
2020-08-31T01:23:17.366944Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:17.366964Z	error	sds	Remote side closed connection
2020-08-31T01:23:17.367051Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest51d54edd-5da6-45aa-9c42-4765c406c289.sock" 

2020-08-31T01:23:17.367151Z	info	sds	Start SDS grpc server
2020-08-31T01:23:17.369900Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:23:17.369966Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:23:17.370015Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:17.370462Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:23:17.370014994 +0000 UTC m=+6.807451324 and is waiting for next SDS request
2020-08-31T01:23:17.370483Z	info	sds	Dynamic push for secret default
2020-08-31T01:23:17.370514Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest51d54edd-5da6-45aa-9c42-4765c406c289.sock: use of closed network connection
2020-08-31T01:23:17.370565Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:17.370582Z	error	sds	Remote side closed connection
2020-08-31T01:23:17.370611Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:17.370621Z	error	sds	Remote side closed connection
2020-08-31T01:23:17.370763Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1b1abba3-4849-4baf-8c62-a55ba1eb9dba.sock" 

2020-08-31T01:23:17.370840Z	info	sds	Start SDS grpc server
2020-08-31T01:23:17.371424Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:23:17.371466Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:23:17.371501Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:17.372009Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:23:17.457969Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:17.872168Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:17.872248Z	info	sds	Dynamic push for secret default
2020-08-31T01:23:17.872971Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1b1abba3-4849-4baf-8c62-a55ba1eb9dba.sock: use of closed network connection
2020-08-31T01:23:17.873081Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:17.873113Z	error	sds	Remote side closed connection
2020-08-31T01:23:17.873128Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:17.873141Z	error	sds	Remote side closed connection
2020-08-31T01:23:17.873284Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6f5df2e6-5ad8-4e6e-89e6-e6c7f62d0cb9.sock" 

2020-08-31T01:23:17.873383Z	info	sds	Start SDS grpc server
2020-08-31T01:23:17.873557Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6f5df2e6-5ad8-4e6e-89e6-e6c7f62d0cb9.sock: use of closed network connection
2020-08-31T01:23:17.873653Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3db1b2f9-27be-4004-86e7-2dafa6b15047.sock" 

2020-08-31T01:23:17.873671Z	info	sds	Start SDS grpc server
2020-08-31T01:23:18.062208Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:18.062269Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:18.174761Z	info	sds	resource:default new connection
2020-08-31T01:23:18.174828Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:23:18.174886Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:18.175172Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:18.175206Z	error	sds	Remote side closed connection
2020-08-31T01:23:18.363962Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:18.366902Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:18.370793Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:18.476058Z	info	sds	resource:default new connection
2020-08-31T01:23:18.476123Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:23:18.476183Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:18.476545Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:18.476581Z	error	sds	Remote side closed connection
2020-08-31T01:23:18.476845Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3db1b2f9-27be-4004-86e7-2dafa6b15047.sock: use of closed network connection
2020-08-31T01:23:18.476979Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd6938ff3-aeb8-42dc-9258-5bd0c1aa208f.sock" 

2020-08-31T01:23:18.477007Z	info	sds	Start SDS grpc server
2020-08-31T01:23:18.778107Z	info	sds	resource:default new connection
2020-08-31T01:23:18.778173Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:23:18.778231Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:18.778595Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:18.778613Z	error	sds	Remote side closed connection
2020-08-31T01:23:18.778806Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd6938ff3-aeb8-42dc-9258-5bd0c1aa208f.sock: use of closed network connection
2020-08-31T01:23:18.873188Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:18.873741Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:19.477039Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:19.642694Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:19.779025Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:23:19.945760Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:19.946951Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:20.248909Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:20.367132Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:20.371017Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:23:20.808101Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb82f7278-e1b9-4c84-a09f-f50af262c987.sock" 

2020-08-31T01:23:20.808150Z	info	sds	Start SDS grpc server
2020-08-31T01:23:20.853651Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:20.853693Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:20.873449Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:20.873880Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:21.156892Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:21.458212Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:21.477311Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:21.779309Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:21.809090Z	info	sds	resource:default new connection
2020-08-31T01:23:21.809194Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:23:21.818027Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:23:21.977065Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:23:21.977110Z	info	cache	GenerateSecret default
2020-08-31T01:23:21.977179Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:21.977532Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb82f7278-e1b9-4c84-a09f-f50af262c987.sock: use of closed network connection
PASS
2020-08-31T01:23:21.977629Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:21.977652Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.658s
2020-08-31T01:23:27.240066Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest313c31cf-ca5b-43f8-a58f-989dce8e231e.sock" 

2020-08-31T01:23:27.240169Z	info	sds	Start SDS grpc server
2020-08-31T01:23:27.241523Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:23:27.241587Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:23:27.241944Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:28.241423Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:28.241484Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:23:29.242274Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:23:29.242366Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:23:29.242398Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:23:29.242470Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:29.242726Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest313c31cf-ca5b-43f8-a58f-989dce8e231e.sock: use of closed network connection
2020-08-31T01:23:29.242878Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:29.242911Z	error	sds	Remote side closed connection
2020-08-31T01:23:29.243059Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9c311476-9f22-4ff2-9e0f-4c478e404391\".sock" 

2020-08-31T01:23:29.243107Z	info	sds	Start SDS grpc server
2020-08-31T01:23:29.544208Z	info	sds	resource:default new connection
2020-08-31T01:23:29.544281Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:23:29.544337Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:29.544578Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:29.544592Z	error	sds	Remote side closed connection
2020-08-31T01:23:29.545516Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:23:29.545568Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:23:29.545730Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:23:29.546004Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:29.546035Z	error	sds	Remote side closed connection
2020-08-31T01:23:29.546285Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9c311476-9f22-4ff2-9e0f-4c478e404391".sock: use of closed network connection
2020-08-31T01:23:29.546469Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"240b15e3-6ae6-4033-ae35-16098b761094\".sock" 

2020-08-31T01:23:29.546497Z	info	sds	Start SDS grpc server
2020-08-31T01:23:29.547012Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:23:29.547044Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:23:29.547080Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:23:29.547371Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:29.547405Z	error	sds	Remote side closed connection
2020-08-31T01:23:29.547540Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"240b15e3-6ae6-4033-ae35-16098b761094".sock: use of closed network connection
2020-08-31T01:23:29.547753Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"9eebe25d-9176-4254-9517-059a7a4c0886\".sock" 

2020-08-31T01:23:29.547790Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:29.848891Z	info	sds	resource:default new connection
2020-08-31T01:23:29.848964Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:23:29.849042Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:29.849321Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:29.849342Z	error	sds	Remote side closed connection
2020-08-31T01:23:29.849579Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"9eebe25d-9176-4254-9517-059a7a4c0886".sock: use of closed network connection
2020-08-31T01:23:29.849838Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f291c390-7390-4a7f-9f4c-4c1dbc05b676\".sock" 

2020-08-31T01:23:29.849899Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"7ad9956b-32b7-456e-bcc2-affdda61f644\".sock" 

2020-08-31T01:23:29.849932Z	info	sds	Start SDS grpc server
2020-08-31T01:23:29.849950Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:30.150982Z	info	sds	resource:default new connection
2020-08-31T01:23:30.151038Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:23:30.151090Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:30.151349Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:30.151365Z	error	sds	Remote side closed connection
2020-08-31T01:23:30.152088Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:23:30.152132Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:23:30.152178Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:23:30.152630Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:30.152690Z	error	sds	Remote side closed connection
2020-08-31T01:23:30.242910Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:30.453690Z	info	sds	resource:default new connection
2020-08-31T01:23:30.453757Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:23:30.453810Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:30.454143Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:30.454174Z	error	sds	Remote side closed connection
2020-08-31T01:23:30.454413Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f291c390-7390-4a7f-9f4c-4c1dbc05b676".sock: use of closed network connection
2020-08-31T01:23:30.454459Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"7ad9956b-32b7-456e-bcc2-affdda61f644".sock: use of closed network connection
2020-08-31T01:23:30.454679Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e0d6a085-4b38-47c8-85cc-a2dc7318ca74\".sock" 

2020-08-31T01:23:30.454693Z	info	sds	Start SDS grpc server
2020-08-31T01:23:30.546503Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:30.547709Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:23:30.757876Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e0d6a085-4b38-47c8-85cc-a2dc7318ca74".sock: use of closed network connection
2020-08-31T01:23:30.758055Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"97f75ff5-93bb-4896-9219-fb90f6546b40\".sock" 

2020-08-31T01:23:30.758075Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:30.849808Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:23:31.059819Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"97f75ff5-93bb-4896-9219-fb90f6546b40".sock: use of closed network connection
2020-08-31T01:23:31.060008Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest807adf7d-3ba4-46cc-bf22-34c46c7982d5.sock" 

2020-08-31T01:23:31.060043Z	info	sds	Start SDS grpc server
2020-08-31T01:23:31.060073Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:31.060067Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"f57db76f-0412-4b9f-999a-2dfdaabd563b\".sock" 

Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:23:31.454490Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:31.454562Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:23:31.664022Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest807adf7d-3ba4-46cc-bf22-34c46c7982d5.sock: use of closed network connection
2020-08-31T01:23:31.664081Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"f57db76f-0412-4b9f-999a-2dfdaabd563b".sock: use of closed network connection
2020-08-31T01:23:31.664246Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestf69da5ff-49d7-44ff-8fb4-7f776021b2dd.sock" 

2020-08-31T01:23:31.664286Z	info	sds	Start SDS grpc server
2020-08-31T01:23:31.757957Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:31.965313Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:23:31.965407Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:31.965646Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestf69da5ff-49d7-44ff-8fb4-7f776021b2dd.sock: use of closed network connection
2020-08-31T01:23:31.965981Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta0668552-4077-44de-9502-9258ba60f37c.sock" 

2020-08-31T01:23:31.966053Z	info	sds	Start SDS grpc server
2020-08-31T01:23:31.968052Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:23:31.968137Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:23:31.969257Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:31.969244Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:23:31.969360Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:23:31.969415Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:23:32.060059Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:32.243167Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:32.546811Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:32.547909Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:32.664272Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:32.664332Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:32.850073Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:32.965907Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:32.968859Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:32.968911Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:23:33.454736Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:33.454774Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:33.758183Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:33.969808Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:33.970142Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta0668552-4077-44de-9502-9258ba60f37c.sock: use of closed network connection
2020-08-31T01:23:33.970163Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:33.970186Z	error	sds	Remote side closed connection
2020-08-31T01:23:33.970291Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:33.970324Z	error	sds	Remote side closed connection
2020-08-31T01:23:33.970348Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest64127e9e-7cd2-4eb7-9078-5227cc997dfb.sock" 

2020-08-31T01:23:33.970381Z	info	sds	Start SDS grpc server
2020-08-31T01:23:33.971171Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:23:33.971217Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:23:33.971261Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:33.971701Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:23:33.971260948 +0000 UTC m=+6.807863171 and is waiting for next SDS request
2020-08-31T01:23:33.971725Z	info	sds	Dynamic push for secret default
2020-08-31T01:23:33.971708Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest64127e9e-7cd2-4eb7-9078-5227cc997dfb.sock: use of closed network connection
2020-08-31T01:23:33.971797Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:33.971821Z	error	sds	Remote side closed connection
2020-08-31T01:23:33.971843Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:33.971860Z	error	sds	Remote side closed connection
2020-08-31T01:23:33.971924Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest71fe935c-f57b-4214-ba5a-059f4d645586.sock" 

2020-08-31T01:23:33.972025Z	info	sds	Start SDS grpc server
2020-08-31T01:23:33.972742Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:23:33.972804Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:23:33.972846Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:33.973436Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:23:34.060314Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:34.473557Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:34.473612Z	info	sds	Dynamic push for secret default
2020-08-31T01:23:34.474225Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest71fe935c-f57b-4214-ba5a-059f4d645586.sock: use of closed network connection
2020-08-31T01:23:34.474329Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:34.474358Z	error	sds	Remote side closed connection
2020-08-31T01:23:34.474427Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:34.474435Z	error	sds	Remote side closed connection
2020-08-31T01:23:34.474571Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste8812da0-1c86-4d29-aa91-10a2c5eaff6e.sock" 

2020-08-31T01:23:34.474582Z	info	sds	Start SDS grpc server
2020-08-31T01:23:34.474834Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste8812da0-1c86-4d29-aa91-10a2c5eaff6e.sock: use of closed network connection
2020-08-31T01:23:34.474940Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdedf3f44-4098-4e64-bae7-fb25a2c82b6b.sock" 

2020-08-31T01:23:34.474961Z	info	sds	Start SDS grpc server
2020-08-31T01:23:34.664534Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:34.664588Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:34.775970Z	info	sds	resource:default new connection
2020-08-31T01:23:34.776146Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:23:34.776227Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:34.776525Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:34.776552Z	error	sds	Remote side closed connection
2020-08-31T01:23:34.966169Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:34.970376Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:34.971902Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:35.077671Z	info	sds	resource:default new connection
2020-08-31T01:23:35.077737Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:23:35.077801Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:35.078068Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:35.078096Z	error	sds	Remote side closed connection
2020-08-31T01:23:35.078381Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdedf3f44-4098-4e64-bae7-fb25a2c82b6b.sock: use of closed network connection
2020-08-31T01:23:35.078503Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest61b35a1e-7639-4d7e-95b7-4b7089b09a7f.sock" 

2020-08-31T01:23:35.078526Z	info	sds	Start SDS grpc server
2020-08-31T01:23:35.379433Z	info	sds	resource:default new connection
2020-08-31T01:23:35.379493Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:23:35.379547Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:35.379886Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:35.379902Z	error	sds	Remote side closed connection
2020-08-31T01:23:35.380128Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest61b35a1e-7639-4d7e-95b7-4b7089b09a7f.sock: use of closed network connection
2020-08-31T01:23:35.474439Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:35.474938Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:36.078615Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:36.243416Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:36.380317Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:23:36.547106Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:36.548044Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:36.850323Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:36.970646Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:36.972093Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:23:37.409966Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb1eaa293-903e-4167-b8a9-a0c71ee6874e.sock" 

2020-08-31T01:23:37.410032Z	info	sds	Start SDS grpc server
2020-08-31T01:23:37.454948Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:37.454982Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:37.474642Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:37.475064Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:37.758361Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:38.060605Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:38.078894Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:38.380588Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:38.410740Z	info	sds	resource:default new connection
2020-08-31T01:23:38.410835Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:23:38.421381Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:23:38.539907Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:23:38.539958Z	info	cache	GenerateSecret default
2020-08-31T01:23:38.540019Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:38.540976Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb1eaa293-903e-4167-b8a9-a0c71ee6874e.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.621s
2020-08-31T01:23:43.840825Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfa0707fd-4e17-4acf-908d-16100032a7e3.sock" 

2020-08-31T01:23:43.840956Z	info	sds	Start SDS grpc server
2020-08-31T01:23:43.842236Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:23:43.842304Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:23:43.842653Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:44.842109Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:44.842165Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:23:45.842900Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:23:45.842973Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:23:45.843000Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:23:45.843067Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:45.843335Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfa0707fd-4e17-4acf-908d-16100032a7e3.sock: use of closed network connection
2020-08-31T01:23:45.843498Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:45.843521Z	error	sds	Remote side closed connection
2020-08-31T01:23:45.843674Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"e5065009-384b-4ebf-a128-0446da79c6c8\".sock" 

2020-08-31T01:23:45.843715Z	info	sds	Start SDS grpc server
2020-08-31T01:23:46.144791Z	info	sds	resource:default new connection
2020-08-31T01:23:46.144902Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:23:46.144961Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:46.145362Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:46.145399Z	error	sds	Remote side closed connection
2020-08-31T01:23:46.145998Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:23:46.146040Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:23:46.146208Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:23:46.146465Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:46.146476Z	error	sds	Remote side closed connection
2020-08-31T01:23:46.146673Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"e5065009-384b-4ebf-a128-0446da79c6c8".sock: use of closed network connection
2020-08-31T01:23:46.146874Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"95ccae90-8e3b-450e-b5f8-4b7040509446\".sock" 

2020-08-31T01:23:46.146984Z	info	sds	Start SDS grpc server
2020-08-31T01:23:46.147414Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:23:46.147456Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:23:46.147501Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:23:46.147718Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:46.147744Z	error	sds	Remote side closed connection
2020-08-31T01:23:46.147872Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"95ccae90-8e3b-450e-b5f8-4b7040509446".sock: use of closed network connection
2020-08-31T01:23:46.148050Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"3860167e-d540-4376-b911-0d8729ad8ba0\".sock" 

2020-08-31T01:23:46.148082Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:46.449389Z	info	sds	resource:default new connection
2020-08-31T01:23:46.449454Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:23:46.449527Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:46.449854Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:46.449880Z	error	sds	Remote side closed connection
2020-08-31T01:23:46.450175Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"3860167e-d540-4376-b911-0d8729ad8ba0".sock: use of closed network connection
2020-08-31T01:23:46.450542Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5ede2f04-bb0f-49aa-a430-aa326bc9d9b5\".sock" 

2020-08-31T01:23:46.450625Z	info	sds	Start SDS grpc server
2020-08-31T01:23:46.450665Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"af3af259-fd0e-45a3-868e-d5491eef9cb3\".sock" 

2020-08-31T01:23:46.450681Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:46.751709Z	info	sds	resource:default new connection
2020-08-31T01:23:46.751776Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:23:46.751835Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:46.752153Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:46.752220Z	error	sds	Remote side closed connection
2020-08-31T01:23:46.752724Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:23:46.752782Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:23:46.752834Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:23:46.753042Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:46.753064Z	error	sds	Remote side closed connection
2020-08-31T01:23:46.843579Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:47.054085Z	info	sds	resource:default new connection
2020-08-31T01:23:47.054186Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:23:47.054245Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:47.054564Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:47.054579Z	error	sds	Remote side closed connection
2020-08-31T01:23:47.055011Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5ede2f04-bb0f-49aa-a430-aa326bc9d9b5".sock: use of closed network connection
2020-08-31T01:23:47.055082Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"af3af259-fd0e-45a3-868e-d5491eef9cb3".sock: use of closed network connection
2020-08-31T01:23:47.055308Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"fb3d4088-aef0-48da-9980-4115c643bb8e\".sock" 

2020-08-31T01:23:47.055336Z	info	sds	Start SDS grpc server
2020-08-31T01:23:47.146767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:47.147940Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:23:47.358326Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"fb3d4088-aef0-48da-9980-4115c643bb8e".sock: use of closed network connection
2020-08-31T01:23:47.358591Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5f9c3f4f-59f0-479b-843f-7fd55c25f811\".sock" 

2020-08-31T01:23:47.358621Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:47.450327Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:23:47.660682Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5f9c3f4f-59f0-479b-843f-7fd55c25f811".sock: use of closed network connection
2020-08-31T01:23:47.660875Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesteb8d5a4c-0744-4a7e-a65c-d7b1c1f3247f.sock" 

2020-08-31T01:23:47.660937Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"40a30c26-e207-49b5-8fb8-aeaad2b49a0a\".sock" 

2020-08-31T01:23:47.660972Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:23:47.660976Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:23:48.055277Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:48.055318Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:23:48.265066Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesteb8d5a4c-0744-4a7e-a65c-d7b1c1f3247f.sock: use of closed network connection
2020-08-31T01:23:48.265118Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"40a30c26-e207-49b5-8fb8-aeaad2b49a0a".sock: use of closed network connection
2020-08-31T01:23:48.265300Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest1cff6d13-15fc-46b9-94c4-469e149b4b28.sock" 

2020-08-31T01:23:48.265322Z	info	sds	Start SDS grpc server
2020-08-31T01:23:48.358567Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:48.566431Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:23:48.566530Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:48.566758Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest1cff6d13-15fc-46b9-94c4-469e149b4b28.sock: use of closed network connection
2020-08-31T01:23:48.567009Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9d9f5858-8069-4289-a396-c901d1527f1f.sock" 

2020-08-31T01:23:48.567016Z	info	sds	Start SDS grpc server
2020-08-31T01:23:48.568824Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:23:48.568905Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:23:48.568989Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:48.570017Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:23:48.570067Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:23:48.570101Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:23:48.660892Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:48.843871Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:49.146987Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:49.148131Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:49.265289Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:49.265340Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:49.450587Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:49.567036Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:49.569620Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:49.569665Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:23:50.055565Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:50.055550Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:50.358888Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:50.570476Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:50.570846Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9d9f5858-8069-4289-a396-c901d1527f1f.sock: use of closed network connection
2020-08-31T01:23:50.570872Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:50.570895Z	error	sds	Remote side closed connection
2020-08-31T01:23:50.570959Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:50.571006Z	error	sds	Remote side closed connection
2020-08-31T01:23:50.571062Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta15597be-b0b1-41c1-88d1-ac58f4655e14.sock" 

2020-08-31T01:23:50.571096Z	info	sds	Start SDS grpc server
2020-08-31T01:23:50.572056Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:23:50.572101Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:23:50.572145Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:50.572605Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:23:50.572145167 +0000 UTC m=+6.813390643 and is waiting for next SDS request
2020-08-31T01:23:50.572631Z	info	sds	Dynamic push for secret default
2020-08-31T01:23:50.572649Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta15597be-b0b1-41c1-88d1-ac58f4655e14.sock: use of closed network connection
2020-08-31T01:23:50.572758Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:50.572762Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:50.572780Z	error	sds	Remote side closed connection
2020-08-31T01:23:50.572768Z	error	sds	Remote side closed connection
2020-08-31T01:23:50.572913Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest11f7e5a2-e362-4b30-ba4a-52db3981f0a9.sock" 

2020-08-31T01:23:50.572994Z	info	sds	Start SDS grpc server
2020-08-31T01:23:50.573624Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:23:50.573668Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:23:50.573703Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:50.574225Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:23:50.664055Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:51.074477Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:51.074534Z	info	sds	Dynamic push for secret default
2020-08-31T01:23:51.075177Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest11f7e5a2-e362-4b30-ba4a-52db3981f0a9.sock: use of closed network connection
2020-08-31T01:23:51.075247Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:51.075256Z	error	sds	Remote side closed connection
2020-08-31T01:23:51.075302Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:51.075327Z	error	sds	Remote side closed connection
2020-08-31T01:23:51.075431Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc9237045-bc82-47f0-9151-bdbb5a11c4be.sock" 

2020-08-31T01:23:51.075451Z	info	sds	Start SDS grpc server
2020-08-31T01:23:51.075656Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc9237045-bc82-47f0-9151-bdbb5a11c4be.sock: use of closed network connection
2020-08-31T01:23:51.075729Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestbfb1b8c6-bbc6-491c-8c42-5948dd518ca4.sock" 

2020-08-31T01:23:51.075746Z	info	sds	Start SDS grpc server
2020-08-31T01:23:51.265564Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:51.265617Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:51.376629Z	info	sds	resource:default new connection
2020-08-31T01:23:51.376738Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:23:51.376791Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:51.377055Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:51.377090Z	error	sds	Remote side closed connection
2020-08-31T01:23:51.567297Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:51.571105Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:51.572855Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:51.678039Z	info	sds	resource:default new connection
2020-08-31T01:23:51.678098Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:23:51.678173Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:51.678397Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:51.678422Z	error	sds	Remote side closed connection
2020-08-31T01:23:51.678822Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestbfb1b8c6-bbc6-491c-8c42-5948dd518ca4.sock: use of closed network connection
2020-08-31T01:23:51.678950Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1ac7771a-cc78-4616-b3aa-11b3bbbe1a02.sock" 

2020-08-31T01:23:51.678983Z	info	sds	Start SDS grpc server
2020-08-31T01:23:51.979934Z	info	sds	resource:default new connection
2020-08-31T01:23:51.979993Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:23:51.980053Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:51.980353Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:23:51.980370Z	error	sds	Remote side closed connection
2020-08-31T01:23:51.980845Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1ac7771a-cc78-4616-b3aa-11b3bbbe1a02.sock: use of closed network connection
2020-08-31T01:23:52.075396Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:52.075805Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:52.679036Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:52.844130Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:52.980941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:23:53.147223Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:53.148290Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:53.450826Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:53.571436Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:53.573011Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:23:54.010635Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6639335f-8df6-4924-a2f0-034ff1b3c964.sock" 

2020-08-31T01:23:54.010687Z	info	sds	Start SDS grpc server
2020-08-31T01:23:54.055784Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:54.055798Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:54.075650Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:54.075993Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:54.359020Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:54.664323Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:23:54.679177Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:54.981178Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:23:55.012297Z	info	sds	resource:default new connection
2020-08-31T01:23:55.012364Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:23:55.015037Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:23:55.245202Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:23:55.245248Z	info	cache	GenerateSecret default
2020-08-31T01:23:55.245304Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:23:55.245666Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6639335f-8df6-4924-a2f0-034ff1b3c964.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.731s
2020-08-31T01:24:00.523160Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaf45944f-642a-4511-a8e7-054edaa59f4d.sock" 

2020-08-31T01:24:00.523256Z	info	sds	Start SDS grpc server
2020-08-31T01:24:00.526433Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:24:00.526527Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:24:00.526943Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:01.525438Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:01.525503Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:24:02.526165Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:24:02.526243Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:24:02.526267Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:24:02.526346Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:02.526672Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaf45944f-642a-4511-a8e7-054edaa59f4d.sock: use of closed network connection
2020-08-31T01:24:02.526832Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:02.526874Z	error	sds	Remote side closed connection
2020-08-31T01:24:02.526932Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"aa05b35d-aedf-4173-b147-a4e1480abae6\".sock" 

2020-08-31T01:24:02.526982Z	info	sds	Start SDS grpc server
2020-08-31T01:24:02.827893Z	info	sds	resource:default new connection
2020-08-31T01:24:02.827976Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:24:02.828038Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:02.828503Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:02.828525Z	error	sds	Remote side closed connection
2020-08-31T01:24:02.829199Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:24:02.829239Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:24:02.829424Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:24:02.829692Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:02.829724Z	error	sds	Remote side closed connection
2020-08-31T01:24:02.829902Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"aa05b35d-aedf-4173-b147-a4e1480abae6".sock: use of closed network connection
2020-08-31T01:24:02.830075Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"02b4c9cf-2514-47d7-b456-d9e9a8d65bf8\".sock" 

2020-08-31T01:24:02.830097Z	info	sds	Start SDS grpc server
2020-08-31T01:24:02.830513Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:24:02.830543Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:24:02.830577Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:24:02.830819Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:02.830857Z	error	sds	Remote side closed connection
2020-08-31T01:24:02.830980Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"02b4c9cf-2514-47d7-b456-d9e9a8d65bf8".sock: use of closed network connection
2020-08-31T01:24:02.831121Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"33e0f820-b35a-4aaa-9044-1815a530cccb\".sock" 

2020-08-31T01:24:02.831146Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:03.132061Z	info	sds	resource:default new connection
2020-08-31T01:24:03.132116Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:24:03.132168Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:03.132517Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:03.132544Z	error	sds	Remote side closed connection
2020-08-31T01:24:03.132802Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"33e0f820-b35a-4aaa-9044-1815a530cccb".sock: use of closed network connection
2020-08-31T01:24:03.133005Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"613af20e-cec2-4421-b8d9-21aad997ca41\".sock" 

2020-08-31T01:24:03.133038Z	info	sds	Start SDS grpc server
2020-08-31T01:24:03.133067Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"297409bf-6531-433f-b279-fd4245d9b03a\".sock" 

2020-08-31T01:24:03.133088Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:03.434003Z	info	sds	resource:default new connection
2020-08-31T01:24:03.434062Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:24:03.434138Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:03.434478Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:03.434496Z	error	sds	Remote side closed connection
2020-08-31T01:24:03.434979Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:24:03.435040Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:24:03.435099Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:24:03.435329Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:03.435350Z	error	sds	Remote side closed connection
2020-08-31T01:24:03.526910Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:03.736478Z	info	sds	resource:default new connection
2020-08-31T01:24:03.736530Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:24:03.736593Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:03.736987Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:03.737037Z	error	sds	Remote side closed connection
2020-08-31T01:24:03.740979Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"613af20e-cec2-4421-b8d9-21aad997ca41".sock: use of closed network connection
2020-08-31T01:24:03.741088Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"297409bf-6531-433f-b279-fd4245d9b03a".sock: use of closed network connection
2020-08-31T01:24:03.741402Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9c3c7c29-25c2-410e-9b30-ba96652d97fb\".sock" 

2020-08-31T01:24:03.741430Z	info	sds	Start SDS grpc server
2020-08-31T01:24:03.830146Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:03.831114Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:24:04.043697Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9c3c7c29-25c2-410e-9b30-ba96652d97fb".sock: use of closed network connection
2020-08-31T01:24:04.044059Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"5b78242f-93ec-4ceb-87e8-19dee06667e9\".sock" 

2020-08-31T01:24:04.044092Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:04.133030Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:24:04.345737Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"5b78242f-93ec-4ceb-87e8-19dee06667e9".sock: use of closed network connection
2020-08-31T01:24:04.345955Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest5fdae82d-9039-4c14-b546-0f62c85b356a.sock" 

2020-08-31T01:24:04.345978Z	info	sds	Start SDS grpc server
2020-08-31T01:24:04.346014Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"03ab25b3-e3bd-4bf1-ae71-7410de140c77\".sock" 

2020-08-31T01:24:04.346030Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:24:04.741255Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:04.741206Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:24:04.949970Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest5fdae82d-9039-4c14-b546-0f62c85b356a.sock: use of closed network connection
2020-08-31T01:24:04.950031Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"03ab25b3-e3bd-4bf1-ae71-7410de140c77".sock: use of closed network connection
2020-08-31T01:24:04.950262Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest463d5a6f-488b-470c-90e7-b4f8dafd5046.sock" 

2020-08-31T01:24:04.950297Z	info	sds	Start SDS grpc server
2020-08-31T01:24:05.043915Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:05.251214Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:24:05.251306Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:05.251516Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest463d5a6f-488b-470c-90e7-b4f8dafd5046.sock: use of closed network connection
2020-08-31T01:24:05.251716Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest3dc2bc34-f838-4460-8bd9-5deb15a96010.sock" 

2020-08-31T01:24:05.251755Z	info	sds	Start SDS grpc server
2020-08-31T01:24:05.252407Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:24:05.252450Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:24:05.252493Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:05.252578Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:24:05.252601Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:24:05.252629Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:24:05.346034Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:05.527132Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:05.830401Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:05.831309Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:05.950224Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:05.950275Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:06.133263Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:06.251746Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:06.252742Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:06.252775Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:24:06.741539Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:06.741595Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:07.044199Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:07.253686Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:07.254072Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest3dc2bc34-f838-4460-8bd9-5deb15a96010.sock: use of closed network connection
2020-08-31T01:24:07.254099Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:07.254123Z	error	sds	Remote side closed connection
2020-08-31T01:24:07.254175Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:07.254183Z	error	sds	Remote side closed connection
2020-08-31T01:24:07.254302Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest31fd5d5a-a4fb-48fc-ac10-ee2c349b0600.sock" 

2020-08-31T01:24:07.254348Z	info	sds	Start SDS grpc server
2020-08-31T01:24:07.255102Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:24:07.255152Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:24:07.255201Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:07.255663Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:24:07.255200817 +0000 UTC m=+6.805360955 and is waiting for next SDS request
2020-08-31T01:24:07.255683Z	info	sds	Dynamic push for secret default
2020-08-31T01:24:07.255706Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest31fd5d5a-a4fb-48fc-ac10-ee2c349b0600.sock: use of closed network connection
2020-08-31T01:24:07.255761Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:07.255787Z	error	sds	Remote side closed connection
2020-08-31T01:24:07.255831Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:07.255855Z	error	sds	Remote side closed connection
2020-08-31T01:24:07.255947Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest24342067-34f7-4dd8-8b2c-4da17917644d.sock" 

2020-08-31T01:24:07.256032Z	info	sds	Start SDS grpc server
2020-08-31T01:24:07.257130Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:24:07.257171Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:24:07.257207Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:07.257788Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:24:07.346305Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:07.757842Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:07.757908Z	info	sds	Dynamic push for secret default
2020-08-31T01:24:07.758481Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest24342067-34f7-4dd8-8b2c-4da17917644d.sock: use of closed network connection
2020-08-31T01:24:07.758670Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:07.758676Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:07.758702Z	error	sds	Remote side closed connection
2020-08-31T01:24:07.758722Z	error	sds	Remote side closed connection
2020-08-31T01:24:07.758790Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest778d4e1e-dcdf-4bf3-bb96-3fd7e6c39be6.sock" 

2020-08-31T01:24:07.758880Z	info	sds	Start SDS grpc server
2020-08-31T01:24:07.759010Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest778d4e1e-dcdf-4bf3-bb96-3fd7e6c39be6.sock: use of closed network connection
2020-08-31T01:24:07.759092Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4c3bd3a3-1d72-4cbb-9d11-0f37d9196026.sock" 

2020-08-31T01:24:07.759110Z	info	sds	Start SDS grpc server
2020-08-31T01:24:07.950436Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:07.950501Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:08.060078Z	info	sds	resource:default new connection
2020-08-31T01:24:08.060140Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:24:08.060200Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:08.060597Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:08.060620Z	error	sds	Remote side closed connection
2020-08-31T01:24:08.251935Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:08.254306Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:08.255892Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:08.361799Z	info	sds	resource:default new connection
2020-08-31T01:24:08.361875Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:24:08.361929Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:08.362243Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:08.362258Z	error	sds	Remote side closed connection
2020-08-31T01:24:08.362592Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4c3bd3a3-1d72-4cbb-9d11-0f37d9196026.sock: use of closed network connection
2020-08-31T01:24:08.362725Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc9a8a275-1884-4736-b01a-2a3d08144867.sock" 

2020-08-31T01:24:08.362751Z	info	sds	Start SDS grpc server
2020-08-31T01:24:08.663724Z	info	sds	resource:default new connection
2020-08-31T01:24:08.663808Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:24:08.663862Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:08.664140Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:08.664169Z	error	sds	Remote side closed connection
2020-08-31T01:24:08.664426Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc9a8a275-1884-4736-b01a-2a3d08144867.sock: use of closed network connection
2020-08-31T01:24:08.758691Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:08.759033Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:09.362802Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:09.527308Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:09.664587Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:24:09.830635Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:09.831470Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:10.133526Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:10.254437Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:10.256061Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:24:10.697053Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestff0e8382-3d64-4822-b3d6-a0ba1859549b.sock" 

2020-08-31T01:24:10.697134Z	info	sds	Start SDS grpc server
2020-08-31T01:24:10.741806Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:10.741836Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:10.758924Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:10.759074Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:11.044433Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:11.346524Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:11.362971Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:11.664913Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:11.697977Z	info	sds	resource:default new connection
2020-08-31T01:24:11.698051Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:24:11.699460Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:24:11.950707Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:11.950779Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:11.960224Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:24:11.960271Z	info	cache	GenerateSecret default
2020-08-31T01:24:11.960330Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:11.960776Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestff0e8382-3d64-4822-b3d6-a0ba1859549b.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.755s
2020-08-31T01:24:17.304138Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc26a2279-29dc-42fc-9aee-54057234c579.sock" 

2020-08-31T01:24:17.304271Z	info	sds	Start SDS grpc server
2020-08-31T01:24:17.305488Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:24:17.305547Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:24:17.305895Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:18.305481Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:18.305541Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:24:19.306227Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:24:19.306358Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:24:19.306416Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:24:19.306516Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:19.306781Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc26a2279-29dc-42fc-9aee-54057234c579.sock: use of closed network connection
2020-08-31T01:24:19.306955Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:19.306989Z	error	sds	Remote side closed connection
2020-08-31T01:24:19.307062Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1e200908-e579-4bb4-aeaa-2bb46aa1c074\".sock" 

2020-08-31T01:24:19.307101Z	info	sds	Start SDS grpc server
2020-08-31T01:24:19.608072Z	info	sds	resource:default new connection
2020-08-31T01:24:19.608126Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:24:19.608177Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:19.608508Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:19.608536Z	error	sds	Remote side closed connection
2020-08-31T01:24:19.609022Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:24:19.609062Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:24:19.609210Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:24:19.609475Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:19.609494Z	error	sds	Remote side closed connection
2020-08-31T01:24:19.609700Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1e200908-e579-4bb4-aeaa-2bb46aa1c074".sock: use of closed network connection
2020-08-31T01:24:19.609915Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"373bc8f1-8a95-4c68-a1ae-0ab6f066f095\".sock" 

2020-08-31T01:24:19.610012Z	info	sds	Start SDS grpc server
2020-08-31T01:24:19.610346Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:24:19.610382Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:24:19.610418Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:24:19.610642Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:19.610653Z	error	sds	Remote side closed connection
2020-08-31T01:24:19.610807Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"373bc8f1-8a95-4c68-a1ae-0ab6f066f095".sock: use of closed network connection
2020-08-31T01:24:19.610948Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a1f0b768-6f08-4e9a-96d9-5ae8697f296a\".sock" 

2020-08-31T01:24:19.610961Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:19.911967Z	info	sds	resource:default new connection
2020-08-31T01:24:19.912044Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:24:19.912097Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:19.912417Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:19.912444Z	error	sds	Remote side closed connection
2020-08-31T01:24:19.912619Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a1f0b768-6f08-4e9a-96d9-5ae8697f296a".sock: use of closed network connection
2020-08-31T01:24:19.912874Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a5ddc46a-bfdb-4bb1-b3c4-2b7f975dbdd3\".sock" 

2020-08-31T01:24:19.912930Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"65974602-d0c1-4071-a901-42303fb44b15\".sock" 

2020-08-31T01:24:19.912964Z	info	sds	Start SDS grpc server
2020-08-31T01:24:19.912986Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:20.213913Z	info	sds	resource:default new connection
2020-08-31T01:24:20.213974Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:24:20.214034Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:20.214352Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:20.214377Z	error	sds	Remote side closed connection
2020-08-31T01:24:20.214906Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:24:20.214937Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:24:20.214970Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:24:20.215190Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:20.215210Z	error	sds	Remote side closed connection
2020-08-31T01:24:20.306969Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:20.516119Z	info	sds	resource:default new connection
2020-08-31T01:24:20.516183Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:24:20.516248Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:20.516581Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:20.516608Z	error	sds	Remote side closed connection
2020-08-31T01:24:20.517022Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a5ddc46a-bfdb-4bb1-b3c4-2b7f975dbdd3".sock: use of closed network connection
2020-08-31T01:24:20.517091Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"65974602-d0c1-4071-a901-42303fb44b15".sock: use of closed network connection
2020-08-31T01:24:20.517405Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"74cee31c-905d-462b-aa09-932ae88a4823\".sock" 

2020-08-31T01:24:20.517443Z	info	sds	Start SDS grpc server
2020-08-31T01:24:20.609817Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:20.610966Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:24:20.820271Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"74cee31c-905d-462b-aa09-932ae88a4823".sock: use of closed network connection
2020-08-31T01:24:20.820526Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"c1b958dc-1dfc-4c55-95e6-b39b03571d2f\".sock" 

2020-08-31T01:24:20.820573Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:20.912802Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:24:21.122105Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"c1b958dc-1dfc-4c55-95e6-b39b03571d2f".sock: use of closed network connection
2020-08-31T01:24:21.122303Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest21db881b-e3e6-41ba-b5dc-6dec02801412.sock" 

2020-08-31T01:24:21.122361Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b93f8c2d-82f5-4c9d-a877-8bcf7ad6239b\".sock" 

2020-08-31T01:24:21.122390Z	info	sds	Start SDS grpc server
2020-08-31T01:24:21.122410Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:24:21.517232Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:21.517289Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:24:21.726184Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest21db881b-e3e6-41ba-b5dc-6dec02801412.sock: use of closed network connection
2020-08-31T01:24:21.726235Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b93f8c2d-82f5-4c9d-a877-8bcf7ad6239b".sock: use of closed network connection
2020-08-31T01:24:21.726462Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest9ff4e2b1-8d75-41b3-b02f-06f14d344ba3.sock" 

2020-08-31T01:24:21.726488Z	info	sds	Start SDS grpc server
2020-08-31T01:24:21.820473Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:22.027632Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:24:22.027735Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:22.027986Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest9ff4e2b1-8d75-41b3-b02f-06f14d344ba3.sock: use of closed network connection
2020-08-31T01:24:22.028239Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestafe7d259-036e-47d1-a44c-3658ad235325.sock" 

2020-08-31T01:24:22.028322Z	info	sds	Start SDS grpc server
2020-08-31T01:24:22.031439Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:24:22.031503Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:24:22.031559Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:22.031723Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:24:22.031770Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:24:22.031807Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:24:22.122371Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:22.307214Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:22.610123Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:22.611122Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:22.726424Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:22.726414Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:22.913063Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:23.028228Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:23.031862Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:23.031917Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:24:23.517540Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:23.517567Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:23.820751Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:24.032822Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:24.033219Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestafe7d259-036e-47d1-a44c-3658ad235325.sock: use of closed network connection
2020-08-31T01:24:24.033222Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:24.033255Z	error	sds	Remote side closed connection
2020-08-31T01:24:24.033318Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:24.033336Z	error	sds	Remote side closed connection
2020-08-31T01:24:24.033500Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestaea9e860-b007-4cd3-ba03-e8ac2dc3517e.sock" 

2020-08-31T01:24:24.033556Z	info	sds	Start SDS grpc server
2020-08-31T01:24:24.034558Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:24:24.034612Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:24:24.034671Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:24.035312Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:24:24.034669747 +0000 UTC m=+6.807138571 and is waiting for next SDS request
2020-08-31T01:24:24.035336Z	info	sds	Dynamic push for secret default
2020-08-31T01:24:24.035338Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestaea9e860-b007-4cd3-ba03-e8ac2dc3517e.sock: use of closed network connection
2020-08-31T01:24:24.035411Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:24.035436Z	error	sds	Remote side closed connection
2020-08-31T01:24:24.035472Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:24.035496Z	error	sds	Remote side closed connection
2020-08-31T01:24:24.035617Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest673ba846-991f-439a-a053-fbe313100f0e.sock" 

2020-08-31T01:24:24.035636Z	info	sds	Start SDS grpc server
2020-08-31T01:24:24.036451Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:24:24.036512Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:24:24.036544Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:24.037134Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:24:24.122616Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:24.537348Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:24.537412Z	info	sds	Dynamic push for secret default
2020-08-31T01:24:24.538073Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest673ba846-991f-439a-a053-fbe313100f0e.sock: use of closed network connection
2020-08-31T01:24:24.538178Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:24.538216Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:24.538251Z	error	sds	Remote side closed connection
2020-08-31T01:24:24.538203Z	error	sds	Remote side closed connection
2020-08-31T01:24:24.538361Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest277a3bac-6d80-4397-8b3c-3a69952a3197.sock" 

2020-08-31T01:24:24.538369Z	info	sds	Start SDS grpc server
2020-08-31T01:24:24.538690Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest277a3bac-6d80-4397-8b3c-3a69952a3197.sock: use of closed network connection
2020-08-31T01:24:24.538782Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest60211ca1-fe7f-4daa-b812-52cfebf0fb06.sock" 

2020-08-31T01:24:24.538815Z	info	sds	Start SDS grpc server
2020-08-31T01:24:24.726958Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:24.726958Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:24.840562Z	info	sds	resource:default new connection
2020-08-31T01:24:24.840736Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:24:24.840906Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:24.841358Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:24.841378Z	error	sds	Remote side closed connection
2020-08-31T01:24:25.028537Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:25.033440Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:25.035550Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:25.142727Z	info	sds	resource:default new connection
2020-08-31T01:24:25.142790Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:24:25.142841Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:25.143268Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:25.143296Z	error	sds	Remote side closed connection
2020-08-31T01:24:25.143602Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest60211ca1-fe7f-4daa-b812-52cfebf0fb06.sock: use of closed network connection
2020-08-31T01:24:25.143828Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0492bc35-f7ad-4f87-b496-638e4e77d650.sock" 

2020-08-31T01:24:25.143842Z	info	sds	Start SDS grpc server
2020-08-31T01:24:25.445004Z	info	sds	resource:default new connection
2020-08-31T01:24:25.445109Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:24:25.445178Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:25.445516Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:25.445551Z	error	sds	Remote side closed connection
2020-08-31T01:24:25.445814Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0492bc35-f7ad-4f87-b496-638e4e77d650.sock: use of closed network connection
2020-08-31T01:24:25.538304Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:25.538736Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:26.143843Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:26.307468Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:26.446023Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:24:26.610384Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:26.611328Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:26.913314Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:27.033548Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:27.035717Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:24:27.479285Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb6f35199-c53b-4edd-ab2b-2dd6cdea9b38.sock" 

2020-08-31T01:24:27.479333Z	info	sds	Start SDS grpc server
2020-08-31T01:24:27.517813Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:27.517863Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:27.538549Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:27.538931Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:27.821056Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:28.122879Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:28.144104Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:28.446279Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:28.480324Z	info	sds	resource:default new connection
2020-08-31T01:24:28.480423Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:24:28.484473Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:24:28.557227Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:24:28.557270Z	info	cache	GenerateSecret default
2020-08-31T01:24:28.559244Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:28.560500Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb6f35199-c53b-4edd-ab2b-2dd6cdea9b38.sock: use of closed network connection
PASS
2020-08-31T01:24:28.560723Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.577s
2020-08-31T01:24:33.952985Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest931087a5-0c58-480a-920c-d83009396354.sock" 

2020-08-31T01:24:33.953086Z	info	sds	Start SDS grpc server
2020-08-31T01:24:33.954359Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:24:33.954422Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:24:33.954921Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:34.954266Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:34.954326Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:24:35.955413Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:24:35.955512Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:24:35.955548Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:24:35.955655Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:35.955868Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest931087a5-0c58-480a-920c-d83009396354.sock: use of closed network connection
2020-08-31T01:24:35.956022Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:35.956140Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"2c91507b-b6a7-41e4-9ee7-5a109e965445\".sock" 

2020-08-31T01:24:35.956146Z	error	sds	Remote side closed connection
2020-08-31T01:24:35.956233Z	info	sds	Start SDS grpc server
2020-08-31T01:24:36.257602Z	info	sds	resource:default new connection
2020-08-31T01:24:36.257661Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:24:36.257717Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:36.258111Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:36.258137Z	error	sds	Remote side closed connection
2020-08-31T01:24:36.258842Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:24:36.258877Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:24:36.259045Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:24:36.259383Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:36.259403Z	error	sds	Remote side closed connection
2020-08-31T01:24:36.259628Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"2c91507b-b6a7-41e4-9ee7-5a109e965445".sock: use of closed network connection
2020-08-31T01:24:36.259861Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"32dbd09b-7666-4f6e-9d3f-9a6764288199\".sock" 

2020-08-31T01:24:36.260036Z	info	sds	Start SDS grpc server
2020-08-31T01:24:36.260527Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:24:36.260599Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:24:36.260702Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:24:36.261058Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:36.261079Z	error	sds	Remote side closed connection
2020-08-31T01:24:36.261257Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"32dbd09b-7666-4f6e-9d3f-9a6764288199".sock: use of closed network connection
2020-08-31T01:24:36.261523Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"16e98080-cd9f-4685-b1a7-e4122936c1cb\".sock" 

2020-08-31T01:24:36.261562Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:36.562587Z	info	sds	resource:default new connection
2020-08-31T01:24:36.562639Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:24:36.562687Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:36.562970Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:36.562997Z	error	sds	Remote side closed connection
2020-08-31T01:24:36.563227Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"16e98080-cd9f-4685-b1a7-e4122936c1cb".sock: use of closed network connection
2020-08-31T01:24:36.563441Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"48d4857f-b15c-41a8-a9ff-1e511fbb8412\".sock" 

2020-08-31T01:24:36.563503Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"4c216082-6068-434a-92cf-f9b1c7de8549\".sock" 

2020-08-31T01:24:36.563511Z	info	sds	Start SDS grpc server
2020-08-31T01:24:36.563537Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:36.865041Z	info	sds	resource:default new connection
2020-08-31T01:24:36.865123Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:24:36.865203Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:36.865653Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:36.865675Z	error	sds	Remote side closed connection
2020-08-31T01:24:36.866336Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:24:36.866374Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:24:36.866414Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:24:36.866989Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:36.867010Z	error	sds	Remote side closed connection
2020-08-31T01:24:36.956160Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:37.168260Z	info	sds	resource:default new connection
2020-08-31T01:24:37.168321Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:24:37.168375Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:37.168601Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:37.168626Z	error	sds	Remote side closed connection
2020-08-31T01:24:37.168868Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"48d4857f-b15c-41a8-a9ff-1e511fbb8412".sock: use of closed network connection
2020-08-31T01:24:37.168998Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"4c216082-6068-434a-92cf-f9b1c7de8549".sock: use of closed network connection
2020-08-31T01:24:37.169235Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"101d9a42-c04c-47df-9b9b-efeb8dd5e494\".sock" 

2020-08-31T01:24:37.169269Z	info	sds	Start SDS grpc server
2020-08-31T01:24:37.259818Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:37.261541Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:24:37.472261Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"101d9a42-c04c-47df-9b9b-efeb8dd5e494".sock: use of closed network connection
2020-08-31T01:24:37.472500Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"2e79cd8d-36d0-443f-a615-4bf15fcd30bc\".sock" 

2020-08-31T01:24:37.472536Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:37.563507Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:24:37.774192Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"2e79cd8d-36d0-443f-a615-4bf15fcd30bc".sock: use of closed network connection
2020-08-31T01:24:37.774443Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest17069502-238e-4229-be3a-63aeda42dd34.sock" 

2020-08-31T01:24:37.774509Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"599bab83-011f-48e8-bb93-3b30976e0963\".sock" 

2020-08-31T01:24:37.774540Z	info	sds	Start SDS grpc server
2020-08-31T01:24:37.774564Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:24:38.169157Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:38.169178Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:24:38.382904Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest17069502-238e-4229-be3a-63aeda42dd34.sock: use of closed network connection
2020-08-31T01:24:38.382987Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"599bab83-011f-48e8-bb93-3b30976e0963".sock: use of closed network connection
2020-08-31T01:24:38.383220Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest26972927-0095-466c-b8e9-773ce6c2ece3.sock" 

2020-08-31T01:24:38.383252Z	info	sds	Start SDS grpc server
2020-08-31T01:24:38.472624Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:38.684489Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:24:38.684591Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:38.684951Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest26972927-0095-466c-b8e9-773ce6c2ece3.sock: use of closed network connection
2020-08-31T01:24:38.685221Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest33a61e46-04fc-4838-827b-80fd4f9cddda.sock" 

2020-08-31T01:24:38.685256Z	info	sds	Start SDS grpc server
2020-08-31T01:24:38.686301Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:24:38.686352Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:24:38.686395Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:38.686538Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:24:38.686583Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:24:38.686614Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:24:38.774413Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:38.956483Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:39.260152Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:39.261614Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:39.383262Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:39.383327Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:39.563817Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:39.685239Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:39.686838Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:39.686884Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:24:40.169459Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:40.169529Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:40.472803Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:40.687813Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:40.688423Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest33a61e46-04fc-4838-827b-80fd4f9cddda.sock: use of closed network connection
2020-08-31T01:24:40.688468Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:40.688494Z	error	sds	Remote side closed connection
2020-08-31T01:24:40.688557Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:40.688580Z	error	sds	Remote side closed connection
2020-08-31T01:24:40.688911Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotesta671445d-9ed6-4f52-bf07-e1b31ce9f641.sock" 

2020-08-31T01:24:40.689109Z	info	sds	Start SDS grpc server
2020-08-31T01:24:40.690240Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:24:40.690408Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:24:40.690521Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:40.691201Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:24:40.690519331 +0000 UTC m=+6.815834993 and is waiting for next SDS request
2020-08-31T01:24:40.691227Z	info	sds	Dynamic push for secret default
2020-08-31T01:24:40.691259Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotesta671445d-9ed6-4f52-bf07-e1b31ce9f641.sock: use of closed network connection
2020-08-31T01:24:40.691354Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:40.691390Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:40.691414Z	error	sds	Remote side closed connection
2020-08-31T01:24:40.691375Z	error	sds	Remote side closed connection
2020-08-31T01:24:40.691489Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4bd3d8ec-ba78-4939-87c4-e277e443ab8c.sock" 

2020-08-31T01:24:40.691521Z	info	sds	Start SDS grpc server
2020-08-31T01:24:40.692488Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:24:40.692527Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:24:40.692563Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:40.693236Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:24:40.774571Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:41.193234Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:41.193288Z	info	sds	Dynamic push for secret default
2020-08-31T01:24:41.193920Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4bd3d8ec-ba78-4939-87c4-e277e443ab8c.sock: use of closed network connection
2020-08-31T01:24:41.194020Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:41.194056Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:41.194054Z	error	sds	Remote side closed connection
2020-08-31T01:24:41.194078Z	error	sds	Remote side closed connection
2020-08-31T01:24:41.194158Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest58e3f46d-a52c-49cf-b54d-2b3209ea7f3e.sock" 

2020-08-31T01:24:41.194178Z	info	sds	Start SDS grpc server
2020-08-31T01:24:41.194386Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest58e3f46d-a52c-49cf-b54d-2b3209ea7f3e.sock: use of closed network connection
2020-08-31T01:24:41.194473Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc9d7d8ed-d173-4064-88b0-9f3fb21554d9.sock" 

2020-08-31T01:24:41.194485Z	info	sds	Start SDS grpc server
2020-08-31T01:24:41.383567Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:41.383551Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:41.495385Z	info	sds	resource:default new connection
2020-08-31T01:24:41.495453Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:24:41.495508Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:41.495776Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:41.495805Z	error	sds	Remote side closed connection
2020-08-31T01:24:41.685482Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:41.688596Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:41.691420Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:41.796619Z	info	sds	resource:default new connection
2020-08-31T01:24:41.796702Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:24:41.796754Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:41.797072Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:41.797100Z	error	sds	Remote side closed connection
2020-08-31T01:24:41.797307Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc9d7d8ed-d173-4064-88b0-9f3fb21554d9.sock: use of closed network connection
2020-08-31T01:24:41.797442Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest07bfb4fe-2361-443f-97a3-e57c66955f75.sock" 

2020-08-31T01:24:41.797475Z	info	sds	Start SDS grpc server
2020-08-31T01:24:42.098410Z	info	sds	resource:default new connection
2020-08-31T01:24:42.098475Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:24:42.098541Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:42.098859Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:42.098887Z	error	sds	Remote side closed connection
2020-08-31T01:24:42.099202Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest07bfb4fe-2361-443f-97a3-e57c66955f75.sock: use of closed network connection
2020-08-31T01:24:42.193985Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:42.194501Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:42.797525Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:42.956755Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:43.099425Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:24:43.260428Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:43.261826Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:43.564102Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:43.688855Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:43.691616Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:24:44.135295Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest8cedaa86-558a-417f-a9d6-3022dd383678.sock" 

2020-08-31T01:24:44.135348Z	info	sds	Start SDS grpc server
2020-08-31T01:24:44.169743Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:44.169744Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:44.194223Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:44.194645Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:44.473046Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:44.774807Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:44.797662Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:45.099684Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:45.136116Z	info	sds	resource:default new connection
2020-08-31T01:24:45.136186Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:24:45.137607Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:24:45.188034Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:24:45.188080Z	info	cache	GenerateSecret default
2020-08-31T01:24:45.188141Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:45.188513Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest8cedaa86-558a-417f-a9d6-3022dd383678.sock: use of closed network connection
PASS
2020-08-31T01:24:45.188617Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:45.188644Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.554s
2020-08-31T01:24:50.396406Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6e2ca498-3633-4fec-9e48-73fb05d69a8f.sock" 

2020-08-31T01:24:50.396508Z	info	sds	Start SDS grpc server
2020-08-31T01:24:50.397855Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:24:50.397925Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:24:50.398318Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:51.397852Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:51.397920Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:24:52.399157Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:24:52.399239Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:24:52.399265Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:24:52.399337Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:52.399552Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6e2ca498-3633-4fec-9e48-73fb05d69a8f.sock: use of closed network connection
2020-08-31T01:24:52.399663Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:52.399691Z	error	sds	Remote side closed connection
2020-08-31T01:24:52.399893Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6aa03d65-1971-4ac2-aad6-65af21ce24c4\".sock" 

2020-08-31T01:24:52.399932Z	info	sds	Start SDS grpc server
2020-08-31T01:24:52.700893Z	info	sds	resource:default new connection
2020-08-31T01:24:52.700998Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:24:52.701050Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:52.701327Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:52.701348Z	error	sds	Remote side closed connection
2020-08-31T01:24:52.701890Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:24:52.701929Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:24:52.702079Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:24:52.702278Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:52.702299Z	error	sds	Remote side closed connection
2020-08-31T01:24:52.702480Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6aa03d65-1971-4ac2-aad6-65af21ce24c4".sock: use of closed network connection
2020-08-31T01:24:52.702654Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"4bfd0b59-7612-482c-90b5-05dc594f199d\".sock" 

2020-08-31T01:24:52.702728Z	info	sds	Start SDS grpc server
2020-08-31T01:24:52.703237Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:24:52.703271Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:24:52.703305Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:24:52.703527Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:52.703549Z	error	sds	Remote side closed connection
2020-08-31T01:24:52.703722Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"4bfd0b59-7612-482c-90b5-05dc594f199d".sock: use of closed network connection
2020-08-31T01:24:52.703875Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"49b5b695-7a9b-42fe-a7bb-6548e296d463\".sock" 

2020-08-31T01:24:52.703904Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:53.005192Z	info	sds	resource:default new connection
2020-08-31T01:24:53.005299Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:24:53.005399Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:53.005841Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:53.005879Z	error	sds	Remote side closed connection
2020-08-31T01:24:53.006093Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"49b5b695-7a9b-42fe-a7bb-6548e296d463".sock: use of closed network connection
2020-08-31T01:24:53.006516Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c9653674-e66d-45ad-92ca-bfd999754e01\".sock" 

2020-08-31T01:24:53.006545Z	info	sds	Start SDS grpc server
2020-08-31T01:24:53.006604Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ce60c60e-f17f-476e-b0ca-e015f33052a9\".sock" 

2020-08-31T01:24:53.006648Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:53.307747Z	info	sds	resource:default new connection
2020-08-31T01:24:53.307810Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:24:53.307861Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:53.308209Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:53.308244Z	error	sds	Remote side closed connection
2020-08-31T01:24:53.308774Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:24:53.308829Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:24:53.308866Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:24:53.309058Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:53.309079Z	error	sds	Remote side closed connection
2020-08-31T01:24:53.399777Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:53.609983Z	info	sds	resource:default new connection
2020-08-31T01:24:53.610056Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:24:53.610107Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:53.610461Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:53.610486Z	error	sds	Remote side closed connection
2020-08-31T01:24:53.610653Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c9653674-e66d-45ad-92ca-bfd999754e01".sock: use of closed network connection
2020-08-31T01:24:53.610698Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ce60c60e-f17f-476e-b0ca-e015f33052a9".sock: use of closed network connection
2020-08-31T01:24:53.610894Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"c84ba482-8894-44f4-bf72-7657560f2d8e\".sock" 

2020-08-31T01:24:53.610920Z	info	sds	Start SDS grpc server
2020-08-31T01:24:53.702649Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:53.703832Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:24:53.913422Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"c84ba482-8894-44f4-bf72-7657560f2d8e".sock: use of closed network connection
2020-08-31T01:24:53.913603Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"193d515e-0781-4de4-a242-5a6fd12b6693\".sock" 

2020-08-31T01:24:53.913624Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:54.006322Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:24:54.215783Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"193d515e-0781-4de4-a242-5a6fd12b6693".sock: use of closed network connection
2020-08-31T01:24:54.215990Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest991c9ac4-0d4e-4c61-b36f-06ac0ee3dd7b.sock" 

2020-08-31T01:24:54.216024Z	info	sds	Start SDS grpc server
2020-08-31T01:24:54.216048Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:24:54.216042Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"045d7e9b-7a8f-434f-a283-38ba11bd46a8\".sock" 

Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:24:54.610906Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:54.610885Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:24:54.819826Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest991c9ac4-0d4e-4c61-b36f-06ac0ee3dd7b.sock: use of closed network connection
2020-08-31T01:24:54.819891Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"045d7e9b-7a8f-434f-a283-38ba11bd46a8".sock: use of closed network connection
2020-08-31T01:24:54.820049Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestc84a6c5d-b613-4406-8c9e-e556a3482533.sock" 

2020-08-31T01:24:54.820069Z	info	sds	Start SDS grpc server
2020-08-31T01:24:54.913651Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:55.121205Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:24:55.121320Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:55.121588Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestc84a6c5d-b613-4406-8c9e-e556a3482533.sock: use of closed network connection
2020-08-31T01:24:55.121876Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdeee6995-3cf0-40af-98a7-9c04ee61dc5d.sock" 

2020-08-31T01:24:55.121950Z	info	sds	Start SDS grpc server
2020-08-31T01:24:55.123156Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:24:55.123262Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:24:55.123451Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:24:55.124301Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:24:55.124360Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:24:55.124417Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:55.216034Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:55.400060Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:55.702904Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:55.704012Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:55.820038Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:55.820102Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:56.006632Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:56.121806Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:56.124329Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:56.124414Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:24:56.611146Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:56.611161Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:56.913967Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:57.125246Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:57.125616Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdeee6995-3cf0-40af-98a7-9c04ee61dc5d.sock: use of closed network connection
2020-08-31T01:24:57.125647Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:57.125687Z	error	sds	Remote side closed connection
2020-08-31T01:24:57.125746Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:57.125772Z	error	sds	Remote side closed connection
2020-08-31T01:24:57.125882Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5a5c5e78-9058-40ff-8827-abd14d01c601.sock" 

2020-08-31T01:24:57.125953Z	info	sds	Start SDS grpc server
2020-08-31T01:24:57.126760Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:24:57.126803Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:24:57.126848Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:57.127379Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:24:57.126847768 +0000 UTC m=+6.806796224 and is waiting for next SDS request
2020-08-31T01:24:57.127407Z	info	sds	Dynamic push for secret default
2020-08-31T01:24:57.127447Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5a5c5e78-9058-40ff-8827-abd14d01c601.sock: use of closed network connection
2020-08-31T01:24:57.127505Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:57.127526Z	error	sds	Remote side closed connection
2020-08-31T01:24:57.127576Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:57.127602Z	error	sds	Remote side closed connection
2020-08-31T01:24:57.127648Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste8b25105-bd4d-4aa3-a84f-867c7a50818c.sock" 

2020-08-31T01:24:57.127696Z	info	sds	Start SDS grpc server
2020-08-31T01:24:57.128484Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:24:57.128540Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:24:57.128587Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:57.129197Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:24:57.216326Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:57.629384Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:57.629437Z	info	sds	Dynamic push for secret default
2020-08-31T01:24:57.630005Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste8b25105-bd4d-4aa3-a84f-867c7a50818c.sock: use of closed network connection
2020-08-31T01:24:57.630084Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:57.630109Z	error	sds	Remote side closed connection
2020-08-31T01:24:57.630138Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:57.630170Z	error	sds	Remote side closed connection
2020-08-31T01:24:57.630245Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd7ee24cf-a6b5-414c-9c2c-5076cad036d5.sock" 

2020-08-31T01:24:57.630301Z	info	sds	Start SDS grpc server
2020-08-31T01:24:57.630463Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd7ee24cf-a6b5-414c-9c2c-5076cad036d5.sock: use of closed network connection
2020-08-31T01:24:57.630566Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest9f5d2b20-0718-4b61-996d-7d0b53bc8857.sock" 

2020-08-31T01:24:57.630583Z	info	sds	Start SDS grpc server
2020-08-31T01:24:57.820258Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:24:57.820306Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:57.931522Z	info	sds	resource:default new connection
2020-08-31T01:24:57.931593Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:24:57.931660Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:57.931964Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:57.931994Z	error	sds	Remote side closed connection
2020-08-31T01:24:58.122082Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:58.125800Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:58.127604Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:58.233035Z	info	sds	resource:default new connection
2020-08-31T01:24:58.233092Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:24:58.233141Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:58.233488Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:58.233519Z	error	sds	Remote side closed connection
2020-08-31T01:24:58.233723Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest9f5d2b20-0718-4b61-996d-7d0b53bc8857.sock: use of closed network connection
2020-08-31T01:24:58.233844Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest2d681ca3-19d9-4390-a524-9ec773b420b3.sock" 

2020-08-31T01:24:58.233860Z	info	sds	Start SDS grpc server
2020-08-31T01:24:58.534849Z	info	sds	resource:default new connection
2020-08-31T01:24:58.534914Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:24:58.534968Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:24:58.535208Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:24:58.535233Z	error	sds	Remote side closed connection
2020-08-31T01:24:58.535619Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest2d681ca3-19d9-4390-a524-9ec773b420b3.sock: use of closed network connection
2020-08-31T01:24:58.630212Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:58.630545Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:59.233957Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:59.400337Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:59.535774Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:24:59.703140Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:24:59.704181Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:00.006933Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:00.126012Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:00.127809Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:25:00.564994Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf1a99cd6-e50e-416c-a3d5-025e5b66ee1c.sock" 

2020-08-31T01:25:00.565040Z	info	sds	Start SDS grpc server
2020-08-31T01:25:00.611403Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:00.611449Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:00.630504Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:00.630647Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:00.914218Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:01.216627Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:01.234158Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:01.536041Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:01.566019Z	info	sds	resource:default new connection
2020-08-31T01:25:01.566090Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:25:01.571781Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:25:01.652471Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:25:01.652511Z	info	cache	GenerateSecret default
2020-08-31T01:25:01.652570Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:01.653028Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf1a99cd6-e50e-416c-a3d5-025e5b66ee1c.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.579s
2020-08-31T01:25:06.872159Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest7653c01d-0bec-40f5-a65b-a906dfab8b26.sock" 

2020-08-31T01:25:06.872195Z	info	sds	Start SDS grpc server
2020-08-31T01:25:06.873620Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:25:06.873687Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:25:06.874138Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:07.873551Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:07.873612Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:25:08.874291Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:25:08.874369Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:25:08.874394Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:25:08.874478Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:08.874724Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest7653c01d-0bec-40f5-a65b-a906dfab8b26.sock: use of closed network connection
2020-08-31T01:25:08.874887Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:08.874914Z	error	sds	Remote side closed connection
2020-08-31T01:25:08.875042Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6c86d872-65e2-4e4e-8abc-e1c417e493cd\".sock" 

2020-08-31T01:25:08.875089Z	info	sds	Start SDS grpc server
2020-08-31T01:25:09.176009Z	info	sds	resource:default new connection
2020-08-31T01:25:09.176072Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:25:09.176151Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:09.176496Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:09.176524Z	error	sds	Remote side closed connection
2020-08-31T01:25:09.177312Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:25:09.177369Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:25:09.177526Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:25:09.177829Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:09.177856Z	error	sds	Remote side closed connection
2020-08-31T01:25:09.178046Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6c86d872-65e2-4e4e-8abc-e1c417e493cd".sock: use of closed network connection
2020-08-31T01:25:09.178273Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"6c920d32-5ef9-424d-bed7-0f4af0a0824f\".sock" 

2020-08-31T01:25:09.178346Z	info	sds	Start SDS grpc server
2020-08-31T01:25:09.178853Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:25:09.178887Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:25:09.178926Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:25:09.179147Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:09.179175Z	error	sds	Remote side closed connection
2020-08-31T01:25:09.179380Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"6c920d32-5ef9-424d-bed7-0f4af0a0824f".sock: use of closed network connection
2020-08-31T01:25:09.179530Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"ad8438ac-74e7-4787-bd90-88aafbd73124\".sock" 

2020-08-31T01:25:09.179559Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:09.480496Z	info	sds	resource:default new connection
2020-08-31T01:25:09.480553Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:25:09.480623Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:09.480967Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:09.481000Z	error	sds	Remote side closed connection
2020-08-31T01:25:09.481263Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"ad8438ac-74e7-4787-bd90-88aafbd73124".sock: use of closed network connection
2020-08-31T01:25:09.481436Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"64d92989-77eb-45f6-842f-24016a5f2877\".sock" 

2020-08-31T01:25:09.481459Z	info	sds	Start SDS grpc server
2020-08-31T01:25:09.481559Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"bfb78009-acf1-4572-ac74-2ec2998ddf38\".sock" 

2020-08-31T01:25:09.481597Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:09.782634Z	info	sds	resource:default new connection
2020-08-31T01:25:09.782695Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:25:09.782751Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:09.783026Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:09.783058Z	error	sds	Remote side closed connection
2020-08-31T01:25:09.783784Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:25:09.783845Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:25:09.783892Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:25:09.784111Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:09.784134Z	error	sds	Remote side closed connection
2020-08-31T01:25:09.874969Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:10.085297Z	info	sds	resource:default new connection
2020-08-31T01:25:10.085368Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:25:10.085431Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:10.085703Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:10.085727Z	error	sds	Remote side closed connection
2020-08-31T01:25:10.086053Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"64d92989-77eb-45f6-842f-24016a5f2877".sock: use of closed network connection
2020-08-31T01:25:10.086109Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"bfb78009-acf1-4572-ac74-2ec2998ddf38".sock: use of closed network connection
2020-08-31T01:25:10.086497Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"15fa3d20-2c3a-45ea-8a16-ca5c80689e94\".sock" 

2020-08-31T01:25:10.086535Z	info	sds	Start SDS grpc server
2020-08-31T01:25:10.178219Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:10.179558Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:25:10.389622Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"15fa3d20-2c3a-45ea-8a16-ca5c80689e94".sock: use of closed network connection
2020-08-31T01:25:10.389810Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8f17f28b-21f0-4ae8-801b-b391d87d9eca\".sock" 

2020-08-31T01:25:10.389837Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:10.481456Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:25:10.691263Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8f17f28b-21f0-4ae8-801b-b391d87d9eca".sock: use of closed network connection
2020-08-31T01:25:10.691481Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotesteb3ab494-8aab-4229-bb2b-871be067cf13.sock" 

2020-08-31T01:25:10.691553Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"e7a4c36d-0047-4228-84ad-a2bc9b9a59a0\".sock" 

2020-08-31T01:25:10.691554Z	info	sds	Start SDS grpc server
2020-08-31T01:25:10.691576Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:25:11.086245Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:11.086288Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:25:11.295767Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotesteb3ab494-8aab-4229-bb2b-871be067cf13.sock: use of closed network connection
2020-08-31T01:25:11.295937Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"e7a4c36d-0047-4228-84ad-a2bc9b9a59a0".sock: use of closed network connection
2020-08-31T01:25:11.296174Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestbfcf4531-e2ca-43c4-ad67-9e6fbdc4a37b.sock" 

2020-08-31T01:25:11.296256Z	info	sds	Start SDS grpc server
2020-08-31T01:25:11.389870Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:11.597220Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:25:11.597304Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:11.597494Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestbfcf4531-e2ca-43c4-ad67-9e6fbdc4a37b.sock: use of closed network connection
2020-08-31T01:25:11.597707Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest21820c11-e255-48d4-8e21-4ef6560c71df.sock" 

2020-08-31T01:25:11.597727Z	info	sds	Start SDS grpc server
2020-08-31T01:25:11.598354Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:25:11.598394Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:25:11.598434Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:11.598525Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:25:11.598563Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:25:11.598595Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:25:11.691351Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:11.875308Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:12.178467Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:12.179753Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:12.296035Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:12.296094Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:12.481678Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:12.597728Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:12.598571Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:12.598611Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:25:13.086497Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:13.086528Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:13.390099Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:13.599366Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:13.599782Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest21820c11-e255-48d4-8e21-4ef6560c71df.sock: use of closed network connection
2020-08-31T01:25:13.599859Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:13.599873Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:13.599869Z	error	sds	Remote side closed connection
2020-08-31T01:25:13.599901Z	error	sds	Remote side closed connection
2020-08-31T01:25:13.600119Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestcb8ad836-cdff-4751-907a-285f2756f996.sock" 

2020-08-31T01:25:13.600281Z	info	sds	Start SDS grpc server
2020-08-31T01:25:13.602008Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:25:13.602093Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:25:13.602150Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:13.604021Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:25:13.602149367 +0000 UTC m=+6.803043897 and is waiting for next SDS request
2020-08-31T01:25:13.604056Z	info	sds	Dynamic push for secret default
2020-08-31T01:25:13.604066Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestcb8ad836-cdff-4751-907a-285f2756f996.sock: use of closed network connection
2020-08-31T01:25:13.604201Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:13.604210Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:13.604214Z	error	sds	Remote side closed connection
2020-08-31T01:25:13.604242Z	error	sds	Remote side closed connection
2020-08-31T01:25:13.604338Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestdcb01697-600c-4b2b-b32c-5cb1d237b58f.sock" 

2020-08-31T01:25:13.604424Z	info	sds	Start SDS grpc server
2020-08-31T01:25:13.605089Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:25:13.605128Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:25:13.605174Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:13.605761Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:25:13.691574Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:14.106018Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:14.106092Z	info	sds	Dynamic push for secret default
2020-08-31T01:25:14.106612Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestdcb01697-600c-4b2b-b32c-5cb1d237b58f.sock: use of closed network connection
2020-08-31T01:25:14.106754Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:14.106788Z	error	sds	Remote side closed connection
2020-08-31T01:25:14.106761Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:14.106846Z	error	sds	Remote side closed connection
2020-08-31T01:25:14.106893Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb317ee90-0bce-4b2f-a469-06ba3551ca60.sock" 

2020-08-31T01:25:14.106985Z	info	sds	Start SDS grpc server
2020-08-31T01:25:14.107130Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb317ee90-0bce-4b2f-a469-06ba3551ca60.sock: use of closed network connection
2020-08-31T01:25:14.107204Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest55c97cfd-df5a-4933-949f-f505cfbe3bf9.sock" 

2020-08-31T01:25:14.107209Z	info	sds	Start SDS grpc server
2020-08-31T01:25:14.296314Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:14.296353Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:14.408124Z	info	sds	resource:default new connection
2020-08-31T01:25:14.408189Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:25:14.408242Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:14.408513Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:14.408541Z	error	sds	Remote side closed connection
2020-08-31T01:25:14.598022Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:14.599874Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:14.604245Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:14.709812Z	info	sds	resource:default new connection
2020-08-31T01:25:14.709883Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:25:14.709937Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:14.710303Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:14.710338Z	error	sds	Remote side closed connection
2020-08-31T01:25:14.710585Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest55c97cfd-df5a-4933-949f-f505cfbe3bf9.sock: use of closed network connection
2020-08-31T01:25:14.710719Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestacbe61b8-e350-48c4-9289-1d6eb755242e.sock" 

2020-08-31T01:25:14.710758Z	info	sds	Start SDS grpc server
2020-08-31T01:25:15.011712Z	info	sds	resource:default new connection
2020-08-31T01:25:15.011786Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:25:15.011851Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:15.012217Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:15.012258Z	error	sds	Remote side closed connection
2020-08-31T01:25:15.012494Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestacbe61b8-e350-48c4-9289-1d6eb755242e.sock: use of closed network connection
2020-08-31T01:25:15.106803Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:15.107198Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:15.710836Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:15.875556Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:16.012736Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:25:16.178683Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:16.180003Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:16.481912Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:16.600079Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:16.604436Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:25:17.041843Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest852b7e8b-ad02-4022-b9b1-59ad2be09c98.sock" 

2020-08-31T01:25:17.041890Z	info	sds	Start SDS grpc server
2020-08-31T01:25:17.086595Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:17.086679Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:17.107060Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:17.107356Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:17.390342Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:17.691820Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:17.747987Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:18.013027Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:18.043251Z	info	sds	resource:default new connection
2020-08-31T01:25:18.043318Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:25:18.044618Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:25:18.142391Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:25:18.142439Z	info	cache	GenerateSecret default
2020-08-31T01:25:18.142517Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:18.142908Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest852b7e8b-ad02-4022-b9b1-59ad2be09c98.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.587s
2020-08-31T01:25:23.369201Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest6e8e14a6-acaa-4155-99e0-7c7244ab2ea8.sock" 

2020-08-31T01:25:23.369297Z	info	sds	Start SDS grpc server
2020-08-31T01:25:23.370701Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:25:23.370767Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:25:23.371115Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:24.370542Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:24.370613Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:25:25.371242Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:25:25.371326Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:25:25.371353Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:25:25.371419Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:25.371647Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest6e8e14a6-acaa-4155-99e0-7c7244ab2ea8.sock: use of closed network connection
2020-08-31T01:25:25.371762Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:25.371788Z	error	sds	Remote side closed connection
2020-08-31T01:25:25.371920Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"771ead22-8c4f-4ad1-a527-c78c3186901d\".sock" 

2020-08-31T01:25:25.371950Z	info	sds	Start SDS grpc server
2020-08-31T01:25:25.673083Z	info	sds	resource:default new connection
2020-08-31T01:25:25.673138Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:25:25.673192Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:25.673508Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:25.673534Z	error	sds	Remote side closed connection
2020-08-31T01:25:25.674073Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:25:25.674108Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:25:25.674291Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:25:25.674576Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:25.674597Z	error	sds	Remote side closed connection
2020-08-31T01:25:25.674825Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"771ead22-8c4f-4ad1-a527-c78c3186901d".sock: use of closed network connection
2020-08-31T01:25:25.674991Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"eb75b280-4781-45f4-86d0-8516ebff44f6\".sock" 

2020-08-31T01:25:25.675086Z	info	sds	Start SDS grpc server
2020-08-31T01:25:25.675439Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:25:25.675477Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:25:25.675511Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:25:25.675695Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:25.675703Z	error	sds	Remote side closed connection
2020-08-31T01:25:25.675947Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"eb75b280-4781-45f4-86d0-8516ebff44f6".sock: use of closed network connection
2020-08-31T01:25:25.676171Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"133d8253-931d-4e1c-848d-78cfa5bae52d\".sock" 

2020-08-31T01:25:25.676259Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:25.977132Z	info	sds	resource:default new connection
2020-08-31T01:25:25.977200Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:25:25.977252Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:25.977559Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:25.977586Z	error	sds	Remote side closed connection
2020-08-31T01:25:25.977723Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"133d8253-931d-4e1c-848d-78cfa5bae52d".sock: use of closed network connection
2020-08-31T01:25:25.977962Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"fb71a3f7-5970-479e-a030-68261a9325ba\".sock" 

2020-08-31T01:25:25.978020Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"13c50aa8-fa32-46df-afe2-128927379b72\".sock" 

2020-08-31T01:25:25.978032Z	info	sds	Start SDS grpc server
2020-08-31T01:25:25.978051Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:26.279469Z	info	sds	resource:default new connection
2020-08-31T01:25:26.279532Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:25:26.279586Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:26.279887Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:26.279951Z	error	sds	Remote side closed connection
2020-08-31T01:25:26.280453Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:25:26.280489Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:25:26.280526Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:25:26.280826Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:26.280855Z	error	sds	Remote side closed connection
2020-08-31T01:25:26.371920Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:26.581844Z	info	sds	resource:default new connection
2020-08-31T01:25:26.581901Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:25:26.581965Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:26.582343Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:26.582411Z	error	sds	Remote side closed connection
2020-08-31T01:25:26.582611Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"fb71a3f7-5970-479e-a030-68261a9325ba".sock: use of closed network connection
2020-08-31T01:25:26.582658Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"13c50aa8-fa32-46df-afe2-128927379b72".sock: use of closed network connection
2020-08-31T01:25:26.582842Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"9e9f1d17-10e0-4933-b925-5625c305bc01\".sock" 

2020-08-31T01:25:26.582864Z	info	sds	Start SDS grpc server
2020-08-31T01:25:26.675006Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:26.676136Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:25:26.885540Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"9e9f1d17-10e0-4933-b925-5625c305bc01".sock: use of closed network connection
2020-08-31T01:25:26.885726Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"48a6d684-68e2-4504-b792-7003a76c6543\".sock" 

2020-08-31T01:25:26.885747Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:26.977930Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:25:27.187167Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"48a6d684-68e2-4504-b792-7003a76c6543".sock: use of closed network connection
2020-08-31T01:25:27.187373Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_goteste47ef8dd-c0ca-44e8-a263-7ceb3c9a0da9.sock" 

2020-08-31T01:25:27.187434Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"fcb286f8-f17c-4872-a9bb-768614ce9c7c\".sock" 

2020-08-31T01:25:27.187467Z	info	sds	Start SDS grpc server
2020-08-31T01:25:27.187481Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:25:27.582842Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:27.582893Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:25:27.791247Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_goteste47ef8dd-c0ca-44e8-a263-7ceb3c9a0da9.sock: use of closed network connection
2020-08-31T01:25:27.791304Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"fcb286f8-f17c-4872-a9bb-768614ce9c7c".sock: use of closed network connection
2020-08-31T01:25:27.791520Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestc061c9b4-1056-42a6-9ea8-81d200b5ccda.sock" 

2020-08-31T01:25:27.791561Z	info	sds	Start SDS grpc server
2020-08-31T01:25:27.885748Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:28.092873Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:25:28.093017Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:28.093287Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestc061c9b4-1056-42a6-9ea8-81d200b5ccda.sock: use of closed network connection
2020-08-31T01:25:28.093546Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb13206c0-0916-479e-b67f-8541c453ad47.sock" 

2020-08-31T01:25:28.093625Z	info	sds	Start SDS grpc server
2020-08-31T01:25:28.095380Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:25:28.095471Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:25:28.095541Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:25:28.096441Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:25:28.096817Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:25:28.096888Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:28.187268Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:28.372179Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:28.675250Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:28.676331Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:28.791480Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:28.791512Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:28.978157Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:29.093508Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:29.096332Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:29.096382Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:25:29.583112Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:29.583163Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:29.886014Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:30.097344Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:30.097722Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb13206c0-0916-479e-b67f-8541c453ad47.sock: use of closed network connection
2020-08-31T01:25:30.097797Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:30.097824Z	error	sds	Remote side closed connection
2020-08-31T01:25:30.097840Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:30.097860Z	error	sds	Remote side closed connection
2020-08-31T01:25:30.097995Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest07343ddd-e6fe-4743-9522-061c0f477ad3.sock" 

2020-08-31T01:25:30.098062Z	info	sds	Start SDS grpc server
2020-08-31T01:25:30.098937Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:25:30.098987Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:25:30.099032Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:30.099489Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:25:30.099031241 +0000 UTC m=+6.805235200 and is waiting for next SDS request
2020-08-31T01:25:30.099510Z	info	sds	Dynamic push for secret default
2020-08-31T01:25:30.099534Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest07343ddd-e6fe-4743-9522-061c0f477ad3.sock: use of closed network connection
2020-08-31T01:25:30.099599Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:30.099612Z	error	sds	Remote side closed connection
2020-08-31T01:25:30.099631Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:30.099655Z	error	sds	Remote side closed connection
2020-08-31T01:25:30.099690Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest27caf5fd-7ca6-40a2-bda0-f732a07e8570.sock" 

2020-08-31T01:25:30.099707Z	info	sds	Start SDS grpc server
2020-08-31T01:25:30.100195Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:25:30.100226Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:25:30.100257Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:30.100839Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:25:30.187524Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:30.600976Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:30.601035Z	info	sds	Dynamic push for secret default
2020-08-31T01:25:30.601634Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest27caf5fd-7ca6-40a2-bda0-f732a07e8570.sock: use of closed network connection
2020-08-31T01:25:30.601718Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:30.601750Z	error	sds	Remote side closed connection
2020-08-31T01:25:30.601770Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:30.601788Z	error	sds	Remote side closed connection
2020-08-31T01:25:30.601884Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest77ec3717-6440-4abf-b1ad-d0dd44273ef3.sock" 

2020-08-31T01:25:30.601908Z	info	sds	Start SDS grpc server
2020-08-31T01:25:30.602210Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest77ec3717-6440-4abf-b1ad-d0dd44273ef3.sock: use of closed network connection
2020-08-31T01:25:30.602317Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestb1aa0ba1-bf6b-452c-bf91-634a060496f8.sock" 

2020-08-31T01:25:30.602337Z	info	sds	Start SDS grpc server
2020-08-31T01:25:30.791757Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:30.791800Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:30.903390Z	info	sds	resource:default new connection
2020-08-31T01:25:30.903448Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:25:30.903500Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:30.903794Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:30.903823Z	error	sds	Remote side closed connection
2020-08-31T01:25:31.093789Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:31.097927Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:31.099672Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:31.204929Z	info	sds	resource:default new connection
2020-08-31T01:25:31.205009Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:25:31.205074Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:31.205434Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:31.205468Z	error	sds	Remote side closed connection
2020-08-31T01:25:31.205680Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestb1aa0ba1-bf6b-452c-bf91-634a060496f8.sock: use of closed network connection
2020-08-31T01:25:31.205817Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest50d9d9af-56b2-4d77-b543-fc5492b69a33.sock" 

2020-08-31T01:25:31.205849Z	info	sds	Start SDS grpc server
2020-08-31T01:25:31.506732Z	info	sds	resource:default new connection
2020-08-31T01:25:31.506815Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:25:31.506907Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:31.507234Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:31.507252Z	error	sds	Remote side closed connection
2020-08-31T01:25:31.507614Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest50d9d9af-56b2-4d77-b543-fc5492b69a33.sock: use of closed network connection
2020-08-31T01:25:31.601838Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:31.602362Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:32.205914Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:32.372439Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:32.507832Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:25:32.675508Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:32.676506Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:32.978432Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:33.098165Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:33.099882Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:25:33.536796Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest307d42e1-b573-4097-ba9d-081a3003dd13.sock" 

2020-08-31T01:25:33.536843Z	info	sds	Start SDS grpc server
2020-08-31T01:25:33.583377Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:33.583444Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:33.602060Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:33.602507Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:33.886292Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:34.187710Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:34.206148Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:34.508076Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:34.537632Z	info	sds	resource:default new connection
2020-08-31T01:25:34.537706Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:25:34.540313Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:25:34.656110Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:25:34.656160Z	info	cache	GenerateSecret default
2020-08-31T01:25:34.656321Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:34.656793Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest307d42e1-b573-4097-ba9d-081a3003dd13.sock: use of closed network connection
PASS
2020-08-31T01:25:34.656906Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:34.656937Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.607s
2020-08-31T01:25:39.793814Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste5e7f8cc-71da-4f1c-a906-aa7eb667cd1e.sock" 

2020-08-31T01:25:39.793937Z	info	sds	Start SDS grpc server
2020-08-31T01:25:39.795200Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:25:39.795261Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:25:39.795608Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:40.795062Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:40.795206Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:25:41.795861Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:25:41.795945Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:25:41.795973Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:25:41.796109Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:41.796341Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste5e7f8cc-71da-4f1c-a906-aa7eb667cd1e.sock: use of closed network connection
2020-08-31T01:25:41.796487Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:41.796518Z	error	sds	Remote side closed connection
2020-08-31T01:25:41.796718Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1ccb5b7e-fb4a-4edb-9192-f6aa58dad819\".sock" 

2020-08-31T01:25:41.796766Z	info	sds	Start SDS grpc server
2020-08-31T01:25:42.097663Z	info	sds	resource:default new connection
2020-08-31T01:25:42.097733Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:25:42.097800Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:42.098303Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:42.098336Z	error	sds	Remote side closed connection
2020-08-31T01:25:42.098624Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:25:42.098654Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:25:42.098856Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:25:42.099103Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:42.099137Z	error	sds	Remote side closed connection
2020-08-31T01:25:42.099297Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1ccb5b7e-fb4a-4edb-9192-f6aa58dad819".sock: use of closed network connection
2020-08-31T01:25:42.099486Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"a3c8806f-205c-42f4-b289-8aaa7ec5dc1e\".sock" 

2020-08-31T01:25:42.099567Z	info	sds	Start SDS grpc server
2020-08-31T01:25:42.100021Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:25:42.100054Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:25:42.100087Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:25:42.100228Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:42.100238Z	error	sds	Remote side closed connection
2020-08-31T01:25:42.100422Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"a3c8806f-205c-42f4-b289-8aaa7ec5dc1e".sock: use of closed network connection
2020-08-31T01:25:42.100615Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"737a37f0-73c1-4fe8-8804-cfb490bea6cf\".sock" 

2020-08-31T01:25:42.100671Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:42.401660Z	info	sds	resource:default new connection
2020-08-31T01:25:42.401742Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:25:42.401797Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:42.402147Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:42.402172Z	error	sds	Remote side closed connection
2020-08-31T01:25:42.402382Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"737a37f0-73c1-4fe8-8804-cfb490bea6cf".sock: use of closed network connection
2020-08-31T01:25:42.402664Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"cd223e95-3d4d-41e6-88d7-4db749b0080a\".sock" 

2020-08-31T01:25:42.402684Z	info	sds	Start SDS grpc server
2020-08-31T01:25:42.402739Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"fdae5ef3-b5f5-4c7b-abad-a40a6a6061cb\".sock" 

2020-08-31T01:25:42.402763Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:42.704223Z	info	sds	resource:default new connection
2020-08-31T01:25:42.704297Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:25:42.704360Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:42.704648Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:42.704710Z	error	sds	Remote side closed connection
2020-08-31T01:25:42.705235Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:25:42.705283Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:25:42.705327Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:25:42.705592Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:42.705647Z	error	sds	Remote side closed connection
2020-08-31T01:25:42.796587Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:43.006572Z	info	sds	resource:default new connection
2020-08-31T01:25:43.006628Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:25:43.006680Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:43.007027Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:43.007053Z	error	sds	Remote side closed connection
2020-08-31T01:25:43.007225Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"cd223e95-3d4d-41e6-88d7-4db749b0080a".sock: use of closed network connection
2020-08-31T01:25:43.007272Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"fdae5ef3-b5f5-4c7b-abad-a40a6a6061cb".sock: use of closed network connection
2020-08-31T01:25:43.007504Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"f724dda0-5d74-44e0-ae16-2906a81dc4d8\".sock" 

2020-08-31T01:25:43.007535Z	info	sds	Start SDS grpc server
2020-08-31T01:25:43.099471Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:43.100585Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:25:43.309945Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"f724dda0-5d74-44e0-ae16-2906a81dc4d8".sock: use of closed network connection
2020-08-31T01:25:43.310179Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8870f7f8-5a5c-4b2c-aeaf-131c30c08cda\".sock" 

2020-08-31T01:25:43.310208Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:43.402619Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:25:43.611556Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8870f7f8-5a5c-4b2c-aeaf-131c30c08cda".sock: use of closed network connection
2020-08-31T01:25:43.611739Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest18497e30-9bb1-4e20-8382-9694e56088b9.sock" 

2020-08-31T01:25:43.611793Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"b841818b-d9a4-49b7-91ba-7e3980d73b39\".sock" 

2020-08-31T01:25:43.611837Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:43.611833Z	info	sds	Start SDS grpc server
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:25:44.007439Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:44.007471Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:25:44.215907Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest18497e30-9bb1-4e20-8382-9694e56088b9.sock: use of closed network connection
2020-08-31T01:25:44.215962Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"b841818b-d9a4-49b7-91ba-7e3980d73b39".sock: use of closed network connection
2020-08-31T01:25:44.216226Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestb10b8aac-5575-462f-b1cf-099f5d533740.sock" 

2020-08-31T01:25:44.216250Z	info	sds	Start SDS grpc server
2020-08-31T01:25:44.310147Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:44.517366Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:25:44.517470Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:44.517722Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestb10b8aac-5575-462f-b1cf-099f5d533740.sock: use of closed network connection
2020-08-31T01:25:44.517952Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestd0343bad-720a-4433-894b-9b46f44272bd.sock" 

2020-08-31T01:25:44.518083Z	info	sds	Start SDS grpc server
2020-08-31T01:25:44.519269Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:25:44.519329Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:25:44.519378Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:44.519454Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:25:44.519496Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:25:44.519532Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:25:44.611774Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:44.796863Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:45.099699Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:45.100768Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:45.216101Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:45.216132Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:45.402833Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:45.517935Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:45.519527Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:45.519559Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:25:46.007741Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:46.007755Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:46.310369Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:46.520340Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:46.520729Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:46.520757Z	error	sds	Remote side closed connection
2020-08-31T01:25:46.520706Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestd0343bad-720a-4433-894b-9b46f44272bd.sock: use of closed network connection
2020-08-31T01:25:46.520976Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:46.520999Z	error	sds	Remote side closed connection
2020-08-31T01:25:46.520996Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest54c95f52-48e3-4e7a-8998-aaf66d0ee334.sock" 

2020-08-31T01:25:46.521134Z	info	sds	Start SDS grpc server
2020-08-31T01:25:46.521803Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:25:46.521852Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:25:46.521900Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:46.522490Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:25:46.521899916 +0000 UTC m=+6.802565581 and is waiting for next SDS request
2020-08-31T01:25:46.522498Z	info	sds	Dynamic push for secret default
2020-08-31T01:25:46.522543Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest54c95f52-48e3-4e7a-8998-aaf66d0ee334.sock: use of closed network connection
2020-08-31T01:25:46.522602Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:46.522622Z	error	sds	Remote side closed connection
2020-08-31T01:25:46.522664Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:46.522670Z	error	sds	Remote side closed connection
2020-08-31T01:25:46.522815Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfe38e562-1735-4663-bd78-da16a474a620.sock" 

2020-08-31T01:25:46.522860Z	info	sds	Start SDS grpc server
2020-08-31T01:25:46.525549Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:25:46.525621Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:25:46.525673Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:46.526344Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:25:46.612043Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:47.026491Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:47.026540Z	info	sds	Dynamic push for secret default
2020-08-31T01:25:47.027170Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfe38e562-1735-4663-bd78-da16a474a620.sock: use of closed network connection
2020-08-31T01:25:47.027262Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:47.027284Z	error	sds	Remote side closed connection
2020-08-31T01:25:47.027464Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:47.027497Z	error	sds	Remote side closed connection
2020-08-31T01:25:47.027583Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestfe91e9a3-d671-431b-b461-046b08074b7c.sock" 

2020-08-31T01:25:47.027699Z	info	sds	Start SDS grpc server
2020-08-31T01:25:47.027824Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestfe91e9a3-d671-431b-b461-046b08074b7c.sock: use of closed network connection
2020-08-31T01:25:47.027943Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest4699241b-7bc0-4f60-a578-453ea92c362b.sock" 

2020-08-31T01:25:47.027959Z	info	sds	Start SDS grpc server
2020-08-31T01:25:47.216405Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:47.216439Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:47.328839Z	info	sds	resource:default new connection
2020-08-31T01:25:47.328903Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:25:47.328969Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:47.329377Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:47.329411Z	error	sds	Remote side closed connection
2020-08-31T01:25:47.518242Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:47.520937Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:47.522703Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:47.630263Z	info	sds	resource:default new connection
2020-08-31T01:25:47.630333Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:25:47.630384Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:47.630727Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:47.630769Z	error	sds	Remote side closed connection
2020-08-31T01:25:47.630938Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest4699241b-7bc0-4f60-a578-453ea92c362b.sock: use of closed network connection
2020-08-31T01:25:47.631059Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest0da559d7-9e59-46a5-a8df-0cb2517914a7.sock" 

2020-08-31T01:25:47.631082Z	info	sds	Start SDS grpc server
2020-08-31T01:25:47.932003Z	info	sds	resource:default new connection
2020-08-31T01:25:47.932088Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:25:47.932143Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:47.932430Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:47.932446Z	error	sds	Remote side closed connection
2020-08-31T01:25:47.932918Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest0da559d7-9e59-46a5-a8df-0cb2517914a7.sock: use of closed network connection
2020-08-31T01:25:48.027433Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:48.027949Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:48.631202Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:48.797096Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:48.933059Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:25:49.099808Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:49.100961Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:49.403112Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:49.521171Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:49.522812Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:25:49.962168Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf64b0823-8b6c-46b8-a3ca-e35fb8f4b27e.sock" 

2020-08-31T01:25:49.962217Z	info	sds	Start SDS grpc server
2020-08-31T01:25:50.008033Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:50.008096Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:50.027680Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:50.028121Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:50.310613Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:50.612280Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:25:50.631442Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:50.933362Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:50.963506Z	info	sds	resource:default new connection
2020-08-31T01:25:50.963574Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:25:50.967246Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:25:51.172385Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:25:51.172429Z	info	cache	GenerateSecret default
2020-08-31T01:25:51.172501Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:51.172978Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf64b0823-8b6c-46b8-a3ca-e35fb8f4b27e.sock: use of closed network connection
PASS
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.695s
2020-08-31T01:25:56.391354Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestf9eca4ee-265e-445d-ad19-b991f613f21a.sock" 

2020-08-31T01:25:56.391474Z	info	sds	Start SDS grpc server
2020-08-31T01:25:56.394445Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:25:56.394511Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:25:56.394972Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:57.393688Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:57.393754Z	error	sds	Remote side closed connection
mockIngressGatewaySecretStore,conId: sidecar~127.0.0.1~SecretsPushStreamOne~local-1, resourceName: default2020-08-31T01:25:58.394525Z	info	sds	resource:default new connection
cannot find secret {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} in cache
2020-08-31T01:25:58.394605Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2 default} . token:  faketoken1
2020-08-31T01:25:58.394629Z	error	sds	resource:default Close connection. Failed to get secret for proxy "invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local" from secret cache: invalid connection for test
mockIngressGatewaySecretStore,conId: invalid~sidecar~127.0.0.1~SecretsPushStreamOne~local-2, resourceName: default2020-08-31T01:25:58.394681Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:58.394971Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestf9eca4ee-265e-445d-ad19-b991f613f21a.sock: use of closed network connection
2020-08-31T01:25:58.395165Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:58.395212Z	error	sds	Remote side closed connection
2020-08-31T01:25:58.395278Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"1f20ee36-c228-42a3-838e-0cb76172ee56\".sock" 

2020-08-31T01:25:58.395317Z	info	sds	Start SDS grpc server
2020-08-31T01:25:58.696308Z	info	sds	resource:default new connection
2020-08-31T01:25:58.696383Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-3 default} . token:  faketoken1
2020-08-31T01:25:58.696453Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:58.696854Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:58.696878Z	error	sds	Remote side closed connection
2020-08-31T01:25:58.697369Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:25:58.697419Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-4 ROOTCA} . token:  faketoken1
2020-08-31T01:25:58.697554Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:25:58.697826Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:58.697847Z	error	sds	Remote side closed connection
2020-08-31T01:25:58.698173Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"1f20ee36-c228-42a3-838e-0cb76172ee56".sock: use of closed network connection
2020-08-31T01:25:58.698510Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"5e24c7ca-af97-4c54-aa8c-d81a6c7b5d9e\".sock" 

2020-08-31T01:25:58.698611Z	info	sds	Start SDS grpc server
2020-08-31T01:25:58.699202Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem new connection
2020-08-31T01:25:58.699251Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-5 file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem} . token:  
2020-08-31T01:25:58.699299Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem pushed root cert to proxy
2020-08-31T01:25:58.699572Z	info	sds	resource:file-root:/usr/local/google/home/fengxiangli/go/src/istio.io/istio/security/pkg/nodeagent/sds/testdata/root-cert.pem connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:58.699593Z	error	sds	Remote side closed connection
2020-08-31T01:25:58.699765Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"5e24c7ca-af97-4c54-aa8c-d81a6c7b5d9e".sock: use of closed network connection
2020-08-31T01:25:58.699923Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"1d98a830-647e-4cfa-aeaa-6de102fc8c28\".sock" 

2020-08-31T01:25:58.699954Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:59.000984Z	info	sds	resource:default new connection
2020-08-31T01:25:59.001047Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-6 default} . token:  
2020-08-31T01:25:59.001108Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:59.001396Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:59.001429Z	error	sds	Remote side closed connection
2020-08-31T01:25:59.001725Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"1d98a830-647e-4cfa-aeaa-6de102fc8c28".sock: use of closed network connection
2020-08-31T01:25:59.001968Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"b5a044c2-9439-4356-9e7a-1550a7fefad3\".sock" 

2020-08-31T01:25:59.002024Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"03169975-c522-4bd4-b57f-e7e997f06dd5\".sock" 

2020-08-31T01:25:59.002011Z	info	sds	Start SDS grpc server
2020-08-31T01:25:59.002057Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:25:59.303084Z	info	sds	resource:default new connection
2020-08-31T01:25:59.303153Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-7 default} . token:  faketoken1
2020-08-31T01:25:59.303208Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:59.303551Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:59.303593Z	error	sds	Remote side closed connection
2020-08-31T01:25:59.304366Z	info	sds	resource:ROOTCA new connection
2020-08-31T01:25:59.304408Z	info	sds	Skipping waiting for gateway secret
Store root cert for key:  {sidecar~127.0.0.1~id1~local-8 ROOTCA} . token:  faketoken1
2020-08-31T01:25:59.304450Z	info	sds	resource:ROOTCA pushed root cert to proxy
2020-08-31T01:25:59.304711Z	info	sds	resource:ROOTCA connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:59.304723Z	error	sds	Remote side closed connection
2020-08-31T01:25:59.395195Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:59.605727Z	info	sds	resource:default new connection
2020-08-31T01:25:59.605785Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~id1~local-9 default} . token:  
2020-08-31T01:25:59.605836Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:25:59.606197Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:25:59.606234Z	error	sds	Remote side closed connection
2020-08-31T01:25:59.606408Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"b5a044c2-9439-4356-9e7a-1550a7fefad3".sock: use of closed network connection
2020-08-31T01:25:59.606459Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"03169975-c522-4bd4-b57f-e7e997f06dd5".sock: use of closed network connection
2020-08-31T01:25:59.606664Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest\"3367e3a5-674f-464b-87b2-111bac01f2ec\".sock" 

2020-08-31T01:25:59.606689Z	info	sds	Start SDS grpc server
2020-08-31T01:25:59.698392Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:25:59.699980Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-10 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-11 ROOTCA} . token:  faketoken1
2020-08-31T01:25:59.909132Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest"3367e3a5-674f-464b-87b2-111bac01f2ec".sock: use of closed network connection
2020-08-31T01:25:59.909357Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"a605f1d5-bb9e-40fe-9e57-d7f64c48fd28\".sock" 

2020-08-31T01:25:59.909377Z	info	sds	Start SDS grpc server for ingress gateway proxy
2020-08-31T01:26:00.001999Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-12 default} . token:  
2020-08-31T01:26:00.210936Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"a605f1d5-bb9e-40fe-9e57-d7f64c48fd28".sock: use of closed network connection
2020-08-31T01:26:00.211126Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotest36dde843-6d56-4794-8c64-c31ac6d250b1.sock" 

2020-08-31T01:26:00.211142Z	info	sds	Start SDS grpc server
2020-08-31T01:26:00.211187Z	info	sds	SDS gRPC server for gateway controller starts, listening on "/tmp/gateway_gotest\"8a406b6c-a646-4891-84c2-9ab538489142\".sock" 

2020-08-31T01:26:00.211190Z	info	sds	Start SDS grpc server for ingress gateway proxy
Store secret for key:  {sidecar~127.0.0.1~id1~local-13 default} . token:  faketoken1
Store root cert for key:  {sidecar~127.0.0.1~id1~local-14 ROOTCA} . token:  faketoken1
2020-08-31T01:26:00.606536Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:00.606531Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
Store secret for key:  {sidecar~127.0.0.1~id1~local-15 default} . token:  
2020-08-31T01:26:00.815034Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotest36dde843-6d56-4794-8c64-c31ac6d250b1.sock: use of closed network connection
2020-08-31T01:26:00.815083Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: accept unix /tmp/gateway_gotest"8a406b6c-a646-4891-84c2-9ab538489142".sock: use of closed network connection
2020-08-31T01:26:00.815300Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/workload_gotestddb56409-413e-43d8-8c1e-98468a268b16.sock" 

2020-08-31T01:26:00.815342Z	info	sds	Start SDS grpc server
2020-08-31T01:26:00.909395Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:01.116459Z	error	sds	Close connection. Error: discovery request node:{id:"sidecar~127.0.0.1~id1~local"}  resource_names:"default"  resource_names:"extra-resource-name"  type_url:"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret" has more than one resourceNames [default extra-resource-name]
2020-08-31T01:26:01.116553Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:01.116819Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/workload_gotestddb56409-413e-43d8-8c1e-98468a268b16.sock: use of closed network connection
2020-08-31T01:26:01.117097Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest1e59bec5-88c7-46bb-9411-975196813501.sock" 

2020-08-31T01:26:01.117113Z	info	sds	Start SDS grpc server
2020-08-31T01:26:01.118708Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} in cache
2020-08-31T01:26:01.118777Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . token:  faketoken1
2020-08-31T01:26:01.118842Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:01.118916Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} in cache
2020-08-31T01:26:01.118963Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsPushStreamTwo~local-2 default} . token:  faketoken2
2020-08-31T01:26:01.118999Z	info	sds	resource:default pushed key/cert pair to proxy
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:26:01.211168Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:01.395485Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:01.698646Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:01.700144Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:01.815249Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:01.815284Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:02.002253Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:02.117100Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:02.118961Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:02.118995Z	info	sds	Dynamic push for secret default
key is:  {sidecar~127.0.0.1~SecretsPushStreamOne~local-1 default} . Token:  faketoken1
requested secret matches cache
2020-08-31T01:26:02.606819Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:02.606864Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:02.909676Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:03.119854Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:03.120204Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest1e59bec5-88c7-46bb-9411-975196813501.sock: use of closed network connection
2020-08-31T01:26:03.120327Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:03.120337Z	error	sds	Remote side closed connection
2020-08-31T01:26:03.120368Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:03.120374Z	error	sds	Remote side closed connection
2020-08-31T01:26:03.120554Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest792a714f-0976-4b14-aba0-65c6a9115b9c.sock" 

2020-08-31T01:26:03.120687Z	info	sds	Start SDS grpc server
2020-08-31T01:26:03.121313Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} in cache
2020-08-31T01:26:03.121354Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~StreamMultiplePush~local-1 default} . token:  faketoken1
2020-08-31T01:26:03.121398Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:03.121838Z	error	sds	resource:default skip multiple push, last push finishes at 2020-08-31 01:26:03.121397479 +0000 UTC m=+6.803063538 and is waiting for next SDS request
2020-08-31T01:26:03.121860Z	info	sds	Dynamic push for secret default
2020-08-31T01:26:03.121890Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest792a714f-0976-4b14-aba0-65c6a9115b9c.sock: use of closed network connection
2020-08-31T01:26:03.121977Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:03.122002Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:03.121992Z	error	sds	Remote side closed connection
2020-08-31T01:26:03.122012Z	error	sds	Remote side closed connection
2020-08-31T01:26:03.122076Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotestc77efb70-a0d9-4e98-8f44-656f55c3846e.sock" 

2020-08-31T01:26:03.122175Z	info	sds	Start SDS grpc server
2020-08-31T01:26:03.122967Z	info	sds	resource:default new connection
cannot find secret {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} in cache
2020-08-31T01:26:03.123006Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~SecretsUpdateFailure~local-1 default} . token:  faketoken1
2020-08-31T01:26:03.123039Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:03.123800Z	error	sds	resource:default received error: code:13  message:"fake error". Will not respond until next secret update
2020-08-31T01:26:03.211412Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:03.623933Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:03.623983Z	info	sds	Dynamic push for secret default
2020-08-31T01:26:03.624601Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotestc77efb70-a0d9-4e98-8f44-656f55c3846e.sock: use of closed network connection
2020-08-31T01:26:03.624773Z	info	sds	resource: connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:03.624774Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:03.624811Z	error	sds	Remote side closed connection
2020-08-31T01:26:03.624798Z	error	sds	Remote side closed connection
2020-08-31T01:26:03.624918Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest494bbfaf-a844-4da8-b956-a58a93439a72.sock" 

2020-08-31T01:26:03.624950Z	info	sds	Start SDS grpc server
2020-08-31T01:26:03.625174Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest494bbfaf-a844-4da8-b956-a58a93439a72.sock: use of closed network connection
2020-08-31T01:26:03.625279Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest752a742e-018d-427b-981e-bcac4507950e.sock" 

2020-08-31T01:26:03.625297Z	info	sds	Start SDS grpc server
2020-08-31T01:26:03.815519Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:03.815580Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:03.926101Z	info	sds	resource:default new connection
2020-08-31T01:26:03.926150Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy1~local-2 default} . token:  faketoken1
2020-08-31T01:26:03.926205Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:03.926518Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:03.926544Z	error	sds	Remote side closed connection
2020-08-31T01:26:04.117322Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:04.120418Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:04.122050Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:04.227487Z	info	sds	resource:default new connection
2020-08-31T01:26:04.227579Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy2~local-3 default} . token:  faketoken1
2020-08-31T01:26:04.227629Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:04.227801Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:04.227836Z	error	sds	Remote side closed connection
2020-08-31T01:26:04.228093Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest752a742e-018d-427b-981e-bcac4507950e.sock: use of closed network connection
2020-08-31T01:26:04.228254Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/goteste50f8e86-1eab-4496-96dd-e41f17c80545.sock" 

2020-08-31T01:26:04.228288Z	info	sds	Start SDS grpc server
2020-08-31T01:26:04.529130Z	info	sds	resource:default new connection
2020-08-31T01:26:04.529188Z	info	sds	Skipping waiting for gateway secret
Store secret for key:  {sidecar~127.0.0.1~DebugEndpointProxy3~local-4 default} . token:  faketoken1
2020-08-31T01:26:04.529247Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:04.529527Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:04.529553Z	error	sds	Remote side closed connection
2020-08-31T01:26:04.529846Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/goteste50f8e86-1eab-4496-96dd-e41f17c80545.sock: use of closed network connection
2020-08-31T01:26:04.624850Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:04.625293Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:05.228260Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:05.395767Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:05.530083Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
CA server is up.
2020-08-31T01:26:05.698910Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:05.700335Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:06.002491Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:06.120697Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:06.122236Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
STS server is up.
2020-08-31T01:26:06.562757Z	info	sds	SDS gRPC server for workload UDS starts, listening on "/tmp/gotest5f7d2c65-9127-4890-a9f1-f32979c3877e.sock" 

2020-08-31T01:26:06.562821Z	info	sds	Start SDS grpc server
2020-08-31T01:26:06.607036Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:06.607070Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:06.625115Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:06.625351Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:06.909941Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:07.211662Z	error	sds	SDS grpc server for ingress gateway proxy failed to start: grpc: the server has been stopped
2020-08-31T01:26:07.228420Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:07.530338Z	error	sds	SDS grpc server for workload proxies failed to start: grpc: the server has been stopped
2020-08-31T01:26:07.563741Z	info	sds	resource:default new connection
2020-08-31T01:26:07.563802Z	info	sds	Skipping waiting for gateway secret
2020-08-31T01:26:07.569335Z	warn	cache	resource:default failed to extract host name from jwt: invalid k8s jwt token, fallback to SDS request resource name: default
2020-08-31T01:26:07.709677Z	info	cache	Root cert has changed, start rotating root cert for SDS clients
2020-08-31T01:26:07.709721Z	info	cache	GenerateSecret default
2020-08-31T01:26:07.709782Z	info	sds	resource:default pushed key/cert pair to proxy
2020-08-31T01:26:07.710148Z	error	sds	SDS grpc server for workload proxies failed to start: accept unix /tmp/gotest5f7d2c65-9127-4890-a9f1-f32979c3877e.sock: use of closed network connection
PASS
2020-08-31T01:26:07.710242Z	info	sds	resource:default connection is terminated: rpc error: code = Canceled desc = context canceled
2020-08-31T01:26:07.710274Z	error	sds	Remote side closed connection
ok  	istio.io/istio/security/pkg/nodeagent/sds	11.635s
