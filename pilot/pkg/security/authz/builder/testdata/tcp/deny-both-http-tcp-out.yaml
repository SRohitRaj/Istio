name: envoy.filters.network.rbac
typedConfig:
  '@type': type.googleapis.com/envoy.extensions.filters.network.rbac.v3.RBAC
  rules:
    action: DENY
    policies:
      ns[foo]-policy[httpbin-deny]-rule[7]:
        permissions:
        - andRules:
            rules:
            - orRules:
                rules:
                - destinationPort: 80
        principals:
        - andIds:
            ids:
            - orIds:
                ids:
                - filterState:
                    key: io.istio.peer_principal
                    stringMatch:
                      safeRegex:
                        regex: .*/ns/ns-1/.*
      ns[foo]-policy[httpbin-deny]-rule[9]:
        permissions:
        - andRules:
            rules:
            - orRules:
                rules:
                - destinationPort: 80
        principals:
        - andIds:
            ids:
            - any: true
  shadowRulesStatPrefix: istio_dry_run_allow_
  statPrefix: tcp.
