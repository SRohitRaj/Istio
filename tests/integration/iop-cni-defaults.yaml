# This file provides CNI defaults for integration testing.
apiVersion: install.istio.io/v1alpha1
kind: IstioOperator
spec:
  components:
    cni:
      namespace: kube-system
      enabled: true
      k8s:
        env:
          - name: LOG_UDS_ADDRESS
            value: "/var/run/istio-cni/cni.sock"
        overlays:
          - kind: DaemonSet
            name: istio-cni-node
            patches:
            - path: 'spec.template.spec.volumes[100]'
              value:
                hostPath:
                  path: /var/run/istio-cni
                name: var-run-istio-cni
            - path: 'spec.template.spec.containers[0].volumeMounts[100]'
              value:
                mountPath: /var/run/istio-cni
                name: var-run-istio-cni
